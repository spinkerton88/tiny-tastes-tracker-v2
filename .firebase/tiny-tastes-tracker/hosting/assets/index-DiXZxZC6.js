function DA(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const o in i)if(o!=="default"&&!(o in n)){const c=Object.getOwnPropertyDescriptor(i,o);c&&Object.defineProperty(n,o,c.get?c:{enumerable:!0,get:()=>i[o]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var $d=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wg(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var sm={exports:{}},ou={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yy;function OA(){if(yy)return ou;yy=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,c){var f=null;if(c!==void 0&&(f=""+c),o.key!==void 0&&(f=""+o.key),"key"in o){c={};for(var y in o)y!=="key"&&(c[y]=o[y])}else c=o;return o=c.ref,{$$typeof:n,type:i,key:f,ref:o!==void 0?o:null,props:c}}return ou.Fragment=e,ou.jsx=t,ou.jsxs=t,ou}var vy;function kA(){return vy||(vy=1,sm.exports=OA()),sm.exports}var h=kA(),rm={exports:{}},Mt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wy;function PA(){if(wy)return Mt;wy=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),f=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),R=Symbol.iterator;function k(ae){return ae===null||typeof ae!="object"?null:(ae=R&&ae[R]||ae["@@iterator"],typeof ae=="function"?ae:null)}var H={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},W=Object.assign,K={};function te(ae,Ie,Ae){this.props=ae,this.context=Ie,this.refs=K,this.updater=Ae||H}te.prototype.isReactComponent={},te.prototype.setState=function(ae,Ie){if(typeof ae!="object"&&typeof ae!="function"&&ae!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ae,Ie,"setState")},te.prototype.forceUpdate=function(ae){this.updater.enqueueForceUpdate(this,ae,"forceUpdate")};function le(){}le.prototype=te.prototype;function ee(ae,Ie,Ae){this.props=ae,this.context=Ie,this.refs=K,this.updater=Ae||H}var de=ee.prototype=new le;de.constructor=ee,W(de,te.prototype),de.isPureReactComponent=!0;var Ee=Array.isArray;function me(){}var U={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function F(ae,Ie,Ae){var je=Ae.ref;return{$$typeof:n,type:ae,key:Ie,ref:je!==void 0?je:null,props:Ae}}function Q(ae,Ie){return F(ae.type,Ie,ae.props)}function Y(ae){return typeof ae=="object"&&ae!==null&&ae.$$typeof===n}function $(ae){var Ie={"=":"=0",":":"=2"};return"$"+ae.replace(/[=:]/g,function(Ae){return Ie[Ae]})}var z=/\/+/g;function _e(ae,Ie){return typeof ae=="object"&&ae!==null&&ae.key!=null?$(""+ae.key):Ie.toString(36)}function he(ae){switch(ae.status){case"fulfilled":return ae.value;case"rejected":throw ae.reason;default:switch(typeof ae.status=="string"?ae.then(me,me):(ae.status="pending",ae.then(function(Ie){ae.status==="pending"&&(ae.status="fulfilled",ae.value=Ie)},function(Ie){ae.status==="pending"&&(ae.status="rejected",ae.reason=Ie)})),ae.status){case"fulfilled":return ae.value;case"rejected":throw ae.reason}}throw ae}function ne(ae,Ie,Ae,je,rt){var pe=typeof ae;(pe==="undefined"||pe==="boolean")&&(ae=null);var Ve=!1;if(ae===null)Ve=!0;else switch(pe){case"bigint":case"string":case"number":Ve=!0;break;case"object":switch(ae.$$typeof){case n:case e:Ve=!0;break;case A:return Ve=ae._init,ne(Ve(ae._payload),Ie,Ae,je,rt)}}if(Ve)return rt=rt(ae),Ve=je===""?"."+_e(ae,0):je,Ee(rt)?(Ae="",Ve!=null&&(Ae=Ve.replace(z,"$&/")+"/"),ne(rt,Ie,Ae,"",function(Mn){return Mn})):rt!=null&&(Y(rt)&&(rt=Q(rt,Ae+(rt.key==null||ae&&ae.key===rt.key?"":(""+rt.key).replace(z,"$&/")+"/")+Ve)),Ie.push(rt)),1;Ve=0;var Ke=je===""?".":je+":";if(Ee(ae))for(var it=0;it<ae.length;it++)je=ae[it],pe=Ke+_e(je,it),Ve+=ne(je,Ie,Ae,pe,rt);else if(it=k(ae),typeof it=="function")for(ae=it.call(ae),it=0;!(je=ae.next()).done;)je=je.value,pe=Ke+_e(je,it++),Ve+=ne(je,Ie,Ae,pe,rt);else if(pe==="object"){if(typeof ae.then=="function")return ne(he(ae),Ie,Ae,je,rt);throw Ie=String(ae),Error("Objects are not valid as a React child (found: "+(Ie==="[object Object]"?"object with keys {"+Object.keys(ae).join(", ")+"}":Ie)+"). If you meant to render a collection of children, use an array instead.")}return Ve}function ie(ae,Ie,Ae){if(ae==null)return ae;var je=[],rt=0;return ne(ae,je,"","",function(pe){return Ie.call(Ae,pe,rt++)}),je}function Me(ae){if(ae._status===-1){var Ie=ae._result;Ie=Ie(),Ie.then(function(Ae){(ae._status===0||ae._status===-1)&&(ae._status=1,ae._result=Ae)},function(Ae){(ae._status===0||ae._status===-1)&&(ae._status=2,ae._result=Ae)}),ae._status===-1&&(ae._status=0,ae._result=Ie)}if(ae._status===1)return ae._result.default;throw ae._result}var ze=typeof reportError=="function"?reportError:function(ae){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ie=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ae=="object"&&ae!==null&&typeof ae.message=="string"?String(ae.message):String(ae),error:ae});if(!window.dispatchEvent(Ie))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ae);return}console.error(ae)},ct={map:ie,forEach:function(ae,Ie,Ae){ie(ae,function(){Ie.apply(this,arguments)},Ae)},count:function(ae){var Ie=0;return ie(ae,function(){Ie++}),Ie},toArray:function(ae){return ie(ae,function(Ie){return Ie})||[]},only:function(ae){if(!Y(ae))throw Error("React.Children.only expected to receive a single React element child.");return ae}};return Mt.Activity=N,Mt.Children=ct,Mt.Component=te,Mt.Fragment=t,Mt.Profiler=o,Mt.PureComponent=ee,Mt.StrictMode=i,Mt.Suspense=w,Mt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,Mt.__COMPILER_RUNTIME={__proto__:null,c:function(ae){return U.H.useMemoCache(ae)}},Mt.cache=function(ae){return function(){return ae.apply(null,arguments)}},Mt.cacheSignal=function(){return null},Mt.cloneElement=function(ae,Ie,Ae){if(ae==null)throw Error("The argument must be a React element, but you passed "+ae+".");var je=W({},ae.props),rt=ae.key;if(Ie!=null)for(pe in Ie.key!==void 0&&(rt=""+Ie.key),Ie)!V.call(Ie,pe)||pe==="key"||pe==="__self"||pe==="__source"||pe==="ref"&&Ie.ref===void 0||(je[pe]=Ie[pe]);var pe=arguments.length-2;if(pe===1)je.children=Ae;else if(1<pe){for(var Ve=Array(pe),Ke=0;Ke<pe;Ke++)Ve[Ke]=arguments[Ke+2];je.children=Ve}return F(ae.type,rt,je)},Mt.createContext=function(ae){return ae={$$typeof:f,_currentValue:ae,_currentValue2:ae,_threadCount:0,Provider:null,Consumer:null},ae.Provider=ae,ae.Consumer={$$typeof:c,_context:ae},ae},Mt.createElement=function(ae,Ie,Ae){var je,rt={},pe=null;if(Ie!=null)for(je in Ie.key!==void 0&&(pe=""+Ie.key),Ie)V.call(Ie,je)&&je!=="key"&&je!=="__self"&&je!=="__source"&&(rt[je]=Ie[je]);var Ve=arguments.length-2;if(Ve===1)rt.children=Ae;else if(1<Ve){for(var Ke=Array(Ve),it=0;it<Ve;it++)Ke[it]=arguments[it+2];rt.children=Ke}if(ae&&ae.defaultProps)for(je in Ve=ae.defaultProps,Ve)rt[je]===void 0&&(rt[je]=Ve[je]);return F(ae,pe,rt)},Mt.createRef=function(){return{current:null}},Mt.forwardRef=function(ae){return{$$typeof:y,render:ae}},Mt.isValidElement=Y,Mt.lazy=function(ae){return{$$typeof:A,_payload:{_status:-1,_result:ae},_init:Me}},Mt.memo=function(ae,Ie){return{$$typeof:x,type:ae,compare:Ie===void 0?null:Ie}},Mt.startTransition=function(ae){var Ie=U.T,Ae={};U.T=Ae;try{var je=ae(),rt=U.S;rt!==null&&rt(Ae,je),typeof je=="object"&&je!==null&&typeof je.then=="function"&&je.then(me,ze)}catch(pe){ze(pe)}finally{Ie!==null&&Ae.types!==null&&(Ie.types=Ae.types),U.T=Ie}},Mt.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},Mt.use=function(ae){return U.H.use(ae)},Mt.useActionState=function(ae,Ie,Ae){return U.H.useActionState(ae,Ie,Ae)},Mt.useCallback=function(ae,Ie){return U.H.useCallback(ae,Ie)},Mt.useContext=function(ae){return U.H.useContext(ae)},Mt.useDebugValue=function(){},Mt.useDeferredValue=function(ae,Ie){return U.H.useDeferredValue(ae,Ie)},Mt.useEffect=function(ae,Ie){return U.H.useEffect(ae,Ie)},Mt.useEffectEvent=function(ae){return U.H.useEffectEvent(ae)},Mt.useId=function(){return U.H.useId()},Mt.useImperativeHandle=function(ae,Ie,Ae){return U.H.useImperativeHandle(ae,Ie,Ae)},Mt.useInsertionEffect=function(ae,Ie){return U.H.useInsertionEffect(ae,Ie)},Mt.useLayoutEffect=function(ae,Ie){return U.H.useLayoutEffect(ae,Ie)},Mt.useMemo=function(ae,Ie){return U.H.useMemo(ae,Ie)},Mt.useOptimistic=function(ae,Ie){return U.H.useOptimistic(ae,Ie)},Mt.useReducer=function(ae,Ie,Ae){return U.H.useReducer(ae,Ie,Ae)},Mt.useRef=function(ae){return U.H.useRef(ae)},Mt.useState=function(ae){return U.H.useState(ae)},Mt.useSyncExternalStore=function(ae,Ie,Ae){return U.H.useSyncExternalStore(ae,Ie,Ae)},Mt.useTransition=function(){return U.H.useTransition()},Mt.version="19.2.3",Mt}var by;function bg(){return by||(by=1,rm.exports=PA()),rm.exports}var oe=bg();const cE=wg(oe);var om={exports:{}},au={},am={exports:{}},lm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ey;function LA(){return Ey||(Ey=1,(function(n){function e(ne,ie){var Me=ne.length;ne.push(ie);e:for(;0<Me;){var ze=Me-1>>>1,ct=ne[ze];if(0<o(ct,ie))ne[ze]=ie,ne[Me]=ct,Me=ze;else break e}}function t(ne){return ne.length===0?null:ne[0]}function i(ne){if(ne.length===0)return null;var ie=ne[0],Me=ne.pop();if(Me!==ie){ne[0]=Me;e:for(var ze=0,ct=ne.length,ae=ct>>>1;ze<ae;){var Ie=2*(ze+1)-1,Ae=ne[Ie],je=Ie+1,rt=ne[je];if(0>o(Ae,Me))je<ct&&0>o(rt,Ae)?(ne[ze]=rt,ne[je]=Me,ze=je):(ne[ze]=Ae,ne[Ie]=Me,ze=Ie);else if(je<ct&&0>o(rt,Me))ne[ze]=rt,ne[je]=Me,ze=je;else break e}}return ie}function o(ne,ie){var Me=ne.sortIndex-ie.sortIndex;return Me!==0?Me:ne.id-ie.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var f=Date,y=f.now();n.unstable_now=function(){return f.now()-y}}var w=[],x=[],A=1,N=null,R=3,k=!1,H=!1,W=!1,K=!1,te=typeof setTimeout=="function"?setTimeout:null,le=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;function de(ne){for(var ie=t(x);ie!==null;){if(ie.callback===null)i(x);else if(ie.startTime<=ne)i(x),ie.sortIndex=ie.expirationTime,e(w,ie);else break;ie=t(x)}}function Ee(ne){if(W=!1,de(ne),!H)if(t(w)!==null)H=!0,me||(me=!0,$());else{var ie=t(x);ie!==null&&he(Ee,ie.startTime-ne)}}var me=!1,U=-1,V=5,F=-1;function Q(){return K?!0:!(n.unstable_now()-F<V)}function Y(){if(K=!1,me){var ne=n.unstable_now();F=ne;var ie=!0;try{e:{H=!1,W&&(W=!1,le(U),U=-1),k=!0;var Me=R;try{t:{for(de(ne),N=t(w);N!==null&&!(N.expirationTime>ne&&Q());){var ze=N.callback;if(typeof ze=="function"){N.callback=null,R=N.priorityLevel;var ct=ze(N.expirationTime<=ne);if(ne=n.unstable_now(),typeof ct=="function"){N.callback=ct,de(ne),ie=!0;break t}N===t(w)&&i(w),de(ne)}else i(w);N=t(w)}if(N!==null)ie=!0;else{var ae=t(x);ae!==null&&he(Ee,ae.startTime-ne),ie=!1}}break e}finally{N=null,R=Me,k=!1}ie=void 0}}finally{ie?$():me=!1}}}var $;if(typeof ee=="function")$=function(){ee(Y)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,_e=z.port2;z.port1.onmessage=Y,$=function(){_e.postMessage(null)}}else $=function(){te(Y,0)};function he(ne,ie){U=te(function(){ne(n.unstable_now())},ie)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ne){ne.callback=null},n.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<ne?Math.floor(1e3/ne):5},n.unstable_getCurrentPriorityLevel=function(){return R},n.unstable_next=function(ne){switch(R){case 1:case 2:case 3:var ie=3;break;default:ie=R}var Me=R;R=ie;try{return ne()}finally{R=Me}},n.unstable_requestPaint=function(){K=!0},n.unstable_runWithPriority=function(ne,ie){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var Me=R;R=ne;try{return ie()}finally{R=Me}},n.unstable_scheduleCallback=function(ne,ie,Me){var ze=n.unstable_now();switch(typeof Me=="object"&&Me!==null?(Me=Me.delay,Me=typeof Me=="number"&&0<Me?ze+Me:ze):Me=ze,ne){case 1:var ct=-1;break;case 2:ct=250;break;case 5:ct=1073741823;break;case 4:ct=1e4;break;default:ct=5e3}return ct=Me+ct,ne={id:A++,callback:ie,priorityLevel:ne,startTime:Me,expirationTime:ct,sortIndex:-1},Me>ze?(ne.sortIndex=Me,e(x,ne),t(w)===null&&ne===t(x)&&(W?(le(U),U=-1):W=!0,he(Ee,Me-ze))):(ne.sortIndex=ct,e(w,ne),H||k||(H=!0,me||(me=!0,$()))),ne},n.unstable_shouldYield=Q,n.unstable_wrapCallback=function(ne){var ie=R;return function(){var Me=R;R=ie;try{return ne.apply(this,arguments)}finally{R=Me}}}})(lm)),lm}var _y;function UA(){return _y||(_y=1,am.exports=LA()),am.exports}var cm={exports:{}},Ji={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ty;function BA(){if(Ty)return Ji;Ty=1;var n=bg();function e(w){var x="https://react.dev/errors/"+w;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var A=2;A<arguments.length;A++)x+="&args[]="+encodeURIComponent(arguments[A])}return"Minified React error #"+w+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(w,x,A){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:N==null?null:""+N,children:w,containerInfo:x,implementation:A}}var f=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function y(w,x){if(w==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return Ji.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ji.createPortal=function(w,x){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(e(299));return c(w,x,null,A)},Ji.flushSync=function(w){var x=f.T,A=i.p;try{if(f.T=null,i.p=2,w)return w()}finally{f.T=x,i.p=A,i.d.f()}},Ji.preconnect=function(w,x){typeof w=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,i.d.C(w,x))},Ji.prefetchDNS=function(w){typeof w=="string"&&i.d.D(w)},Ji.preinit=function(w,x){if(typeof w=="string"&&x&&typeof x.as=="string"){var A=x.as,N=y(A,x.crossOrigin),R=typeof x.integrity=="string"?x.integrity:void 0,k=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;A==="style"?i.d.S(w,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:N,integrity:R,fetchPriority:k}):A==="script"&&i.d.X(w,{crossOrigin:N,integrity:R,fetchPriority:k,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},Ji.preinitModule=function(w,x){if(typeof w=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var A=y(x.as,x.crossOrigin);i.d.M(w,{crossOrigin:A,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&i.d.M(w)},Ji.preload=function(w,x){if(typeof w=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var A=x.as,N=y(A,x.crossOrigin);i.d.L(w,A,{crossOrigin:N,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},Ji.preloadModule=function(w,x){if(typeof w=="string")if(x){var A=y(x.as,x.crossOrigin);i.d.m(w,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:A,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else i.d.m(w)},Ji.requestFormReset=function(w){i.d.r(w)},Ji.unstable_batchedUpdates=function(w,x){return w(x)},Ji.useFormState=function(w,x,A){return f.H.useFormState(w,x,A)},Ji.useFormStatus=function(){return f.H.useHostTransitionStatus()},Ji.version="19.2.3",Ji}var Ay;function FA(){if(Ay)return cm.exports;Ay=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),cm.exports=BA(),cm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sy;function jA(){if(Sy)return au;Sy=1;var n=UA(),e=bg(),t=FA();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)a+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var a=s,d=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(d=a.return),s=a.return;while(s)}return a.tag===3?d:null}function f(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function y(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function w(s){if(c(s)!==s)throw Error(i(188))}function x(s){var a=s.alternate;if(!a){if(a=c(s),a===null)throw Error(i(188));return a!==s?null:s}for(var d=s,p=a;;){var S=d.return;if(S===null)break;var I=S.alternate;if(I===null){if(p=S.return,p!==null){d=p;continue}break}if(S.child===I.child){for(I=S.child;I;){if(I===d)return w(S),s;if(I===p)return w(S),a;I=I.sibling}throw Error(i(188))}if(d.return!==p.return)d=S,p=I;else{for(var P=!1,q=S.child;q;){if(q===d){P=!0,d=S,p=I;break}if(q===p){P=!0,p=S,d=I;break}q=q.sibling}if(!P){for(q=I.child;q;){if(q===d){P=!0,d=I,p=S;break}if(q===p){P=!0,p=I,d=S;break}q=q.sibling}if(!P)throw Error(i(189))}}if(d.alternate!==p)throw Error(i(190))}if(d.tag!==3)throw Error(i(188));return d.stateNode.current===d?s:a}function A(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=A(s),a!==null)return a;s=s.sibling}return null}var N=Object.assign,R=Symbol.for("react.element"),k=Symbol.for("react.transitional.element"),H=Symbol.for("react.portal"),W=Symbol.for("react.fragment"),K=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),le=Symbol.for("react.consumer"),ee=Symbol.for("react.context"),de=Symbol.for("react.forward_ref"),Ee=Symbol.for("react.suspense"),me=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),Y=Symbol.iterator;function $(s){return s===null||typeof s!="object"?null:(s=Y&&s[Y]||s["@@iterator"],typeof s=="function"?s:null)}var z=Symbol.for("react.client.reference");function _e(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===z?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case W:return"Fragment";case te:return"Profiler";case K:return"StrictMode";case Ee:return"Suspense";case me:return"SuspenseList";case F:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case H:return"Portal";case ee:return s.displayName||"Context";case le:return(s._context.displayName||"Context")+".Consumer";case de:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case U:return a=s.displayName||null,a!==null?a:_e(s.type)||"Memo";case V:a=s._payload,s=s._init;try{return _e(s(a))}catch{}}return null}var he=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Me={pending:!1,data:null,method:null,action:null},ze=[],ct=-1;function ae(s){return{current:s}}function Ie(s){0>ct||(s.current=ze[ct],ze[ct]=null,ct--)}function Ae(s,a){ct++,ze[ct]=s.current,s.current=a}var je=ae(null),rt=ae(null),pe=ae(null),Ve=ae(null);function Ke(s,a){switch(Ae(pe,a),Ae(rt,s),Ae(je,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?Vx(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=Vx(a),s=Gx(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Ie(je),Ae(je,s)}function it(){Ie(je),Ie(rt),Ie(pe)}function Mn(s){s.memoizedState!==null&&Ae(Ve,s);var a=je.current,d=Gx(a,s.type);a!==d&&(Ae(rt,s),Ae(je,d))}function kt(s){rt.current===s&&(Ie(je),Ie(rt)),Ve.current===s&&(Ie(Ve),nu._currentValue=Me)}var Dn,St;function Pn(s){if(Dn===void 0)try{throw Error()}catch(d){var a=d.stack.trim().match(/\n( *(at )?)/);Dn=a&&a[1]||"",St=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Dn+s+St}var De=!1;function ot(s,a){if(!s||De)return"";De=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(a){var Pe=function(){throw Error()};if(Object.defineProperty(Pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Pe,[])}catch(Re){var Te=Re}Reflect.construct(s,[],Pe)}else{try{Pe.call()}catch(Re){Te=Re}s.call(Pe.prototype)}}else{try{throw Error()}catch(Re){Te=Re}(Pe=s())&&typeof Pe.catch=="function"&&Pe.catch(function(){})}}catch(Re){if(Re&&Te&&typeof Re.stack=="string")return[Re.stack,Te.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var I=p.DetermineComponentFrameRoot(),P=I[0],q=I[1];if(P&&q){var se=P.split(`
`),be=q.split(`
`);for(S=p=0;p<se.length&&!se[p].includes("DetermineComponentFrameRoot");)p++;for(;S<be.length&&!be[S].includes("DetermineComponentFrameRoot");)S++;if(p===se.length||S===be.length)for(p=se.length-1,S=be.length-1;1<=p&&0<=S&&se[p]!==be[S];)S--;for(;1<=p&&0<=S;p--,S--)if(se[p]!==be[S]){if(p!==1||S!==1)do if(p--,S--,0>S||se[p]!==be[S]){var Oe=`
`+se[p].replace(" at new "," at ");return s.displayName&&Oe.includes("<anonymous>")&&(Oe=Oe.replace("<anonymous>",s.displayName)),Oe}while(1<=p&&0<=S);break}}}finally{De=!1,Error.prepareStackTrace=d}return(d=s?s.displayName||s.name:"")?Pn(d):""}function ht(s,a){switch(s.tag){case 26:case 27:case 5:return Pn(s.type);case 16:return Pn("Lazy");case 13:return s.child!==a&&a!==null?Pn("Suspense Fallback"):Pn("Suspense");case 19:return Pn("SuspenseList");case 0:case 15:return ot(s.type,!1);case 11:return ot(s.type.render,!1);case 1:return ot(s.type,!0);case 31:return Pn("Activity");default:return""}}function Qe(s){try{var a="",d=null;do a+=ht(s,d),d=s,s=s.return;while(s);return a}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var nt=Object.prototype.hasOwnProperty,xn=n.unstable_scheduleCallback,Ze=n.unstable_cancelCallback,Gr=n.unstable_shouldYield,Mo=n.unstable_requestPaint,On=n.unstable_now,qs=n.unstable_getCurrentPriorityLevel,Ei=n.unstable_ImmediatePriority,Hr=n.unstable_UserBlockingPriority,_i=n.unstable_NormalPriority,ci=n.unstable_LowPriority,Do=n.unstable_IdlePriority,Tr=n.log,Ma=n.unstable_setDisableYieldValue,an=null,Ge=null;function ln(s){if(typeof Tr=="function"&&Ma(s),Ge&&typeof Ge.setStrictMode=="function")try{Ge.setStrictMode(an,s)}catch{}}var _t=Math.clz32?Math.clz32:xt,Ue=Math.log,Xe=Math.LN2;function xt(s){return s>>>=0,s===0?32:31-(Ue(s)/Xe|0)|0}var yt=256,ut=262144,At=4194304;function Tn(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function yn(s,a,d){var p=s.pendingLanes;if(p===0)return 0;var S=0,I=s.suspendedLanes,P=s.pingedLanes;s=s.warmLanes;var q=p&134217727;return q!==0?(p=q&~I,p!==0?S=Tn(p):(P&=q,P!==0?S=Tn(P):d||(d=q&~s,d!==0&&(S=Tn(d))))):(q=p&~I,q!==0?S=Tn(q):P!==0?S=Tn(P):d||(d=p&~s,d!==0&&(S=Tn(d)))),S===0?0:a!==0&&a!==S&&(a&I)===0&&(I=S&-S,d=a&-a,I>=d||I===32&&(d&4194048)!==0)?a:S}function Pt(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function is(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vt(){var s=At;return At<<=1,(At&62914560)===0&&(At=4194304),s}function ii(s){for(var a=[],d=0;31>d;d++)a.push(s);return a}function zi(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function ps(s,a,d,p,S,I){var P=s.pendingLanes;s.pendingLanes=d,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=d,s.entangledLanes&=d,s.errorRecoveryDisabledLanes&=d,s.shellSuspendCounter=0;var q=s.entanglements,se=s.expirationTimes,be=s.hiddenUpdates;for(d=P&~d;0<d;){var Oe=31-_t(d),Pe=1<<Oe;q[Oe]=0,se[Oe]=-1;var Te=be[Oe];if(Te!==null)for(be[Oe]=null,Oe=0;Oe<Te.length;Oe++){var Re=Te[Oe];Re!==null&&(Re.lane&=-536870913)}d&=~Pe}p!==0&&zr(s,p,0),I!==0&&S===0&&s.tag!==0&&(s.suspendedLanes|=I&~(P&~a))}function zr(s,a,d){s.pendingLanes|=a,s.suspendedLanes&=~a;var p=31-_t(a);s.entangledLanes|=a,s.entanglements[p]=s.entanglements[p]|1073741824|d&261930}function Is(s,a){var d=s.entangledLanes|=a;for(s=s.entanglements;d;){var p=31-_t(d),S=1<<p;S&a|s[p]&a&&(s[p]|=a),d&=~S}}function qr(s,a){var d=a&-a;return d=(d&42)!==0?1:Qn(d),(d&(s.suspendedLanes|a))!==0?0:d}function Qn(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Ri(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Mi(){var s=ie.p;return s!==0?s:(s=window.event,s===void 0?32:dy(s.type))}function Je(s,a){var d=ie.p;try{return ie.p=s,a()}finally{ie.p=d}}var Ti=Math.random().toString(36).slice(2),jn="__reactFiber$"+Ti,cn="__reactProps$"+Ti,Di="__reactContainer$"+Ti,dr="__reactEvents$"+Ti,Oo="__reactListeners$"+Ti,ss="__reactHandles$"+Ti,fl="__reactResources$"+Ti,Ys="__reactMarker$"+Ti;function Oi(s){delete s[jn],delete s[cn],delete s[dr],delete s[Oo],delete s[ss]}function kn(s){var a=s[jn];if(a)return a;for(var d=s.parentNode;d;){if(a=d[Di]||d[jn]){if(d=a.alternate,a.child!==null||d!==null&&d.child!==null)for(s=Kx(s);s!==null;){if(d=s[jn])return d;s=Kx(s)}return a}s=d,d=s.parentNode}return null}function zt(s){if(s=s[jn]||s[Di]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function qi(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function xi(s){var a=s[fl];return a||(a=s[fl]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Vn(s){s[Ys]=!0}var Le=new Set,Da={};function un(s,a){ki(s,a),ki(s+"Capture",a)}function ki(s,a){for(Da[s]=a,s=0;s<a.length;s++)Le.add(a[s])}var Oa=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Kt={},qt={};function Ft(s){return nt.call(qt,s)?!0:nt.call(Kt,s)?!1:Oa.test(s)?qt[s]=!0:(Kt[s]=!0,!1)}function Ar(s,a,d){if(Ft(a))if(d===null)s.removeAttribute(a);else{switch(typeof d){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var p=a.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+d)}}function Pi(s,a,d){if(d===null)s.removeAttribute(a);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+d)}}function Gn(s,a,d,p){if(p===null)s.removeAttribute(d);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(d);return}s.setAttributeNS(a,d,""+p)}}function Gt(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Li(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function ka(s,a,d){var p=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,I=p.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return S.call(this)},set:function(P){d=""+P,I.call(this,P)}}),Object.defineProperty(s,a,{enumerable:p.enumerable}),{getValue:function(){return d},setValue:function(P){d=""+P},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function wt(s){if(!s._valueTracker){var a=Li(s)?"checked":"value";s._valueTracker=ka(s,a,""+s[a])}}function Yi(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var d=a.getValue(),p="";return s&&(p=Li(s)?s.checked?"true":"false":s.value),s=p,s!==d?(a.setValue(s),!0):!1}function Ws(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var xs=/[\n"\\]/g;function Ut(s){return s.replace(xs,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Wn(s,a,d,p,S,I,P,q){s.name="",P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?s.type=P:s.removeAttribute("type"),a!=null?P==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+Gt(a)):s.value!==""+Gt(a)&&(s.value=""+Gt(a)):P!=="submit"&&P!=="reset"||s.removeAttribute("value"),a!=null?J(s,P,Gt(a)):d!=null?J(s,P,Gt(d)):p!=null&&s.removeAttribute("value"),S==null&&I!=null&&(s.defaultChecked=!!I),S!=null&&(s.checked=S&&typeof S!="function"&&typeof S!="symbol"),q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?s.name=""+Gt(q):s.removeAttribute("name")}function ve(s,a,d,p,S,I,P,q){if(I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(s.type=I),a!=null||d!=null){if(!(I!=="submit"&&I!=="reset"||a!=null)){wt(s);return}d=d!=null?""+Gt(d):"",a=a!=null?""+Gt(a):d,q||a===s.value||(s.value=a),s.defaultValue=a}p=p??S,p=typeof p!="function"&&typeof p!="symbol"&&!!p,s.checked=q?s.checked:!!p,s.defaultChecked=!!p,P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(s.name=P),wt(s)}function J(s,a,d){a==="number"&&Ws(s.ownerDocument)===s||s.defaultValue===""+d||(s.defaultValue=""+d)}function at(s,a,d,p){if(s=s.options,a){a={};for(var S=0;S<d.length;S++)a["$"+d[S]]=!0;for(d=0;d<s.length;d++)S=a.hasOwnProperty("$"+s[d].value),s[d].selected!==S&&(s[d].selected=S),S&&p&&(s[d].defaultSelected=!0)}else{for(d=""+Gt(d),a=null,S=0;S<s.length;S++){if(s[S].value===d){s[S].selected=!0,p&&(s[S].defaultSelected=!0);return}a!==null||s[S].disabled||(a=s[S])}a!==null&&(a.selected=!0)}}function Xn(s,a,d){if(a!=null&&(a=""+Gt(a),a!==s.value&&(s.value=a),d==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=d!=null?""+Gt(d):""}function si(s,a,d,p){if(a==null){if(p!=null){if(d!=null)throw Error(i(92));if(he(p)){if(1<p.length)throw Error(i(93));p=p[0]}d=p}d==null&&(d=""),a=d}d=Gt(a),s.defaultValue=d,p=s.textContent,p===d&&p!==""&&p!==null&&(s.value=p),wt(s)}function Wi(s,a){if(a){var d=s.firstChild;if(d&&d===s.lastChild&&d.nodeType===3){d.nodeValue=a;return}}s.textContent=a}var ko=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ai(s,a,d){var p=a.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?p?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":p?s.setProperty(a,d):typeof d!="number"||d===0||ko.has(a)?a==="float"?s.cssFloat=d:s[a]=(""+d).trim():s[a]=d+"px"}function ft(s,a,d){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,d!=null){for(var p in d)!d.hasOwnProperty(p)||a!=null&&a.hasOwnProperty(p)||(p.indexOf("--")===0?s.setProperty(p,""):p==="float"?s.cssFloat="":s[p]="");for(var S in a)p=a[S],a.hasOwnProperty(S)&&d[S]!==p&&Ai(s,S,p)}else for(var I in a)a.hasOwnProperty(I)&&Ai(s,I,a[I])}function vn(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pa=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Sr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Cr(s){return Sr.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Xi(){}var Yr=null;function ys(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Nn=null,Ki=null;function $i(s){var a=zt(s);if(a&&(s=a.stateNode)){var d=s[cn]||null;e:switch(s=a.stateNode,a.type){case"input":if(Wn(s,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),a=d.name,d.type==="radio"&&a!=null){for(d=s;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+Ut(""+a)+'"][type="radio"]'),a=0;a<d.length;a++){var p=d[a];if(p!==s&&p.form===s.form){var S=p[cn]||null;if(!S)throw Error(i(90));Wn(p,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(a=0;a<d.length;a++)p=d[a],p.form===s.form&&Yi(p)}break e;case"textarea":Xn(s,d.value,d.defaultValue);break e;case"select":a=d.value,a!=null&&at(s,!!d.multiple,a,!1)}}}var mt=!1;function Nr(s,a,d){if(mt)return s(a,d);mt=!0;try{var p=s(a);return p}finally{if(mt=!1,(Nn!==null||Ki!==null)&&(Nd(),Nn&&(a=Nn,s=Ki,Ki=Nn=null,$i(a),s)))for(a=0;a<s.length;a++)$i(s[a])}}function vt(s,a){var d=s.stateNode;if(d===null)return null;var p=d[cn]||null;if(p===null)return null;d=p[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(s=s.type,p=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!p;break e;default:s=!1}if(s)return null;if(d&&typeof d!="function")throw Error(i(231,a,typeof d));return d}var wn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wr=!1;if(wn)try{var hn={};Object.defineProperty(hn,"passive",{get:function(){Wr=!0}}),window.addEventListener("test",hn,hn),window.removeEventListener("test",hn,hn)}catch{Wr=!1}var Rs=null,Ms=null,Xr=null;function hr(){if(Xr)return Xr;var s,a=Ms,d=a.length,p,S="value"in Rs?Rs.value:Rs.textContent,I=S.length;for(s=0;s<d&&a[s]===S[s];s++);var P=d-s;for(p=1;p<=P&&a[d-p]===S[I-p];p++);return Xr=S.slice(s,1<p?1-p:void 0)}function Ds(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function rs(){return!0}function vs(){return!1}function Kn(s){function a(d,p,S,I,P){this._reactName=d,this._targetInst=S,this.type=p,this.nativeEvent=I,this.target=P,this.currentTarget=null;for(var q in s)s.hasOwnProperty(q)&&(d=s[q],this[q]=d?d(I):I[q]);return this.isDefaultPrevented=(I.defaultPrevented!=null?I.defaultPrevented:I.returnValue===!1)?rs:vs,this.isPropagationStopped=vs,this}return N(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=rs)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=rs)},persist:function(){},isPersistent:rs}),a}var os={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ln=Kn(os),fr=N({},os,{view:0,detail:0}),Po=Kn(fr),mr,Lo,Xs,Uo=N({},fr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$s,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Xs&&(Xs&&s.type==="mousemove"?(mr=s.screenX-Xs.screenX,Lo=s.screenY-Xs.screenY):Lo=mr=0,Xs=s),mr)},movementY:function(s){return"movementY"in s?s.movementY:Lo}}),sn=Kn(Uo),Ir=N({},Uo,{dataTransfer:0}),Kr=Kn(Ir),Os=N({},fr,{relatedTarget:0}),$r=Kn(Os),Se=N({},os,{animationName:0,elapsedTime:0,pseudoElement:0}),Rt=Kn(Se),Hn=N({},os,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Jr=Kn(Hn),La=N({},os,{data:0}),Ks=Kn(La),ml={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zn(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Bo[s])?!!a[s]:!1}function $s(){return zn}var Ht=N({},fr,{key:function(s){if(s.key){var a=ml[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Ds(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?gl[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$s,charCode:function(s){return s.type==="keypress"?Ds(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ds(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Qr=Kn(Ht),Js=N({},Uo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yt=Kn(Js),E=N({},fr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$s}),D=Kn(E),L=N({},os,{propertyName:0,elapsedTime:0,pseudoElement:0}),X=Kn(L),xe=N({},Uo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Ne=Kn(xe),Ye=N({},os,{newState:0,oldState:0}),Ct=Kn(Ye),qn=[9,13,27,32],en=wn&&"CompositionEvent"in window,In=null;wn&&"documentMode"in document&&(In=document.documentMode);var as=wn&&"TextEvent"in window&&!In,Qs=wn&&(!en||In&&8<In&&11>=In),Si=" ",ls=!1;function Zr(s,a){switch(s){case"keyup":return qn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zs(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Fo=!1;function Rr(s,a){switch(s){case"compositionend":return Zs(a);case"keypress":return a.which!==32?null:(ls=!0,Si);case"textInput":return s=a.data,s===Si&&ls?null:s;default:return null}}function pl(s,a){if(Fo)return s==="compositionend"||!en&&Zr(s,a)?(s=hr(),Xr=Ms=Rs=null,Fo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Qs&&a.locale!=="ko"?null:a.data;default:return null}}var ws={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sc(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!ws[s.type]:a==="textarea"}function ks(s,a,d,p){Nn?Ki?Ki.push(p):Ki=[p]:Nn=p,a=Pd(a,"onChange"),0<a.length&&(d=new Ln("onChange","change",null,d,p),s.push({event:d,listeners:a}))}var Ua=null,eo=null;function xf(s){Px(s,0)}function Ba(s){var a=qi(s);if(Yi(a))return s}function Ps(s,a){if(s==="change")return a}var Yu=!1;if(wn){var Fa;if(wn){var to="oninput"in document;if(!to){var $t=document.createElement("div");$t.setAttribute("oninput","return;"),to=typeof $t.oninput=="function"}Fa=to}else Fa=!1;Yu=Fa&&(!document.documentMode||9<document.documentMode)}function ja(){Ua&&(Ua.detachEvent("onpropertychange",B),eo=Ua=null)}function B(s){if(s.propertyName==="value"&&Ba(eo)){var a=[];ks(a,eo,s,ys(s)),Nr(xf,a)}}function r(s,a,d){s==="focusin"?(ja(),Ua=a,eo=d,Ua.attachEvent("onpropertychange",B)):s==="focusout"&&ja()}function l(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ba(eo)}function u(s,a){if(s==="click")return Ba(a)}function m(s,a){if(s==="input"||s==="change")return Ba(a)}function g(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var v=typeof Object.is=="function"?Object.is:g;function _(s,a){if(v(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var d=Object.keys(s),p=Object.keys(a);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var S=d[p];if(!nt.call(a,S)||!v(s[S],a[S]))return!1}return!0}function C(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function M(s,a){var d=C(s);s=0;for(var p;d;){if(d.nodeType===3){if(p=s+d.textContent.length,s<=a&&p>=a)return{node:d,offset:a-s};s=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=C(d)}}function O(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?O(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function j(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=Ws(s.document);a instanceof s.HTMLIFrameElement;){try{var d=typeof a.contentWindow.location.href=="string"}catch{d=!1}if(d)s=a.contentWindow;else break;a=Ws(s.document)}return a}function G(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var Z=wn&&"documentMode"in document&&11>=document.documentMode,re=null,ce=null,ye=null,Ce=!1;function qe(s,a,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Ce||re==null||re!==Ws(p)||(p=re,"selectionStart"in p&&G(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),ye&&_(ye,p)||(ye=p,p=Pd(ce,"onSelect"),0<p.length&&(a=new Ln("onSelect","select",null,a,d),s.push({event:a,listeners:p}),a.target=re)))}function He(s,a){var d={};return d[s.toLowerCase()]=a.toLowerCase(),d["Webkit"+s]="webkit"+a,d["Moz"+s]="moz"+a,d}var Fe={animationend:He("Animation","AnimationEnd"),animationiteration:He("Animation","AnimationIteration"),animationstart:He("Animation","AnimationStart"),transitionrun:He("Transition","TransitionRun"),transitionstart:He("Transition","TransitionStart"),transitioncancel:He("Transition","TransitionCancel"),transitionend:He("Transition","TransitionEnd")},jt={},Nt={};wn&&(Nt=document.createElement("div").style,"AnimationEvent"in window||(delete Fe.animationend.animation,delete Fe.animationiteration.animation,delete Fe.animationstart.animation),"TransitionEvent"in window||delete Fe.transitionend.transition);function Zn(s){if(jt[s])return jt[s];if(!Fe[s])return s;var a=Fe[s],d;for(d in a)if(a.hasOwnProperty(d)&&d in Nt)return jt[s]=a[d];return s}var bs=Zn("animationend"),Ui=Zn("animationiteration"),bn=Zn("animationstart"),yi=Zn("transitionrun"),cs=Zn("transitionstart"),jo=Zn("transitioncancel"),no=Zn("transitionend"),Wu=new Map,Cc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Cc.push("scrollEnd");function gr(s,a){Wu.set(s,a),un(a,[s])}var Xu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},er=[],xl=0,yf=0;function Ku(){for(var s=xl,a=yf=xl=0;a<s;){var d=er[a];er[a++]=null;var p=er[a];er[a++]=null;var S=er[a];er[a++]=null;var I=er[a];if(er[a++]=null,p!==null&&S!==null){var P=p.pending;P===null?S.next=S:(S.next=P.next,P.next=S),p.pending=S}I!==0&&pp(d,S,I)}}function $u(s,a,d,p){er[xl++]=s,er[xl++]=a,er[xl++]=d,er[xl++]=p,yf|=p,s.lanes|=p,s=s.alternate,s!==null&&(s.lanes|=p)}function vf(s,a,d,p){return $u(s,a,d,p),Ju(s)}function Va(s,a){return $u(s,null,null,a),Ju(s)}function pp(s,a,d){s.lanes|=d;var p=s.alternate;p!==null&&(p.lanes|=d);for(var S=!1,I=s.return;I!==null;)I.childLanes|=d,p=I.alternate,p!==null&&(p.childLanes|=d),I.tag===22&&(s=I.stateNode,s===null||s._visibility&1||(S=!0)),s=I,I=I.return;return s.tag===3?(I=s.stateNode,S&&a!==null&&(S=31-_t(d),s=I.hiddenUpdates,p=s[S],p===null?s[S]=[a]:p.push(a),a.lane=d|536870912),I):null}function Ju(s){if(50<Kc)throw Kc=0,N0=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var yl={};function gT(s,a,d,p){this.tag=s,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ls(s,a,d,p){return new gT(s,a,d,p)}function wf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function io(s,a){var d=s.alternate;return d===null?(d=Ls(s.tag,a,s.key,s.mode),d.elementType=s.elementType,d.type=s.type,d.stateNode=s.stateNode,d.alternate=s,s.alternate=d):(d.pendingProps=a,d.type=s.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=s.flags&65011712,d.childLanes=s.childLanes,d.lanes=s.lanes,d.child=s.child,d.memoizedProps=s.memoizedProps,d.memoizedState=s.memoizedState,d.updateQueue=s.updateQueue,a=s.dependencies,d.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},d.sibling=s.sibling,d.index=s.index,d.ref=s.ref,d.refCleanup=s.refCleanup,d}function xp(s,a){s.flags&=65011714;var d=s.alternate;return d===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=d.childLanes,s.lanes=d.lanes,s.child=d.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=d.memoizedProps,s.memoizedState=d.memoizedState,s.updateQueue=d.updateQueue,s.type=d.type,a=d.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function Qu(s,a,d,p,S,I){var P=0;if(p=s,typeof s=="function")wf(s)&&(P=1);else if(typeof s=="string")P=wA(s,d,je.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case F:return s=Ls(31,d,a,S),s.elementType=F,s.lanes=I,s;case W:return Ga(d.children,S,I,a);case K:P=8,S|=24;break;case te:return s=Ls(12,d,a,S|2),s.elementType=te,s.lanes=I,s;case Ee:return s=Ls(13,d,a,S),s.elementType=Ee,s.lanes=I,s;case me:return s=Ls(19,d,a,S),s.elementType=me,s.lanes=I,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ee:P=10;break e;case le:P=9;break e;case de:P=11;break e;case U:P=14;break e;case V:P=16,p=null;break e}P=29,d=Error(i(130,s===null?"null":typeof s,"")),p=null}return a=Ls(P,d,a,S),a.elementType=s,a.type=p,a.lanes=I,a}function Ga(s,a,d,p){return s=Ls(7,s,p,a),s.lanes=d,s}function bf(s,a,d){return s=Ls(6,s,null,a),s.lanes=d,s}function yp(s){var a=Ls(18,null,null,0);return a.stateNode=s,a}function Ef(s,a,d){return a=Ls(4,s.children!==null?s.children:[],s.key,a),a.lanes=d,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var vp=new WeakMap;function tr(s,a){if(typeof s=="object"&&s!==null){var d=vp.get(s);return d!==void 0?d:(a={value:s,source:a,stack:Qe(a)},vp.set(s,a),a)}return{value:s,source:a,stack:Qe(a)}}var vl=[],wl=0,Zu=null,Nc=0,nr=[],ir=0,Vo=null,Mr=1,Dr="";function so(s,a){vl[wl++]=Nc,vl[wl++]=Zu,Zu=s,Nc=a}function wp(s,a,d){nr[ir++]=Mr,nr[ir++]=Dr,nr[ir++]=Vo,Vo=s;var p=Mr;s=Dr;var S=32-_t(p)-1;p&=~(1<<S),d+=1;var I=32-_t(a)+S;if(30<I){var P=S-S%5;I=(p&(1<<P)-1).toString(32),p>>=P,S-=P,Mr=1<<32-_t(a)+S|d<<S|p,Dr=I+s}else Mr=1<<I|d<<S|p,Dr=s}function _f(s){s.return!==null&&(so(s,1),wp(s,1,0))}function Tf(s){for(;s===Zu;)Zu=vl[--wl],vl[wl]=null,Nc=vl[--wl],vl[wl]=null;for(;s===Vo;)Vo=nr[--ir],nr[ir]=null,Dr=nr[--ir],nr[ir]=null,Mr=nr[--ir],nr[ir]=null}function bp(s,a){nr[ir++]=Mr,nr[ir++]=Dr,nr[ir++]=Vo,Mr=a.id,Dr=a.overflow,Vo=s}var Bi=null,Un=null,tn=!1,Go=null,sr=!1,Af=Error(i(519));function Ho(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ic(tr(a,s)),Af}function Ep(s){var a=s.stateNode,d=s.type,p=s.memoizedProps;switch(a[jn]=s,a[cn]=p,d){case"dialog":Xt("cancel",a),Xt("close",a);break;case"iframe":case"object":case"embed":Xt("load",a);break;case"video":case"audio":for(d=0;d<Jc.length;d++)Xt(Jc[d],a);break;case"source":Xt("error",a);break;case"img":case"image":case"link":Xt("error",a),Xt("load",a);break;case"details":Xt("toggle",a);break;case"input":Xt("invalid",a),ve(a,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":Xt("invalid",a);break;case"textarea":Xt("invalid",a),si(a,p.value,p.defaultValue,p.children)}d=p.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||a.textContent===""+d||p.suppressHydrationWarning===!0||Fx(a.textContent,d)?(p.popover!=null&&(Xt("beforetoggle",a),Xt("toggle",a)),p.onScroll!=null&&Xt("scroll",a),p.onScrollEnd!=null&&Xt("scrollend",a),p.onClick!=null&&(a.onclick=Xi),a=!0):a=!1,a||Ho(s,!0)}function _p(s){for(Bi=s.return;Bi;)switch(Bi.tag){case 5:case 31:case 13:sr=!1;return;case 27:case 3:sr=!0;return;default:Bi=Bi.return}}function bl(s){if(s!==Bi)return!1;if(!tn)return _p(s),tn=!0,!1;var a=s.tag,d;if((d=a!==3&&a!==27)&&((d=a===5)&&(d=s.type,d=!(d!=="form"&&d!=="button")||H0(s.type,s.memoizedProps)),d=!d),d&&Un&&Ho(s),_p(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Un=Xx(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Un=Xx(s)}else a===27?(a=Un,ia(s.type)?(s=X0,X0=null,Un=s):Un=a):Un=Bi?or(s.stateNode.nextSibling):null;return!0}function Ha(){Un=Bi=null,tn=!1}function Sf(){var s=Go;return s!==null&&(As===null?As=s:As.push.apply(As,s),Go=null),s}function Ic(s){Go===null?Go=[s]:Go.push(s)}var Cf=ae(null),za=null,ro=null;function zo(s,a,d){Ae(Cf,a._currentValue),a._currentValue=d}function oo(s){s._currentValue=Cf.current,Ie(Cf)}function Nf(s,a,d){for(;s!==null;){var p=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,p!==null&&(p.childLanes|=a)):p!==null&&(p.childLanes&a)!==a&&(p.childLanes|=a),s===d)break;s=s.return}}function If(s,a,d,p){var S=s.child;for(S!==null&&(S.return=s);S!==null;){var I=S.dependencies;if(I!==null){var P=S.child;I=I.firstContext;e:for(;I!==null;){var q=I;I=S;for(var se=0;se<a.length;se++)if(q.context===a[se]){I.lanes|=d,q=I.alternate,q!==null&&(q.lanes|=d),Nf(I.return,d,s),p||(P=null);break e}I=q.next}}else if(S.tag===18){if(P=S.return,P===null)throw Error(i(341));P.lanes|=d,I=P.alternate,I!==null&&(I.lanes|=d),Nf(P,d,s),P=null}else P=S.child;if(P!==null)P.return=S;else for(P=S;P!==null;){if(P===s){P=null;break}if(S=P.sibling,S!==null){S.return=P.return,P=S;break}P=P.return}S=P}}function El(s,a,d,p){s=null;for(var S=a,I=!1;S!==null;){if(!I){if((S.flags&524288)!==0)I=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var P=S.alternate;if(P===null)throw Error(i(387));if(P=P.memoizedProps,P!==null){var q=S.type;v(S.pendingProps.value,P.value)||(s!==null?s.push(q):s=[q])}}else if(S===Ve.current){if(P=S.alternate,P===null)throw Error(i(387));P.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(s!==null?s.push(nu):s=[nu])}S=S.return}s!==null&&If(a,s,d,p),a.flags|=262144}function ed(s){for(s=s.firstContext;s!==null;){if(!v(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function qa(s){za=s,ro=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Fi(s){return Tp(za,s)}function td(s,a){return za===null&&qa(s),Tp(s,a)}function Tp(s,a){var d=a._currentValue;if(a={context:a,memoizedValue:d,next:null},ro===null){if(s===null)throw Error(i(308));ro=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else ro=ro.next=a;return d}var pT=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(d,p){s.push(p)}};this.abort=function(){a.aborted=!0,s.forEach(function(d){return d()})}},xT=n.unstable_scheduleCallback,yT=n.unstable_NormalPriority,ui={$$typeof:ee,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Rf(){return{controller:new pT,data:new Map,refCount:0}}function Rc(s){s.refCount--,s.refCount===0&&xT(yT,function(){s.controller.abort()})}var Mc=null,Mf=0,_l=0,Tl=null;function vT(s,a){if(Mc===null){var d=Mc=[];Mf=0,_l=k0(),Tl={status:"pending",value:void 0,then:function(p){d.push(p)}}}return Mf++,a.then(Ap,Ap),a}function Ap(){if(--Mf===0&&Mc!==null){Tl!==null&&(Tl.status="fulfilled");var s=Mc;Mc=null,_l=0,Tl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function wT(s,a){var d=[],p={status:"pending",value:null,reason:null,then:function(S){d.push(S)}};return s.then(function(){p.status="fulfilled",p.value=a;for(var S=0;S<d.length;S++)(0,d[S])(a)},function(S){for(p.status="rejected",p.reason=S,S=0;S<d.length;S++)(0,d[S])(void 0)}),p}var Sp=ne.S;ne.S=function(s,a){cx=On(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&vT(s,a),Sp!==null&&Sp(s,a)};var Ya=ae(null);function Df(){var s=Ya.current;return s!==null?s:Rn.pooledCache}function nd(s,a){a===null?Ae(Ya,Ya.current):Ae(Ya,a.pool)}function Cp(){var s=Df();return s===null?null:{parent:ui._currentValue,pool:s}}var Al=Error(i(460)),Of=Error(i(474)),id=Error(i(542)),sd={then:function(){}};function Np(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Ip(s,a,d){switch(d=s[d],d===void 0?s.push(a):d!==a&&(a.then(Xi,Xi),a=d),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Mp(s),s;default:if(typeof a.status=="string")a.then(Xi,Xi);else{if(s=Rn,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(p){if(a.status==="pending"){var S=a;S.status="fulfilled",S.value=p}},function(p){if(a.status==="pending"){var S=a;S.status="rejected",S.reason=p}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Mp(s),s}throw Xa=a,Al}}function Wa(s){try{var a=s._init;return a(s._payload)}catch(d){throw d!==null&&typeof d=="object"&&typeof d.then=="function"?(Xa=d,Al):d}}var Xa=null;function Rp(){if(Xa===null)throw Error(i(459));var s=Xa;return Xa=null,s}function Mp(s){if(s===Al||s===id)throw Error(i(483))}var Sl=null,Dc=0;function rd(s){var a=Dc;return Dc+=1,Sl===null&&(Sl=[]),Ip(Sl,s,a)}function Oc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function od(s,a){throw a.$$typeof===R?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Dp(s){function a(ge,fe){if(s){var we=ge.deletions;we===null?(ge.deletions=[fe],ge.flags|=16):we.push(fe)}}function d(ge,fe){if(!s)return null;for(;fe!==null;)a(ge,fe),fe=fe.sibling;return null}function p(ge){for(var fe=new Map;ge!==null;)ge.key!==null?fe.set(ge.key,ge):fe.set(ge.index,ge),ge=ge.sibling;return fe}function S(ge,fe){return ge=io(ge,fe),ge.index=0,ge.sibling=null,ge}function I(ge,fe,we){return ge.index=we,s?(we=ge.alternate,we!==null?(we=we.index,we<fe?(ge.flags|=67108866,fe):we):(ge.flags|=67108866,fe)):(ge.flags|=1048576,fe)}function P(ge){return s&&ge.alternate===null&&(ge.flags|=67108866),ge}function q(ge,fe,we,ke){return fe===null||fe.tag!==6?(fe=bf(we,ge.mode,ke),fe.return=ge,fe):(fe=S(fe,we),fe.return=ge,fe)}function se(ge,fe,we,ke){var gt=we.type;return gt===W?Oe(ge,fe,we.props.children,ke,we.key):fe!==null&&(fe.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===V&&Wa(gt)===fe.type)?(fe=S(fe,we.props),Oc(fe,we),fe.return=ge,fe):(fe=Qu(we.type,we.key,we.props,null,ge.mode,ke),Oc(fe,we),fe.return=ge,fe)}function be(ge,fe,we,ke){return fe===null||fe.tag!==4||fe.stateNode.containerInfo!==we.containerInfo||fe.stateNode.implementation!==we.implementation?(fe=Ef(we,ge.mode,ke),fe.return=ge,fe):(fe=S(fe,we.children||[]),fe.return=ge,fe)}function Oe(ge,fe,we,ke,gt){return fe===null||fe.tag!==7?(fe=Ga(we,ge.mode,ke,gt),fe.return=ge,fe):(fe=S(fe,we),fe.return=ge,fe)}function Pe(ge,fe,we){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return fe=bf(""+fe,ge.mode,we),fe.return=ge,fe;if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case k:return we=Qu(fe.type,fe.key,fe.props,null,ge.mode,we),Oc(we,fe),we.return=ge,we;case H:return fe=Ef(fe,ge.mode,we),fe.return=ge,fe;case V:return fe=Wa(fe),Pe(ge,fe,we)}if(he(fe)||$(fe))return fe=Ga(fe,ge.mode,we,null),fe.return=ge,fe;if(typeof fe.then=="function")return Pe(ge,rd(fe),we);if(fe.$$typeof===ee)return Pe(ge,td(ge,fe),we);od(ge,fe)}return null}function Te(ge,fe,we,ke){var gt=fe!==null?fe.key:null;if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return gt!==null?null:q(ge,fe,""+we,ke);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case k:return we.key===gt?se(ge,fe,we,ke):null;case H:return we.key===gt?be(ge,fe,we,ke):null;case V:return we=Wa(we),Te(ge,fe,we,ke)}if(he(we)||$(we))return gt!==null?null:Oe(ge,fe,we,ke,null);if(typeof we.then=="function")return Te(ge,fe,rd(we),ke);if(we.$$typeof===ee)return Te(ge,fe,td(ge,we),ke);od(ge,we)}return null}function Re(ge,fe,we,ke,gt){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return ge=ge.get(we)||null,q(fe,ge,""+ke,gt);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case k:return ge=ge.get(ke.key===null?we:ke.key)||null,se(fe,ge,ke,gt);case H:return ge=ge.get(ke.key===null?we:ke.key)||null,be(fe,ge,ke,gt);case V:return ke=Wa(ke),Re(ge,fe,we,ke,gt)}if(he(ke)||$(ke))return ge=ge.get(we)||null,Oe(fe,ge,ke,gt,null);if(typeof ke.then=="function")return Re(ge,fe,we,rd(ke),gt);if(ke.$$typeof===ee)return Re(ge,fe,we,td(fe,ke),gt);od(fe,ke)}return null}function lt(ge,fe,we,ke){for(var gt=null,fn=null,dt=fe,Bt=fe=0,Qt=null;dt!==null&&Bt<we.length;Bt++){dt.index>Bt?(Qt=dt,dt=null):Qt=dt.sibling;var mn=Te(ge,dt,we[Bt],ke);if(mn===null){dt===null&&(dt=Qt);break}s&&dt&&mn.alternate===null&&a(ge,dt),fe=I(mn,fe,Bt),fn===null?gt=mn:fn.sibling=mn,fn=mn,dt=Qt}if(Bt===we.length)return d(ge,dt),tn&&so(ge,Bt),gt;if(dt===null){for(;Bt<we.length;Bt++)dt=Pe(ge,we[Bt],ke),dt!==null&&(fe=I(dt,fe,Bt),fn===null?gt=dt:fn.sibling=dt,fn=dt);return tn&&so(ge,Bt),gt}for(dt=p(dt);Bt<we.length;Bt++)Qt=Re(dt,ge,Bt,we[Bt],ke),Qt!==null&&(s&&Qt.alternate!==null&&dt.delete(Qt.key===null?Bt:Qt.key),fe=I(Qt,fe,Bt),fn===null?gt=Qt:fn.sibling=Qt,fn=Qt);return s&&dt.forEach(function(la){return a(ge,la)}),tn&&so(ge,Bt),gt}function bt(ge,fe,we,ke){if(we==null)throw Error(i(151));for(var gt=null,fn=null,dt=fe,Bt=fe=0,Qt=null,mn=we.next();dt!==null&&!mn.done;Bt++,mn=we.next()){dt.index>Bt?(Qt=dt,dt=null):Qt=dt.sibling;var la=Te(ge,dt,mn.value,ke);if(la===null){dt===null&&(dt=Qt);break}s&&dt&&la.alternate===null&&a(ge,dt),fe=I(la,fe,Bt),fn===null?gt=la:fn.sibling=la,fn=la,dt=Qt}if(mn.done)return d(ge,dt),tn&&so(ge,Bt),gt;if(dt===null){for(;!mn.done;Bt++,mn=we.next())mn=Pe(ge,mn.value,ke),mn!==null&&(fe=I(mn,fe,Bt),fn===null?gt=mn:fn.sibling=mn,fn=mn);return tn&&so(ge,Bt),gt}for(dt=p(dt);!mn.done;Bt++,mn=we.next())mn=Re(dt,ge,Bt,mn.value,ke),mn!==null&&(s&&mn.alternate!==null&&dt.delete(mn.key===null?Bt:mn.key),fe=I(mn,fe,Bt),fn===null?gt=mn:fn.sibling=mn,fn=mn);return s&&dt.forEach(function(MA){return a(ge,MA)}),tn&&so(ge,Bt),gt}function Cn(ge,fe,we,ke){if(typeof we=="object"&&we!==null&&we.type===W&&we.key===null&&(we=we.props.children),typeof we=="object"&&we!==null){switch(we.$$typeof){case k:e:{for(var gt=we.key;fe!==null;){if(fe.key===gt){if(gt=we.type,gt===W){if(fe.tag===7){d(ge,fe.sibling),ke=S(fe,we.props.children),ke.return=ge,ge=ke;break e}}else if(fe.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===V&&Wa(gt)===fe.type){d(ge,fe.sibling),ke=S(fe,we.props),Oc(ke,we),ke.return=ge,ge=ke;break e}d(ge,fe);break}else a(ge,fe);fe=fe.sibling}we.type===W?(ke=Ga(we.props.children,ge.mode,ke,we.key),ke.return=ge,ge=ke):(ke=Qu(we.type,we.key,we.props,null,ge.mode,ke),Oc(ke,we),ke.return=ge,ge=ke)}return P(ge);case H:e:{for(gt=we.key;fe!==null;){if(fe.key===gt)if(fe.tag===4&&fe.stateNode.containerInfo===we.containerInfo&&fe.stateNode.implementation===we.implementation){d(ge,fe.sibling),ke=S(fe,we.children||[]),ke.return=ge,ge=ke;break e}else{d(ge,fe);break}else a(ge,fe);fe=fe.sibling}ke=Ef(we,ge.mode,ke),ke.return=ge,ge=ke}return P(ge);case V:return we=Wa(we),Cn(ge,fe,we,ke)}if(he(we))return lt(ge,fe,we,ke);if($(we)){if(gt=$(we),typeof gt!="function")throw Error(i(150));return we=gt.call(we),bt(ge,fe,we,ke)}if(typeof we.then=="function")return Cn(ge,fe,rd(we),ke);if(we.$$typeof===ee)return Cn(ge,fe,td(ge,we),ke);od(ge,we)}return typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint"?(we=""+we,fe!==null&&fe.tag===6?(d(ge,fe.sibling),ke=S(fe,we),ke.return=ge,ge=ke):(d(ge,fe),ke=bf(we,ge.mode,ke),ke.return=ge,ge=ke),P(ge)):d(ge,fe)}return function(ge,fe,we,ke){try{Dc=0;var gt=Cn(ge,fe,we,ke);return Sl=null,gt}catch(dt){if(dt===Al||dt===id)throw dt;var fn=Ls(29,dt,null,ge.mode);return fn.lanes=ke,fn.return=ge,fn}finally{}}}var Ka=Dp(!0),Op=Dp(!1),qo=!1;function kf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pf(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Yo(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Wo(s,a,d){var p=s.updateQueue;if(p===null)return null;if(p=p.shared,(pn&2)!==0){var S=p.pending;return S===null?a.next=a:(a.next=S.next,S.next=a),p.pending=a,a=Ju(s),pp(s,null,d),a}return $u(s,p,a,d),Ju(s)}function kc(s,a,d){if(a=a.updateQueue,a!==null&&(a=a.shared,(d&4194048)!==0)){var p=a.lanes;p&=s.pendingLanes,d|=p,a.lanes=d,Is(s,d)}}function Lf(s,a){var d=s.updateQueue,p=s.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var S=null,I=null;if(d=d.firstBaseUpdate,d!==null){do{var P={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};I===null?S=I=P:I=I.next=P,d=d.next}while(d!==null);I===null?S=I=a:I=I.next=a}else S=I=a;d={baseState:p.baseState,firstBaseUpdate:S,lastBaseUpdate:I,shared:p.shared,callbacks:p.callbacks},s.updateQueue=d;return}s=d.lastBaseUpdate,s===null?d.firstBaseUpdate=a:s.next=a,d.lastBaseUpdate=a}var Uf=!1;function Pc(){if(Uf){var s=Tl;if(s!==null)throw s}}function Lc(s,a,d,p){Uf=!1;var S=s.updateQueue;qo=!1;var I=S.firstBaseUpdate,P=S.lastBaseUpdate,q=S.shared.pending;if(q!==null){S.shared.pending=null;var se=q,be=se.next;se.next=null,P===null?I=be:P.next=be,P=se;var Oe=s.alternate;Oe!==null&&(Oe=Oe.updateQueue,q=Oe.lastBaseUpdate,q!==P&&(q===null?Oe.firstBaseUpdate=be:q.next=be,Oe.lastBaseUpdate=se))}if(I!==null){var Pe=S.baseState;P=0,Oe=be=se=null,q=I;do{var Te=q.lane&-536870913,Re=Te!==q.lane;if(Re?(Jt&Te)===Te:(p&Te)===Te){Te!==0&&Te===_l&&(Uf=!0),Oe!==null&&(Oe=Oe.next={lane:0,tag:q.tag,payload:q.payload,callback:null,next:null});e:{var lt=s,bt=q;Te=a;var Cn=d;switch(bt.tag){case 1:if(lt=bt.payload,typeof lt=="function"){Pe=lt.call(Cn,Pe,Te);break e}Pe=lt;break e;case 3:lt.flags=lt.flags&-65537|128;case 0:if(lt=bt.payload,Te=typeof lt=="function"?lt.call(Cn,Pe,Te):lt,Te==null)break e;Pe=N({},Pe,Te);break e;case 2:qo=!0}}Te=q.callback,Te!==null&&(s.flags|=64,Re&&(s.flags|=8192),Re=S.callbacks,Re===null?S.callbacks=[Te]:Re.push(Te))}else Re={lane:Te,tag:q.tag,payload:q.payload,callback:q.callback,next:null},Oe===null?(be=Oe=Re,se=Pe):Oe=Oe.next=Re,P|=Te;if(q=q.next,q===null){if(q=S.shared.pending,q===null)break;Re=q,q=Re.next,Re.next=null,S.lastBaseUpdate=Re,S.shared.pending=null}}while(!0);Oe===null&&(se=Pe),S.baseState=se,S.firstBaseUpdate=be,S.lastBaseUpdate=Oe,I===null&&(S.shared.lanes=0),Qo|=P,s.lanes=P,s.memoizedState=Pe}}function kp(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function Pp(s,a){var d=s.callbacks;if(d!==null)for(s.callbacks=null,s=0;s<d.length;s++)kp(d[s],a)}var Cl=ae(null),ad=ae(0);function Lp(s,a){s=po,Ae(ad,s),Ae(Cl,a),po=s|a.baseLanes}function Bf(){Ae(ad,po),Ae(Cl,Cl.current)}function Ff(){po=ad.current,Ie(Cl),Ie(ad)}var Us=ae(null),rr=null;function Xo(s){var a=s.alternate;Ae(ri,ri.current&1),Ae(Us,s),rr===null&&(a===null||Cl.current!==null||a.memoizedState!==null)&&(rr=s)}function jf(s){Ae(ri,ri.current),Ae(Us,s),rr===null&&(rr=s)}function Up(s){s.tag===22?(Ae(ri,ri.current),Ae(Us,s),rr===null&&(rr=s)):Ko()}function Ko(){Ae(ri,ri.current),Ae(Us,Us.current)}function Bs(s){Ie(Us),rr===s&&(rr=null),Ie(ri)}var ri=ae(0);function ld(s){for(var a=s;a!==null;){if(a.tag===13){var d=a.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||Y0(d)||W0(d)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ao=0,Lt=null,An=null,di=null,cd=!1,Nl=!1,$a=!1,ud=0,Uc=0,Il=null,bT=0;function ei(){throw Error(i(321))}function Vf(s,a){if(a===null)return!1;for(var d=0;d<a.length&&d<s.length;d++)if(!v(s[d],a[d]))return!1;return!0}function Gf(s,a,d,p,S,I){return ao=I,Lt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,ne.H=s===null||s.memoizedState===null?w1:i0,$a=!1,I=d(p,S),$a=!1,Nl&&(I=Fp(a,d,p,S)),Bp(s),I}function Bp(s){ne.H=jc;var a=An!==null&&An.next!==null;if(ao=0,di=An=Lt=null,cd=!1,Uc=0,Il=null,a)throw Error(i(300));s===null||hi||(s=s.dependencies,s!==null&&ed(s)&&(hi=!0))}function Fp(s,a,d,p){Lt=s;var S=0;do{if(Nl&&(Il=null),Uc=0,Nl=!1,25<=S)throw Error(i(301));if(S+=1,di=An=null,s.updateQueue!=null){var I=s.updateQueue;I.lastEffect=null,I.events=null,I.stores=null,I.memoCache!=null&&(I.memoCache.index=0)}ne.H=b1,I=a(d,p)}while(Nl);return I}function ET(){var s=ne.H,a=s.useState()[0];return a=typeof a.then=="function"?Bc(a):a,s=s.useState()[0],(An!==null?An.memoizedState:null)!==s&&(Lt.flags|=1024),a}function Hf(){var s=ud!==0;return ud=0,s}function zf(s,a,d){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~d}function qf(s){if(cd){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}cd=!1}ao=0,di=An=Lt=null,Nl=!1,Uc=ud=0,Il=null}function us(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return di===null?Lt.memoizedState=di=s:di=di.next=s,di}function oi(){if(An===null){var s=Lt.alternate;s=s!==null?s.memoizedState:null}else s=An.next;var a=di===null?Lt.memoizedState:di.next;if(a!==null)di=a,An=s;else{if(s===null)throw Lt.alternate===null?Error(i(467)):Error(i(310));An=s,s={memoizedState:An.memoizedState,baseState:An.baseState,baseQueue:An.baseQueue,queue:An.queue,next:null},di===null?Lt.memoizedState=di=s:di=di.next=s}return di}function dd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Bc(s){var a=Uc;return Uc+=1,Il===null&&(Il=[]),s=Ip(Il,s,a),a=Lt,(di===null?a.memoizedState:di.next)===null&&(a=a.alternate,ne.H=a===null||a.memoizedState===null?w1:i0),s}function hd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Bc(s);if(s.$$typeof===ee)return Fi(s)}throw Error(i(438,String(s)))}function Yf(s){var a=null,d=Lt.updateQueue;if(d!==null&&(a=d.memoCache),a==null){var p=Lt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(a={data:p.data.map(function(S){return S.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),d===null&&(d=dd(),Lt.updateQueue=d),d.memoCache=a,d=a.data[a.index],d===void 0)for(d=a.data[a.index]=Array(s),p=0;p<s;p++)d[p]=Q;return a.index++,d}function lo(s,a){return typeof a=="function"?a(s):a}function fd(s){var a=oi();return Wf(a,An,s)}function Wf(s,a,d){var p=s.queue;if(p===null)throw Error(i(311));p.lastRenderedReducer=d;var S=s.baseQueue,I=p.pending;if(I!==null){if(S!==null){var P=S.next;S.next=I.next,I.next=P}a.baseQueue=S=I,p.pending=null}if(I=s.baseState,S===null)s.memoizedState=I;else{a=S.next;var q=P=null,se=null,be=a,Oe=!1;do{var Pe=be.lane&-536870913;if(Pe!==be.lane?(Jt&Pe)===Pe:(ao&Pe)===Pe){var Te=be.revertLane;if(Te===0)se!==null&&(se=se.next={lane:0,revertLane:0,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null}),Pe===_l&&(Oe=!0);else if((ao&Te)===Te){be=be.next,Te===_l&&(Oe=!0);continue}else Pe={lane:0,revertLane:be.revertLane,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},se===null?(q=se=Pe,P=I):se=se.next=Pe,Lt.lanes|=Te,Qo|=Te;Pe=be.action,$a&&d(I,Pe),I=be.hasEagerState?be.eagerState:d(I,Pe)}else Te={lane:Pe,revertLane:be.revertLane,gesture:be.gesture,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},se===null?(q=se=Te,P=I):se=se.next=Te,Lt.lanes|=Pe,Qo|=Pe;be=be.next}while(be!==null&&be!==a);if(se===null?P=I:se.next=q,!v(I,s.memoizedState)&&(hi=!0,Oe&&(d=Tl,d!==null)))throw d;s.memoizedState=I,s.baseState=P,s.baseQueue=se,p.lastRenderedState=I}return S===null&&(p.lanes=0),[s.memoizedState,p.dispatch]}function Xf(s){var a=oi(),d=a.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=s;var p=d.dispatch,S=d.pending,I=a.memoizedState;if(S!==null){d.pending=null;var P=S=S.next;do I=s(I,P.action),P=P.next;while(P!==S);v(I,a.memoizedState)||(hi=!0),a.memoizedState=I,a.baseQueue===null&&(a.baseState=I),d.lastRenderedState=I}return[I,p]}function jp(s,a,d){var p=Lt,S=oi(),I=tn;if(I){if(d===void 0)throw Error(i(407));d=d()}else d=a();var P=!v((An||S).memoizedState,d);if(P&&(S.memoizedState=d,hi=!0),S=S.queue,Jf(Hp.bind(null,p,S,s),[s]),S.getSnapshot!==a||P||di!==null&&di.memoizedState.tag&1){if(p.flags|=2048,Rl(9,{destroy:void 0},Gp.bind(null,p,S,d,a),null),Rn===null)throw Error(i(349));I||(ao&127)!==0||Vp(p,a,d)}return d}function Vp(s,a,d){s.flags|=16384,s={getSnapshot:a,value:d},a=Lt.updateQueue,a===null?(a=dd(),Lt.updateQueue=a,a.stores=[s]):(d=a.stores,d===null?a.stores=[s]:d.push(s))}function Gp(s,a,d,p){a.value=d,a.getSnapshot=p,zp(a)&&qp(s)}function Hp(s,a,d){return d(function(){zp(a)&&qp(s)})}function zp(s){var a=s.getSnapshot;s=s.value;try{var d=a();return!v(s,d)}catch{return!0}}function qp(s){var a=Va(s,2);a!==null&&Ss(a,s,2)}function Kf(s){var a=us();if(typeof s=="function"){var d=s;if(s=d(),$a){ln(!0);try{d()}finally{ln(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:lo,lastRenderedState:s},a}function Yp(s,a,d,p){return s.baseState=d,Wf(s,An,typeof p=="function"?p:lo)}function _T(s,a,d,p,S){if(pd(s))throw Error(i(485));if(s=a.action,s!==null){var I={payload:S,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(P){I.listeners.push(P)}};ne.T!==null?d(!0):I.isTransition=!1,p(I),d=a.pending,d===null?(I.next=a.pending=I,Wp(a,I)):(I.next=d.next,a.pending=d.next=I)}}function Wp(s,a){var d=a.action,p=a.payload,S=s.state;if(a.isTransition){var I=ne.T,P={};ne.T=P;try{var q=d(S,p),se=ne.S;se!==null&&se(P,q),Xp(s,a,q)}catch(be){$f(s,a,be)}finally{I!==null&&P.types!==null&&(I.types=P.types),ne.T=I}}else try{I=d(S,p),Xp(s,a,I)}catch(be){$f(s,a,be)}}function Xp(s,a,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(p){Kp(s,a,p)},function(p){return $f(s,a,p)}):Kp(s,a,d)}function Kp(s,a,d){a.status="fulfilled",a.value=d,$p(a),s.state=d,a=s.pending,a!==null&&(d=a.next,d===a?s.pending=null:(d=d.next,a.next=d,Wp(s,d)))}function $f(s,a,d){var p=s.pending;if(s.pending=null,p!==null){p=p.next;do a.status="rejected",a.reason=d,$p(a),a=a.next;while(a!==p)}s.action=null}function $p(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function Jp(s,a){return a}function Qp(s,a){if(tn){var d=Rn.formState;if(d!==null){e:{var p=Lt;if(tn){if(Un){t:{for(var S=Un,I=sr;S.nodeType!==8;){if(!I){S=null;break t}if(S=or(S.nextSibling),S===null){S=null;break t}}I=S.data,S=I==="F!"||I==="F"?S:null}if(S){Un=or(S.nextSibling),p=S.data==="F!";break e}}Ho(p)}p=!1}p&&(a=d[0])}}return d=us(),d.memoizedState=d.baseState=a,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jp,lastRenderedState:a},d.queue=p,d=x1.bind(null,Lt,p),p.dispatch=d,p=Kf(!1),I=n0.bind(null,Lt,!1,p.queue),p=us(),S={state:a,dispatch:null,action:s,pending:null},p.queue=S,d=_T.bind(null,Lt,S,I,d),S.dispatch=d,p.memoizedState=s,[a,d,!1]}function Zp(s){var a=oi();return e1(a,An,s)}function e1(s,a,d){if(a=Wf(s,a,Jp)[0],s=fd(lo)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var p=Bc(a)}catch(P){throw P===Al?id:P}else p=a;a=oi();var S=a.queue,I=S.dispatch;return d!==a.memoizedState&&(Lt.flags|=2048,Rl(9,{destroy:void 0},TT.bind(null,S,d),null)),[p,I,s]}function TT(s,a){s.action=a}function t1(s){var a=oi(),d=An;if(d!==null)return e1(a,d,s);oi(),a=a.memoizedState,d=oi();var p=d.queue.dispatch;return d.memoizedState=s,[a,p,!1]}function Rl(s,a,d,p){return s={tag:s,create:d,deps:p,inst:a,next:null},a=Lt.updateQueue,a===null&&(a=dd(),Lt.updateQueue=a),d=a.lastEffect,d===null?a.lastEffect=s.next=s:(p=d.next,d.next=s,s.next=p,a.lastEffect=s),s}function n1(){return oi().memoizedState}function md(s,a,d,p){var S=us();Lt.flags|=s,S.memoizedState=Rl(1|a,{destroy:void 0},d,p===void 0?null:p)}function gd(s,a,d,p){var S=oi();p=p===void 0?null:p;var I=S.memoizedState.inst;An!==null&&p!==null&&Vf(p,An.memoizedState.deps)?S.memoizedState=Rl(a,I,d,p):(Lt.flags|=s,S.memoizedState=Rl(1|a,I,d,p))}function i1(s,a){md(8390656,8,s,a)}function Jf(s,a){gd(2048,8,s,a)}function AT(s){Lt.flags|=4;var a=Lt.updateQueue;if(a===null)a=dd(),Lt.updateQueue=a,a.events=[s];else{var d=a.events;d===null?a.events=[s]:d.push(s)}}function s1(s){var a=oi().memoizedState;return AT({ref:a,nextImpl:s}),function(){if((pn&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function r1(s,a){return gd(4,2,s,a)}function o1(s,a){return gd(4,4,s,a)}function a1(s,a){if(typeof a=="function"){s=s();var d=a(s);return function(){typeof d=="function"?d():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function l1(s,a,d){d=d!=null?d.concat([s]):null,gd(4,4,a1.bind(null,a,s),d)}function Qf(){}function c1(s,a){var d=oi();a=a===void 0?null:a;var p=d.memoizedState;return a!==null&&Vf(a,p[1])?p[0]:(d.memoizedState=[s,a],s)}function u1(s,a){var d=oi();a=a===void 0?null:a;var p=d.memoizedState;if(a!==null&&Vf(a,p[1]))return p[0];if(p=s(),$a){ln(!0);try{s()}finally{ln(!1)}}return d.memoizedState=[p,a],p}function Zf(s,a,d){return d===void 0||(ao&1073741824)!==0&&(Jt&261930)===0?s.memoizedState=a:(s.memoizedState=d,s=dx(),Lt.lanes|=s,Qo|=s,d)}function d1(s,a,d,p){return v(d,a)?d:Cl.current!==null?(s=Zf(s,d,p),v(s,a)||(hi=!0),s):(ao&42)===0||(ao&1073741824)!==0&&(Jt&261930)===0?(hi=!0,s.memoizedState=d):(s=dx(),Lt.lanes|=s,Qo|=s,a)}function h1(s,a,d,p,S){var I=ie.p;ie.p=I!==0&&8>I?I:8;var P=ne.T,q={};ne.T=q,n0(s,!1,a,d);try{var se=S(),be=ne.S;if(be!==null&&be(q,se),se!==null&&typeof se=="object"&&typeof se.then=="function"){var Oe=wT(se,p);Fc(s,a,Oe,Vs(s))}else Fc(s,a,p,Vs(s))}catch(Pe){Fc(s,a,{then:function(){},status:"rejected",reason:Pe},Vs())}finally{ie.p=I,P!==null&&q.types!==null&&(P.types=q.types),ne.T=P}}function ST(){}function e0(s,a,d,p){if(s.tag!==5)throw Error(i(476));var S=f1(s).queue;h1(s,S,a,Me,d===null?ST:function(){return m1(s),d(p)})}function f1(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:Me,baseState:Me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:lo,lastRenderedState:Me},next:null};var d={};return a.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:lo,lastRenderedState:d},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function m1(s){var a=f1(s);a.next===null&&(a=s.alternate.memoizedState),Fc(s,a.next.queue,{},Vs())}function t0(){return Fi(nu)}function g1(){return oi().memoizedState}function p1(){return oi().memoizedState}function CT(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var d=Vs();s=Yo(d);var p=Wo(a,s,d);p!==null&&(Ss(p,a,d),kc(p,a,d)),a={cache:Rf()},s.payload=a;return}a=a.return}}function NT(s,a,d){var p=Vs();d={lane:p,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},pd(s)?y1(a,d):(d=vf(s,a,d,p),d!==null&&(Ss(d,s,p),v1(d,a,p)))}function x1(s,a,d){var p=Vs();Fc(s,a,d,p)}function Fc(s,a,d,p){var S={lane:p,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null};if(pd(s))y1(a,S);else{var I=s.alternate;if(s.lanes===0&&(I===null||I.lanes===0)&&(I=a.lastRenderedReducer,I!==null))try{var P=a.lastRenderedState,q=I(P,d);if(S.hasEagerState=!0,S.eagerState=q,v(q,P))return $u(s,a,S,0),Rn===null&&Ku(),!1}catch{}finally{}if(d=vf(s,a,S,p),d!==null)return Ss(d,s,p),v1(d,a,p),!0}return!1}function n0(s,a,d,p){if(p={lane:2,revertLane:k0(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},pd(s)){if(a)throw Error(i(479))}else a=vf(s,d,p,2),a!==null&&Ss(a,s,2)}function pd(s){var a=s.alternate;return s===Lt||a!==null&&a===Lt}function y1(s,a){Nl=cd=!0;var d=s.pending;d===null?a.next=a:(a.next=d.next,d.next=a),s.pending=a}function v1(s,a,d){if((d&4194048)!==0){var p=a.lanes;p&=s.pendingLanes,d|=p,a.lanes=d,Is(s,d)}}var jc={readContext:Fi,use:hd,useCallback:ei,useContext:ei,useEffect:ei,useImperativeHandle:ei,useLayoutEffect:ei,useInsertionEffect:ei,useMemo:ei,useReducer:ei,useRef:ei,useState:ei,useDebugValue:ei,useDeferredValue:ei,useTransition:ei,useSyncExternalStore:ei,useId:ei,useHostTransitionStatus:ei,useFormState:ei,useActionState:ei,useOptimistic:ei,useMemoCache:ei,useCacheRefresh:ei};jc.useEffectEvent=ei;var w1={readContext:Fi,use:hd,useCallback:function(s,a){return us().memoizedState=[s,a===void 0?null:a],s},useContext:Fi,useEffect:i1,useImperativeHandle:function(s,a,d){d=d!=null?d.concat([s]):null,md(4194308,4,a1.bind(null,a,s),d)},useLayoutEffect:function(s,a){return md(4194308,4,s,a)},useInsertionEffect:function(s,a){md(4,2,s,a)},useMemo:function(s,a){var d=us();a=a===void 0?null:a;var p=s();if($a){ln(!0);try{s()}finally{ln(!1)}}return d.memoizedState=[p,a],p},useReducer:function(s,a,d){var p=us();if(d!==void 0){var S=d(a);if($a){ln(!0);try{d(a)}finally{ln(!1)}}}else S=a;return p.memoizedState=p.baseState=S,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:S},p.queue=s,s=s.dispatch=NT.bind(null,Lt,s),[p.memoizedState,s]},useRef:function(s){var a=us();return s={current:s},a.memoizedState=s},useState:function(s){s=Kf(s);var a=s.queue,d=x1.bind(null,Lt,a);return a.dispatch=d,[s.memoizedState,d]},useDebugValue:Qf,useDeferredValue:function(s,a){var d=us();return Zf(d,s,a)},useTransition:function(){var s=Kf(!1);return s=h1.bind(null,Lt,s.queue,!0,!1),us().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,d){var p=Lt,S=us();if(tn){if(d===void 0)throw Error(i(407));d=d()}else{if(d=a(),Rn===null)throw Error(i(349));(Jt&127)!==0||Vp(p,a,d)}S.memoizedState=d;var I={value:d,getSnapshot:a};return S.queue=I,i1(Hp.bind(null,p,I,s),[s]),p.flags|=2048,Rl(9,{destroy:void 0},Gp.bind(null,p,I,d,a),null),d},useId:function(){var s=us(),a=Rn.identifierPrefix;if(tn){var d=Dr,p=Mr;d=(p&~(1<<32-_t(p)-1)).toString(32)+d,a="_"+a+"R_"+d,d=ud++,0<d&&(a+="H"+d.toString(32)),a+="_"}else d=bT++,a="_"+a+"r_"+d.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:t0,useFormState:Qp,useActionState:Qp,useOptimistic:function(s){var a=us();a.memoizedState=a.baseState=s;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=d,a=n0.bind(null,Lt,!0,d),d.dispatch=a,[s,a]},useMemoCache:Yf,useCacheRefresh:function(){return us().memoizedState=CT.bind(null,Lt)},useEffectEvent:function(s){var a=us(),d={impl:s};return a.memoizedState=d,function(){if((pn&2)!==0)throw Error(i(440));return d.impl.apply(void 0,arguments)}}},i0={readContext:Fi,use:hd,useCallback:c1,useContext:Fi,useEffect:Jf,useImperativeHandle:l1,useInsertionEffect:r1,useLayoutEffect:o1,useMemo:u1,useReducer:fd,useRef:n1,useState:function(){return fd(lo)},useDebugValue:Qf,useDeferredValue:function(s,a){var d=oi();return d1(d,An.memoizedState,s,a)},useTransition:function(){var s=fd(lo)[0],a=oi().memoizedState;return[typeof s=="boolean"?s:Bc(s),a]},useSyncExternalStore:jp,useId:g1,useHostTransitionStatus:t0,useFormState:Zp,useActionState:Zp,useOptimistic:function(s,a){var d=oi();return Yp(d,An,s,a)},useMemoCache:Yf,useCacheRefresh:p1};i0.useEffectEvent=s1;var b1={readContext:Fi,use:hd,useCallback:c1,useContext:Fi,useEffect:Jf,useImperativeHandle:l1,useInsertionEffect:r1,useLayoutEffect:o1,useMemo:u1,useReducer:Xf,useRef:n1,useState:function(){return Xf(lo)},useDebugValue:Qf,useDeferredValue:function(s,a){var d=oi();return An===null?Zf(d,s,a):d1(d,An.memoizedState,s,a)},useTransition:function(){var s=Xf(lo)[0],a=oi().memoizedState;return[typeof s=="boolean"?s:Bc(s),a]},useSyncExternalStore:jp,useId:g1,useHostTransitionStatus:t0,useFormState:t1,useActionState:t1,useOptimistic:function(s,a){var d=oi();return An!==null?Yp(d,An,s,a):(d.baseState=s,[s,d.queue.dispatch])},useMemoCache:Yf,useCacheRefresh:p1};b1.useEffectEvent=s1;function s0(s,a,d,p){a=s.memoizedState,d=d(p,a),d=d==null?a:N({},a,d),s.memoizedState=d,s.lanes===0&&(s.updateQueue.baseState=d)}var r0={enqueueSetState:function(s,a,d){s=s._reactInternals;var p=Vs(),S=Yo(p);S.payload=a,d!=null&&(S.callback=d),a=Wo(s,S,p),a!==null&&(Ss(a,s,p),kc(a,s,p))},enqueueReplaceState:function(s,a,d){s=s._reactInternals;var p=Vs(),S=Yo(p);S.tag=1,S.payload=a,d!=null&&(S.callback=d),a=Wo(s,S,p),a!==null&&(Ss(a,s,p),kc(a,s,p))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var d=Vs(),p=Yo(d);p.tag=2,a!=null&&(p.callback=a),a=Wo(s,p,d),a!==null&&(Ss(a,s,d),kc(a,s,d))}};function E1(s,a,d,p,S,I,P){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(p,I,P):a.prototype&&a.prototype.isPureReactComponent?!_(d,p)||!_(S,I):!0}function _1(s,a,d,p){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(d,p),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(d,p),a.state!==s&&r0.enqueueReplaceState(a,a.state,null)}function Ja(s,a){var d=a;if("ref"in a){d={};for(var p in a)p!=="ref"&&(d[p]=a[p])}if(s=s.defaultProps){d===a&&(d=N({},d));for(var S in s)d[S]===void 0&&(d[S]=s[S])}return d}function T1(s){Xu(s)}function A1(s){console.error(s)}function S1(s){Xu(s)}function xd(s,a){try{var d=s.onUncaughtError;d(a.value,{componentStack:a.stack})}catch(p){setTimeout(function(){throw p})}}function C1(s,a,d){try{var p=s.onCaughtError;p(d.value,{componentStack:d.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function o0(s,a,d){return d=Yo(d),d.tag=3,d.payload={element:null},d.callback=function(){xd(s,a)},d}function N1(s){return s=Yo(s),s.tag=3,s}function I1(s,a,d,p){var S=d.type.getDerivedStateFromError;if(typeof S=="function"){var I=p.value;s.payload=function(){return S(I)},s.callback=function(){C1(a,d,p)}}var P=d.stateNode;P!==null&&typeof P.componentDidCatch=="function"&&(s.callback=function(){C1(a,d,p),typeof S!="function"&&(Zo===null?Zo=new Set([this]):Zo.add(this));var q=p.stack;this.componentDidCatch(p.value,{componentStack:q!==null?q:""})})}function IT(s,a,d,p,S){if(d.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(a=d.alternate,a!==null&&El(a,d,S,!0),d=Us.current,d!==null){switch(d.tag){case 31:case 13:return rr===null?Id():d.alternate===null&&ti===0&&(ti=3),d.flags&=-257,d.flags|=65536,d.lanes=S,p===sd?d.flags|=16384:(a=d.updateQueue,a===null?d.updateQueue=new Set([p]):a.add(p),M0(s,p,S)),!1;case 22:return d.flags|=65536,p===sd?d.flags|=16384:(a=d.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([p])},d.updateQueue=a):(d=a.retryQueue,d===null?a.retryQueue=new Set([p]):d.add(p)),M0(s,p,S)),!1}throw Error(i(435,d.tag))}return M0(s,p,S),Id(),!1}if(tn)return a=Us.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=S,p!==Af&&(s=Error(i(422),{cause:p}),Ic(tr(s,d)))):(p!==Af&&(a=Error(i(423),{cause:p}),Ic(tr(a,d))),s=s.current.alternate,s.flags|=65536,S&=-S,s.lanes|=S,p=tr(p,d),S=o0(s.stateNode,p,S),Lf(s,S),ti!==4&&(ti=2)),!1;var I=Error(i(520),{cause:p});if(I=tr(I,d),Xc===null?Xc=[I]:Xc.push(I),ti!==4&&(ti=2),a===null)return!0;p=tr(p,d),d=a;do{switch(d.tag){case 3:return d.flags|=65536,s=S&-S,d.lanes|=s,s=o0(d.stateNode,p,s),Lf(d,s),!1;case 1:if(a=d.type,I=d.stateNode,(d.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Zo===null||!Zo.has(I))))return d.flags|=65536,S&=-S,d.lanes|=S,S=N1(S),I1(S,s,d,p),Lf(d,S),!1}d=d.return}while(d!==null);return!1}var a0=Error(i(461)),hi=!1;function ji(s,a,d,p){a.child=s===null?Op(a,null,d,p):Ka(a,s.child,d,p)}function R1(s,a,d,p,S){d=d.render;var I=a.ref;if("ref"in p){var P={};for(var q in p)q!=="ref"&&(P[q]=p[q])}else P=p;return qa(a),p=Gf(s,a,d,P,I,S),q=Hf(),s!==null&&!hi?(zf(s,a,S),co(s,a,S)):(tn&&q&&_f(a),a.flags|=1,ji(s,a,p,S),a.child)}function M1(s,a,d,p,S){if(s===null){var I=d.type;return typeof I=="function"&&!wf(I)&&I.defaultProps===void 0&&d.compare===null?(a.tag=15,a.type=I,D1(s,a,I,p,S)):(s=Qu(d.type,null,p,a,a.mode,S),s.ref=a.ref,s.return=a,a.child=s)}if(I=s.child,!g0(s,S)){var P=I.memoizedProps;if(d=d.compare,d=d!==null?d:_,d(P,p)&&s.ref===a.ref)return co(s,a,S)}return a.flags|=1,s=io(I,p),s.ref=a.ref,s.return=a,a.child=s}function D1(s,a,d,p,S){if(s!==null){var I=s.memoizedProps;if(_(I,p)&&s.ref===a.ref)if(hi=!1,a.pendingProps=p=I,g0(s,S))(s.flags&131072)!==0&&(hi=!0);else return a.lanes=s.lanes,co(s,a,S)}return l0(s,a,d,p,S)}function O1(s,a,d,p){var S=p.children,I=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((a.flags&128)!==0){if(I=I!==null?I.baseLanes|d:d,s!==null){for(p=a.child=s.child,S=0;p!==null;)S=S|p.lanes|p.childLanes,p=p.sibling;p=S&~I}else p=0,a.child=null;return k1(s,a,I,d,p)}if((d&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&nd(a,I!==null?I.cachePool:null),I!==null?Lp(a,I):Bf(),Up(a);else return p=a.lanes=536870912,k1(s,a,I!==null?I.baseLanes|d:d,d,p)}else I!==null?(nd(a,I.cachePool),Lp(a,I),Ko(),a.memoizedState=null):(s!==null&&nd(a,null),Bf(),Ko());return ji(s,a,S,d),a.child}function Vc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function k1(s,a,d,p,S){var I=Df();return I=I===null?null:{parent:ui._currentValue,pool:I},a.memoizedState={baseLanes:d,cachePool:I},s!==null&&nd(a,null),Bf(),Up(a),s!==null&&El(s,a,p,!0),a.childLanes=S,null}function yd(s,a){return a=wd({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function P1(s,a,d){return Ka(a,s.child,null,d),s=yd(a,a.pendingProps),s.flags|=2,Bs(a),a.memoizedState=null,s}function RT(s,a,d){var p=a.pendingProps,S=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(tn){if(p.mode==="hidden")return s=yd(a,p),a.lanes=536870912,Vc(null,s);if(jf(a),(s=Un)?(s=Wx(s,sr),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Vo!==null?{id:Mr,overflow:Dr}:null,retryLane:536870912,hydrationErrors:null},d=yp(s),d.return=a,a.child=d,Bi=a,Un=null)):s=null,s===null)throw Ho(a);return a.lanes=536870912,null}return yd(a,p)}var I=s.memoizedState;if(I!==null){var P=I.dehydrated;if(jf(a),S)if(a.flags&256)a.flags&=-257,a=P1(s,a,d);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(hi||El(s,a,d,!1),S=(d&s.childLanes)!==0,hi||S){if(p=Rn,p!==null&&(P=qr(p,d),P!==0&&P!==I.retryLane))throw I.retryLane=P,Va(s,P),Ss(p,s,P),a0;Id(),a=P1(s,a,d)}else s=I.treeContext,Un=or(P.nextSibling),Bi=a,tn=!0,Go=null,sr=!1,s!==null&&bp(a,s),a=yd(a,p),a.flags|=4096;return a}return s=io(s.child,{mode:p.mode,children:p.children}),s.ref=a.ref,a.child=s,s.return=a,s}function vd(s,a){var d=a.ref;if(d===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(i(284));(s===null||s.ref!==d)&&(a.flags|=4194816)}}function l0(s,a,d,p,S){return qa(a),d=Gf(s,a,d,p,void 0,S),p=Hf(),s!==null&&!hi?(zf(s,a,S),co(s,a,S)):(tn&&p&&_f(a),a.flags|=1,ji(s,a,d,S),a.child)}function L1(s,a,d,p,S,I){return qa(a),a.updateQueue=null,d=Fp(a,p,d,S),Bp(s),p=Hf(),s!==null&&!hi?(zf(s,a,I),co(s,a,I)):(tn&&p&&_f(a),a.flags|=1,ji(s,a,d,I),a.child)}function U1(s,a,d,p,S){if(qa(a),a.stateNode===null){var I=yl,P=d.contextType;typeof P=="object"&&P!==null&&(I=Fi(P)),I=new d(p,I),a.memoizedState=I.state!==null&&I.state!==void 0?I.state:null,I.updater=r0,a.stateNode=I,I._reactInternals=a,I=a.stateNode,I.props=p,I.state=a.memoizedState,I.refs={},kf(a),P=d.contextType,I.context=typeof P=="object"&&P!==null?Fi(P):yl,I.state=a.memoizedState,P=d.getDerivedStateFromProps,typeof P=="function"&&(s0(a,d,P,p),I.state=a.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof I.getSnapshotBeforeUpdate=="function"||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(P=I.state,typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount(),P!==I.state&&r0.enqueueReplaceState(I,I.state,null),Lc(a,p,I,S),Pc(),I.state=a.memoizedState),typeof I.componentDidMount=="function"&&(a.flags|=4194308),p=!0}else if(s===null){I=a.stateNode;var q=a.memoizedProps,se=Ja(d,q);I.props=se;var be=I.context,Oe=d.contextType;P=yl,typeof Oe=="object"&&Oe!==null&&(P=Fi(Oe));var Pe=d.getDerivedStateFromProps;Oe=typeof Pe=="function"||typeof I.getSnapshotBeforeUpdate=="function",q=a.pendingProps!==q,Oe||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(q||be!==P)&&_1(a,I,p,P),qo=!1;var Te=a.memoizedState;I.state=Te,Lc(a,p,I,S),Pc(),be=a.memoizedState,q||Te!==be||qo?(typeof Pe=="function"&&(s0(a,d,Pe,p),be=a.memoizedState),(se=qo||E1(a,d,se,p,Te,be,P))?(Oe||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(a.flags|=4194308)):(typeof I.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=p,a.memoizedState=be),I.props=p,I.state=be,I.context=P,p=se):(typeof I.componentDidMount=="function"&&(a.flags|=4194308),p=!1)}else{I=a.stateNode,Pf(s,a),P=a.memoizedProps,Oe=Ja(d,P),I.props=Oe,Pe=a.pendingProps,Te=I.context,be=d.contextType,se=yl,typeof be=="object"&&be!==null&&(se=Fi(be)),q=d.getDerivedStateFromProps,(be=typeof q=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(P!==Pe||Te!==se)&&_1(a,I,p,se),qo=!1,Te=a.memoizedState,I.state=Te,Lc(a,p,I,S),Pc();var Re=a.memoizedState;P!==Pe||Te!==Re||qo||s!==null&&s.dependencies!==null&&ed(s.dependencies)?(typeof q=="function"&&(s0(a,d,q,p),Re=a.memoizedState),(Oe=qo||E1(a,d,Oe,p,Te,Re,se)||s!==null&&s.dependencies!==null&&ed(s.dependencies))?(be||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(p,Re,se),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(p,Re,se)),typeof I.componentDidUpdate=="function"&&(a.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof I.componentDidUpdate!="function"||P===s.memoizedProps&&Te===s.memoizedState||(a.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||P===s.memoizedProps&&Te===s.memoizedState||(a.flags|=1024),a.memoizedProps=p,a.memoizedState=Re),I.props=p,I.state=Re,I.context=se,p=Oe):(typeof I.componentDidUpdate!="function"||P===s.memoizedProps&&Te===s.memoizedState||(a.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||P===s.memoizedProps&&Te===s.memoizedState||(a.flags|=1024),p=!1)}return I=p,vd(s,a),p=(a.flags&128)!==0,I||p?(I=a.stateNode,d=p&&typeof d.getDerivedStateFromError!="function"?null:I.render(),a.flags|=1,s!==null&&p?(a.child=Ka(a,s.child,null,S),a.child=Ka(a,null,d,S)):ji(s,a,d,S),a.memoizedState=I.state,s=a.child):s=co(s,a,S),s}function B1(s,a,d,p){return Ha(),a.flags|=256,ji(s,a,d,p),a.child}var c0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function u0(s){return{baseLanes:s,cachePool:Cp()}}function d0(s,a,d){return s=s!==null?s.childLanes&~d:0,a&&(s|=js),s}function F1(s,a,d){var p=a.pendingProps,S=!1,I=(a.flags&128)!==0,P;if((P=I)||(P=s!==null&&s.memoizedState===null?!1:(ri.current&2)!==0),P&&(S=!0,a.flags&=-129),P=(a.flags&32)!==0,a.flags&=-33,s===null){if(tn){if(S?Xo(a):Ko(),(s=Un)?(s=Wx(s,sr),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Vo!==null?{id:Mr,overflow:Dr}:null,retryLane:536870912,hydrationErrors:null},d=yp(s),d.return=a,a.child=d,Bi=a,Un=null)):s=null,s===null)throw Ho(a);return W0(s)?a.lanes=32:a.lanes=536870912,null}var q=p.children;return p=p.fallback,S?(Ko(),S=a.mode,q=wd({mode:"hidden",children:q},S),p=Ga(p,S,d,null),q.return=a,p.return=a,q.sibling=p,a.child=q,p=a.child,p.memoizedState=u0(d),p.childLanes=d0(s,P,d),a.memoizedState=c0,Vc(null,p)):(Xo(a),h0(a,q))}var se=s.memoizedState;if(se!==null&&(q=se.dehydrated,q!==null)){if(I)a.flags&256?(Xo(a),a.flags&=-257,a=f0(s,a,d)):a.memoizedState!==null?(Ko(),a.child=s.child,a.flags|=128,a=null):(Ko(),q=p.fallback,S=a.mode,p=wd({mode:"visible",children:p.children},S),q=Ga(q,S,d,null),q.flags|=2,p.return=a,q.return=a,p.sibling=q,a.child=p,Ka(a,s.child,null,d),p=a.child,p.memoizedState=u0(d),p.childLanes=d0(s,P,d),a.memoizedState=c0,a=Vc(null,p));else if(Xo(a),W0(q)){if(P=q.nextSibling&&q.nextSibling.dataset,P)var be=P.dgst;P=be,p=Error(i(419)),p.stack="",p.digest=P,Ic({value:p,source:null,stack:null}),a=f0(s,a,d)}else if(hi||El(s,a,d,!1),P=(d&s.childLanes)!==0,hi||P){if(P=Rn,P!==null&&(p=qr(P,d),p!==0&&p!==se.retryLane))throw se.retryLane=p,Va(s,p),Ss(P,s,p),a0;Y0(q)||Id(),a=f0(s,a,d)}else Y0(q)?(a.flags|=192,a.child=s.child,a=null):(s=se.treeContext,Un=or(q.nextSibling),Bi=a,tn=!0,Go=null,sr=!1,s!==null&&bp(a,s),a=h0(a,p.children),a.flags|=4096);return a}return S?(Ko(),q=p.fallback,S=a.mode,se=s.child,be=se.sibling,p=io(se,{mode:"hidden",children:p.children}),p.subtreeFlags=se.subtreeFlags&65011712,be!==null?q=io(be,q):(q=Ga(q,S,d,null),q.flags|=2),q.return=a,p.return=a,p.sibling=q,a.child=p,Vc(null,p),p=a.child,q=s.child.memoizedState,q===null?q=u0(d):(S=q.cachePool,S!==null?(se=ui._currentValue,S=S.parent!==se?{parent:se,pool:se}:S):S=Cp(),q={baseLanes:q.baseLanes|d,cachePool:S}),p.memoizedState=q,p.childLanes=d0(s,P,d),a.memoizedState=c0,Vc(s.child,p)):(Xo(a),d=s.child,s=d.sibling,d=io(d,{mode:"visible",children:p.children}),d.return=a,d.sibling=null,s!==null&&(P=a.deletions,P===null?(a.deletions=[s],a.flags|=16):P.push(s)),a.child=d,a.memoizedState=null,d)}function h0(s,a){return a=wd({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function wd(s,a){return s=Ls(22,s,null,a),s.lanes=0,s}function f0(s,a,d){return Ka(a,s.child,null,d),s=h0(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function j1(s,a,d){s.lanes|=a;var p=s.alternate;p!==null&&(p.lanes|=a),Nf(s.return,a,d)}function m0(s,a,d,p,S,I){var P=s.memoizedState;P===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:S,treeForkCount:I}:(P.isBackwards=a,P.rendering=null,P.renderingStartTime=0,P.last=p,P.tail=d,P.tailMode=S,P.treeForkCount=I)}function V1(s,a,d){var p=a.pendingProps,S=p.revealOrder,I=p.tail;p=p.children;var P=ri.current,q=(P&2)!==0;if(q?(P=P&1|2,a.flags|=128):P&=1,Ae(ri,P),ji(s,a,p,d),p=tn?Nc:0,!q&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&j1(s,d,a);else if(s.tag===19)j1(s,d,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(S){case"forwards":for(d=a.child,S=null;d!==null;)s=d.alternate,s!==null&&ld(s)===null&&(S=d),d=d.sibling;d=S,d===null?(S=a.child,a.child=null):(S=d.sibling,d.sibling=null),m0(a,!1,S,d,I,p);break;case"backwards":case"unstable_legacy-backwards":for(d=null,S=a.child,a.child=null;S!==null;){if(s=S.alternate,s!==null&&ld(s)===null){a.child=S;break}s=S.sibling,S.sibling=d,d=S,S=s}m0(a,!0,d,null,I,p);break;case"together":m0(a,!1,null,null,void 0,p);break;default:a.memoizedState=null}return a.child}function co(s,a,d){if(s!==null&&(a.dependencies=s.dependencies),Qo|=a.lanes,(d&a.childLanes)===0)if(s!==null){if(El(s,a,d,!1),(d&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,d=io(s,s.pendingProps),a.child=d,d.return=a;s.sibling!==null;)s=s.sibling,d=d.sibling=io(s,s.pendingProps),d.return=a;d.sibling=null}return a.child}function g0(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&ed(s)))}function MT(s,a,d){switch(a.tag){case 3:Ke(a,a.stateNode.containerInfo),zo(a,ui,s.memoizedState.cache),Ha();break;case 27:case 5:Mn(a);break;case 4:Ke(a,a.stateNode.containerInfo);break;case 10:zo(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,jf(a),null;break;case 13:var p=a.memoizedState;if(p!==null)return p.dehydrated!==null?(Xo(a),a.flags|=128,null):(d&a.child.childLanes)!==0?F1(s,a,d):(Xo(a),s=co(s,a,d),s!==null?s.sibling:null);Xo(a);break;case 19:var S=(s.flags&128)!==0;if(p=(d&a.childLanes)!==0,p||(El(s,a,d,!1),p=(d&a.childLanes)!==0),S){if(p)return V1(s,a,d);a.flags|=128}if(S=a.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),Ae(ri,ri.current),p)break;return null;case 22:return a.lanes=0,O1(s,a,d,a.pendingProps);case 24:zo(a,ui,s.memoizedState.cache)}return co(s,a,d)}function G1(s,a,d){if(s!==null)if(s.memoizedProps!==a.pendingProps)hi=!0;else{if(!g0(s,d)&&(a.flags&128)===0)return hi=!1,MT(s,a,d);hi=(s.flags&131072)!==0}else hi=!1,tn&&(a.flags&1048576)!==0&&wp(a,Nc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var p=a.pendingProps;if(s=Wa(a.elementType),a.type=s,typeof s=="function")wf(s)?(p=Ja(s,p),a.tag=1,a=U1(null,a,s,p,d)):(a.tag=0,a=l0(null,a,s,p,d));else{if(s!=null){var S=s.$$typeof;if(S===de){a.tag=11,a=R1(null,a,s,p,d);break e}else if(S===U){a.tag=14,a=M1(null,a,s,p,d);break e}}throw a=_e(s)||s,Error(i(306,a,""))}}return a;case 0:return l0(s,a,a.type,a.pendingProps,d);case 1:return p=a.type,S=Ja(p,a.pendingProps),U1(s,a,p,S,d);case 3:e:{if(Ke(a,a.stateNode.containerInfo),s===null)throw Error(i(387));p=a.pendingProps;var I=a.memoizedState;S=I.element,Pf(s,a),Lc(a,p,null,d);var P=a.memoizedState;if(p=P.cache,zo(a,ui,p),p!==I.cache&&If(a,[ui],d,!0),Pc(),p=P.element,I.isDehydrated)if(I={element:p,isDehydrated:!1,cache:P.cache},a.updateQueue.baseState=I,a.memoizedState=I,a.flags&256){a=B1(s,a,p,d);break e}else if(p!==S){S=tr(Error(i(424)),a),Ic(S),a=B1(s,a,p,d);break e}else{switch(s=a.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Un=or(s.firstChild),Bi=a,tn=!0,Go=null,sr=!0,d=Op(a,null,p,d),a.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(Ha(),p===S){a=co(s,a,d);break e}ji(s,a,p,d)}a=a.child}return a;case 26:return vd(s,a),s===null?(d=Zx(a.type,null,a.pendingProps,null))?a.memoizedState=d:tn||(d=a.type,s=a.pendingProps,p=Ld(pe.current).createElement(d),p[jn]=a,p[cn]=s,Vi(p,d,s),Vn(p),a.stateNode=p):a.memoizedState=Zx(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Mn(a),s===null&&tn&&(p=a.stateNode=$x(a.type,a.pendingProps,pe.current),Bi=a,sr=!0,S=Un,ia(a.type)?(X0=S,Un=or(p.firstChild)):Un=S),ji(s,a,a.pendingProps.children,d),vd(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&tn&&((S=p=Un)&&(p=aA(p,a.type,a.pendingProps,sr),p!==null?(a.stateNode=p,Bi=a,Un=or(p.firstChild),sr=!1,S=!0):S=!1),S||Ho(a)),Mn(a),S=a.type,I=a.pendingProps,P=s!==null?s.memoizedProps:null,p=I.children,H0(S,I)?p=null:P!==null&&H0(S,P)&&(a.flags|=32),a.memoizedState!==null&&(S=Gf(s,a,ET,null,null,d),nu._currentValue=S),vd(s,a),ji(s,a,p,d),a.child;case 6:return s===null&&tn&&((s=d=Un)&&(d=lA(d,a.pendingProps,sr),d!==null?(a.stateNode=d,Bi=a,Un=null,s=!0):s=!1),s||Ho(a)),null;case 13:return F1(s,a,d);case 4:return Ke(a,a.stateNode.containerInfo),p=a.pendingProps,s===null?a.child=Ka(a,null,p,d):ji(s,a,p,d),a.child;case 11:return R1(s,a,a.type,a.pendingProps,d);case 7:return ji(s,a,a.pendingProps,d),a.child;case 8:return ji(s,a,a.pendingProps.children,d),a.child;case 12:return ji(s,a,a.pendingProps.children,d),a.child;case 10:return p=a.pendingProps,zo(a,a.type,p.value),ji(s,a,p.children,d),a.child;case 9:return S=a.type._context,p=a.pendingProps.children,qa(a),S=Fi(S),p=p(S),a.flags|=1,ji(s,a,p,d),a.child;case 14:return M1(s,a,a.type,a.pendingProps,d);case 15:return D1(s,a,a.type,a.pendingProps,d);case 19:return V1(s,a,d);case 31:return RT(s,a,d);case 22:return O1(s,a,d,a.pendingProps);case 24:return qa(a),p=Fi(ui),s===null?(S=Df(),S===null&&(S=Rn,I=Rf(),S.pooledCache=I,I.refCount++,I!==null&&(S.pooledCacheLanes|=d),S=I),a.memoizedState={parent:p,cache:S},kf(a),zo(a,ui,S)):((s.lanes&d)!==0&&(Pf(s,a),Lc(a,null,null,d),Pc()),S=s.memoizedState,I=a.memoizedState,S.parent!==p?(S={parent:p,cache:p},a.memoizedState=S,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=S),zo(a,ui,p)):(p=I.cache,zo(a,ui,p),p!==S.cache&&If(a,[ui],d,!0))),ji(s,a,a.pendingProps.children,d),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function uo(s){s.flags|=4}function p0(s,a,d,p,S){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(S&335544128)===S)if(s.stateNode.complete)s.flags|=8192;else if(gx())s.flags|=8192;else throw Xa=sd,Of}else s.flags&=-16777217}function H1(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!sy(a))if(gx())s.flags|=8192;else throw Xa=sd,Of}function bd(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?Vt():536870912,s.lanes|=a,kl|=a)}function Gc(s,a){if(!tn)switch(s.tailMode){case"hidden":a=s.tail;for(var d=null;a!==null;)a.alternate!==null&&(d=a),a=a.sibling;d===null?s.tail=null:d.sibling=null;break;case"collapsed":d=s.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:p.sibling=null}}function Bn(s){var a=s.alternate!==null&&s.alternate.child===s.child,d=0,p=0;if(a)for(var S=s.child;S!==null;)d|=S.lanes|S.childLanes,p|=S.subtreeFlags&65011712,p|=S.flags&65011712,S.return=s,S=S.sibling;else for(S=s.child;S!==null;)d|=S.lanes|S.childLanes,p|=S.subtreeFlags,p|=S.flags,S.return=s,S=S.sibling;return s.subtreeFlags|=p,s.childLanes=d,a}function DT(s,a,d){var p=a.pendingProps;switch(Tf(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(a),null;case 1:return Bn(a),null;case 3:return d=a.stateNode,p=null,s!==null&&(p=s.memoizedState.cache),a.memoizedState.cache!==p&&(a.flags|=2048),oo(ui),it(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(s===null||s.child===null)&&(bl(a)?uo(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Sf())),Bn(a),null;case 26:var S=a.type,I=a.memoizedState;return s===null?(uo(a),I!==null?(Bn(a),H1(a,I)):(Bn(a),p0(a,S,null,p,d))):I?I!==s.memoizedState?(uo(a),Bn(a),H1(a,I)):(Bn(a),a.flags&=-16777217):(s=s.memoizedProps,s!==p&&uo(a),Bn(a),p0(a,S,s,p,d)),null;case 27:if(kt(a),d=pe.current,S=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==p&&uo(a);else{if(!p){if(a.stateNode===null)throw Error(i(166));return Bn(a),null}s=je.current,bl(a)?Ep(a):(s=$x(S,p,d),a.stateNode=s,uo(a))}return Bn(a),null;case 5:if(kt(a),S=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==p&&uo(a);else{if(!p){if(a.stateNode===null)throw Error(i(166));return Bn(a),null}if(I=je.current,bl(a))Ep(a);else{var P=Ld(pe.current);switch(I){case 1:I=P.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:I=P.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":I=P.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":I=P.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":I=P.createElement("div"),I.innerHTML="<script><\/script>",I=I.removeChild(I.firstChild);break;case"select":I=typeof p.is=="string"?P.createElement("select",{is:p.is}):P.createElement("select"),p.multiple?I.multiple=!0:p.size&&(I.size=p.size);break;default:I=typeof p.is=="string"?P.createElement(S,{is:p.is}):P.createElement(S)}}I[jn]=a,I[cn]=p;e:for(P=a.child;P!==null;){if(P.tag===5||P.tag===6)I.appendChild(P.stateNode);else if(P.tag!==4&&P.tag!==27&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===a)break e;for(;P.sibling===null;){if(P.return===null||P.return===a)break e;P=P.return}P.sibling.return=P.return,P=P.sibling}a.stateNode=I;e:switch(Vi(I,S,p),S){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&uo(a)}}return Bn(a),p0(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,d),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==p&&uo(a);else{if(typeof p!="string"&&a.stateNode===null)throw Error(i(166));if(s=pe.current,bl(a)){if(s=a.stateNode,d=a.memoizedProps,p=null,S=Bi,S!==null)switch(S.tag){case 27:case 5:p=S.memoizedProps}s[jn]=a,s=!!(s.nodeValue===d||p!==null&&p.suppressHydrationWarning===!0||Fx(s.nodeValue,d)),s||Ho(a,!0)}else s=Ld(s).createTextNode(p),s[jn]=a,a.stateNode=s}return Bn(a),null;case 31:if(d=a.memoizedState,s===null||s.memoizedState!==null){if(p=bl(a),d!==null){if(s===null){if(!p)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[jn]=a}else Ha(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Bn(a),s=!1}else d=Sf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=d),s=!0;if(!s)return a.flags&256?(Bs(a),a):(Bs(a),null);if((a.flags&128)!==0)throw Error(i(558))}return Bn(a),null;case 13:if(p=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(S=bl(a),p!==null&&p.dehydrated!==null){if(s===null){if(!S)throw Error(i(318));if(S=a.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(i(317));S[jn]=a}else Ha(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Bn(a),S=!1}else S=Sf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=S),S=!0;if(!S)return a.flags&256?(Bs(a),a):(Bs(a),null)}return Bs(a),(a.flags&128)!==0?(a.lanes=d,a):(d=p!==null,s=s!==null&&s.memoizedState!==null,d&&(p=a.child,S=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(S=p.alternate.memoizedState.cachePool.pool),I=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(I=p.memoizedState.cachePool.pool),I!==S&&(p.flags|=2048)),d!==s&&d&&(a.child.flags|=8192),bd(a,a.updateQueue),Bn(a),null);case 4:return it(),s===null&&B0(a.stateNode.containerInfo),Bn(a),null;case 10:return oo(a.type),Bn(a),null;case 19:if(Ie(ri),p=a.memoizedState,p===null)return Bn(a),null;if(S=(a.flags&128)!==0,I=p.rendering,I===null)if(S)Gc(p,!1);else{if(ti!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(I=ld(s),I!==null){for(a.flags|=128,Gc(p,!1),s=I.updateQueue,a.updateQueue=s,bd(a,s),a.subtreeFlags=0,s=d,d=a.child;d!==null;)xp(d,s),d=d.sibling;return Ae(ri,ri.current&1|2),tn&&so(a,p.treeForkCount),a.child}s=s.sibling}p.tail!==null&&On()>Sd&&(a.flags|=128,S=!0,Gc(p,!1),a.lanes=4194304)}else{if(!S)if(s=ld(I),s!==null){if(a.flags|=128,S=!0,s=s.updateQueue,a.updateQueue=s,bd(a,s),Gc(p,!0),p.tail===null&&p.tailMode==="hidden"&&!I.alternate&&!tn)return Bn(a),null}else 2*On()-p.renderingStartTime>Sd&&d!==536870912&&(a.flags|=128,S=!0,Gc(p,!1),a.lanes=4194304);p.isBackwards?(I.sibling=a.child,a.child=I):(s=p.last,s!==null?s.sibling=I:a.child=I,p.last=I)}return p.tail!==null?(s=p.tail,p.rendering=s,p.tail=s.sibling,p.renderingStartTime=On(),s.sibling=null,d=ri.current,Ae(ri,S?d&1|2:d&1),tn&&so(a,p.treeForkCount),s):(Bn(a),null);case 22:case 23:return Bs(a),Ff(),p=a.memoizedState!==null,s!==null?s.memoizedState!==null!==p&&(a.flags|=8192):p&&(a.flags|=8192),p?(d&536870912)!==0&&(a.flags&128)===0&&(Bn(a),a.subtreeFlags&6&&(a.flags|=8192)):Bn(a),d=a.updateQueue,d!==null&&bd(a,d.retryQueue),d=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(d=s.memoizedState.cachePool.pool),p=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),p!==d&&(a.flags|=2048),s!==null&&Ie(Ya),null;case 24:return d=null,s!==null&&(d=s.memoizedState.cache),a.memoizedState.cache!==d&&(a.flags|=2048),oo(ui),Bn(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function OT(s,a){switch(Tf(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return oo(ui),it(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return kt(a),null;case 31:if(a.memoizedState!==null){if(Bs(a),a.alternate===null)throw Error(i(340));Ha()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Bs(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Ha()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return Ie(ri),null;case 4:return it(),null;case 10:return oo(a.type),null;case 22:case 23:return Bs(a),Ff(),s!==null&&Ie(Ya),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return oo(ui),null;case 25:return null;default:return null}}function z1(s,a){switch(Tf(a),a.tag){case 3:oo(ui),it();break;case 26:case 27:case 5:kt(a);break;case 4:it();break;case 31:a.memoizedState!==null&&Bs(a);break;case 13:Bs(a);break;case 19:Ie(ri);break;case 10:oo(a.type);break;case 22:case 23:Bs(a),Ff(),s!==null&&Ie(Ya);break;case 24:oo(ui)}}function Hc(s,a){try{var d=a.updateQueue,p=d!==null?d.lastEffect:null;if(p!==null){var S=p.next;d=S;do{if((d.tag&s)===s){p=void 0;var I=d.create,P=d.inst;p=I(),P.destroy=p}d=d.next}while(d!==S)}}catch(q){_n(a,a.return,q)}}function $o(s,a,d){try{var p=a.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var I=S.next;p=I;do{if((p.tag&s)===s){var P=p.inst,q=P.destroy;if(q!==void 0){P.destroy=void 0,S=a;var se=d,be=q;try{be()}catch(Oe){_n(S,se,Oe)}}}p=p.next}while(p!==I)}}catch(Oe){_n(a,a.return,Oe)}}function q1(s){var a=s.updateQueue;if(a!==null){var d=s.stateNode;try{Pp(a,d)}catch(p){_n(s,s.return,p)}}}function Y1(s,a,d){d.props=Ja(s.type,s.memoizedProps),d.state=s.memoizedState;try{d.componentWillUnmount()}catch(p){_n(s,a,p)}}function zc(s,a){try{var d=s.ref;if(d!==null){switch(s.tag){case 26:case 27:case 5:var p=s.stateNode;break;case 30:p=s.stateNode;break;default:p=s.stateNode}typeof d=="function"?s.refCleanup=d(p):d.current=p}}catch(S){_n(s,a,S)}}function Or(s,a){var d=s.ref,p=s.refCleanup;if(d!==null)if(typeof p=="function")try{p()}catch(S){_n(s,a,S)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(S){_n(s,a,S)}else d.current=null}function W1(s){var a=s.type,d=s.memoizedProps,p=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":d.autoFocus&&p.focus();break e;case"img":d.src?p.src=d.src:d.srcSet&&(p.srcset=d.srcSet)}}catch(S){_n(s,s.return,S)}}function x0(s,a,d){try{var p=s.stateNode;tA(p,s.type,d,a),p[cn]=a}catch(S){_n(s,s.return,S)}}function X1(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ia(s.type)||s.tag===4}function y0(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||X1(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ia(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function v0(s,a,d){var p=s.tag;if(p===5||p===6)s=s.stateNode,a?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(s,a):(a=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,a.appendChild(s),d=d._reactRootContainer,d!=null||a.onclick!==null||(a.onclick=Xi));else if(p!==4&&(p===27&&ia(s.type)&&(d=s.stateNode,a=null),s=s.child,s!==null))for(v0(s,a,d),s=s.sibling;s!==null;)v0(s,a,d),s=s.sibling}function Ed(s,a,d){var p=s.tag;if(p===5||p===6)s=s.stateNode,a?d.insertBefore(s,a):d.appendChild(s);else if(p!==4&&(p===27&&ia(s.type)&&(d=s.stateNode),s=s.child,s!==null))for(Ed(s,a,d),s=s.sibling;s!==null;)Ed(s,a,d),s=s.sibling}function K1(s){var a=s.stateNode,d=s.memoizedProps;try{for(var p=s.type,S=a.attributes;S.length;)a.removeAttributeNode(S[0]);Vi(a,p,d),a[jn]=s,a[cn]=d}catch(I){_n(s,s.return,I)}}var ho=!1,fi=!1,w0=!1,$1=typeof WeakSet=="function"?WeakSet:Set,Ci=null;function kT(s,a){if(s=s.containerInfo,V0=Hd,s=j(s),G(s)){if("selectionStart"in s)var d={start:s.selectionStart,end:s.selectionEnd};else e:{d=(d=s.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var S=p.anchorOffset,I=p.focusNode;p=p.focusOffset;try{d.nodeType,I.nodeType}catch{d=null;break e}var P=0,q=-1,se=-1,be=0,Oe=0,Pe=s,Te=null;t:for(;;){for(var Re;Pe!==d||S!==0&&Pe.nodeType!==3||(q=P+S),Pe!==I||p!==0&&Pe.nodeType!==3||(se=P+p),Pe.nodeType===3&&(P+=Pe.nodeValue.length),(Re=Pe.firstChild)!==null;)Te=Pe,Pe=Re;for(;;){if(Pe===s)break t;if(Te===d&&++be===S&&(q=P),Te===I&&++Oe===p&&(se=P),(Re=Pe.nextSibling)!==null)break;Pe=Te,Te=Pe.parentNode}Pe=Re}d=q===-1||se===-1?null:{start:q,end:se}}else d=null}d=d||{start:0,end:0}}else d=null;for(G0={focusedElem:s,selectionRange:d},Hd=!1,Ci=a;Ci!==null;)if(a=Ci,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Ci=s;else for(;Ci!==null;){switch(a=Ci,I=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(d=0;d<s.length;d++)S=s[d],S.ref.impl=S.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&I!==null){s=void 0,d=a,S=I.memoizedProps,I=I.memoizedState,p=d.stateNode;try{var lt=Ja(d.type,S);s=p.getSnapshotBeforeUpdate(lt,I),p.__reactInternalSnapshotBeforeUpdate=s}catch(bt){_n(d,d.return,bt)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,d=s.nodeType,d===9)q0(s);else if(d===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":q0(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,Ci=s;break}Ci=a.return}}function J1(s,a,d){var p=d.flags;switch(d.tag){case 0:case 11:case 15:mo(s,d),p&4&&Hc(5,d);break;case 1:if(mo(s,d),p&4)if(s=d.stateNode,a===null)try{s.componentDidMount()}catch(P){_n(d,d.return,P)}else{var S=Ja(d.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(S,a,s.__reactInternalSnapshotBeforeUpdate)}catch(P){_n(d,d.return,P)}}p&64&&q1(d),p&512&&zc(d,d.return);break;case 3:if(mo(s,d),p&64&&(s=d.updateQueue,s!==null)){if(a=null,d.child!==null)switch(d.child.tag){case 27:case 5:a=d.child.stateNode;break;case 1:a=d.child.stateNode}try{Pp(s,a)}catch(P){_n(d,d.return,P)}}break;case 27:a===null&&p&4&&K1(d);case 26:case 5:mo(s,d),a===null&&p&4&&W1(d),p&512&&zc(d,d.return);break;case 12:mo(s,d);break;case 31:mo(s,d),p&4&&ex(s,d);break;case 13:mo(s,d),p&4&&tx(s,d),p&64&&(s=d.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(d=HT.bind(null,d),cA(s,d))));break;case 22:if(p=d.memoizedState!==null||ho,!p){a=a!==null&&a.memoizedState!==null||fi,S=ho;var I=fi;ho=p,(fi=a)&&!I?go(s,d,(d.subtreeFlags&8772)!==0):mo(s,d),ho=S,fi=I}break;case 30:break;default:mo(s,d)}}function Q1(s){var a=s.alternate;a!==null&&(s.alternate=null,Q1(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&Oi(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Yn=null,Es=!1;function fo(s,a,d){for(d=d.child;d!==null;)Z1(s,a,d),d=d.sibling}function Z1(s,a,d){if(Ge&&typeof Ge.onCommitFiberUnmount=="function")try{Ge.onCommitFiberUnmount(an,d)}catch{}switch(d.tag){case 26:fi||Or(d,a),fo(s,a,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:fi||Or(d,a);var p=Yn,S=Es;ia(d.type)&&(Yn=d.stateNode,Es=!1),fo(s,a,d),Zc(d.stateNode),Yn=p,Es=S;break;case 5:fi||Or(d,a);case 6:if(p=Yn,S=Es,Yn=null,fo(s,a,d),Yn=p,Es=S,Yn!==null)if(Es)try{(Yn.nodeType===9?Yn.body:Yn.nodeName==="HTML"?Yn.ownerDocument.body:Yn).removeChild(d.stateNode)}catch(I){_n(d,a,I)}else try{Yn.removeChild(d.stateNode)}catch(I){_n(d,a,I)}break;case 18:Yn!==null&&(Es?(s=Yn,qx(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,d.stateNode),Gl(s)):qx(Yn,d.stateNode));break;case 4:p=Yn,S=Es,Yn=d.stateNode.containerInfo,Es=!0,fo(s,a,d),Yn=p,Es=S;break;case 0:case 11:case 14:case 15:$o(2,d,a),fi||$o(4,d,a),fo(s,a,d);break;case 1:fi||(Or(d,a),p=d.stateNode,typeof p.componentWillUnmount=="function"&&Y1(d,a,p)),fo(s,a,d);break;case 21:fo(s,a,d);break;case 22:fi=(p=fi)||d.memoizedState!==null,fo(s,a,d),fi=p;break;default:fo(s,a,d)}}function ex(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Gl(s)}catch(d){_n(a,a.return,d)}}}function tx(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Gl(s)}catch(d){_n(a,a.return,d)}}function PT(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new $1),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new $1),a;default:throw Error(i(435,s.tag))}}function _d(s,a){var d=PT(s);a.forEach(function(p){if(!d.has(p)){d.add(p);var S=zT.bind(null,s,p);p.then(S,S)}})}function _s(s,a){var d=a.deletions;if(d!==null)for(var p=0;p<d.length;p++){var S=d[p],I=s,P=a,q=P;e:for(;q!==null;){switch(q.tag){case 27:if(ia(q.type)){Yn=q.stateNode,Es=!1;break e}break;case 5:Yn=q.stateNode,Es=!1;break e;case 3:case 4:Yn=q.stateNode.containerInfo,Es=!0;break e}q=q.return}if(Yn===null)throw Error(i(160));Z1(I,P,S),Yn=null,Es=!1,I=S.alternate,I!==null&&(I.return=null),S.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)nx(a,s),a=a.sibling}var pr=null;function nx(s,a){var d=s.alternate,p=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:_s(a,s),Ts(s),p&4&&($o(3,s,s.return),Hc(3,s),$o(5,s,s.return));break;case 1:_s(a,s),Ts(s),p&512&&(fi||d===null||Or(d,d.return)),p&64&&ho&&(s=s.updateQueue,s!==null&&(p=s.callbacks,p!==null&&(d=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=d===null?p:d.concat(p))));break;case 26:var S=pr;if(_s(a,s),Ts(s),p&512&&(fi||d===null||Or(d,d.return)),p&4){var I=d!==null?d.memoizedState:null;if(p=s.memoizedState,d===null)if(p===null)if(s.stateNode===null){e:{p=s.type,d=s.memoizedProps,S=S.ownerDocument||S;t:switch(p){case"title":I=S.getElementsByTagName("title")[0],(!I||I[Ys]||I[jn]||I.namespaceURI==="http://www.w3.org/2000/svg"||I.hasAttribute("itemprop"))&&(I=S.createElement(p),S.head.insertBefore(I,S.querySelector("head > title"))),Vi(I,p,d),I[jn]=s,Vn(I),p=I;break e;case"link":var P=ny("link","href",S).get(p+(d.href||""));if(P){for(var q=0;q<P.length;q++)if(I=P[q],I.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&I.getAttribute("rel")===(d.rel==null?null:d.rel)&&I.getAttribute("title")===(d.title==null?null:d.title)&&I.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){P.splice(q,1);break t}}I=S.createElement(p),Vi(I,p,d),S.head.appendChild(I);break;case"meta":if(P=ny("meta","content",S).get(p+(d.content||""))){for(q=0;q<P.length;q++)if(I=P[q],I.getAttribute("content")===(d.content==null?null:""+d.content)&&I.getAttribute("name")===(d.name==null?null:d.name)&&I.getAttribute("property")===(d.property==null?null:d.property)&&I.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&I.getAttribute("charset")===(d.charSet==null?null:d.charSet)){P.splice(q,1);break t}}I=S.createElement(p),Vi(I,p,d),S.head.appendChild(I);break;default:throw Error(i(468,p))}I[jn]=s,Vn(I),p=I}s.stateNode=p}else iy(S,s.type,s.stateNode);else s.stateNode=ty(S,p,s.memoizedProps);else I!==p?(I===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):I.count--,p===null?iy(S,s.type,s.stateNode):ty(S,p,s.memoizedProps)):p===null&&s.stateNode!==null&&x0(s,s.memoizedProps,d.memoizedProps)}break;case 27:_s(a,s),Ts(s),p&512&&(fi||d===null||Or(d,d.return)),d!==null&&p&4&&x0(s,s.memoizedProps,d.memoizedProps);break;case 5:if(_s(a,s),Ts(s),p&512&&(fi||d===null||Or(d,d.return)),s.flags&32){S=s.stateNode;try{Wi(S,"")}catch(lt){_n(s,s.return,lt)}}p&4&&s.stateNode!=null&&(S=s.memoizedProps,x0(s,S,d!==null?d.memoizedProps:S)),p&1024&&(w0=!0);break;case 6:if(_s(a,s),Ts(s),p&4){if(s.stateNode===null)throw Error(i(162));p=s.memoizedProps,d=s.stateNode;try{d.nodeValue=p}catch(lt){_n(s,s.return,lt)}}break;case 3:if(Fd=null,S=pr,pr=Ud(a.containerInfo),_s(a,s),pr=S,Ts(s),p&4&&d!==null&&d.memoizedState.isDehydrated)try{Gl(a.containerInfo)}catch(lt){_n(s,s.return,lt)}w0&&(w0=!1,ix(s));break;case 4:p=pr,pr=Ud(s.stateNode.containerInfo),_s(a,s),Ts(s),pr=p;break;case 12:_s(a,s),Ts(s);break;case 31:_s(a,s),Ts(s),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,_d(s,p)));break;case 13:_s(a,s),Ts(s),s.child.flags&8192&&s.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(Ad=On()),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,_d(s,p)));break;case 22:S=s.memoizedState!==null;var se=d!==null&&d.memoizedState!==null,be=ho,Oe=fi;if(ho=be||S,fi=Oe||se,_s(a,s),fi=Oe,ho=be,Ts(s),p&8192)e:for(a=s.stateNode,a._visibility=S?a._visibility&-2:a._visibility|1,S&&(d===null||se||ho||fi||Qa(s)),d=null,a=s;;){if(a.tag===5||a.tag===26){if(d===null){se=d=a;try{if(I=se.stateNode,S)P=I.style,typeof P.setProperty=="function"?P.setProperty("display","none","important"):P.display="none";else{q=se.stateNode;var Pe=se.memoizedProps.style,Te=Pe!=null&&Pe.hasOwnProperty("display")?Pe.display:null;q.style.display=Te==null||typeof Te=="boolean"?"":(""+Te).trim()}}catch(lt){_n(se,se.return,lt)}}}else if(a.tag===6){if(d===null){se=a;try{se.stateNode.nodeValue=S?"":se.memoizedProps}catch(lt){_n(se,se.return,lt)}}}else if(a.tag===18){if(d===null){se=a;try{var Re=se.stateNode;S?Yx(Re,!0):Yx(se.stateNode,!1)}catch(lt){_n(se,se.return,lt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;d===a&&(d=null),a=a.return}d===a&&(d=null),a.sibling.return=a.return,a=a.sibling}p&4&&(p=s.updateQueue,p!==null&&(d=p.retryQueue,d!==null&&(p.retryQueue=null,_d(s,d))));break;case 19:_s(a,s),Ts(s),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,_d(s,p)));break;case 30:break;case 21:break;default:_s(a,s),Ts(s)}}function Ts(s){var a=s.flags;if(a&2){try{for(var d,p=s.return;p!==null;){if(X1(p)){d=p;break}p=p.return}if(d==null)throw Error(i(160));switch(d.tag){case 27:var S=d.stateNode,I=y0(s);Ed(s,I,S);break;case 5:var P=d.stateNode;d.flags&32&&(Wi(P,""),d.flags&=-33);var q=y0(s);Ed(s,q,P);break;case 3:case 4:var se=d.stateNode.containerInfo,be=y0(s);v0(s,be,se);break;default:throw Error(i(161))}}catch(Oe){_n(s,s.return,Oe)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function ix(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;ix(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function mo(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)J1(s,a.alternate,a),a=a.sibling}function Qa(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:$o(4,a,a.return),Qa(a);break;case 1:Or(a,a.return);var d=a.stateNode;typeof d.componentWillUnmount=="function"&&Y1(a,a.return,d),Qa(a);break;case 27:Zc(a.stateNode);case 26:case 5:Or(a,a.return),Qa(a);break;case 22:a.memoizedState===null&&Qa(a);break;case 30:Qa(a);break;default:Qa(a)}s=s.sibling}}function go(s,a,d){for(d=d&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var p=a.alternate,S=s,I=a,P=I.flags;switch(I.tag){case 0:case 11:case 15:go(S,I,d),Hc(4,I);break;case 1:if(go(S,I,d),p=I,S=p.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(be){_n(p,p.return,be)}if(p=I,S=p.updateQueue,S!==null){var q=p.stateNode;try{var se=S.shared.hiddenCallbacks;if(se!==null)for(S.shared.hiddenCallbacks=null,S=0;S<se.length;S++)kp(se[S],q)}catch(be){_n(p,p.return,be)}}d&&P&64&&q1(I),zc(I,I.return);break;case 27:K1(I);case 26:case 5:go(S,I,d),d&&p===null&&P&4&&W1(I),zc(I,I.return);break;case 12:go(S,I,d);break;case 31:go(S,I,d),d&&P&4&&ex(S,I);break;case 13:go(S,I,d),d&&P&4&&tx(S,I);break;case 22:I.memoizedState===null&&go(S,I,d),zc(I,I.return);break;case 30:break;default:go(S,I,d)}a=a.sibling}}function b0(s,a){var d=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(d=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==d&&(s!=null&&s.refCount++,d!=null&&Rc(d))}function E0(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Rc(s))}function xr(s,a,d,p){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)sx(s,a,d,p),a=a.sibling}function sx(s,a,d,p){var S=a.flags;switch(a.tag){case 0:case 11:case 15:xr(s,a,d,p),S&2048&&Hc(9,a);break;case 1:xr(s,a,d,p);break;case 3:xr(s,a,d,p),S&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Rc(s)));break;case 12:if(S&2048){xr(s,a,d,p),s=a.stateNode;try{var I=a.memoizedProps,P=I.id,q=I.onPostCommit;typeof q=="function"&&q(P,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(se){_n(a,a.return,se)}}else xr(s,a,d,p);break;case 31:xr(s,a,d,p);break;case 13:xr(s,a,d,p);break;case 23:break;case 22:I=a.stateNode,P=a.alternate,a.memoizedState!==null?I._visibility&2?xr(s,a,d,p):qc(s,a):I._visibility&2?xr(s,a,d,p):(I._visibility|=2,Ml(s,a,d,p,(a.subtreeFlags&10256)!==0||!1)),S&2048&&b0(P,a);break;case 24:xr(s,a,d,p),S&2048&&E0(a.alternate,a);break;default:xr(s,a,d,p)}}function Ml(s,a,d,p,S){for(S=S&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var I=s,P=a,q=d,se=p,be=P.flags;switch(P.tag){case 0:case 11:case 15:Ml(I,P,q,se,S),Hc(8,P);break;case 23:break;case 22:var Oe=P.stateNode;P.memoizedState!==null?Oe._visibility&2?Ml(I,P,q,se,S):qc(I,P):(Oe._visibility|=2,Ml(I,P,q,se,S)),S&&be&2048&&b0(P.alternate,P);break;case 24:Ml(I,P,q,se,S),S&&be&2048&&E0(P.alternate,P);break;default:Ml(I,P,q,se,S)}a=a.sibling}}function qc(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var d=s,p=a,S=p.flags;switch(p.tag){case 22:qc(d,p),S&2048&&b0(p.alternate,p);break;case 24:qc(d,p),S&2048&&E0(p.alternate,p);break;default:qc(d,p)}a=a.sibling}}var Yc=8192;function Dl(s,a,d){if(s.subtreeFlags&Yc)for(s=s.child;s!==null;)rx(s,a,d),s=s.sibling}function rx(s,a,d){switch(s.tag){case 26:Dl(s,a,d),s.flags&Yc&&s.memoizedState!==null&&bA(d,pr,s.memoizedState,s.memoizedProps);break;case 5:Dl(s,a,d);break;case 3:case 4:var p=pr;pr=Ud(s.stateNode.containerInfo),Dl(s,a,d),pr=p;break;case 22:s.memoizedState===null&&(p=s.alternate,p!==null&&p.memoizedState!==null?(p=Yc,Yc=16777216,Dl(s,a,d),Yc=p):Dl(s,a,d));break;default:Dl(s,a,d)}}function ox(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Wc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var d=0;d<a.length;d++){var p=a[d];Ci=p,lx(p,s)}ox(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)ax(s),s=s.sibling}function ax(s){switch(s.tag){case 0:case 11:case 15:Wc(s),s.flags&2048&&$o(9,s,s.return);break;case 3:Wc(s);break;case 12:Wc(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Td(s)):Wc(s);break;default:Wc(s)}}function Td(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var d=0;d<a.length;d++){var p=a[d];Ci=p,lx(p,s)}ox(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:$o(8,a,a.return),Td(a);break;case 22:d=a.stateNode,d._visibility&2&&(d._visibility&=-3,Td(a));break;default:Td(a)}s=s.sibling}}function lx(s,a){for(;Ci!==null;){var d=Ci;switch(d.tag){case 0:case 11:case 15:$o(8,d,a);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var p=d.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Rc(d.memoizedState.cache)}if(p=d.child,p!==null)p.return=d,Ci=p;else e:for(d=s;Ci!==null;){p=Ci;var S=p.sibling,I=p.return;if(Q1(p),p===d){Ci=null;break e}if(S!==null){S.return=I,Ci=S;break e}Ci=I}}}var LT={getCacheForType:function(s){var a=Fi(ui),d=a.data.get(s);return d===void 0&&(d=s(),a.data.set(s,d)),d},cacheSignal:function(){return Fi(ui).controller.signal}},UT=typeof WeakMap=="function"?WeakMap:Map,pn=0,Rn=null,Wt=null,Jt=0,En=0,Fs=null,Jo=!1,Ol=!1,_0=!1,po=0,ti=0,Qo=0,Za=0,T0=0,js=0,kl=0,Xc=null,As=null,A0=!1,Ad=0,cx=0,Sd=1/0,Cd=null,Zo=null,vi=0,ea=null,Pl=null,xo=0,S0=0,C0=null,ux=null,Kc=0,N0=null;function Vs(){return(pn&2)!==0&&Jt!==0?Jt&-Jt:ne.T!==null?k0():Mi()}function dx(){if(js===0)if((Jt&536870912)===0||tn){var s=ut;ut<<=1,(ut&3932160)===0&&(ut=262144),js=s}else js=536870912;return s=Us.current,s!==null&&(s.flags|=32),js}function Ss(s,a,d){(s===Rn&&(En===2||En===9)||s.cancelPendingCommit!==null)&&(Ll(s,0),ta(s,Jt,js,!1)),zi(s,d),((pn&2)===0||s!==Rn)&&(s===Rn&&((pn&2)===0&&(Za|=d),ti===4&&ta(s,Jt,js,!1)),kr(s))}function hx(s,a,d){if((pn&6)!==0)throw Error(i(327));var p=!d&&(a&127)===0&&(a&s.expiredLanes)===0||Pt(s,a),S=p?jT(s,a):R0(s,a,!0),I=p;do{if(S===0){Ol&&!p&&ta(s,a,0,!1);break}else{if(d=s.current.alternate,I&&!BT(d)){S=R0(s,a,!1),I=!1;continue}if(S===2){if(I=a,s.errorRecoveryDisabledLanes&I)var P=0;else P=s.pendingLanes&-536870913,P=P!==0?P:P&536870912?536870912:0;if(P!==0){a=P;e:{var q=s;S=Xc;var se=q.current.memoizedState.isDehydrated;if(se&&(Ll(q,P).flags|=256),P=R0(q,P,!1),P!==2){if(_0&&!se){q.errorRecoveryDisabledLanes|=I,Za|=I,S=4;break e}I=As,As=S,I!==null&&(As===null?As=I:As.push.apply(As,I))}S=P}if(I=!1,S!==2)continue}}if(S===1){Ll(s,0),ta(s,a,0,!0);break}e:{switch(p=s,I=S,I){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:ta(p,a,js,!Jo);break e;case 2:As=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(S=Ad+300-On(),10<S)){if(ta(p,a,js,!Jo),yn(p,0,!0)!==0)break e;xo=a,p.timeoutHandle=Hx(fx.bind(null,p,d,As,Cd,A0,a,js,Za,kl,Jo,I,"Throttled",-0,0),S);break e}fx(p,d,As,Cd,A0,a,js,Za,kl,Jo,I,null,-0,0)}}break}while(!0);kr(s)}function fx(s,a,d,p,S,I,P,q,se,be,Oe,Pe,Te,Re){if(s.timeoutHandle=-1,Pe=a.subtreeFlags,Pe&8192||(Pe&16785408)===16785408){Pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Xi},rx(a,I,Pe);var lt=(I&62914560)===I?Ad-On():(I&4194048)===I?cx-On():0;if(lt=EA(Pe,lt),lt!==null){xo=I,s.cancelPendingCommit=lt(bx.bind(null,s,a,I,d,p,S,P,q,se,Oe,Pe,null,Te,Re)),ta(s,I,P,!be);return}}bx(s,a,I,d,p,S,P,q,se)}function BT(s){for(var a=s;;){var d=a.tag;if((d===0||d===11||d===15)&&a.flags&16384&&(d=a.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var p=0;p<d.length;p++){var S=d[p],I=S.getSnapshot;S=S.value;try{if(!v(I(),S))return!1}catch{return!1}}if(d=a.child,a.subtreeFlags&16384&&d!==null)d.return=a,a=d;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ta(s,a,d,p){a&=~T0,a&=~Za,s.suspendedLanes|=a,s.pingedLanes&=~a,p&&(s.warmLanes|=a),p=s.expirationTimes;for(var S=a;0<S;){var I=31-_t(S),P=1<<I;p[I]=-1,S&=~P}d!==0&&zr(s,d,a)}function Nd(){return(pn&6)===0?($c(0),!1):!0}function I0(){if(Wt!==null){if(En===0)var s=Wt.return;else s=Wt,ro=za=null,qf(s),Sl=null,Dc=0,s=Wt;for(;s!==null;)z1(s.alternate,s),s=s.return;Wt=null}}function Ll(s,a){var d=s.timeoutHandle;d!==-1&&(s.timeoutHandle=-1,sA(d)),d=s.cancelPendingCommit,d!==null&&(s.cancelPendingCommit=null,d()),xo=0,I0(),Rn=s,Wt=d=io(s.current,null),Jt=a,En=0,Fs=null,Jo=!1,Ol=Pt(s,a),_0=!1,kl=js=T0=Za=Qo=ti=0,As=Xc=null,A0=!1,(a&8)!==0&&(a|=a&32);var p=s.entangledLanes;if(p!==0)for(s=s.entanglements,p&=a;0<p;){var S=31-_t(p),I=1<<S;a|=s[S],p&=~I}return po=a,Ku(),d}function mx(s,a){Lt=null,ne.H=jc,a===Al||a===id?(a=Rp(),En=3):a===Of?(a=Rp(),En=4):En=a===a0?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Fs=a,Wt===null&&(ti=1,xd(s,tr(a,s.current)))}function gx(){var s=Us.current;return s===null?!0:(Jt&4194048)===Jt?rr===null:(Jt&62914560)===Jt||(Jt&536870912)!==0?s===rr:!1}function px(){var s=ne.H;return ne.H=jc,s===null?jc:s}function xx(){var s=ne.A;return ne.A=LT,s}function Id(){ti=4,Jo||(Jt&4194048)!==Jt&&Us.current!==null||(Ol=!0),(Qo&134217727)===0&&(Za&134217727)===0||Rn===null||ta(Rn,Jt,js,!1)}function R0(s,a,d){var p=pn;pn|=2;var S=px(),I=xx();(Rn!==s||Jt!==a)&&(Cd=null,Ll(s,a)),a=!1;var P=ti;e:do try{if(En!==0&&Wt!==null){var q=Wt,se=Fs;switch(En){case 8:I0(),P=6;break e;case 3:case 2:case 9:case 6:Us.current===null&&(a=!0);var be=En;if(En=0,Fs=null,Ul(s,q,se,be),d&&Ol){P=0;break e}break;default:be=En,En=0,Fs=null,Ul(s,q,se,be)}}FT(),P=ti;break}catch(Oe){mx(s,Oe)}while(!0);return a&&s.shellSuspendCounter++,ro=za=null,pn=p,ne.H=S,ne.A=I,Wt===null&&(Rn=null,Jt=0,Ku()),P}function FT(){for(;Wt!==null;)yx(Wt)}function jT(s,a){var d=pn;pn|=2;var p=px(),S=xx();Rn!==s||Jt!==a?(Cd=null,Sd=On()+500,Ll(s,a)):Ol=Pt(s,a);e:do try{if(En!==0&&Wt!==null){a=Wt;var I=Fs;t:switch(En){case 1:En=0,Fs=null,Ul(s,a,I,1);break;case 2:case 9:if(Np(I)){En=0,Fs=null,vx(a);break}a=function(){En!==2&&En!==9||Rn!==s||(En=7),kr(s)},I.then(a,a);break e;case 3:En=7;break e;case 4:En=5;break e;case 7:Np(I)?(En=0,Fs=null,vx(a)):(En=0,Fs=null,Ul(s,a,I,7));break;case 5:var P=null;switch(Wt.tag){case 26:P=Wt.memoizedState;case 5:case 27:var q=Wt;if(P?sy(P):q.stateNode.complete){En=0,Fs=null;var se=q.sibling;if(se!==null)Wt=se;else{var be=q.return;be!==null?(Wt=be,Rd(be)):Wt=null}break t}}En=0,Fs=null,Ul(s,a,I,5);break;case 6:En=0,Fs=null,Ul(s,a,I,6);break;case 8:I0(),ti=6;break e;default:throw Error(i(462))}}VT();break}catch(Oe){mx(s,Oe)}while(!0);return ro=za=null,ne.H=p,ne.A=S,pn=d,Wt!==null?0:(Rn=null,Jt=0,Ku(),ti)}function VT(){for(;Wt!==null&&!Gr();)yx(Wt)}function yx(s){var a=G1(s.alternate,s,po);s.memoizedProps=s.pendingProps,a===null?Rd(s):Wt=a}function vx(s){var a=s,d=a.alternate;switch(a.tag){case 15:case 0:a=L1(d,a,a.pendingProps,a.type,void 0,Jt);break;case 11:a=L1(d,a,a.pendingProps,a.type.render,a.ref,Jt);break;case 5:qf(a);default:z1(d,a),a=Wt=xp(a,po),a=G1(d,a,po)}s.memoizedProps=s.pendingProps,a===null?Rd(s):Wt=a}function Ul(s,a,d,p){ro=za=null,qf(a),Sl=null,Dc=0;var S=a.return;try{if(IT(s,S,a,d,Jt)){ti=1,xd(s,tr(d,s.current)),Wt=null;return}}catch(I){if(S!==null)throw Wt=S,I;ti=1,xd(s,tr(d,s.current)),Wt=null;return}a.flags&32768?(tn||p===1?s=!0:Ol||(Jt&536870912)!==0?s=!1:(Jo=s=!0,(p===2||p===9||p===3||p===6)&&(p=Us.current,p!==null&&p.tag===13&&(p.flags|=16384))),wx(a,s)):Rd(a)}function Rd(s){var a=s;do{if((a.flags&32768)!==0){wx(a,Jo);return}s=a.return;var d=DT(a.alternate,a,po);if(d!==null){Wt=d;return}if(a=a.sibling,a!==null){Wt=a;return}Wt=a=s}while(a!==null);ti===0&&(ti=5)}function wx(s,a){do{var d=OT(s.alternate,s);if(d!==null){d.flags&=32767,Wt=d;return}if(d=s.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!a&&(s=s.sibling,s!==null)){Wt=s;return}Wt=s=d}while(s!==null);ti=6,Wt=null}function bx(s,a,d,p,S,I,P,q,se){s.cancelPendingCommit=null;do Md();while(vi!==0);if((pn&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(I=a.lanes|a.childLanes,I|=yf,ps(s,d,I,P,q,se),s===Rn&&(Wt=Rn=null,Jt=0),Pl=a,ea=s,xo=d,S0=I,C0=S,ux=p,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,qT(_i,function(){return Sx(),null})):(s.callbackNode=null,s.callbackPriority=0),p=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||p){p=ne.T,ne.T=null,S=ie.p,ie.p=2,P=pn,pn|=4;try{kT(s,a,d)}finally{pn=P,ie.p=S,ne.T=p}}vi=1,Ex(),_x(),Tx()}}function Ex(){if(vi===1){vi=0;var s=ea,a=Pl,d=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||d){d=ne.T,ne.T=null;var p=ie.p;ie.p=2;var S=pn;pn|=4;try{nx(a,s);var I=G0,P=j(s.containerInfo),q=I.focusedElem,se=I.selectionRange;if(P!==q&&q&&q.ownerDocument&&O(q.ownerDocument.documentElement,q)){if(se!==null&&G(q)){var be=se.start,Oe=se.end;if(Oe===void 0&&(Oe=be),"selectionStart"in q)q.selectionStart=be,q.selectionEnd=Math.min(Oe,q.value.length);else{var Pe=q.ownerDocument||document,Te=Pe&&Pe.defaultView||window;if(Te.getSelection){var Re=Te.getSelection(),lt=q.textContent.length,bt=Math.min(se.start,lt),Cn=se.end===void 0?bt:Math.min(se.end,lt);!Re.extend&&bt>Cn&&(P=Cn,Cn=bt,bt=P);var ge=M(q,bt),fe=M(q,Cn);if(ge&&fe&&(Re.rangeCount!==1||Re.anchorNode!==ge.node||Re.anchorOffset!==ge.offset||Re.focusNode!==fe.node||Re.focusOffset!==fe.offset)){var we=Pe.createRange();we.setStart(ge.node,ge.offset),Re.removeAllRanges(),bt>Cn?(Re.addRange(we),Re.extend(fe.node,fe.offset)):(we.setEnd(fe.node,fe.offset),Re.addRange(we))}}}}for(Pe=[],Re=q;Re=Re.parentNode;)Re.nodeType===1&&Pe.push({element:Re,left:Re.scrollLeft,top:Re.scrollTop});for(typeof q.focus=="function"&&q.focus(),q=0;q<Pe.length;q++){var ke=Pe[q];ke.element.scrollLeft=ke.left,ke.element.scrollTop=ke.top}}Hd=!!V0,G0=V0=null}finally{pn=S,ie.p=p,ne.T=d}}s.current=a,vi=2}}function _x(){if(vi===2){vi=0;var s=ea,a=Pl,d=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||d){d=ne.T,ne.T=null;var p=ie.p;ie.p=2;var S=pn;pn|=4;try{J1(s,a.alternate,a)}finally{pn=S,ie.p=p,ne.T=d}}vi=3}}function Tx(){if(vi===4||vi===3){vi=0,Mo();var s=ea,a=Pl,d=xo,p=ux;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?vi=5:(vi=0,Pl=ea=null,Ax(s,s.pendingLanes));var S=s.pendingLanes;if(S===0&&(Zo=null),Ri(d),a=a.stateNode,Ge&&typeof Ge.onCommitFiberRoot=="function")try{Ge.onCommitFiberRoot(an,a,void 0,(a.current.flags&128)===128)}catch{}if(p!==null){a=ne.T,S=ie.p,ie.p=2,ne.T=null;try{for(var I=s.onRecoverableError,P=0;P<p.length;P++){var q=p[P];I(q.value,{componentStack:q.stack})}}finally{ne.T=a,ie.p=S}}(xo&3)!==0&&Md(),kr(s),S=s.pendingLanes,(d&261930)!==0&&(S&42)!==0?s===N0?Kc++:(Kc=0,N0=s):Kc=0,$c(0)}}function Ax(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,Rc(a)))}function Md(){return Ex(),_x(),Tx(),Sx()}function Sx(){if(vi!==5)return!1;var s=ea,a=S0;S0=0;var d=Ri(xo),p=ne.T,S=ie.p;try{ie.p=32>d?32:d,ne.T=null,d=C0,C0=null;var I=ea,P=xo;if(vi=0,Pl=ea=null,xo=0,(pn&6)!==0)throw Error(i(331));var q=pn;if(pn|=4,ax(I.current),sx(I,I.current,P,d),pn=q,$c(0,!1),Ge&&typeof Ge.onPostCommitFiberRoot=="function")try{Ge.onPostCommitFiberRoot(an,I)}catch{}return!0}finally{ie.p=S,ne.T=p,Ax(s,a)}}function Cx(s,a,d){a=tr(d,a),a=o0(s.stateNode,a,2),s=Wo(s,a,2),s!==null&&(zi(s,2),kr(s))}function _n(s,a,d){if(s.tag===3)Cx(s,s,d);else for(;a!==null;){if(a.tag===3){Cx(a,s,d);break}else if(a.tag===1){var p=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Zo===null||!Zo.has(p))){s=tr(d,s),d=N1(2),p=Wo(a,d,2),p!==null&&(I1(d,p,a,s),zi(p,2),kr(p));break}}a=a.return}}function M0(s,a,d){var p=s.pingCache;if(p===null){p=s.pingCache=new UT;var S=new Set;p.set(a,S)}else S=p.get(a),S===void 0&&(S=new Set,p.set(a,S));S.has(d)||(_0=!0,S.add(d),s=GT.bind(null,s,a,d),a.then(s,s))}function GT(s,a,d){var p=s.pingCache;p!==null&&p.delete(a),s.pingedLanes|=s.suspendedLanes&d,s.warmLanes&=~d,Rn===s&&(Jt&d)===d&&(ti===4||ti===3&&(Jt&62914560)===Jt&&300>On()-Ad?(pn&2)===0&&Ll(s,0):T0|=d,kl===Jt&&(kl=0)),kr(s)}function Nx(s,a){a===0&&(a=Vt()),s=Va(s,a),s!==null&&(zi(s,a),kr(s))}function HT(s){var a=s.memoizedState,d=0;a!==null&&(d=a.retryLane),Nx(s,d)}function zT(s,a){var d=0;switch(s.tag){case 31:case 13:var p=s.stateNode,S=s.memoizedState;S!==null&&(d=S.retryLane);break;case 19:p=s.stateNode;break;case 22:p=s.stateNode._retryCache;break;default:throw Error(i(314))}p!==null&&p.delete(a),Nx(s,d)}function qT(s,a){return xn(s,a)}var Dd=null,Bl=null,D0=!1,Od=!1,O0=!1,na=0;function kr(s){s!==Bl&&s.next===null&&(Bl===null?Dd=Bl=s:Bl=Bl.next=s),Od=!0,D0||(D0=!0,WT())}function $c(s,a){if(!O0&&Od){O0=!0;do for(var d=!1,p=Dd;p!==null;){if(s!==0){var S=p.pendingLanes;if(S===0)var I=0;else{var P=p.suspendedLanes,q=p.pingedLanes;I=(1<<31-_t(42|s)+1)-1,I&=S&~(P&~q),I=I&201326741?I&201326741|1:I?I|2:0}I!==0&&(d=!0,Dx(p,I))}else I=Jt,I=yn(p,p===Rn?I:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(I&3)===0||Pt(p,I)||(d=!0,Dx(p,I));p=p.next}while(d);O0=!1}}function YT(){Ix()}function Ix(){Od=D0=!1;var s=0;na!==0&&iA()&&(s=na);for(var a=On(),d=null,p=Dd;p!==null;){var S=p.next,I=Rx(p,a);I===0?(p.next=null,d===null?Dd=S:d.next=S,S===null&&(Bl=d)):(d=p,(s!==0||(I&3)!==0)&&(Od=!0)),p=S}vi!==0&&vi!==5||$c(s),na!==0&&(na=0)}function Rx(s,a){for(var d=s.suspendedLanes,p=s.pingedLanes,S=s.expirationTimes,I=s.pendingLanes&-62914561;0<I;){var P=31-_t(I),q=1<<P,se=S[P];se===-1?((q&d)===0||(q&p)!==0)&&(S[P]=is(q,a)):se<=a&&(s.expiredLanes|=q),I&=~q}if(a=Rn,d=Jt,d=yn(s,s===a?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p=s.callbackNode,d===0||s===a&&(En===2||En===9)||s.cancelPendingCommit!==null)return p!==null&&p!==null&&Ze(p),s.callbackNode=null,s.callbackPriority=0;if((d&3)===0||Pt(s,d)){if(a=d&-d,a===s.callbackPriority)return a;switch(p!==null&&Ze(p),Ri(d)){case 2:case 8:d=Hr;break;case 32:d=_i;break;case 268435456:d=Do;break;default:d=_i}return p=Mx.bind(null,s),d=xn(d,p),s.callbackPriority=a,s.callbackNode=d,a}return p!==null&&p!==null&&Ze(p),s.callbackPriority=2,s.callbackNode=null,2}function Mx(s,a){if(vi!==0&&vi!==5)return s.callbackNode=null,s.callbackPriority=0,null;var d=s.callbackNode;if(Md()&&s.callbackNode!==d)return null;var p=Jt;return p=yn(s,s===Rn?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p===0?null:(hx(s,p,a),Rx(s,On()),s.callbackNode!=null&&s.callbackNode===d?Mx.bind(null,s):null)}function Dx(s,a){if(Md())return null;hx(s,a,!0)}function WT(){rA(function(){(pn&6)!==0?xn(Ei,YT):Ix()})}function k0(){if(na===0){var s=_l;s===0&&(s=yt,yt<<=1,(yt&261888)===0&&(yt=256)),na=s}return na}function Ox(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Cr(""+s)}function kx(s,a){var d=a.ownerDocument.createElement("input");return d.name=a.name,d.value=a.value,s.id&&d.setAttribute("form",s.id),a.parentNode.insertBefore(d,a),s=new FormData(s),d.parentNode.removeChild(d),s}function XT(s,a,d,p,S){if(a==="submit"&&d&&d.stateNode===S){var I=Ox((S[cn]||null).action),P=p.submitter;P&&(a=(a=P[cn]||null)?Ox(a.formAction):P.getAttribute("formAction"),a!==null&&(I=a,P=null));var q=new Ln("action","action",null,p,S);s.push({event:q,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(na!==0){var se=P?kx(S,P):new FormData(S);e0(d,{pending:!0,data:se,method:S.method,action:I},null,se)}}else typeof I=="function"&&(q.preventDefault(),se=P?kx(S,P):new FormData(S),e0(d,{pending:!0,data:se,method:S.method,action:I},I,se))},currentTarget:S}]})}}for(var P0=0;P0<Cc.length;P0++){var L0=Cc[P0],KT=L0.toLowerCase(),$T=L0[0].toUpperCase()+L0.slice(1);gr(KT,"on"+$T)}gr(bs,"onAnimationEnd"),gr(Ui,"onAnimationIteration"),gr(bn,"onAnimationStart"),gr("dblclick","onDoubleClick"),gr("focusin","onFocus"),gr("focusout","onBlur"),gr(yi,"onTransitionRun"),gr(cs,"onTransitionStart"),gr(jo,"onTransitionCancel"),gr(no,"onTransitionEnd"),ki("onMouseEnter",["mouseout","mouseover"]),ki("onMouseLeave",["mouseout","mouseover"]),ki("onPointerEnter",["pointerout","pointerover"]),ki("onPointerLeave",["pointerout","pointerover"]),un("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),un("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),un("onBeforeInput",["compositionend","keypress","textInput","paste"]),un("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),un("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),un("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),JT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Jc));function Px(s,a){a=(a&4)!==0;for(var d=0;d<s.length;d++){var p=s[d],S=p.event;p=p.listeners;e:{var I=void 0;if(a)for(var P=p.length-1;0<=P;P--){var q=p[P],se=q.instance,be=q.currentTarget;if(q=q.listener,se!==I&&S.isPropagationStopped())break e;I=q,S.currentTarget=be;try{I(S)}catch(Oe){Xu(Oe)}S.currentTarget=null,I=se}else for(P=0;P<p.length;P++){if(q=p[P],se=q.instance,be=q.currentTarget,q=q.listener,se!==I&&S.isPropagationStopped())break e;I=q,S.currentTarget=be;try{I(S)}catch(Oe){Xu(Oe)}S.currentTarget=null,I=se}}}}function Xt(s,a){var d=a[dr];d===void 0&&(d=a[dr]=new Set);var p=s+"__bubble";d.has(p)||(Lx(a,s,2,!1),d.add(p))}function U0(s,a,d){var p=0;a&&(p|=4),Lx(d,s,p,a)}var kd="_reactListening"+Math.random().toString(36).slice(2);function B0(s){if(!s[kd]){s[kd]=!0,Le.forEach(function(d){d!=="selectionchange"&&(JT.has(d)||U0(d,!1,s),U0(d,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[kd]||(a[kd]=!0,U0("selectionchange",!1,a))}}function Lx(s,a,d,p){switch(dy(a)){case 2:var S=AA;break;case 8:S=SA;break;default:S=Z0}d=S.bind(null,a,d,s),S=void 0,!Wr||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(S=!0),p?S!==void 0?s.addEventListener(a,d,{capture:!0,passive:S}):s.addEventListener(a,d,!0):S!==void 0?s.addEventListener(a,d,{passive:S}):s.addEventListener(a,d,!1)}function F0(s,a,d,p,S){var I=p;if((a&1)===0&&(a&2)===0&&p!==null)e:for(;;){if(p===null)return;var P=p.tag;if(P===3||P===4){var q=p.stateNode.containerInfo;if(q===S)break;if(P===4)for(P=p.return;P!==null;){var se=P.tag;if((se===3||se===4)&&P.stateNode.containerInfo===S)return;P=P.return}for(;q!==null;){if(P=kn(q),P===null)return;if(se=P.tag,se===5||se===6||se===26||se===27){p=I=P;continue e}q=q.parentNode}}p=p.return}Nr(function(){var be=I,Oe=ys(d),Pe=[];e:{var Te=Wu.get(s);if(Te!==void 0){var Re=Ln,lt=s;switch(s){case"keypress":if(Ds(d)===0)break e;case"keydown":case"keyup":Re=Qr;break;case"focusin":lt="focus",Re=$r;break;case"focusout":lt="blur",Re=$r;break;case"beforeblur":case"afterblur":Re=$r;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Re=sn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Re=Kr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Re=D;break;case bs:case Ui:case bn:Re=Rt;break;case no:Re=X;break;case"scroll":case"scrollend":Re=Po;break;case"wheel":Re=Ne;break;case"copy":case"cut":case"paste":Re=Jr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Re=Yt;break;case"toggle":case"beforetoggle":Re=Ct}var bt=(a&4)!==0,Cn=!bt&&(s==="scroll"||s==="scrollend"),ge=bt?Te!==null?Te+"Capture":null:Te;bt=[];for(var fe=be,we;fe!==null;){var ke=fe;if(we=ke.stateNode,ke=ke.tag,ke!==5&&ke!==26&&ke!==27||we===null||ge===null||(ke=vt(fe,ge),ke!=null&&bt.push(Qc(fe,ke,we))),Cn)break;fe=fe.return}0<bt.length&&(Te=new Re(Te,lt,null,d,Oe),Pe.push({event:Te,listeners:bt}))}}if((a&7)===0){e:{if(Te=s==="mouseover"||s==="pointerover",Re=s==="mouseout"||s==="pointerout",Te&&d!==Yr&&(lt=d.relatedTarget||d.fromElement)&&(kn(lt)||lt[Di]))break e;if((Re||Te)&&(Te=Oe.window===Oe?Oe:(Te=Oe.ownerDocument)?Te.defaultView||Te.parentWindow:window,Re?(lt=d.relatedTarget||d.toElement,Re=be,lt=lt?kn(lt):null,lt!==null&&(Cn=c(lt),bt=lt.tag,lt!==Cn||bt!==5&&bt!==27&&bt!==6)&&(lt=null)):(Re=null,lt=be),Re!==lt)){if(bt=sn,ke="onMouseLeave",ge="onMouseEnter",fe="mouse",(s==="pointerout"||s==="pointerover")&&(bt=Yt,ke="onPointerLeave",ge="onPointerEnter",fe="pointer"),Cn=Re==null?Te:qi(Re),we=lt==null?Te:qi(lt),Te=new bt(ke,fe+"leave",Re,d,Oe),Te.target=Cn,Te.relatedTarget=we,ke=null,kn(Oe)===be&&(bt=new bt(ge,fe+"enter",lt,d,Oe),bt.target=we,bt.relatedTarget=Cn,ke=bt),Cn=ke,Re&&lt)t:{for(bt=QT,ge=Re,fe=lt,we=0,ke=ge;ke;ke=bt(ke))we++;ke=0;for(var gt=fe;gt;gt=bt(gt))ke++;for(;0<we-ke;)ge=bt(ge),we--;for(;0<ke-we;)fe=bt(fe),ke--;for(;we--;){if(ge===fe||fe!==null&&ge===fe.alternate){bt=ge;break t}ge=bt(ge),fe=bt(fe)}bt=null}else bt=null;Re!==null&&Ux(Pe,Te,Re,bt,!1),lt!==null&&Cn!==null&&Ux(Pe,Cn,lt,bt,!0)}}e:{if(Te=be?qi(be):window,Re=Te.nodeName&&Te.nodeName.toLowerCase(),Re==="select"||Re==="input"&&Te.type==="file")var fn=Ps;else if(Sc(Te))if(Yu)fn=m;else{fn=l;var dt=r}else Re=Te.nodeName,!Re||Re.toLowerCase()!=="input"||Te.type!=="checkbox"&&Te.type!=="radio"?be&&vn(be.elementType)&&(fn=Ps):fn=u;if(fn&&(fn=fn(s,be))){ks(Pe,fn,d,Oe);break e}dt&&dt(s,Te,be),s==="focusout"&&be&&Te.type==="number"&&be.memoizedProps.value!=null&&J(Te,"number",Te.value)}switch(dt=be?qi(be):window,s){case"focusin":(Sc(dt)||dt.contentEditable==="true")&&(re=dt,ce=be,ye=null);break;case"focusout":ye=ce=re=null;break;case"mousedown":Ce=!0;break;case"contextmenu":case"mouseup":case"dragend":Ce=!1,qe(Pe,d,Oe);break;case"selectionchange":if(Z)break;case"keydown":case"keyup":qe(Pe,d,Oe)}var Bt;if(en)e:{switch(s){case"compositionstart":var Qt="onCompositionStart";break e;case"compositionend":Qt="onCompositionEnd";break e;case"compositionupdate":Qt="onCompositionUpdate";break e}Qt=void 0}else Fo?Zr(s,d)&&(Qt="onCompositionEnd"):s==="keydown"&&d.keyCode===229&&(Qt="onCompositionStart");Qt&&(Qs&&d.locale!=="ko"&&(Fo||Qt!=="onCompositionStart"?Qt==="onCompositionEnd"&&Fo&&(Bt=hr()):(Rs=Oe,Ms="value"in Rs?Rs.value:Rs.textContent,Fo=!0)),dt=Pd(be,Qt),0<dt.length&&(Qt=new Ks(Qt,s,null,d,Oe),Pe.push({event:Qt,listeners:dt}),Bt?Qt.data=Bt:(Bt=Zs(d),Bt!==null&&(Qt.data=Bt)))),(Bt=as?Rr(s,d):pl(s,d))&&(Qt=Pd(be,"onBeforeInput"),0<Qt.length&&(dt=new Ks("onBeforeInput","beforeinput",null,d,Oe),Pe.push({event:dt,listeners:Qt}),dt.data=Bt)),XT(Pe,s,be,d,Oe)}Px(Pe,a)})}function Qc(s,a,d){return{instance:s,listener:a,currentTarget:d}}function Pd(s,a){for(var d=a+"Capture",p=[];s!==null;){var S=s,I=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||I===null||(S=vt(s,d),S!=null&&p.unshift(Qc(s,S,I)),S=vt(s,a),S!=null&&p.push(Qc(s,S,I))),s.tag===3)return p;s=s.return}return[]}function QT(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Ux(s,a,d,p,S){for(var I=a._reactName,P=[];d!==null&&d!==p;){var q=d,se=q.alternate,be=q.stateNode;if(q=q.tag,se!==null&&se===p)break;q!==5&&q!==26&&q!==27||be===null||(se=be,S?(be=vt(d,I),be!=null&&P.unshift(Qc(d,be,se))):S||(be=vt(d,I),be!=null&&P.push(Qc(d,be,se)))),d=d.return}P.length!==0&&s.push({event:a,listeners:P})}var ZT=/\r\n?/g,eA=/\u0000|\uFFFD/g;function Bx(s){return(typeof s=="string"?s:""+s).replace(ZT,`
`).replace(eA,"")}function Fx(s,a){return a=Bx(a),Bx(s)===a}function Sn(s,a,d,p,S,I){switch(d){case"children":typeof p=="string"?a==="body"||a==="textarea"&&p===""||Wi(s,p):(typeof p=="number"||typeof p=="bigint")&&a!=="body"&&Wi(s,""+p);break;case"className":Pi(s,"class",p);break;case"tabIndex":Pi(s,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Pi(s,d,p);break;case"style":ft(s,p,I);break;case"data":if(a!=="object"){Pi(s,"data",p);break}case"src":case"href":if(p===""&&(a!=="a"||d!=="href")){s.removeAttribute(d);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(d);break}p=Cr(""+p),s.setAttribute(d,p);break;case"action":case"formAction":if(typeof p=="function"){s.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof I=="function"&&(d==="formAction"?(a!=="input"&&Sn(s,a,"name",S.name,S,null),Sn(s,a,"formEncType",S.formEncType,S,null),Sn(s,a,"formMethod",S.formMethod,S,null),Sn(s,a,"formTarget",S.formTarget,S,null)):(Sn(s,a,"encType",S.encType,S,null),Sn(s,a,"method",S.method,S,null),Sn(s,a,"target",S.target,S,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(d);break}p=Cr(""+p),s.setAttribute(d,p);break;case"onClick":p!=null&&(s.onclick=Xi);break;case"onScroll":p!=null&&Xt("scroll",s);break;case"onScrollEnd":p!=null&&Xt("scrollend",s);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(i(61));if(d=p.__html,d!=null){if(S.children!=null)throw Error(i(60));s.innerHTML=d}}break;case"multiple":s.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":s.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){s.removeAttribute("xlink:href");break}d=Cr(""+p),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(d,""+p):s.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(d,""):s.removeAttribute(d);break;case"capture":case"download":p===!0?s.setAttribute(d,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(d,p):s.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?s.setAttribute(d,p):s.removeAttribute(d);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?s.removeAttribute(d):s.setAttribute(d,p);break;case"popover":Xt("beforetoggle",s),Xt("toggle",s),Ar(s,"popover",p);break;case"xlinkActuate":Gn(s,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Gn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Gn(s,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Gn(s,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Gn(s,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Gn(s,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Gn(s,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Gn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Gn(s,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Ar(s,"is",p);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=Pa.get(d)||d,Ar(s,d,p))}}function j0(s,a,d,p,S,I){switch(d){case"style":ft(s,p,I);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(i(61));if(d=p.__html,d!=null){if(S.children!=null)throw Error(i(60));s.innerHTML=d}}break;case"children":typeof p=="string"?Wi(s,p):(typeof p=="number"||typeof p=="bigint")&&Wi(s,""+p);break;case"onScroll":p!=null&&Xt("scroll",s);break;case"onScrollEnd":p!=null&&Xt("scrollend",s);break;case"onClick":p!=null&&(s.onclick=Xi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Da.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(S=d.endsWith("Capture"),a=d.slice(2,S?d.length-7:void 0),I=s[cn]||null,I=I!=null?I[d]:null,typeof I=="function"&&s.removeEventListener(a,I,S),typeof p=="function")){typeof I!="function"&&I!==null&&(d in s?s[d]=null:s.hasAttribute(d)&&s.removeAttribute(d)),s.addEventListener(a,p,S);break e}d in s?s[d]=p:p===!0?s.setAttribute(d,""):Ar(s,d,p)}}}function Vi(s,a,d){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Xt("error",s),Xt("load",s);var p=!1,S=!1,I;for(I in d)if(d.hasOwnProperty(I)){var P=d[I];if(P!=null)switch(I){case"src":p=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Sn(s,a,I,P,d,null)}}S&&Sn(s,a,"srcSet",d.srcSet,d,null),p&&Sn(s,a,"src",d.src,d,null);return;case"input":Xt("invalid",s);var q=I=P=S=null,se=null,be=null;for(p in d)if(d.hasOwnProperty(p)){var Oe=d[p];if(Oe!=null)switch(p){case"name":S=Oe;break;case"type":P=Oe;break;case"checked":se=Oe;break;case"defaultChecked":be=Oe;break;case"value":I=Oe;break;case"defaultValue":q=Oe;break;case"children":case"dangerouslySetInnerHTML":if(Oe!=null)throw Error(i(137,a));break;default:Sn(s,a,p,Oe,d,null)}}ve(s,I,q,se,be,P,S,!1);return;case"select":Xt("invalid",s),p=P=I=null;for(S in d)if(d.hasOwnProperty(S)&&(q=d[S],q!=null))switch(S){case"value":I=q;break;case"defaultValue":P=q;break;case"multiple":p=q;default:Sn(s,a,S,q,d,null)}a=I,d=P,s.multiple=!!p,a!=null?at(s,!!p,a,!1):d!=null&&at(s,!!p,d,!0);return;case"textarea":Xt("invalid",s),I=S=p=null;for(P in d)if(d.hasOwnProperty(P)&&(q=d[P],q!=null))switch(P){case"value":p=q;break;case"defaultValue":S=q;break;case"children":I=q;break;case"dangerouslySetInnerHTML":if(q!=null)throw Error(i(91));break;default:Sn(s,a,P,q,d,null)}si(s,p,S,I);return;case"option":for(se in d)if(d.hasOwnProperty(se)&&(p=d[se],p!=null))switch(se){case"selected":s.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Sn(s,a,se,p,d,null)}return;case"dialog":Xt("beforetoggle",s),Xt("toggle",s),Xt("cancel",s),Xt("close",s);break;case"iframe":case"object":Xt("load",s);break;case"video":case"audio":for(p=0;p<Jc.length;p++)Xt(Jc[p],s);break;case"image":Xt("error",s),Xt("load",s);break;case"details":Xt("toggle",s);break;case"embed":case"source":case"link":Xt("error",s),Xt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(be in d)if(d.hasOwnProperty(be)&&(p=d[be],p!=null))switch(be){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Sn(s,a,be,p,d,null)}return;default:if(vn(a)){for(Oe in d)d.hasOwnProperty(Oe)&&(p=d[Oe],p!==void 0&&j0(s,a,Oe,p,d,void 0));return}}for(q in d)d.hasOwnProperty(q)&&(p=d[q],p!=null&&Sn(s,a,q,p,d,null))}function tA(s,a,d,p){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,I=null,P=null,q=null,se=null,be=null,Oe=null;for(Re in d){var Pe=d[Re];if(d.hasOwnProperty(Re)&&Pe!=null)switch(Re){case"checked":break;case"value":break;case"defaultValue":se=Pe;default:p.hasOwnProperty(Re)||Sn(s,a,Re,null,p,Pe)}}for(var Te in p){var Re=p[Te];if(Pe=d[Te],p.hasOwnProperty(Te)&&(Re!=null||Pe!=null))switch(Te){case"type":I=Re;break;case"name":S=Re;break;case"checked":be=Re;break;case"defaultChecked":Oe=Re;break;case"value":P=Re;break;case"defaultValue":q=Re;break;case"children":case"dangerouslySetInnerHTML":if(Re!=null)throw Error(i(137,a));break;default:Re!==Pe&&Sn(s,a,Te,Re,p,Pe)}}Wn(s,P,q,se,be,Oe,I,S);return;case"select":Re=P=q=Te=null;for(I in d)if(se=d[I],d.hasOwnProperty(I)&&se!=null)switch(I){case"value":break;case"multiple":Re=se;default:p.hasOwnProperty(I)||Sn(s,a,I,null,p,se)}for(S in p)if(I=p[S],se=d[S],p.hasOwnProperty(S)&&(I!=null||se!=null))switch(S){case"value":Te=I;break;case"defaultValue":q=I;break;case"multiple":P=I;default:I!==se&&Sn(s,a,S,I,p,se)}a=q,d=P,p=Re,Te!=null?at(s,!!d,Te,!1):!!p!=!!d&&(a!=null?at(s,!!d,a,!0):at(s,!!d,d?[]:"",!1));return;case"textarea":Re=Te=null;for(q in d)if(S=d[q],d.hasOwnProperty(q)&&S!=null&&!p.hasOwnProperty(q))switch(q){case"value":break;case"children":break;default:Sn(s,a,q,null,p,S)}for(P in p)if(S=p[P],I=d[P],p.hasOwnProperty(P)&&(S!=null||I!=null))switch(P){case"value":Te=S;break;case"defaultValue":Re=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:S!==I&&Sn(s,a,P,S,p,I)}Xn(s,Te,Re);return;case"option":for(var lt in d)if(Te=d[lt],d.hasOwnProperty(lt)&&Te!=null&&!p.hasOwnProperty(lt))switch(lt){case"selected":s.selected=!1;break;default:Sn(s,a,lt,null,p,Te)}for(se in p)if(Te=p[se],Re=d[se],p.hasOwnProperty(se)&&Te!==Re&&(Te!=null||Re!=null))switch(se){case"selected":s.selected=Te&&typeof Te!="function"&&typeof Te!="symbol";break;default:Sn(s,a,se,Te,p,Re)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var bt in d)Te=d[bt],d.hasOwnProperty(bt)&&Te!=null&&!p.hasOwnProperty(bt)&&Sn(s,a,bt,null,p,Te);for(be in p)if(Te=p[be],Re=d[be],p.hasOwnProperty(be)&&Te!==Re&&(Te!=null||Re!=null))switch(be){case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(i(137,a));break;default:Sn(s,a,be,Te,p,Re)}return;default:if(vn(a)){for(var Cn in d)Te=d[Cn],d.hasOwnProperty(Cn)&&Te!==void 0&&!p.hasOwnProperty(Cn)&&j0(s,a,Cn,void 0,p,Te);for(Oe in p)Te=p[Oe],Re=d[Oe],!p.hasOwnProperty(Oe)||Te===Re||Te===void 0&&Re===void 0||j0(s,a,Oe,Te,p,Re);return}}for(var ge in d)Te=d[ge],d.hasOwnProperty(ge)&&Te!=null&&!p.hasOwnProperty(ge)&&Sn(s,a,ge,null,p,Te);for(Pe in p)Te=p[Pe],Re=d[Pe],!p.hasOwnProperty(Pe)||Te===Re||Te==null&&Re==null||Sn(s,a,Pe,Te,p,Re)}function jx(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function nA(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,d=performance.getEntriesByType("resource"),p=0;p<d.length;p++){var S=d[p],I=S.transferSize,P=S.initiatorType,q=S.duration;if(I&&q&&jx(P)){for(P=0,q=S.responseEnd,p+=1;p<d.length;p++){var se=d[p],be=se.startTime;if(be>q)break;var Oe=se.transferSize,Pe=se.initiatorType;Oe&&jx(Pe)&&(se=se.responseEnd,P+=Oe*(se<q?1:(q-be)/(se-be)))}if(--p,a+=8*(I+P)/(S.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var V0=null,G0=null;function Ld(s){return s.nodeType===9?s:s.ownerDocument}function Vx(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gx(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function H0(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var z0=null;function iA(){var s=window.event;return s&&s.type==="popstate"?s===z0?!1:(z0=s,!0):(z0=null,!1)}var Hx=typeof setTimeout=="function"?setTimeout:void 0,sA=typeof clearTimeout=="function"?clearTimeout:void 0,zx=typeof Promise=="function"?Promise:void 0,rA=typeof queueMicrotask=="function"?queueMicrotask:typeof zx<"u"?function(s){return zx.resolve(null).then(s).catch(oA)}:Hx;function oA(s){setTimeout(function(){throw s})}function ia(s){return s==="head"}function qx(s,a){var d=a,p=0;do{var S=d.nextSibling;if(s.removeChild(d),S&&S.nodeType===8)if(d=S.data,d==="/$"||d==="/&"){if(p===0){s.removeChild(S),Gl(a);return}p--}else if(d==="$"||d==="$?"||d==="$~"||d==="$!"||d==="&")p++;else if(d==="html")Zc(s.ownerDocument.documentElement);else if(d==="head"){d=s.ownerDocument.head,Zc(d);for(var I=d.firstChild;I;){var P=I.nextSibling,q=I.nodeName;I[Ys]||q==="SCRIPT"||q==="STYLE"||q==="LINK"&&I.rel.toLowerCase()==="stylesheet"||d.removeChild(I),I=P}}else d==="body"&&Zc(s.ownerDocument.body);d=S}while(d);Gl(a)}function Yx(s,a){var d=s;s=0;do{var p=d.nextSibling;if(d.nodeType===1?a?(d._stashedDisplay=d.style.display,d.style.display="none"):(d.style.display=d._stashedDisplay||"",d.getAttribute("style")===""&&d.removeAttribute("style")):d.nodeType===3&&(a?(d._stashedText=d.nodeValue,d.nodeValue=""):d.nodeValue=d._stashedText||""),p&&p.nodeType===8)if(d=p.data,d==="/$"){if(s===0)break;s--}else d!=="$"&&d!=="$?"&&d!=="$~"&&d!=="$!"||s++;d=p}while(d)}function q0(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var d=a;switch(a=a.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":q0(d),Oi(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}s.removeChild(d)}}function aA(s,a,d,p){for(;s.nodeType===1;){var S=d;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!p&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(p){if(!s[Ys])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(I=s.getAttribute("rel"),I==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(I!==S.rel||s.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||s.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||s.getAttribute("title")!==(S.title==null?null:S.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(I=s.getAttribute("src"),(I!==(S.src==null?null:S.src)||s.getAttribute("type")!==(S.type==null?null:S.type)||s.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&I&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var I=S.name==null?null:""+S.name;if(S.type==="hidden"&&s.getAttribute("name")===I)return s}else return s;if(s=or(s.nextSibling),s===null)break}return null}function lA(s,a,d){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!d||(s=or(s.nextSibling),s===null))return null;return s}function Wx(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=or(s.nextSibling),s===null))return null;return s}function Y0(s){return s.data==="$?"||s.data==="$~"}function W0(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function cA(s,a){var d=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||d.readyState!=="loading")a();else{var p=function(){a(),d.removeEventListener("DOMContentLoaded",p)};d.addEventListener("DOMContentLoaded",p),s._reactRetry=p}}function or(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var X0=null;function Xx(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var d=s.data;if(d==="/$"||d==="/&"){if(a===0)return or(s.nextSibling);a--}else d!=="$"&&d!=="$!"&&d!=="$?"&&d!=="$~"&&d!=="&"||a++}s=s.nextSibling}return null}function Kx(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var d=s.data;if(d==="$"||d==="$!"||d==="$?"||d==="$~"||d==="&"){if(a===0)return s;a--}else d!=="/$"&&d!=="/&"||a++}s=s.previousSibling}return null}function $x(s,a,d){switch(a=Ld(d),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Zc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);Oi(s)}var ar=new Map,Jx=new Set;function Ud(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var yo=ie.d;ie.d={f:uA,r:dA,D:hA,C:fA,L:mA,m:gA,X:xA,S:pA,M:yA};function uA(){var s=yo.f(),a=Nd();return s||a}function dA(s){var a=zt(s);a!==null&&a.tag===5&&a.type==="form"?m1(a):yo.r(s)}var Fl=typeof document>"u"?null:document;function Qx(s,a,d){var p=Fl;if(p&&typeof a=="string"&&a){var S=Ut(a);S='link[rel="'+s+'"][href="'+S+'"]',typeof d=="string"&&(S+='[crossorigin="'+d+'"]'),Jx.has(S)||(Jx.add(S),s={rel:s,crossOrigin:d,href:a},p.querySelector(S)===null&&(a=p.createElement("link"),Vi(a,"link",s),Vn(a),p.head.appendChild(a)))}}function hA(s){yo.D(s),Qx("dns-prefetch",s,null)}function fA(s,a){yo.C(s,a),Qx("preconnect",s,a)}function mA(s,a,d){yo.L(s,a,d);var p=Fl;if(p&&s&&a){var S='link[rel="preload"][as="'+Ut(a)+'"]';a==="image"&&d&&d.imageSrcSet?(S+='[imagesrcset="'+Ut(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(S+='[imagesizes="'+Ut(d.imageSizes)+'"]')):S+='[href="'+Ut(s)+'"]';var I=S;switch(a){case"style":I=jl(s);break;case"script":I=Vl(s)}ar.has(I)||(s=N({rel:"preload",href:a==="image"&&d&&d.imageSrcSet?void 0:s,as:a},d),ar.set(I,s),p.querySelector(S)!==null||a==="style"&&p.querySelector(eu(I))||a==="script"&&p.querySelector(tu(I))||(a=p.createElement("link"),Vi(a,"link",s),Vn(a),p.head.appendChild(a)))}}function gA(s,a){yo.m(s,a);var d=Fl;if(d&&s){var p=a&&typeof a.as=="string"?a.as:"script",S='link[rel="modulepreload"][as="'+Ut(p)+'"][href="'+Ut(s)+'"]',I=S;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":I=Vl(s)}if(!ar.has(I)&&(s=N({rel:"modulepreload",href:s},a),ar.set(I,s),d.querySelector(S)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(tu(I)))return}p=d.createElement("link"),Vi(p,"link",s),Vn(p),d.head.appendChild(p)}}}function pA(s,a,d){yo.S(s,a,d);var p=Fl;if(p&&s){var S=xi(p).hoistableStyles,I=jl(s);a=a||"default";var P=S.get(I);if(!P){var q={loading:0,preload:null};if(P=p.querySelector(eu(I)))q.loading=5;else{s=N({rel:"stylesheet",href:s,"data-precedence":a},d),(d=ar.get(I))&&K0(s,d);var se=P=p.createElement("link");Vn(se),Vi(se,"link",s),se._p=new Promise(function(be,Oe){se.onload=be,se.onerror=Oe}),se.addEventListener("load",function(){q.loading|=1}),se.addEventListener("error",function(){q.loading|=2}),q.loading|=4,Bd(P,a,p)}P={type:"stylesheet",instance:P,count:1,state:q},S.set(I,P)}}}function xA(s,a){yo.X(s,a);var d=Fl;if(d&&s){var p=xi(d).hoistableScripts,S=Vl(s),I=p.get(S);I||(I=d.querySelector(tu(S)),I||(s=N({src:s,async:!0},a),(a=ar.get(S))&&$0(s,a),I=d.createElement("script"),Vn(I),Vi(I,"link",s),d.head.appendChild(I)),I={type:"script",instance:I,count:1,state:null},p.set(S,I))}}function yA(s,a){yo.M(s,a);var d=Fl;if(d&&s){var p=xi(d).hoistableScripts,S=Vl(s),I=p.get(S);I||(I=d.querySelector(tu(S)),I||(s=N({src:s,async:!0,type:"module"},a),(a=ar.get(S))&&$0(s,a),I=d.createElement("script"),Vn(I),Vi(I,"link",s),d.head.appendChild(I)),I={type:"script",instance:I,count:1,state:null},p.set(S,I))}}function Zx(s,a,d,p){var S=(S=pe.current)?Ud(S):null;if(!S)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(a=jl(d.href),d=xi(S).hoistableStyles,p=d.get(a),p||(p={type:"style",instance:null,count:0,state:null},d.set(a,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){s=jl(d.href);var I=xi(S).hoistableStyles,P=I.get(s);if(P||(S=S.ownerDocument||S,P={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},I.set(s,P),(I=S.querySelector(eu(s)))&&!I._p&&(P.instance=I,P.state.loading=5),ar.has(s)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},ar.set(s,d),I||vA(S,s,d,P.state))),a&&p===null)throw Error(i(528,""));return P}if(a&&p!==null)throw Error(i(529,""));return null;case"script":return a=d.async,d=d.src,typeof d=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Vl(d),d=xi(S).hoistableScripts,p=d.get(a),p||(p={type:"script",instance:null,count:0,state:null},d.set(a,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function jl(s){return'href="'+Ut(s)+'"'}function eu(s){return'link[rel="stylesheet"]['+s+"]"}function ey(s){return N({},s,{"data-precedence":s.precedence,precedence:null})}function vA(s,a,d,p){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?p.loading=1:(a=s.createElement("link"),p.preload=a,a.addEventListener("load",function(){return p.loading|=1}),a.addEventListener("error",function(){return p.loading|=2}),Vi(a,"link",d),Vn(a),s.head.appendChild(a))}function Vl(s){return'[src="'+Ut(s)+'"]'}function tu(s){return"script[async]"+s}function ty(s,a,d){if(a.count++,a.instance===null)switch(a.type){case"style":var p=s.querySelector('style[data-href~="'+Ut(d.href)+'"]');if(p)return a.instance=p,Vn(p),p;var S=N({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return p=(s.ownerDocument||s).createElement("style"),Vn(p),Vi(p,"style",S),Bd(p,d.precedence,s),a.instance=p;case"stylesheet":S=jl(d.href);var I=s.querySelector(eu(S));if(I)return a.state.loading|=4,a.instance=I,Vn(I),I;p=ey(d),(S=ar.get(S))&&K0(p,S),I=(s.ownerDocument||s).createElement("link"),Vn(I);var P=I;return P._p=new Promise(function(q,se){P.onload=q,P.onerror=se}),Vi(I,"link",p),a.state.loading|=4,Bd(I,d.precedence,s),a.instance=I;case"script":return I=Vl(d.src),(S=s.querySelector(tu(I)))?(a.instance=S,Vn(S),S):(p=d,(S=ar.get(I))&&(p=N({},d),$0(p,S)),s=s.ownerDocument||s,S=s.createElement("script"),Vn(S),Vi(S,"link",p),s.head.appendChild(S),a.instance=S);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(p=a.instance,a.state.loading|=4,Bd(p,d.precedence,s));return a.instance}function Bd(s,a,d){for(var p=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=p.length?p[p.length-1]:null,I=S,P=0;P<p.length;P++){var q=p[P];if(q.dataset.precedence===a)I=q;else if(I!==S)break}I?I.parentNode.insertBefore(s,I.nextSibling):(a=d.nodeType===9?d.head:d,a.insertBefore(s,a.firstChild))}function K0(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function $0(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var Fd=null;function ny(s,a,d){if(Fd===null){var p=new Map,S=Fd=new Map;S.set(d,p)}else S=Fd,p=S.get(d),p||(p=new Map,S.set(d,p));if(p.has(s))return p;for(p.set(s,null),d=d.getElementsByTagName(s),S=0;S<d.length;S++){var I=d[S];if(!(I[Ys]||I[jn]||s==="link"&&I.getAttribute("rel")==="stylesheet")&&I.namespaceURI!=="http://www.w3.org/2000/svg"){var P=I.getAttribute(a)||"";P=s+P;var q=p.get(P);q?q.push(I):p.set(P,[I])}}return p}function iy(s,a,d){s=s.ownerDocument||s,s.head.insertBefore(d,a==="title"?s.querySelector("head > title"):null)}function wA(s,a,d){if(d===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return s=a.disabled,typeof a.precedence=="string"&&s==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function sy(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function bA(s,a,d,p){if(d.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var S=jl(p.href),I=a.querySelector(eu(S));if(I){a=I._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=jd.bind(s),a.then(s,s)),d.state.loading|=4,d.instance=I,Vn(I);return}I=a.ownerDocument||a,p=ey(p),(S=ar.get(S))&&K0(p,S),I=I.createElement("link"),Vn(I);var P=I;P._p=new Promise(function(q,se){P.onload=q,P.onerror=se}),Vi(I,"link",p),d.instance=I}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(d,a),(a=d.state.preload)&&(d.state.loading&3)===0&&(s.count++,d=jd.bind(s),a.addEventListener("load",d),a.addEventListener("error",d))}}var J0=0;function EA(s,a){return s.stylesheets&&s.count===0&&Gd(s,s.stylesheets),0<s.count||0<s.imgCount?function(d){var p=setTimeout(function(){if(s.stylesheets&&Gd(s,s.stylesheets),s.unsuspend){var I=s.unsuspend;s.unsuspend=null,I()}},6e4+a);0<s.imgBytes&&J0===0&&(J0=62500*nA());var S=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Gd(s,s.stylesheets),s.unsuspend)){var I=s.unsuspend;s.unsuspend=null,I()}},(s.imgBytes>J0?50:800)+a);return s.unsuspend=d,function(){s.unsuspend=null,clearTimeout(p),clearTimeout(S)}}:null}function jd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Gd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Vd=null;function Gd(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Vd=new Map,a.forEach(_A,s),Vd=null,jd.call(s))}function _A(s,a){if(!(a.state.loading&4)){var d=Vd.get(s);if(d)var p=d.get(null);else{d=new Map,Vd.set(s,d);for(var S=s.querySelectorAll("link[data-precedence],style[data-precedence]"),I=0;I<S.length;I++){var P=S[I];(P.nodeName==="LINK"||P.getAttribute("media")!=="not all")&&(d.set(P.dataset.precedence,P),p=P)}p&&d.set(null,p)}S=a.instance,P=S.getAttribute("data-precedence"),I=d.get(P)||p,I===p&&d.set(null,S),d.set(P,S),this.count++,p=jd.bind(this),S.addEventListener("load",p),S.addEventListener("error",p),I?I.parentNode.insertBefore(S,I.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(S,s.firstChild)),a.state.loading|=4}}var nu={$$typeof:ee,Provider:null,Consumer:null,_currentValue:Me,_currentValue2:Me,_threadCount:0};function TA(s,a,d,p,S,I,P,q,se){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ii(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ii(0),this.hiddenUpdates=ii(null),this.identifierPrefix=p,this.onUncaughtError=S,this.onCaughtError=I,this.onRecoverableError=P,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=se,this.incompleteTransitions=new Map}function ry(s,a,d,p,S,I,P,q,se,be,Oe,Pe){return s=new TA(s,a,d,P,se,be,Oe,Pe,q),a=1,I===!0&&(a|=24),I=Ls(3,null,null,a),s.current=I,I.stateNode=s,a=Rf(),a.refCount++,s.pooledCache=a,a.refCount++,I.memoizedState={element:p,isDehydrated:d,cache:a},kf(I),s}function oy(s){return s?(s=yl,s):yl}function ay(s,a,d,p,S,I){S=oy(S),p.context===null?p.context=S:p.pendingContext=S,p=Yo(a),p.payload={element:d},I=I===void 0?null:I,I!==null&&(p.callback=I),d=Wo(s,p,a),d!==null&&(Ss(d,s,a),kc(d,s,a))}function ly(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var d=s.retryLane;s.retryLane=d!==0&&d<a?d:a}}function Q0(s,a){ly(s,a),(s=s.alternate)&&ly(s,a)}function cy(s){if(s.tag===13||s.tag===31){var a=Va(s,67108864);a!==null&&Ss(a,s,67108864),Q0(s,67108864)}}function uy(s){if(s.tag===13||s.tag===31){var a=Vs();a=Qn(a);var d=Va(s,a);d!==null&&Ss(d,s,a),Q0(s,a)}}var Hd=!0;function AA(s,a,d,p){var S=ne.T;ne.T=null;var I=ie.p;try{ie.p=2,Z0(s,a,d,p)}finally{ie.p=I,ne.T=S}}function SA(s,a,d,p){var S=ne.T;ne.T=null;var I=ie.p;try{ie.p=8,Z0(s,a,d,p)}finally{ie.p=I,ne.T=S}}function Z0(s,a,d,p){if(Hd){var S=em(p);if(S===null)F0(s,a,p,zd,d),hy(s,p);else if(NA(S,s,a,d,p))p.stopPropagation();else if(hy(s,p),a&4&&-1<CA.indexOf(s)){for(;S!==null;){var I=zt(S);if(I!==null)switch(I.tag){case 3:if(I=I.stateNode,I.current.memoizedState.isDehydrated){var P=Tn(I.pendingLanes);if(P!==0){var q=I;for(q.pendingLanes|=2,q.entangledLanes|=2;P;){var se=1<<31-_t(P);q.entanglements[1]|=se,P&=~se}kr(I),(pn&6)===0&&(Sd=On()+500,$c(0))}}break;case 31:case 13:q=Va(I,2),q!==null&&Ss(q,I,2),Nd(),Q0(I,2)}if(I=em(p),I===null&&F0(s,a,p,zd,d),I===S)break;S=I}S!==null&&p.stopPropagation()}else F0(s,a,p,null,d)}}function em(s){return s=ys(s),tm(s)}var zd=null;function tm(s){if(zd=null,s=kn(s),s!==null){var a=c(s);if(a===null)s=null;else{var d=a.tag;if(d===13){if(s=f(a),s!==null)return s;s=null}else if(d===31){if(s=y(a),s!==null)return s;s=null}else if(d===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return zd=s,null}function dy(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(qs()){case Ei:return 2;case Hr:return 8;case _i:case ci:return 32;case Do:return 268435456;default:return 32}default:return 32}}var nm=!1,sa=null,ra=null,oa=null,iu=new Map,su=new Map,aa=[],CA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function hy(s,a){switch(s){case"focusin":case"focusout":sa=null;break;case"dragenter":case"dragleave":ra=null;break;case"mouseover":case"mouseout":oa=null;break;case"pointerover":case"pointerout":iu.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":su.delete(a.pointerId)}}function ru(s,a,d,p,S,I){return s===null||s.nativeEvent!==I?(s={blockedOn:a,domEventName:d,eventSystemFlags:p,nativeEvent:I,targetContainers:[S]},a!==null&&(a=zt(a),a!==null&&cy(a)),s):(s.eventSystemFlags|=p,a=s.targetContainers,S!==null&&a.indexOf(S)===-1&&a.push(S),s)}function NA(s,a,d,p,S){switch(a){case"focusin":return sa=ru(sa,s,a,d,p,S),!0;case"dragenter":return ra=ru(ra,s,a,d,p,S),!0;case"mouseover":return oa=ru(oa,s,a,d,p,S),!0;case"pointerover":var I=S.pointerId;return iu.set(I,ru(iu.get(I)||null,s,a,d,p,S)),!0;case"gotpointercapture":return I=S.pointerId,su.set(I,ru(su.get(I)||null,s,a,d,p,S)),!0}return!1}function fy(s){var a=kn(s.target);if(a!==null){var d=c(a);if(d!==null){if(a=d.tag,a===13){if(a=f(d),a!==null){s.blockedOn=a,Je(s.priority,function(){uy(d)});return}}else if(a===31){if(a=y(d),a!==null){s.blockedOn=a,Je(s.priority,function(){uy(d)});return}}else if(a===3&&d.stateNode.current.memoizedState.isDehydrated){s.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}s.blockedOn=null}function qd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var d=em(s.nativeEvent);if(d===null){d=s.nativeEvent;var p=new d.constructor(d.type,d);Yr=p,d.target.dispatchEvent(p),Yr=null}else return a=zt(d),a!==null&&cy(a),s.blockedOn=d,!1;a.shift()}return!0}function my(s,a,d){qd(s)&&d.delete(a)}function IA(){nm=!1,sa!==null&&qd(sa)&&(sa=null),ra!==null&&qd(ra)&&(ra=null),oa!==null&&qd(oa)&&(oa=null),iu.forEach(my),su.forEach(my)}function Yd(s,a){s.blockedOn===a&&(s.blockedOn=null,nm||(nm=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,IA)))}var Wd=null;function gy(s){Wd!==s&&(Wd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Wd===s&&(Wd=null);for(var a=0;a<s.length;a+=3){var d=s[a],p=s[a+1],S=s[a+2];if(typeof p!="function"){if(tm(p||d)===null)continue;break}var I=zt(d);I!==null&&(s.splice(a,3),a-=3,e0(I,{pending:!0,data:S,method:d.method,action:p},p,S))}}))}function Gl(s){function a(se){return Yd(se,s)}sa!==null&&Yd(sa,s),ra!==null&&Yd(ra,s),oa!==null&&Yd(oa,s),iu.forEach(a),su.forEach(a);for(var d=0;d<aa.length;d++){var p=aa[d];p.blockedOn===s&&(p.blockedOn=null)}for(;0<aa.length&&(d=aa[0],d.blockedOn===null);)fy(d),d.blockedOn===null&&aa.shift();if(d=(s.ownerDocument||s).$$reactFormReplay,d!=null)for(p=0;p<d.length;p+=3){var S=d[p],I=d[p+1],P=S[cn]||null;if(typeof I=="function")P||gy(d);else if(P){var q=null;if(I&&I.hasAttribute("formAction")){if(S=I,P=I[cn]||null)q=P.formAction;else if(tm(S)!==null)continue}else q=P.action;typeof q=="function"?d[p+1]=q:(d.splice(p,3),p-=3),gy(d)}}}function py(){function s(I){I.canIntercept&&I.info==="react-transition"&&I.intercept({handler:function(){return new Promise(function(P){return S=P})},focusReset:"manual",scroll:"manual"})}function a(){S!==null&&(S(),S=null),p||setTimeout(d,20)}function d(){if(!p&&!navigation.transition){var I=navigation.currentEntry;I&&I.url!=null&&navigation.navigate(I.url,{state:I.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,S=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(d,100),function(){p=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),S!==null&&(S(),S=null)}}}function im(s){this._internalRoot=s}Xd.prototype.render=im.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var d=a.current,p=Vs();ay(d,p,s,a,null,null)},Xd.prototype.unmount=im.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;ay(s.current,2,null,s,null,null),Nd(),a[Di]=null}};function Xd(s){this._internalRoot=s}Xd.prototype.unstable_scheduleHydration=function(s){if(s){var a=Mi();s={blockedOn:null,target:s,priority:a};for(var d=0;d<aa.length&&a!==0&&a<aa[d].priority;d++);aa.splice(d,0,s),d===0&&fy(s)}};var xy=e.version;if(xy!=="19.2.3")throw Error(i(527,xy,"19.2.3"));ie.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=x(a),s=s!==null?A(s):null,s=s===null?null:s.stateNode,s};var RA={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kd.isDisabled&&Kd.supportsFiber)try{an=Kd.inject(RA),Ge=Kd}catch{}}return au.createRoot=function(s,a){if(!o(s))throw Error(i(299));var d=!1,p="",S=T1,I=A1,P=S1;return a!=null&&(a.unstable_strictMode===!0&&(d=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onUncaughtError!==void 0&&(S=a.onUncaughtError),a.onCaughtError!==void 0&&(I=a.onCaughtError),a.onRecoverableError!==void 0&&(P=a.onRecoverableError)),a=ry(s,1,!1,null,null,d,p,null,S,I,P,py),s[Di]=a.current,B0(s),new im(a)},au.hydrateRoot=function(s,a,d){if(!o(s))throw Error(i(299));var p=!1,S="",I=T1,P=A1,q=S1,se=null;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(S=d.identifierPrefix),d.onUncaughtError!==void 0&&(I=d.onUncaughtError),d.onCaughtError!==void 0&&(P=d.onCaughtError),d.onRecoverableError!==void 0&&(q=d.onRecoverableError),d.formState!==void 0&&(se=d.formState)),a=ry(s,1,!0,a,d??null,p,S,se,I,P,q,py),a.context=oy(null),d=a.current,p=Vs(),p=Qn(p),S=Yo(p),S.callback=null,Wo(d,S,p),d=p,a.current.lanes=d,zi(a,d),kr(a),s[Di]=a.current,B0(s),new Xd(a)},au.version="19.2.3",au}var Cy;function VA(){if(Cy)return om.exports;Cy=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),om.exports=jA(),om.exports}var GA=VA();const HA=wg(GA),zA="modulepreload",qA=function(n){return"/"+n},Ny={},YA=function(e,t,i){let o=Promise.resolve();if(t&&t.length>0){let f=function(x){return Promise.all(x.map(A=>Promise.resolve(A).then(N=>({status:"fulfilled",value:N}),N=>({status:"rejected",reason:N}))))};document.getElementsByTagName("link");const y=document.querySelector("meta[property=csp-nonce]"),w=(y==null?void 0:y.nonce)||(y==null?void 0:y.getAttribute("nonce"));o=f(t.map(x=>{if(x=qA(x),x in Ny)return;Ny[x]=!0;const A=x.endsWith(".css"),N=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${N}`))return;const R=document.createElement("link");if(R.rel=A?"stylesheet":zA,A||(R.as="script"),R.crossOrigin="",R.href=x,w&&R.setAttribute("nonce",w),document.head.appendChild(R),A)return new Promise((k,H)=>{R.addEventListener("load",k),R.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${x}`)))})}))}function c(f){const y=new Event("vite:preloadError",{cancelable:!0});if(y.payload=f,window.dispatchEvent(y),!y.defaultPrevented)throw f}return o.then(f=>{for(const y of f||[])y.status==="rejected"&&c(y.reason);return e().catch(c)})},ue=({name:n,className:e=""})=>{const t=oe.useRef(null);return oe.useEffect(()=>{if(t.current){const i=`<i data-lucide="${n}" class="${e}"></i>`;t.current.innerHTML=i,window.lucide&&window.lucide.createIcons()}},[n,e]),h.jsx("span",{ref:t,className:e})},WA=({page:n,label:e,icon:t,currentPage:i,setCurrentPage:o,activeColorClass:c})=>{const y=i===n?c:"text-gray-500 hover:text-gray-700";return h.jsxs("button",{onClick:()=>o(n),className:`nav-btn flex flex-col items-center justify-center p-3 w-full transition-colors ${y}`,children:[h.jsx(ue,{name:t}),h.jsx("span",{className:"text-xs font-medium",children:e})]})},XA=({currentPage:n,setCurrentPage:e,profile:t,allProfiles:i=[],onSwitchProfile:o,onAddProfile:c,children:f,mode:y="EXPLORER",config:w})=>{const[x,A]=oe.useState(!1),N=(w==null?void 0:w.themeColor)||"bg-teal-600",R=(w==null?void 0:w.homeTitle)||"Tiny Tastes",k=(w==null?void 0:w.navItems)||[{id:"tracker",label:"Tracker",icon:"grid-3x3"},{id:"recommendations",label:"Recs",icon:"lightbulb"},{id:"recipes",label:"Recipes",icon:"notebook-pen"},{id:"learn",label:"Learn",icon:"book-open"},{id:"profile",label:"Profile",icon:"user"}],H=(w==null?void 0:w.textColor)||"text-teal-600",W=te=>{o&&o(te),A(!1)},K=()=>{c&&c(),A(!1)};return h.jsxs("div",{className:"flex flex-col min-h-screen",children:[h.jsx("header",{className:`fixed top-0 left-0 right-0 ${N} shadow-md z-50 pt-safe transition-colors duration-500`,children:h.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:h.jsxs("div",{className:"flex justify-between items-center relative",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-white drop-shadow-sm",children:R}),h.jsxs("div",{className:"relative mt-1",children:[h.jsxs("button",{onClick:()=>A(!x),className:"flex items-center gap-1 text-sm text-white/90 font-medium hover:text-white transition-colors focus:outline-none",children:[h.jsxs("span",{children:["Tracking: ",h.jsx("span",{className:"font-bold border-b border-white/40",children:(t==null?void 0:t.babyName)||"Baby"})]}),h.jsx(ue,{name:"chevron-down",className:`w-3 h-3 transition-transform ${x?"rotate-180":""}`})]}),x&&h.jsx("div",{className:"absolute top-full left-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-100 overflow-hidden animate-fadeIn z-[60]",children:h.jsxs("div",{className:"py-1",children:[i.map(te=>h.jsxs("button",{onClick:()=>W(te.id),className:`w-full text-left px-4 py-2 text-sm flex items-center justify-between ${te.id===(t==null?void 0:t.id)?"bg-teal-50 text-teal-700 font-bold":"text-gray-700 hover:bg-gray-50"}`,children:[te.babyName,te.id===(t==null?void 0:t.id)&&h.jsx(ue,{name:"check",className:"w-3 h-3"})]},te.id)),h.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:h.jsxs("button",{onClick:K,className:"w-full text-left px-4 py-2 text-sm text-teal-600 font-bold hover:bg-gray-50 flex items-center gap-2",children:[h.jsx(ue,{name:"plus-circle",className:"w-4 h-4"})," Add Child"]})})]})})]})]}),h.jsx("div",{className:"bg-white/20 backdrop-blur-sm px-3 py-1 rounded-full border border-white/30",children:h.jsxs("span",{className:"text-[10px] sm:text-xs font-bold text-white uppercase tracking-wider",children:[y," MODE"]})})]})})}),x&&h.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>A(!1)}),h.jsx("main",{className:"flex-grow pt-[calc(76px+env(safe-area-inset-top))] sm:pt-[calc(88px+env(safe-area-inset-top))] pb-[calc(80px+env(safe-area-inset-bottom))]",children:h.jsx("div",{className:"max-w-7xl mx-auto w-full",children:h.jsx("div",{className:"page-content px-4 sm:px-6 lg:px-8",children:f})})}),h.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] z-40 pb-safe",children:h.jsx("div",{className:"max-w-7xl mx-auto flex justify-around px-2 sm:px-6 lg:px-8",children:k.map(te=>h.jsx(WA,{page:te.id,label:te.label,icon:te.icon,currentPage:n,setCurrentPage:e,activeColorClass:H},te.id))})})]})},KA=["Dairy","Lactose","Egg","Peanut","Tree Nut","Soy","Wheat","Fish","Shellfish","Sesame"],Iy={eaten:{color:"bg-green-50 border-green-200",icon:"check",label:"Ate it",text:"text-green-700"},touched:{color:"bg-yellow-50 border-yellow-200",icon:"hand",label:"Played/Touched",text:"text-yellow-700"},refused:{color:"bg-red-50 border-red-200",icon:"x",label:"Refused",text:"text-red-700"}},bh={touched:["Licked it","Played with it","Pushed away","Only one bite"],refused:["Threw it","Spat out","Cried","Gagged","Ignored it","Said No"]},um={TOMATOES:"red",STRAWBERRIES:"red",RASPBERRIES:"red",APPLES:"red",WATERMELON:"red","RED PEPPER":"red",CHERRIES:"red",POMEGRANATE:"red",BEETS:"red",CARROTS:"orange","SWEET POTATO":"orange",ORANGE:"orange",MANGO:"orange",PEACHES:"orange",CANTALOUPE:"orange",PAPAYA:"orange",PUMPKIN:"orange","BUTTERNUT SQUASH":"orange",APRICOT:"orange",BANANA:"yellow",CORN:"yellow",PINEAPPLE:"yellow","LEMON & LIME":"yellow",STARFRUIT:"yellow",SQUASH:"yellow","YELLOW PEPPER":"yellow",SPINACH:"green",BROCCOLI:"green",KALE:"green",PEAS:"green",AVOCADO:"green",KIWIFRUIT:"green",ASPARAGUS:"green",ZUCCHINI:"green","GREEN BEANS":"green",CUCUMBER:"green",CELERY:"green","BRUSSELS SPROUTS":"green",EDAMAME:"green",HONEYDEW:"green",PEARS:"green",BLUEBERRIES:"purple",EGGPLANT:"purple",GRAPES:"purple",BLACKBERRIES:"purple",PLUMS:"purple",FIGS:"purple","PURPLE CABBAGE":"purple"},uE=[{id:"green_machine",title:"The Green Machine",description:"Tried 10 green vegetables.",icon:"leaf",isUnlocked:!1,color:"text-green-600 bg-green-100 border-green-200"},{id:"fruit_ninja",title:"Fruit Ninja",description:"Tried 15 different fruits.",icon:"citrus",isUnlocked:!1,color:"text-orange-600 bg-orange-100 border-orange-200"},{id:"protein_power",title:"Protein Power",description:"Tried 5 different protein sources.",icon:"dumbbell",isUnlocked:!1,color:"text-blue-600 bg-blue-100 border-blue-200"},{id:"tried_10",title:"10 Foods Down!",description:"You are off to a great start.",icon:"star",isUnlocked:!1,color:"text-teal-600 bg-teal-100 border-teal-200"},{id:"tried_20",title:"20 Foods Tried",description:"Building that palate!",icon:"utensils",isUnlocked:!1,color:"text-indigo-600 bg-indigo-100 border-indigo-200"},{id:"tried_30",title:"30 Foods Milestone",description:"Getting adventurous.",icon:"compass",isUnlocked:!1,color:"text-violet-600 bg-violet-100 border-violet-200"},{id:"tried_40",title:"40 Foods",description:"Almost halfway there!",icon:"sandwich",isUnlocked:!1,color:"text-pink-600 bg-pink-100 border-pink-200"},{id:"tried_50",title:"Halfway Hero",description:"50 foods tried! Amazing progress.",icon:"award",isUnlocked:!1,color:"text-purple-600 bg-purple-100 border-purple-200"},{id:"tried_60",title:"60 Foods",description:"Exploring new flavors.",icon:"carrot",isUnlocked:!1,color:"text-fuchsia-600 bg-fuchsia-100 border-fuchsia-200"},{id:"tried_70",title:"70 Foods",description:"Serious foodie in the making.",icon:"chef-hat",isUnlocked:!1,color:"text-rose-600 bg-rose-100 border-rose-200"},{id:"tried_80",title:"80 Foods",description:"Only 20 to go!",icon:"flame",isUnlocked:!1,color:"text-orange-600 bg-orange-100 border-orange-200"},{id:"tried_90",title:"90 Foods",description:"The finish line is in sight.",icon:"zap",isUnlocked:!1,color:"text-yellow-600 bg-yellow-100 border-yellow-200"},{id:"100_club",title:"The 100 Club",description:"Tried all 100 foods!",icon:"trophy",isUnlocked:!1,color:"text-yellow-600 bg-yellow-100 border-yellow-200"}],dm=[{id:"puree",title:"Smooth Purees",desc:"Blended, liquidy foods.",icon:"soup"},{id:"mashed",title:"Mashed / Lumpy",desc:"Thicker textures mashed with a fork.",icon:"utensils"},{id:"finger_food",title:"Finger Foods",desc:"Soft pieces baby picks up.",icon:"hand"}],Jd=[{id:"sit_unassisted",title:"Sits Unassisted",icon:"baby",description:"Can sit in a high chair with minimal support.",isAchieved:!1},{id:"first_taste",title:"First Taste",icon:"utensils",description:"Tried their very first solid food.",isAchieved:!1},{id:"bring_to_mouth",title:"Self-Feeding",icon:"hand",description:"Successfully brought food to mouth independently.",isAchieved:!1},{id:"pincer_grasp",title:"Pincer Grasp",icon:"fingerprint",description:"Uses thumb and forefinger to pick up small pieces of food.",isAchieved:!1},{id:"open_cup",title:"Open Cup",icon:"cup-soda",description:"Took a sip from an open cup (even if messy!).",isAchieved:!1},{id:"straw_cup",title:"Straw Cup",icon:"milk",description:"Successfully drank from a straw.",isAchieved:!1},{id:"spoon_feed",title:"Spoon Master",icon:"utensils-crossed",description:"Loaded a spoon and brought it to mouth.",isAchieved:!1},{id:"chew_swallow",title:"Advanced Chewing",icon:"apple",description:"Chewed and swallowed a complex texture (like meat or bread).",isAchieved:!1}],Eh={YOGURT:["Dairy","Lactose"],MOZZARELLA:["Dairy","Lactose"],"RICOTTA CHEESE":["Dairy","Lactose"],"COTTAGE CHEESE":["Dairy","Lactose"],EGGS:["Egg"],KAMUT:["Wheat"],PASTA:["Wheat"],COUSCOUS:["Wheat"],BREAD:["Wheat"],FARRO:["Wheat"],BULGUR:["Wheat"],FREEKEH:["Wheat"],WAFFLES:["Wheat","Egg","Dairy"],"HEALTHY MUFFINS":["Wheat","Egg"],GNOCCHI:["Wheat"],TORTILLA:["Wheat"],TOFU:["Soy"],EDAMAME:["Soy"],PEANUTS:["Peanut"],"PEANUT BUTTER":["Peanut"],ALMONDS:["Tree Nut"],"ALMOND BUTTER":["Tree Nut"],COCONUT:["Tree Nut"],FISH:["Fish"],TUNA:["Fish"],SARDINES:["Fish"],SALMON:["Fish"],SHRIMP:["Shellfish"],SEEDS:["Sesame"]},Yh={Iron:{bg:"bg-red-100",text:"text-red-800",border:"border-red-200",icon:"battery-charging",label:"Iron"},"Vitamin C":{bg:"bg-orange-100",text:"text-orange-800",border:"border-orange-200",icon:"sun",label:"Vit C"},"Omega-3":{bg:"bg-blue-100",text:"text-blue-800",border:"border-blue-200",icon:"fish",label:"Omega-3"},Protein:{bg:"bg-purple-100",text:"text-purple-800",border:"border-purple-200",icon:"dumbbell",label:"Protein"},Fiber:{bg:"bg-emerald-100",text:"text-emerald-800",border:"border-emerald-200",icon:"leaf",label:"Fiber"},"Vitamin A":{bg:"bg-amber-100",text:"text-amber-800",border:"border-amber-200",icon:"eye",label:"Vit A"},Calcium:{bg:"bg-yellow-50",text:"text-yellow-800",border:"border-yellow-200",icon:"bone",label:"Calcium"},"Healthy Fats":{bg:"bg-cyan-100",text:"text-cyan-800",border:"border-cyan-200",icon:"droplet",label:"Healthy Fats"},Zinc:{bg:"bg-slate-100",text:"text-slate-800",border:"border-slate-200",icon:"shield",label:"Zinc"},Potassium:{bg:"bg-indigo-100",text:"text-indigo-800",border:"border-indigo-200",icon:"zap",label:"Potassium"},"Vitamin D":{bg:"bg-yellow-100",text:"text-yellow-800",border:"border-yellow-200",icon:"sun-medium",label:"Vit D"},Folate:{bg:"bg-green-50",text:"text-green-800",border:"border-green-200",icon:"sprout",label:"Folate"},Choline:{bg:"bg-pink-100",text:"text-pink-800",border:"border-pink-200",icon:"brain",label:"Choline"},"Vitamin B6":{bg:"bg-fuchsia-100",text:"text-fuchsia-800",border:"border-fuchsia-200",icon:"zap",label:"Vit B6"},"Vitamin B12":{bg:"bg-violet-100",text:"text-violet-800",border:"border-violet-200",icon:"zap",label:"Vit B12"},"Vitamin K":{bg:"bg-lime-100",text:"text-lime-800",border:"border-lime-200",icon:"droplet",label:"Vit K"},"Vitamin E":{bg:"bg-teal-100",text:"text-teal-800",border:"border-teal-200",icon:"droplet",label:"Vit E"},Magnesium:{bg:"bg-gray-100",text:"text-gray-800",border:"border-gray-200",icon:"layers",label:"Magnesium"},Antioxidants:{bg:"bg-rose-100",text:"text-rose-800",border:"border-rose-200",icon:"heart",label:"Antioxidants"},Hydration:{bg:"bg-sky-100",text:"text-sky-800",border:"border-sky-200",icon:"glass-water",label:"Hydration"},Selenium:{bg:"bg-indigo-50",text:"text-indigo-700",border:"border-indigo-200",icon:"sparkles",label:"Selenium"},Probiotics:{bg:"bg-cyan-50",text:"text-cyan-700",border:"border-cyan-200",icon:"biceps-flexed",label:"Probiotics"}},Jl={ASPARAGUS:["Fiber","Folate","Vitamin K","Antioxidants"],"BUTTERNUT SQUASH":["Vitamin A","Fiber","Potassium","Vitamin C"],CAULIFLOWER:["Vitamin C","Fiber","Vitamin K","Choline"],"SWEET POTATO":["Vitamin A","Fiber","Potassium","Vitamin B6"],POTATOES:["Potassium","Vitamin C","Fiber","Vitamin B6"],PARSNIPS:["Fiber","Vitamin C","Folate"],"BELL PEPPERS":["Vitamin C","Vitamin A","Fiber","Vitamin B6"],BEETS:["Folate","Fiber","Potassium"],"CHAYOTE SQUASH":["Folate","Fiber","Vitamin C"],PUMPKIN:["Vitamin A","Fiber","Potassium"],CARROTS:["Vitamin A","Fiber","Vitamin K","Potassium"],ZUCCHINI:["Folate","Potassium","Vitamin A"],MUSHROOMS:["Vitamin D","Magnesium","Potassium"],ONION:["Vitamin C","Potassium"],"BRUSSELS SPROUTS":["Vitamin K","Vitamin C","Fiber","Folate"],CORN:["Fiber","Magnesium"],CUCUMBER:["Hydration","Vitamin K"],CELERY:["Hydration","Vitamin K","Folate"],PEAS:["Protein","Fiber","Vitamin A","Vitamin K"],"SNAP PEAS":["Vitamin C","Fiber","Vitamin K"],CILANTRO:["Vitamin K","Antioxidants"],EGGPLANT:["Fiber","Antioxidants"],GARLIC:["Vitamin B6","Vitamin C"],PARSLEY:["Vitamin K","Vitamin C","Vitamin A"],KALE:["Vitamin K","Vitamin C","Calcium","Fiber"],ARTICHOKE:["Fiber","Vitamin K","Folate"],BROCCOLI:["Vitamin C","Iron","Fiber","Calcium","Vitamin K"],KAMUT:["Protein","Fiber","Zinc"],CEREALS:["Iron","Zinc"],MILLET:["Magnesium","Antioxidants"],OATMEAL:["Iron","Fiber","Zinc","Magnesium"],BUCKWHEAT:["Fiber","Magnesium"],WAFFLES:["Iron"],"HEALTHY MUFFINS":["Fiber"],PASTA:["Iron"],COUSCOUS:["Selenium"],POLENTA:["Vitamin A"],CORNMEAL:["Iron"],BREAD:["Iron","Fiber"],GNOCCHI:["Potassium"],TORTILLA:["Calcium"],FARRO:["Fiber","Protein","Magnesium","Zinc"],BARLEY:["Fiber","Selenium"],BULGUR:["Fiber","Magnesium"],"BROWN RICE":["Fiber","Magnesium"],QUINOA:["Protein","Iron","Fiber","Magnesium","Folate"],FREEKEH:["Fiber","Protein"],AVOCADO:["Healthy Fats","Fiber","Potassium","Vitamin E"],TOMATOES:["Vitamin C","Antioxidants","Vitamin K"],ORANGE:["Vitamin C","Fiber","Folate"],"LEMON & LIME":["Vitamin C"],PAPAYA:["Vitamin C","Vitamin A","Folate"],PINEAPPLE:["Vitamin C","Magnesium"],KIWIFRUIT:["Vitamin C","Fiber","Vitamin K"],MANGO:["Vitamin C","Vitamin A","Folate"],STARFRUIT:["Vitamin C"],FIGS:["Fiber","Potassium","Calcium"],BANANA:["Potassium","Fiber","Vitamin B6","Vitamin C"],COCONUT:["Healthy Fats","Magnesium"],WATERMELON:["Hydration","Vitamin C"],HONEYDEW:["Vitamin C","Potassium"],CANTALOUPE:["Vitamin A","Vitamin C"],APPLESAUCE:["Vitamin C"],RASPBERRIES:["Fiber","Vitamin C"],BLUEBERRIES:["Antioxidants","Vitamin C","Fiber","Vitamin K"],STRAWBERRIES:["Vitamin C","Folate","Antioxidants"],GRAPES:["Vitamin K","Hydration"],PEACHES:["Vitamin C","Vitamin A","Potassium"],PEARS:["Fiber","Vitamin C"],APPLES:["Fiber","Vitamin C"],TOFU:["Protein","Iron","Calcium"],EDAMAME:["Protein","Iron","Fiber","Folate"],PEANUTS:["Protein","Healthy Fats","Vitamin E"],ALMONDS:["Healthy Fats","Protein","Vitamin E","Magnesium"],"WHITE BEANS":["Iron","Protein","Fiber","Calcium"],CHICKPEAS:["Iron","Protein","Fiber","Folate"],"BLACK BEANS":["Iron","Protein","Fiber","Magnesium"],"KIDNEY BEANS":["Iron","Protein","Fiber","Folate"],LENTILS:["Iron","Protein","Fiber","Folate"],"ALMOND BUTTER":["Healthy Fats","Protein","Vitamin E"],"PEANUT BUTTER":["Protein","Healthy Fats","Vitamin E"],SEEDS:["Fiber","Healthy Fats","Iron","Magnesium"],FISH:["Protein","Omega-3","Vitamin B12"],TUNA:["Protein","Omega-3","Vitamin B12"],SARDINES:["Omega-3","Calcium","Iron","Protein","Vitamin D"],SALMON:["Omega-3","Protein","Vitamin D","Vitamin B12"],SHRIMP:["Protein","Vitamin B12"],"BEEF, SLICED":["Iron","Protein","Zinc","Vitamin B12"],"BEEF, GROUND":["Iron","Protein","Zinc","Vitamin B12"],CHICKEN:["Protein","Iron","Zinc","Vitamin B6"],LAMB:["Iron","Protein","Zinc","Vitamin B12"],TURKEY:["Protein","Iron","Zinc"],PORK:["Protein","Zinc"],YOGURT:["Calcium","Protein","Probiotics","Vitamin B12"],EGGS:["Protein","Choline","Iron","Vitamin D"],MOZZARELLA:["Calcium","Protein"],"RICOTTA CHEESE":["Calcium","Protein","Vitamin A"],"COTTAGE CHEESE":["Protein","Calcium"],WATER:["Hydration"],"SPICES & HERBS":["Antioxidants"]},Ns=[{category:"Vegetables",color:"bg-green-100",textColor:"text-green-800",borderColor:"border-green-300",items:[{name:"ASPARAGUS",emoji:""},{name:"BUTTERNUT SQUASH",emoji:""},{name:"CAULIFLOWER",emoji:""},{name:"SWEET POTATO",emoji:""},{name:"POTATOES",emoji:""},{name:"PARSNIPS",emoji:""},{name:"BELL PEPPERS",emoji:""},{name:"BEETS",emoji:""},{name:"CHAYOTE SQUASH",emoji:""},{name:"PUMPKIN",emoji:""},{name:"CARROTS",emoji:""},{name:"ZUCCHINI",emoji:""},{name:"MUSHROOMS",emoji:""},{name:"ONION",emoji:""},{name:"BRUSSELS SPROUTS",emoji:""},{name:"CORN",emoji:""},{name:"CUCUMBER",emoji:""},{name:"CELERY",emoji:""},{name:"PEAS",emoji:""},{name:"SNAP PEAS",emoji:""},{name:"CILANTRO",emoji:""},{name:"EGGPLANT",emoji:""},{name:"GARLIC",emoji:""},{name:"PARSLEY",emoji:""},{name:"KALE",emoji:""},{name:"ARTICHOKE",emoji:""},{name:"BROCCOLI",emoji:""}]},{category:"Grains",color:"bg-yellow-100",textColor:"text-yellow-800",borderColor:"border-yellow-300",items:[{name:"KAMUT",emoji:""},{name:"CEREALS",emoji:""},{name:"MILLET",emoji:""},{name:"OATMEAL",emoji:""},{name:"BUCKWHEAT",emoji:""},{name:"WAFFLES",emoji:""},{name:"HEALTHY MUFFINS",emoji:""},{name:"PASTA",emoji:""},{name:"COUSCOUS",emoji:""},{name:"POLENTA",emoji:""},{name:"CORNMEAL",emoji:""},{name:"BREAD",emoji:""},{name:"GNOCCHI",emoji:""},{name:"TORTILLA",emoji:""},{name:"FARRO",emoji:""},{name:"BARLEY",emoji:""},{name:"BULGUR",emoji:""},{name:"BROWN RICE",emoji:""},{name:"QUINOA",emoji:""},{name:"FREEKEH",emoji:""}]},{category:"Fruits",color:"bg-pink-100",textColor:"text-pink-800",borderColor:"border-pink-300",items:[{name:"AVOCADO",emoji:""},{name:"TOMATOES",emoji:""},{name:"ORANGE",emoji:""},{name:"LEMON & LIME",emoji:""},{name:"PAPAYA",emoji:""},{name:"PINEAPPLE",emoji:""},{name:"KIWIFRUIT",emoji:""},{name:"MANGO",emoji:""},{name:"STARFRUIT",emoji:""},{name:"FIGS",emoji:""},{name:"BANANA",emoji:""},{name:"COCONUT",emoji:""},{name:"WATERMELON",emoji:""},{name:"HONEYDEW",emoji:""},{name:"CANTALOUPE",emoji:""},{name:"APPLESAUCE",emoji:""},{name:"RASPBERRIES",emoji:""},{name:"BLUEBERRIES",emoji:""},{name:"STRAWBERRIES",emoji:""},{name:"GRAPES",emoji:""},{name:"PEACHES",emoji:""},{name:"PEARS",emoji:""},{name:"APPLES",emoji:""}]},{category:"Plant Protein",color:"bg-blue-100",textColor:"text-blue-800",borderColor:"border-blue-300",items:[{name:"TOFU",emoji:""},{name:"EDAMAME",emoji:""},{name:"PEANUTS",emoji:""},{name:"ALMONDS",emoji:""},{name:"WHITE BEANS",emoji:""},{name:"CHICKPEAS",emoji:""},{name:"BLACK BEANS",emoji:""},{name:"KIDNEY BEANS",emoji:""},{name:"LENTILS",emoji:""},{name:"ALMOND BUTTER",emoji:""},{name:"PEANUT BUTTER",emoji:""},{name:"SEEDS",emoji:""}]},{category:"Meat",color:"bg-red-100",textColor:"text-red-800",borderColor:"border-red-300",items:[{name:"FISH",emoji:""},{name:"TUNA",emoji:""},{name:"SARDINES",emoji:""},{name:"SALMON",emoji:""},{name:"SHRIMP",emoji:""},{name:"BEEF, SLICED",emoji:""},{name:"BEEF, GROUND",emoji:""},{name:"CHICKEN",emoji:""},{name:"LAMB",emoji:""},{name:"TURKEY",emoji:""},{name:"PORK",emoji:""}]},{category:"Dairy & Eggs",color:"bg-purple-100",textColor:"text-purple-800",borderColor:"border-purple-300",items:[{name:"YOGURT",emoji:""},{name:"EGGS",emoji:""},{name:"MOZZARELLA",emoji:""},{name:"RICOTTA CHEESE",emoji:""},{name:"COTTAGE CHEESE",emoji:""}]},{category:"Other",color:"bg-gray-100",textColor:"text-gray-800",borderColor:"border-gray-300",items:[{name:"WATER",emoji:""},{name:"SPICES & HERBS",emoji:""}]}],ac=Ns.flatMap(n=>n.items.map(e=>e.name)),$A=ac.length,JA={ASPARAGUS:{allergyRisk:"Low",chokingRisk:"Low (when soft-cooked)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Steam or roast whole asparagus spears until very tender. Offer the whole spear for baby to gnaw on. The fibrous end is tough to chew through, reducing risk.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Continue serving whole, soft-cooked spears. As pincer grasp develops, you can chop the soft-cooked tips and stems into small, bite-sized pieces.</p>"},AVOCADO:{allergyRisk:"Low",chokingRisk:"Low",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Offer large, ripe wedges that baby can grip with their whole hand (palmar grasp). You can roll the wedge in hemp seeds or crushed cereal to make it less slippery.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Cut into smaller, bite-sized chunks as baby develops their pincer grasp.</p>"},BANANA:{allergyRisk:"Low",chokingRisk:"Low",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Offer half a peeled banana. You can leave a bit of peel on the bottom to help baby grip it (wash peel first). Or push a finger down the center to split it into natural thirds.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Cut into small slices or chunks.</p>"},"SWEET POTATO":{allergyRisk:"Low",chokingRisk:"Low (when soft)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Steam or roast wedges until very soft. They should be easily squashed between your fingers.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Cut into smaller cubes. You can also mash it.</p>"},CARROTS:{allergyRisk:"Low",chokingRisk:"High (if raw)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p><strong>MUST be cooked soft.</strong> Steam or roast whole carrots until they are completely soft. Do not serve raw.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Cut cooked carrots into small pieces. Grated raw carrot is also okay.</p>"},BROCCOLI:{allergyRisk:"Low",chokingRisk:"Low",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Steam large florets until soft. The 'handle' (stalk) is easy for babies to hold.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Chop into smaller pieces, including the florets.</p>"},"BUTTERNUT SQUASH":{allergyRisk:"Low",chokingRisk:"Low (cooked)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Roast large crescent-shaped wedges until soft. Remove seeds and skin. The natural curve makes it easy for baby to hold.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Cut into small, bite-sized cubes.</p>"},CAULIFLOWER:{allergyRisk:"Low",chokingRisk:"Low (cooked)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Steam large florets until soft. Baby can hold the stem.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Chop into small pieces.</p>"},ZUCCHINI:{allergyRisk:"Low",chokingRisk:"Low",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Steam large spears or wedges until soft. If the skin is tough, peel it off in stripes.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Chopped pieces or half-moons.</p>"},"BELL PEPPERS":{allergyRisk:"Low",chokingRisk:"Low (cooked)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Roast large quarters until skin peels off easily. Remove skin and serve soft strips.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Chopped cooked peppers.</p>"},EGGS:{allergyRisk:"High (Common Allergen)",chokingRisk:"Low",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Serve omelet strips roughly the size of two adult fingers. Ensure egg is fully cooked.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Scrambled eggs or hard-boiled egg pieces.</p>"},"PEANUT BUTTER":{allergyRisk:"High (Common Allergen)",chokingRisk:"High (if thick)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p><strong>Never serve plain thick peanut butter.</strong> Thin it out with water, breastmilk, or formula, or stir it into oatmeal/yogurt.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Spread thinly on toast strips.</p>"},YOGURT:{allergyRisk:"High (Dairy)",chokingRisk:"Low",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Serve plain, whole-milk yogurt on a pre-loaded spoon for baby to grab, or let them use their hands.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Continue with pre-loaded spoons or practice dipping fruit.</p>"},SALMON:{allergyRisk:"High (Fish)",chokingRisk:"Low (bones)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Cook until well-done and flake it to ensure there are absolutely no bones. Serve large flakes.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Continue serving flakes or mix into mashed potatoes.</p>"},CHICKEN:{allergyRisk:"Low",chokingRisk:"Medium",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Serve a large drumstick (skin and cartilage removed) for baby to gnaw on, or slow-cooked shredded thigh meat.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Chopped pieces of soft chicken or ground chicken.</p>"},APPLE:{allergyRisk:"Low",chokingRisk:"High (raw)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p><strong>Cook until soft.</strong> Steam or bake wedges. Do not serve raw slices.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Grated raw apple or very thin slices.</p>"},BLUEBERRIES:{allergyRisk:"Low",chokingRisk:"High (whole)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p><strong>Flatten or quarter</strong> every single berry. Never serve whole round berries.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Continue to flatten or quarter.</p>"},STRAWBERRIES:{allergyRisk:"Low",chokingRisk:"Low",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Serve large, whole berries (larger than baby's mouth) so they can gnaw on them.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Chop into small pieces.</p>"},OATMEAL:{allergyRisk:"Low",chokingRisk:"Low",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Serve thick enough to stick to a spoon (pre-load spoon) or roll into balls.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Baby can practice scooping with a spoon or eating oatmeal fingers.</p>"},PASTA:{allergyRisk:"High (Wheat/Egg)",chokingRisk:"Low",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Large pasta shapes like Fusilli or Penne cooked very soft. Serve plain or with a little oil/sauce.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Cut up spaghetti or continue with shapes. Macaroni is great for pincer grasp.</p>"},WATERMELON:{allergyRisk:"Low",chokingRisk:"Low",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Remove seeds. Serve large rectangular strips with rind removed.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Cut into bite-sized pieces.</p>"},TOFU:{allergyRisk:"High (Soy)",chokingRisk:"Low",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Serve large strips of firm tofu. It is soft and easy to gum.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Cut into cubes.</p>"},CUCUMBER:{allergyRisk:"Low",chokingRisk:"Medium",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Serve long, wide spears with the skin removed if it's tough. Avoid round slices.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Small pieces or thin half-moons.</p>"},CHEESE:{allergyRisk:"High (Dairy)",chokingRisk:"Medium",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Grated cheese or very thin slices. Avoid cubes.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Small pieces or shreds.</p>"},BREAD:{allergyRisk:"High (Wheat)",chokingRisk:"Medium (gummy)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Toast lightly and serve in strips. Soft bread can ball up and cause gagging, toast holds shape better.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Small pieces of toast with toppings.</p>"},"BEEF, GROUND":{allergyRisk:"Low",chokingRisk:"Low",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Cook into meatballs or logs that are easy to hold.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Crumbled ground beef.</p>"},ORANGE:{allergyRisk:"Low",chokingRisk:"Medium (membranes)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Cut into wedges with the membrane and peel removed (supremes).</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Cut segments into smaller pieces.</p>"},TOMATOES:{allergyRisk:"Low (Acidic)",chokingRisk:"Medium (Cherry tomatoes)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Large wedges of big tomatoes. If serving cherry tomatoes, <strong>quarter them lengthwise</strong>.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Small pieces.</p>"},PEARS:{allergyRisk:"Low",chokingRisk:"Low (if ripe)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>If very soft/ripe, serve in large halves/quarters. If hard, steam until soft.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Small bite-sized pieces.</p>"},MUSHROOMS:{allergyRisk:"Low",chokingRisk:"Medium (if rubbery)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Cook very well (saut or steam) until soft. Serve large whole caps or large slices.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Chopped cooked mushrooms.</p>"},ONION:{allergyRisk:"Low",chokingRisk:"Low (cooked)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Roast large wedges until sweet and soft.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Chopped cooked onion mixed into other dishes.</p>"},CORN:{allergyRisk:"Low",chokingRisk:"Medium (loose kernels)",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Serve on the cob! Baby can gnaw on the kernels.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Cut kernels off the cob. Flatten them slightly if possible.</p>"},EGGPLANT:{allergyRisk:"Low",chokingRisk:"Low",serve6to8:"<h4 class='font-semibold'>6-8 Months:</h4><p>Roast strips or rounds until very soft. Leave skin on to help it hold together, or peel if preferred.</p>",serve9to12:"<h4 class='font-semibold mt-4'>9-12 Months:</h4><p>Chopped cooked eggplant.</p>"}},hm={too_young:{title:"Preparing for Solids",message:"Your baby is getting ready! Watch for signs like sitting up unassisted and bringing toys to their mouth. Consult your pediatrician before starting.",foods:[]},"6_months":{title:"6 Months: First Tastes",message:"Focus on iron-rich foods and easy-to-hold shapes (strips). Let baby explore textures.",foods:["AVOCADO","SWEET POTATO","BANANA","BROCCOLI","BEEF, SLICED","OATMEAL","BUTTERNUT SQUASH","CARROTS","PEARS","CHICKEN"]},"7_8_months":{title:"7-8 Months: Allergens & Flavors",message:"Introduce top allergens one at a time. Mix flavors and offer lumpy mashed textures.",foods:["EGGS","PEANUT BUTTER","SALMON","YOGURT","TOFU","STRAWBERRIES","LENTILS","ALMOND BUTTER","MANGO","CAULIFLOWER"]},"9_11_months":{title:"9-11 Months: Pincer Grasp",message:"Baby is using thumb and forefinger. Offer smaller, bite-sized pieces (like a chickpea).",foods:["BLUEBERRIES","PEAS","MOZZARELLA","PASTA","CHICKPEAS","BEEF, GROUND","CORN","SNAP PEAS","KIWIFRUIT","QUINOA"]},"12_plus":{title:"12+ Months: Table Foods",message:"Baby can eat most family meals! Watch sodium/sugar. Continue offering variety.",foods:["TOMATOES","MUSHROOMS","SPINACH","SHRIMP","BELL PEPPERS","EGGPLANT","PORK","ORANGE","APPLES","ZUCCHINI"]}},QA={NEWBORN:{guides:[{title:"Breastfeeding 101",icon:"milk",content:"Focus on a deep latch. Feed on demand and watch for hunger cues like rooting or sucking on hands."},{title:"Formula Safety",icon:"droplet",content:"Always follow preparation instructions exactly. Use boiled water (cooled) if recommended."}],research:[{title:"Sleep Cycles",icon:"moon",content:"Newborns have shorter sleep cycles (approx 45-50 mins) and spend more time in active sleep."}]},EXPLORER:{guides:[{title:"Gagging vs Choking",icon:"alert-triangle",content:"Gagging is loud and red; choking is silent and blue. Gagging is a safety reflex."},{title:"The 100 Foods Challenge",icon:"trophy",content:"Exposing baby to 100 foods before age 1 reduces pickiness and potential allergies."}],research:[{title:"Iron Importance",icon:"battery-charging",content:"Iron stores from birth deplete around 6 months, making dietary iron crucial."}]},TODDLER:{guides:[{title:"Division of Responsibility",icon:"scale",content:"You decide what, when, and where; they decide how much and whether to eat."},{title:"Food Throwing",icon:"x-circle",content:"It's normal testing of boundaries. Calmly remove the food if it continues."}],research:[{title:"Neophobia",icon:"frown",content:"Fear of new foods peaks around 18-24 months. Keep offering without pressure."}]}};var ZA={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let eS,tS;function nS(){return{geminiUrl:eS,vertexUrl:tS}}function iS(n,e,t,i){var o,c;if(!(n!=null&&n.baseUrl)){const f=nS();return e?(o=f.vertexUrl)!==null&&o!==void 0?o:t:(c=f.geminiUrl)!==null&&c!==void 0?c:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class No{}function et(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){const c=e[o];return c!=null?String(c):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function T(n,e,t){for(let c=0;c<e.length-1;c++){const f=e[c];if(f.endsWith("[]")){const y=f.slice(0,-2);if(!(y in n))if(Array.isArray(t))n[y]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${f}`);if(Array.isArray(n[y])){const w=n[y];if(Array.isArray(t))for(let x=0;x<w.length;x++){const A=w[x];T(A,e.slice(c+1),t[x])}else for(const x of w)T(x,e.slice(c+1),t)}return}else if(f.endsWith("[0]")){const y=f.slice(0,-3);y in n||(n[y]=[{}]);const w=n[y];T(w[0],e.slice(c+1),t);return}(!n[f]||typeof n[f]!="object")&&(n[f]={}),n=n[f]}const i=e[e.length-1],o=n[i];if(o!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===o)return;if(typeof o=="object"&&typeof t=="object"&&o!==null&&t!==null)Object.assign(o,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function b(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const o=e[i];if(o.endsWith("[]")){const c=o.slice(0,-2);if(c in n){const f=n[c];return Array.isArray(f)?f.map(y=>b(y,e.slice(i+1),t)):t}else return t}else n=n[o]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function sS(n,e){for(const[t,i]of Object.entries(e)){const o=t.split("."),c=i.split("."),f=new Set;let y=-1;for(let w=0;w<o.length;w++)if(o[w]==="*"){y=w;break}if(y!==-1&&c.length>y)for(let w=y;w<c.length;w++){const x=c[w];x!=="*"&&!x.endsWith("[]")&&!x.endsWith("[0]")&&f.add(x)}Mm(n,o,c,0,f)}}function Mm(n,e,t,i,o){if(i>=e.length||typeof n!="object"||n===null)return;const c=e[i];if(c.endsWith("[]")){const f=c.slice(0,-2),y=n;if(f in y&&Array.isArray(y[f]))for(const w of y[f])Mm(w,e,t,i+1,o)}else if(c==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const f=n,y=Object.keys(f).filter(x=>!x.startsWith("_")&&!o.has(x)),w={};for(const x of y)w[x]=f[x];for(const[x,A]of Object.entries(w)){const N=[];for(const R of t.slice(i))R==="*"?N.push(x):N.push(R);T(f,N,A)}for(const x of y)delete f[x]}}else{const f=n;c in f&&Mm(f[c],e,t,i+1,o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Eg(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rS(n){const e={},t=b(n,["operationName"]);t!=null&&T(e,["operationName"],t);const i=b(n,["resourceName"]);return i!=null&&T(e,["_url","resourceName"],i),e}function oS(n){const e={},t=b(n,["name"]);t!=null&&T(e,["name"],t);const i=b(n,["metadata"]);i!=null&&T(e,["metadata"],i);const o=b(n,["done"]);o!=null&&T(e,["done"],o);const c=b(n,["error"]);c!=null&&T(e,["error"],c);const f=b(n,["response","generateVideoResponse"]);return f!=null&&T(e,["response"],lS(f)),e}function aS(n){const e={},t=b(n,["name"]);t!=null&&T(e,["name"],t);const i=b(n,["metadata"]);i!=null&&T(e,["metadata"],i);const o=b(n,["done"]);o!=null&&T(e,["done"],o);const c=b(n,["error"]);c!=null&&T(e,["error"],c);const f=b(n,["response"]);return f!=null&&T(e,["response"],cS(f)),e}function lS(n){const e={},t=b(n,["generatedSamples"]);if(t!=null){let c=t;Array.isArray(c)&&(c=c.map(f=>uS(f))),T(e,["generatedVideos"],c)}const i=b(n,["raiMediaFilteredCount"]);i!=null&&T(e,["raiMediaFilteredCount"],i);const o=b(n,["raiMediaFilteredReasons"]);return o!=null&&T(e,["raiMediaFilteredReasons"],o),e}function cS(n){const e={},t=b(n,["videos"]);if(t!=null){let c=t;Array.isArray(c)&&(c=c.map(f=>dS(f))),T(e,["generatedVideos"],c)}const i=b(n,["raiMediaFilteredCount"]);i!=null&&T(e,["raiMediaFilteredCount"],i);const o=b(n,["raiMediaFilteredReasons"]);return o!=null&&T(e,["raiMediaFilteredReasons"],o),e}function uS(n){const e={},t=b(n,["video"]);return t!=null&&T(e,["video"],xS(t)),e}function dS(n){const e={},t=b(n,["_self"]);return t!=null&&T(e,["video"],yS(t)),e}function hS(n){const e={},t=b(n,["operationName"]);return t!=null&&T(e,["_url","operationName"],t),e}function fS(n){const e={},t=b(n,["operationName"]);return t!=null&&T(e,["_url","operationName"],t),e}function mS(n){const e={},t=b(n,["name"]);t!=null&&T(e,["name"],t);const i=b(n,["metadata"]);i!=null&&T(e,["metadata"],i);const o=b(n,["done"]);o!=null&&T(e,["done"],o);const c=b(n,["error"]);c!=null&&T(e,["error"],c);const f=b(n,["response"]);return f!=null&&T(e,["response"],gS(f)),e}function gS(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["parent"]);i!=null&&T(e,["parent"],i);const o=b(n,["documentName"]);return o!=null&&T(e,["documentName"],o),e}function dE(n){const e={},t=b(n,["name"]);t!=null&&T(e,["name"],t);const i=b(n,["metadata"]);i!=null&&T(e,["metadata"],i);const o=b(n,["done"]);o!=null&&T(e,["done"],o);const c=b(n,["error"]);c!=null&&T(e,["error"],c);const f=b(n,["response"]);return f!=null&&T(e,["response"],pS(f)),e}function pS(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["parent"]);i!=null&&T(e,["parent"],i);const o=b(n,["documentName"]);return o!=null&&T(e,["documentName"],o),e}function xS(n){const e={},t=b(n,["uri"]);t!=null&&T(e,["uri"],t);const i=b(n,["encodedVideo"]);i!=null&&T(e,["videoBytes"],Eg(i));const o=b(n,["encoding"]);return o!=null&&T(e,["mimeType"],o),e}function yS(n){const e={},t=b(n,["gcsUri"]);t!=null&&T(e,["uri"],t);const i=b(n,["bytesBase64Encoded"]);i!=null&&T(e,["videoBytes"],Eg(i));const o=b(n,["mimeType"]);return o!=null&&T(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ry;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Ry||(Ry={}));var My;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(My||(My={}));var Dy;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(Dy||(Dy={}));var We;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(We||(We={}));var Oy;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Oy||(Oy={}));var ky;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(ky||(ky={}));var Py;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Py||(Py={}));var Ly;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Ly||(Ly={}));var Uy;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Uy||(Uy={}));var By;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(By||(By={}));var Fy;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Fy||(Fy={}));var jy;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(jy||(jy={}));var Vy;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Vy||(Vy={}));var Gy;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(Gy||(Gy={}));var Hy;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Hy||(Hy={}));var zy;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(zy||(zy={}));var qy;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(qy||(qy={}));var Yy;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(Yy||(Yy={}));var Wy;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Wy||(Wy={}));var Tu;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Tu||(Tu={}));var Xy;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Xy||(Xy={}));var Ky;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Ky||(Ky={}));var $y;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})($y||($y={}));var Dm;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Dm||(Dm={}));var Jy;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Jy||(Jy={}));var Qy;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(Qy||(Qy={}));var Zy;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(Zy||(Zy={}));var ev;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(ev||(ev={}));var tv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(tv||(tv={}));var nv;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(nv||(nv={}));var iv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(iv||(iv={}));var sv;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(sv||(sv={}));var rv;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(rv||(rv={}));var ov;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(ov||(ov={}));var av;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(av||(av={}));var lv;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(lv||(lv={}));var cv;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(cv||(cv={}));var uv;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(uv||(uv={}));var dv;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(dv||(dv={}));var hv;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(hv||(hv={}));var fv;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(fv||(fv={}));var mv;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(mv||(mv={}));var gv;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(gv||(gv={}));var pv;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(pv||(pv={}));var xv;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(xv||(xv={}));var yv;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(yv||(yv={}));var vv;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(vv||(vv={}));var wv;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(wv||(wv={}));var bv;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(bv||(bv={}));var Ev;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Ev||(Ev={}));var _v;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(_v||(_v={}));var Tv;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(Tv||(Tv={}));var Av;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Av||(Av={}));var Sv;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Sv||(Sv={}));var Cv;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(Cv||(Cv={}));var Xl;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Xl||(Xl={}));class Om{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class lu{get text(){var e,t,i,o,c,f,y,w;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let x="",A=!1;const N=[];for(const R of(w=(y=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||y===void 0?void 0:y.parts)!==null&&w!==void 0?w:[]){for(const[k,H]of Object.entries(R))k!=="text"&&k!=="thought"&&k!=="thoughtSignature"&&(H!==null||H!==void 0)&&N.push(k);if(typeof R.text=="string"){if(typeof R.thought=="boolean"&&R.thought)continue;A=!0,x+=R.text}}return N.length>0&&console.warn(`there are non-text parts ${N} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),A?x:void 0}get data(){var e,t,i,o,c,f,y,w;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let x="";const A=[];for(const N of(w=(y=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||y===void 0?void 0:y.parts)!==null&&w!==void 0?w:[]){for(const[R,k]of Object.entries(N))R!=="inlineData"&&(k!==null||k!==void 0)&&A.push(R);N.inlineData&&typeof N.inlineData.data=="string"&&(x+=atob(N.inlineData.data))}return A.length>0&&console.warn(`there are non-data parts ${A} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),x.length>0?btoa(x):void 0}get functionCalls(){var e,t,i,o,c,f,y,w;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const x=(w=(y=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||y===void 0?void 0:y.parts)===null||w===void 0?void 0:w.filter(A=>A.functionCall).map(A=>A.functionCall).filter(A=>A!==void 0);if((x==null?void 0:x.length)!==0)return x}get executableCode(){var e,t,i,o,c,f,y,w,x;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const A=(w=(y=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||y===void 0?void 0:y.parts)===null||w===void 0?void 0:w.filter(N=>N.executableCode).map(N=>N.executableCode).filter(N=>N!==void 0);if((A==null?void 0:A.length)!==0)return(x=A==null?void 0:A[0])===null||x===void 0?void 0:x.code}get codeExecutionResult(){var e,t,i,o,c,f,y,w,x;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const A=(w=(y=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||y===void 0?void 0:y.parts)===null||w===void 0?void 0:w.filter(N=>N.codeExecutionResult).map(N=>N.codeExecutionResult).filter(N=>N!==void 0);if((A==null?void 0:A.length)!==0)return(x=A==null?void 0:A[0])===null||x===void 0?void 0:x.output}}class Nv{}class Iv{}class vS{}class wS{}class bS{}class ES{}class Rv{}class Mv{}class Dv{}class _S{}class _h{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new _h;let o;const c=e;return t?o=aS(c):o=oS(c),Object.assign(i,o),i}}class Ov{}class kv{}class Pv{}class Lv{}class TS{}class AS{}class SS{}class _g{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new _g,c=mS(e);return Object.assign(i,c),i}}class CS{}class NS{}class IS{}class Uv{}class RS{get text(){var e,t,i;let o="",c=!1;const f=[];for(const y of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[w,x]of Object.entries(y))w!=="text"&&w!=="thought"&&x!==null&&f.push(w);if(typeof y.text=="string"){if(typeof y.thought=="boolean"&&y.thought)continue;c=!0,o+=y.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),c?o:void 0}get data(){var e,t,i;let o="";const c=[];for(const f of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[y,w]of Object.entries(f))y!=="inlineData"&&w!==null&&c.push(y);f.inlineData&&typeof f.inlineData.data=="string"&&(o+=atob(f.inlineData.data))}return c.length>0&&console.warn(`there are non-data parts ${c} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class MS{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Tg{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Tg,c=dE(e);return Object.assign(i,c),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gn(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function hE(n,e){const t=gn(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function fE(n){return Array.isArray(n)?n.map(e=>Th(e)):[Th(n)]}function Th(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function mE(n){const e=Th(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function gE(n){const e=Th(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Bv(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function pE(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>Bv(e)):[Bv(n)]}function km(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function Fv(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function jv(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function ts(n){if(n==null)throw new Error("ContentUnion is required");return km(n)?n:{role:"user",parts:pE(n)}}function Ag(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=ts(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=ts(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>ts(t)):[ts(e)]}function lr(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(Fv(n)||jv(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ts(n)]}const e=[],t=[],i=km(n[0]);for(const o of n){const c=km(o);if(c!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(c)e.push(o);else{if(Fv(o)||jv(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(o)}}return i||e.push({role:"user",parts:pE(t)}),e}function DS(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(We).includes(t[0].toUpperCase())?t[0].toUpperCase():We.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(We).includes(i.toUpperCase())?i.toUpperCase():We.TYPE_UNSPECIFIED})}}function Ql(n){const e={},t=["items"],i=["anyOf"],o=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const c=n.anyOf;c!=null&&c.length==2&&(c[0].type==="null"?(e.nullable=!0,n=c[1]):c[1].type==="null"&&(e.nullable=!0,n=c[0])),n.type instanceof Array&&DS(n.type,e);for(const[f,y]of Object.entries(n))if(y!=null)if(f=="type"){if(y==="null")throw new Error("type: null can not be the only possible type for the field.");if(y instanceof Array)continue;e.type=Object.values(We).includes(y.toUpperCase())?y.toUpperCase():We.TYPE_UNSPECIFIED}else if(t.includes(f))e[f]=Ql(y);else if(i.includes(f)){const w=[];for(const x of y){if(x.type=="null"){e.nullable=!0;continue}w.push(Ql(x))}e[f]=w}else if(o.includes(f)){const w={};for(const[x,A]of Object.entries(y))w[x]=Ql(A);e[f]=w}else{if(f==="additionalProperties")continue;e[f]=y}return e}function Sg(n){return Ql(n)}function Cg(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Ng(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function pc(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ql(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ql(e.response));return n}function xc(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function OS(n,e,t,i=1){const o=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:o?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:o?`${t}/${e}`:e}function Io(n,e){if(typeof e!="string")throw new Error("name must be a string");return OS(n,e,"cachedContents")}function xE(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Ca(n){return Eg(n)}function kS(n){return n!=null&&typeof n=="object"&&"name"in n}function PS(n){return n!=null&&typeof n=="object"&&"video"in n}function LS(n){return n!=null&&typeof n=="object"&&"uri"in n}function yE(n){var e;let t;if(kS(n)&&(t=n.name),!(LS(n)&&(t=n.uri,t===void 0))&&!(PS(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const o=t.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${t}`);t=o[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function vE(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function wE(n){for(const e of["models","tunedModels","publisherModels"])if(US(n,e))return n[e];return[]}function US(n,e){return n!==null&&typeof n=="object"&&e in n}function BS(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function FS(n,e={}){const t=[],i=new Set;for(const o of n){const c=o.name;if(i.has(c))throw new Error(`Duplicate function name ${c} found in MCP tools. Please ensure function names are unique.`);i.add(c);const f=BS(o,e);f.functionDeclarations&&t.push(...f.functionDeclarations)}return{functionDeclarations:t}}function bE(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,o=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(o>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||o!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function jS(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function EE(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const o=t.inlinedResponses;if(!Array.isArray(o)||o.length===0)return n;let c=!1;for(const f of o){if(typeof f!="object"||f===null)continue;const w=f.response;if(typeof w!="object"||w===null)continue;if(w.embedding!==void 0){c=!0;break}}return c&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function yc(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function _E(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function VS(n){const e={},t=b(n,["responsesFile"]);t!=null&&T(e,["fileName"],t);const i=b(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>bC(f))),T(e,["inlinedResponses"],c)}const o=b(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>f)),T(e,["inlinedEmbedContentResponses"],c)}return e}function GS(n){const e={},t=b(n,["predictionsFormat"]);t!=null&&T(e,["format"],t);const i=b(n,["gcsDestination","outputUriPrefix"]);i!=null&&T(e,["gcsUri"],i);const o=b(n,["bigqueryDestination","outputUri"]);return o!=null&&T(e,["bigqueryUri"],o),e}function HS(n){const e={},t=b(n,["format"]);t!=null&&T(e,["predictionsFormat"],t);const i=b(n,["gcsUri"]);i!=null&&T(e,["gcsDestination","outputUriPrefix"],i);const o=b(n,["bigqueryUri"]);if(o!=null&&T(e,["bigqueryDestination","outputUri"],o),b(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(b(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(b(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function ch(n){const e={},t=b(n,["name"]);t!=null&&T(e,["name"],t);const i=b(n,["metadata","displayName"]);i!=null&&T(e,["displayName"],i);const o=b(n,["metadata","state"]);o!=null&&T(e,["state"],_E(o));const c=b(n,["metadata","createTime"]);c!=null&&T(e,["createTime"],c);const f=b(n,["metadata","endTime"]);f!=null&&T(e,["endTime"],f);const y=b(n,["metadata","updateTime"]);y!=null&&T(e,["updateTime"],y);const w=b(n,["metadata","model"]);w!=null&&T(e,["model"],w);const x=b(n,["metadata","output"]);return x!=null&&T(e,["dest"],VS(EE(x))),e}function Pm(n){const e={},t=b(n,["name"]);t!=null&&T(e,["name"],t);const i=b(n,["displayName"]);i!=null&&T(e,["displayName"],i);const o=b(n,["state"]);o!=null&&T(e,["state"],_E(o));const c=b(n,["error"]);c!=null&&T(e,["error"],c);const f=b(n,["createTime"]);f!=null&&T(e,["createTime"],f);const y=b(n,["startTime"]);y!=null&&T(e,["startTime"],y);const w=b(n,["endTime"]);w!=null&&T(e,["endTime"],w);const x=b(n,["updateTime"]);x!=null&&T(e,["updateTime"],x);const A=b(n,["model"]);A!=null&&T(e,["model"],A);const N=b(n,["inputConfig"]);N!=null&&T(e,["src"],zS(N));const R=b(n,["outputConfig"]);R!=null&&T(e,["dest"],GS(EE(R)));const k=b(n,["completionStats"]);return k!=null&&T(e,["completionStats"],k),e}function zS(n){const e={},t=b(n,["instancesFormat"]);t!=null&&T(e,["format"],t);const i=b(n,["gcsSource","uris"]);i!=null&&T(e,["gcsUri"],i);const o=b(n,["bigquerySource","inputUri"]);return o!=null&&T(e,["bigqueryUri"],o),e}function qS(n,e){const t={};if(b(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(b(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(b(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=b(e,["fileName"]);i!=null&&T(t,["fileName"],i);const o=b(e,["inlinedRequests"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>wC(n,f))),T(t,["requests","requests"],c)}return t}function YS(n){const e={},t=b(n,["format"]);t!=null&&T(e,["instancesFormat"],t);const i=b(n,["gcsUri"]);i!=null&&T(e,["gcsSource","uris"],i);const o=b(n,["bigqueryUri"]);if(o!=null&&T(e,["bigquerySource","inputUri"],o),b(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(b(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function WS(n){const e={},t=b(n,["data"]);if(t!=null&&T(e,["data"],t),b(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=b(n,["mimeType"]);return i!=null&&T(e,["mimeType"],i),e}function XS(n,e){const t={},i=b(e,["name"]);return i!=null&&T(t,["_url","name"],yc(n,i)),t}function KS(n,e){const t={},i=b(e,["name"]);return i!=null&&T(t,["_url","name"],yc(n,i)),t}function $S(n){const e={},t=b(n,["content"]);t!=null&&T(e,["content"],t);const i=b(n,["citationMetadata"]);i!=null&&T(e,["citationMetadata"],JS(i));const o=b(n,["tokenCount"]);o!=null&&T(e,["tokenCount"],o);const c=b(n,["finishReason"]);c!=null&&T(e,["finishReason"],c);const f=b(n,["avgLogprobs"]);f!=null&&T(e,["avgLogprobs"],f);const y=b(n,["groundingMetadata"]);y!=null&&T(e,["groundingMetadata"],y);const w=b(n,["index"]);w!=null&&T(e,["index"],w);const x=b(n,["logprobsResult"]);x!=null&&T(e,["logprobsResult"],x);const A=b(n,["safetyRatings"]);if(A!=null){let R=A;Array.isArray(R)&&(R=R.map(k=>k)),T(e,["safetyRatings"],R)}const N=b(n,["urlContextMetadata"]);return N!=null&&T(e,["urlContextMetadata"],N),e}function JS(n){const e={},t=b(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),T(e,["citations"],i)}return e}function TE(n){const e={},t=b(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(c=>NC(c))),T(e,["parts"],o)}const i=b(n,["role"]);return i!=null&&T(e,["role"],i),e}function QS(n,e){const t={},i=b(n,["displayName"]);if(e!==void 0&&i!=null&&T(e,["batch","displayName"],i),b(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function ZS(n,e){const t={},i=b(n,["displayName"]);e!==void 0&&i!=null&&T(e,["displayName"],i);const o=b(n,["dest"]);return e!==void 0&&o!=null&&T(e,["outputConfig"],HS(jS(o))),t}function Vv(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["src"]);o!=null&&T(t,["batch","inputConfig"],qS(n,bE(n,o)));const c=b(e,["config"]);return c!=null&&QS(c,t),t}function eC(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["model"],gn(n,i));const o=b(e,["src"]);o!=null&&T(t,["inputConfig"],YS(bE(n,o)));const c=b(e,["config"]);return c!=null&&ZS(c,t),t}function tC(n,e){const t={},i=b(n,["displayName"]);return e!==void 0&&i!=null&&T(e,["batch","displayName"],i),t}function nC(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["src"]);o!=null&&T(t,["batch","inputConfig"],cC(n,o));const c=b(e,["config"]);return c!=null&&tC(c,t),t}function iC(n,e){const t={},i=b(e,["name"]);return i!=null&&T(t,["_url","name"],yc(n,i)),t}function sC(n,e){const t={},i=b(e,["name"]);return i!=null&&T(t,["_url","name"],yc(n,i)),t}function rC(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["name"]);i!=null&&T(e,["name"],i);const o=b(n,["done"]);o!=null&&T(e,["done"],o);const c=b(n,["error"]);return c!=null&&T(e,["error"],c),e}function oC(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["name"]);i!=null&&T(e,["name"],i);const o=b(n,["done"]);o!=null&&T(e,["done"],o);const c=b(n,["error"]);return c!=null&&T(e,["error"],c),e}function aC(n,e){const t={},i=b(e,["contents"]);if(i!=null){let c=Ag(n,i);Array.isArray(c)&&(c=c.map(f=>f)),T(t,["requests[]","request","content"],c)}const o=b(e,["config"]);return o!=null&&(T(t,["_self"],lC(o,t)),sS(t,{"requests[].*":"requests[].request.*"})),t}function lC(n,e){const t={},i=b(n,["taskType"]);e!==void 0&&i!=null&&T(e,["requests[]","taskType"],i);const o=b(n,["title"]);e!==void 0&&o!=null&&T(e,["requests[]","title"],o);const c=b(n,["outputDimensionality"]);if(e!==void 0&&c!=null&&T(e,["requests[]","outputDimensionality"],c),b(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(b(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function cC(n,e){const t={},i=b(e,["fileName"]);i!=null&&T(t,["file_name"],i);const o=b(e,["inlinedRequests"]);return o!=null&&T(t,["requests"],aC(n,o)),t}function uC(n){const e={};if(b(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=b(n,["fileUri"]);t!=null&&T(e,["fileUri"],t);const i=b(n,["mimeType"]);return i!=null&&T(e,["mimeType"],i),e}function dC(n){const e={},t=b(n,["id"]);t!=null&&T(e,["id"],t);const i=b(n,["args"]);i!=null&&T(e,["args"],i);const o=b(n,["name"]);if(o!=null&&T(e,["name"],o),b(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(b(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function hC(n){const e={},t=b(n,["mode"]);t!=null&&T(e,["mode"],t);const i=b(n,["allowedFunctionNames"]);if(i!=null&&T(e,["allowedFunctionNames"],i),b(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function fC(n,e,t){const i={},o=b(e,["systemInstruction"]);t!==void 0&&o!=null&&T(t,["systemInstruction"],TE(ts(o)));const c=b(e,["temperature"]);c!=null&&T(i,["temperature"],c);const f=b(e,["topP"]);f!=null&&T(i,["topP"],f);const y=b(e,["topK"]);y!=null&&T(i,["topK"],y);const w=b(e,["candidateCount"]);w!=null&&T(i,["candidateCount"],w);const x=b(e,["maxOutputTokens"]);x!=null&&T(i,["maxOutputTokens"],x);const A=b(e,["stopSequences"]);A!=null&&T(i,["stopSequences"],A);const N=b(e,["responseLogprobs"]);N!=null&&T(i,["responseLogprobs"],N);const R=b(e,["logprobs"]);R!=null&&T(i,["logprobs"],R);const k=b(e,["presencePenalty"]);k!=null&&T(i,["presencePenalty"],k);const H=b(e,["frequencyPenalty"]);H!=null&&T(i,["frequencyPenalty"],H);const W=b(e,["seed"]);W!=null&&T(i,["seed"],W);const K=b(e,["responseMimeType"]);K!=null&&T(i,["responseMimeType"],K);const te=b(e,["responseSchema"]);te!=null&&T(i,["responseSchema"],Sg(te));const le=b(e,["responseJsonSchema"]);if(le!=null&&T(i,["responseJsonSchema"],le),b(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(b(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const ee=b(e,["safetySettings"]);if(t!==void 0&&ee!=null){let z=ee;Array.isArray(z)&&(z=z.map(_e=>IC(_e))),T(t,["safetySettings"],z)}const de=b(e,["tools"]);if(t!==void 0&&de!=null){let z=xc(de);Array.isArray(z)&&(z=z.map(_e=>MC(pc(_e)))),T(t,["tools"],z)}const Ee=b(e,["toolConfig"]);if(t!==void 0&&Ee!=null&&T(t,["toolConfig"],RC(Ee)),b(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const me=b(e,["cachedContent"]);t!==void 0&&me!=null&&T(t,["cachedContent"],Io(n,me));const U=b(e,["responseModalities"]);U!=null&&T(i,["responseModalities"],U);const V=b(e,["mediaResolution"]);V!=null&&T(i,["mediaResolution"],V);const F=b(e,["speechConfig"]);if(F!=null&&T(i,["speechConfig"],Cg(F)),b(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=b(e,["thinkingConfig"]);Q!=null&&T(i,["thinkingConfig"],Q);const Y=b(e,["imageConfig"]);Y!=null&&T(i,["imageConfig"],vC(Y));const $=b(e,["enableEnhancedCivicAnswers"]);return $!=null&&T(i,["enableEnhancedCivicAnswers"],$),i}function mC(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["candidates"]);if(i!=null){let w=i;Array.isArray(w)&&(w=w.map(x=>$S(x))),T(e,["candidates"],w)}const o=b(n,["modelVersion"]);o!=null&&T(e,["modelVersion"],o);const c=b(n,["promptFeedback"]);c!=null&&T(e,["promptFeedback"],c);const f=b(n,["responseId"]);f!=null&&T(e,["responseId"],f);const y=b(n,["usageMetadata"]);return y!=null&&T(e,["usageMetadata"],y),e}function gC(n,e){const t={},i=b(e,["name"]);return i!=null&&T(t,["_url","name"],yc(n,i)),t}function pC(n,e){const t={},i=b(e,["name"]);return i!=null&&T(t,["_url","name"],yc(n,i)),t}function xC(n){const e={};if(b(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=b(n,["enableWidget"]);return t!=null&&T(e,["enableWidget"],t),e}function yC(n){const e={};if(b(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(b(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=b(n,["timeRangeFilter"]);return t!=null&&T(e,["timeRangeFilter"],t),e}function vC(n){const e={},t=b(n,["aspectRatio"]);t!=null&&T(e,["aspectRatio"],t);const i=b(n,["imageSize"]);if(i!=null&&T(e,["imageSize"],i),b(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(b(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function wC(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["request","model"],gn(n,i));const o=b(e,["contents"]);if(o!=null){let y=lr(o);Array.isArray(y)&&(y=y.map(w=>TE(w))),T(t,["request","contents"],y)}const c=b(e,["metadata"]);c!=null&&T(t,["metadata"],c);const f=b(e,["config"]);return f!=null&&T(t,["request","generationConfig"],fC(n,f,b(t,["request"],{}))),t}function bC(n){const e={},t=b(n,["response"]);t!=null&&T(e,["response"],mC(t));const i=b(n,["error"]);return i!=null&&T(e,["error"],i),e}function EC(n,e){const t={},i=b(n,["pageSize"]);e!==void 0&&i!=null&&T(e,["_query","pageSize"],i);const o=b(n,["pageToken"]);if(e!==void 0&&o!=null&&T(e,["_query","pageToken"],o),b(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function _C(n,e){const t={},i=b(n,["pageSize"]);e!==void 0&&i!=null&&T(e,["_query","pageSize"],i);const o=b(n,["pageToken"]);e!==void 0&&o!=null&&T(e,["_query","pageToken"],o);const c=b(n,["filter"]);return e!==void 0&&c!=null&&T(e,["_query","filter"],c),t}function TC(n){const e={},t=b(n,["config"]);return t!=null&&EC(t,e),e}function AC(n){const e={},t=b(n,["config"]);return t!=null&&_C(t,e),e}function SC(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["nextPageToken"]);i!=null&&T(e,["nextPageToken"],i);const o=b(n,["operations"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>ch(f))),T(e,["batchJobs"],c)}return e}function CC(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["nextPageToken"]);i!=null&&T(e,["nextPageToken"],i);const o=b(n,["batchPredictionJobs"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>Pm(f))),T(e,["batchJobs"],c)}return e}function NC(n){const e={},t=b(n,["mediaResolution"]);t!=null&&T(e,["mediaResolution"],t);const i=b(n,["codeExecutionResult"]);i!=null&&T(e,["codeExecutionResult"],i);const o=b(n,["executableCode"]);o!=null&&T(e,["executableCode"],o);const c=b(n,["fileData"]);c!=null&&T(e,["fileData"],uC(c));const f=b(n,["functionCall"]);f!=null&&T(e,["functionCall"],dC(f));const y=b(n,["functionResponse"]);y!=null&&T(e,["functionResponse"],y);const w=b(n,["inlineData"]);w!=null&&T(e,["inlineData"],WS(w));const x=b(n,["text"]);x!=null&&T(e,["text"],x);const A=b(n,["thought"]);A!=null&&T(e,["thought"],A);const N=b(n,["thoughtSignature"]);N!=null&&T(e,["thoughtSignature"],N);const R=b(n,["videoMetadata"]);return R!=null&&T(e,["videoMetadata"],R),e}function IC(n){const e={},t=b(n,["category"]);if(t!=null&&T(e,["category"],t),b(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=b(n,["threshold"]);return i!=null&&T(e,["threshold"],i),e}function RC(n){const e={},t=b(n,["functionCallingConfig"]);t!=null&&T(e,["functionCallingConfig"],hC(t));const i=b(n,["retrievalConfig"]);return i!=null&&T(e,["retrievalConfig"],i),e}function MC(n){const e={},t=b(n,["functionDeclarations"]);if(t!=null){let A=t;Array.isArray(A)&&(A=A.map(N=>N)),T(e,["functionDeclarations"],A)}if(b(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=b(n,["googleSearchRetrieval"]);i!=null&&T(e,["googleSearchRetrieval"],i);const o=b(n,["computerUse"]);o!=null&&T(e,["computerUse"],o);const c=b(n,["fileSearch"]);c!=null&&T(e,["fileSearch"],c);const f=b(n,["codeExecution"]);if(f!=null&&T(e,["codeExecution"],f),b(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const y=b(n,["googleMaps"]);y!=null&&T(e,["googleMaps"],xC(y));const w=b(n,["googleSearch"]);w!=null&&T(e,["googleSearch"],yC(w));const x=b(n,["urlContext"]);return x!=null&&T(e,["urlContext"],x),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var To;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(To||(To={}));class dl{constructor(e,t,i,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,o)}init(e,t,i){var o,c;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let f={config:{}};!i||Object.keys(i).length===0?f={config:{}}:typeof i=="object"?f=Object.assign({},i):f=i,f.config&&(f.config.pageToken=t.nextPageToken),this.paramsInternal=f,this.pageInternalSize=(c=(o=f.config)===null||o===void 0?void 0:o.pageSize)!==null&&c!==void 0?c:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DC extends No{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new dl(To.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=Vv(this.apiClient,e),i=t._url,o=et("{model}:batchGenerateContent",i),y=t.batch.inputConfig.requests,w=y.requests,x=[];for(const A of w){const N=Object.assign({},A);if(N.systemInstruction){const R=N.systemInstruction;delete N.systemInstruction;const k=N.request;k.systemInstruction=R,N.request=k}x.push(N)}return y.requests=x,delete t.config,delete t._url,delete t._query,{path:o,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},o=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${o}`),i.dest===void 0){const c=this.getGcsUri(e),f=this.getBigqueryUri(e);if(c)c.endsWith(".jsonl")?i.dest=`${c.slice(0,-6)}/dest`:i.dest=`${c}_dest_${o}`;else if(f)i.dest=`${f}_dest_${o}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=eC(this.apiClient,e);return y=et("batchPredictionJobs",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json()),f.then(A=>Pm(A))}else{const x=Vv(this.apiClient,e);return y=et("{model}:batchGenerateContent",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json()),f.then(A=>ch(A))}}async createEmbeddingsInternal(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=nC(this.apiClient,e);return c=et("{model}:asyncBatchEmbedContent",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json()),o.then(w=>ch(w))}}async get(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=pC(this.apiClient,e);return y=et("batchPredictionJobs/{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json()),f.then(A=>Pm(A))}else{const x=gC(this.apiClient,e);return y=et("batches/{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json()),f.then(A=>ch(A))}}async cancel(e){var t,i,o,c;let f="",y={};if(this.apiClient.isVertexAI()){const w=KS(this.apiClient,e);f=et("batchPredictionJobs/{name}:cancel",w._url),y=w._query,delete w._url,delete w._query,await this.apiClient.request({path:f,queryParams:y,body:JSON.stringify(w),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const w=XS(this.apiClient,e);f=et("batches/{name}:cancel",w._url),y=w._query,delete w._url,delete w._query,await this.apiClient.request({path:f,queryParams:y,body:JSON.stringify(w),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal})}}async listInternal(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=AC(e);return y=et("batchPredictionJobs",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=CC(A),R=new Uv;return Object.assign(R,N),R})}else{const x=TC(e);return y=et("batches",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=SC(A),R=new Uv;return Object.assign(R,N),R})}}async delete(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=sC(this.apiClient,e);return y=et("batchPredictionJobs/{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>oC(A))}else{const x=iC(this.apiClient,e);return y=et("batches/{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>rC(A))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OC(n){const e={},t=b(n,["data"]);if(t!=null&&T(e,["data"],t),b(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=b(n,["mimeType"]);return i!=null&&T(e,["mimeType"],i),e}function Gv(n){const e={},t=b(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(c=>nN(c))),T(e,["parts"],o)}const i=b(n,["role"]);return i!=null&&T(e,["role"],i),e}function kC(n,e){const t={},i=b(n,["ttl"]);e!==void 0&&i!=null&&T(e,["ttl"],i);const o=b(n,["expireTime"]);e!==void 0&&o!=null&&T(e,["expireTime"],o);const c=b(n,["displayName"]);e!==void 0&&c!=null&&T(e,["displayName"],c);const f=b(n,["contents"]);if(e!==void 0&&f!=null){let A=lr(f);Array.isArray(A)&&(A=A.map(N=>Gv(N))),T(e,["contents"],A)}const y=b(n,["systemInstruction"]);e!==void 0&&y!=null&&T(e,["systemInstruction"],Gv(ts(y)));const w=b(n,["tools"]);if(e!==void 0&&w!=null){let A=w;Array.isArray(A)&&(A=A.map(N=>sN(N))),T(e,["tools"],A)}const x=b(n,["toolConfig"]);if(e!==void 0&&x!=null&&T(e,["toolConfig"],iN(x)),b(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function PC(n,e){const t={},i=b(n,["ttl"]);e!==void 0&&i!=null&&T(e,["ttl"],i);const o=b(n,["expireTime"]);e!==void 0&&o!=null&&T(e,["expireTime"],o);const c=b(n,["displayName"]);e!==void 0&&c!=null&&T(e,["displayName"],c);const f=b(n,["contents"]);if(e!==void 0&&f!=null){let N=lr(f);Array.isArray(N)&&(N=N.map(R=>R)),T(e,["contents"],N)}const y=b(n,["systemInstruction"]);e!==void 0&&y!=null&&T(e,["systemInstruction"],ts(y));const w=b(n,["tools"]);if(e!==void 0&&w!=null){let N=w;Array.isArray(N)&&(N=N.map(R=>rN(R))),T(e,["tools"],N)}const x=b(n,["toolConfig"]);e!==void 0&&x!=null&&T(e,["toolConfig"],x);const A=b(n,["kmsKeyName"]);return e!==void 0&&A!=null&&T(e,["encryption_spec","kmsKeyName"],A),t}function LC(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["model"],hE(n,i));const o=b(e,["config"]);return o!=null&&kC(o,t),t}function UC(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["model"],hE(n,i));const o=b(e,["config"]);return o!=null&&PC(o,t),t}function BC(n,e){const t={},i=b(e,["name"]);return i!=null&&T(t,["_url","name"],Io(n,i)),t}function FC(n,e){const t={},i=b(e,["name"]);return i!=null&&T(t,["_url","name"],Io(n,i)),t}function jC(n){const e={},t=b(n,["sdkHttpResponse"]);return t!=null&&T(e,["sdkHttpResponse"],t),e}function VC(n){const e={},t=b(n,["sdkHttpResponse"]);return t!=null&&T(e,["sdkHttpResponse"],t),e}function GC(n){const e={};if(b(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=b(n,["fileUri"]);t!=null&&T(e,["fileUri"],t);const i=b(n,["mimeType"]);return i!=null&&T(e,["mimeType"],i),e}function HC(n){const e={},t=b(n,["id"]);t!=null&&T(e,["id"],t);const i=b(n,["args"]);i!=null&&T(e,["args"],i);const o=b(n,["name"]);if(o!=null&&T(e,["name"],o),b(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(b(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function zC(n){const e={},t=b(n,["mode"]);t!=null&&T(e,["mode"],t);const i=b(n,["allowedFunctionNames"]);if(i!=null&&T(e,["allowedFunctionNames"],i),b(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function qC(n){const e={};if(b(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=b(n,["description"]);t!=null&&T(e,["description"],t);const i=b(n,["name"]);i!=null&&T(e,["name"],i);const o=b(n,["parameters"]);o!=null&&T(e,["parameters"],o);const c=b(n,["parametersJsonSchema"]);c!=null&&T(e,["parametersJsonSchema"],c);const f=b(n,["response"]);f!=null&&T(e,["response"],f);const y=b(n,["responseJsonSchema"]);return y!=null&&T(e,["responseJsonSchema"],y),e}function YC(n,e){const t={},i=b(e,["name"]);return i!=null&&T(t,["_url","name"],Io(n,i)),t}function WC(n,e){const t={},i=b(e,["name"]);return i!=null&&T(t,["_url","name"],Io(n,i)),t}function XC(n){const e={};if(b(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=b(n,["enableWidget"]);return t!=null&&T(e,["enableWidget"],t),e}function KC(n){const e={};if(b(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(b(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=b(n,["timeRangeFilter"]);return t!=null&&T(e,["timeRangeFilter"],t),e}function $C(n,e){const t={},i=b(n,["pageSize"]);e!==void 0&&i!=null&&T(e,["_query","pageSize"],i);const o=b(n,["pageToken"]);return e!==void 0&&o!=null&&T(e,["_query","pageToken"],o),t}function JC(n,e){const t={},i=b(n,["pageSize"]);e!==void 0&&i!=null&&T(e,["_query","pageSize"],i);const o=b(n,["pageToken"]);return e!==void 0&&o!=null&&T(e,["_query","pageToken"],o),t}function QC(n){const e={},t=b(n,["config"]);return t!=null&&$C(t,e),e}function ZC(n){const e={},t=b(n,["config"]);return t!=null&&JC(t,e),e}function eN(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["nextPageToken"]);i!=null&&T(e,["nextPageToken"],i);const o=b(n,["cachedContents"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>f)),T(e,["cachedContents"],c)}return e}function tN(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["nextPageToken"]);i!=null&&T(e,["nextPageToken"],i);const o=b(n,["cachedContents"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>f)),T(e,["cachedContents"],c)}return e}function nN(n){const e={},t=b(n,["mediaResolution"]);t!=null&&T(e,["mediaResolution"],t);const i=b(n,["codeExecutionResult"]);i!=null&&T(e,["codeExecutionResult"],i);const o=b(n,["executableCode"]);o!=null&&T(e,["executableCode"],o);const c=b(n,["fileData"]);c!=null&&T(e,["fileData"],GC(c));const f=b(n,["functionCall"]);f!=null&&T(e,["functionCall"],HC(f));const y=b(n,["functionResponse"]);y!=null&&T(e,["functionResponse"],y);const w=b(n,["inlineData"]);w!=null&&T(e,["inlineData"],OC(w));const x=b(n,["text"]);x!=null&&T(e,["text"],x);const A=b(n,["thought"]);A!=null&&T(e,["thought"],A);const N=b(n,["thoughtSignature"]);N!=null&&T(e,["thoughtSignature"],N);const R=b(n,["videoMetadata"]);return R!=null&&T(e,["videoMetadata"],R),e}function iN(n){const e={},t=b(n,["functionCallingConfig"]);t!=null&&T(e,["functionCallingConfig"],zC(t));const i=b(n,["retrievalConfig"]);return i!=null&&T(e,["retrievalConfig"],i),e}function sN(n){const e={},t=b(n,["functionDeclarations"]);if(t!=null){let A=t;Array.isArray(A)&&(A=A.map(N=>N)),T(e,["functionDeclarations"],A)}if(b(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=b(n,["googleSearchRetrieval"]);i!=null&&T(e,["googleSearchRetrieval"],i);const o=b(n,["computerUse"]);o!=null&&T(e,["computerUse"],o);const c=b(n,["fileSearch"]);c!=null&&T(e,["fileSearch"],c);const f=b(n,["codeExecution"]);if(f!=null&&T(e,["codeExecution"],f),b(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const y=b(n,["googleMaps"]);y!=null&&T(e,["googleMaps"],XC(y));const w=b(n,["googleSearch"]);w!=null&&T(e,["googleSearch"],KC(w));const x=b(n,["urlContext"]);return x!=null&&T(e,["urlContext"],x),e}function rN(n){const e={},t=b(n,["functionDeclarations"]);if(t!=null){let N=t;Array.isArray(N)&&(N=N.map(R=>qC(R))),T(e,["functionDeclarations"],N)}const i=b(n,["retrieval"]);i!=null&&T(e,["retrieval"],i);const o=b(n,["googleSearchRetrieval"]);o!=null&&T(e,["googleSearchRetrieval"],o);const c=b(n,["computerUse"]);if(c!=null&&T(e,["computerUse"],c),b(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const f=b(n,["codeExecution"]);f!=null&&T(e,["codeExecution"],f);const y=b(n,["enterpriseWebSearch"]);y!=null&&T(e,["enterpriseWebSearch"],y);const w=b(n,["googleMaps"]);w!=null&&T(e,["googleMaps"],w);const x=b(n,["googleSearch"]);x!=null&&T(e,["googleSearch"],x);const A=b(n,["urlContext"]);return A!=null&&T(e,["urlContext"],A),e}function oN(n,e){const t={},i=b(n,["ttl"]);e!==void 0&&i!=null&&T(e,["ttl"],i);const o=b(n,["expireTime"]);return e!==void 0&&o!=null&&T(e,["expireTime"],o),t}function aN(n,e){const t={},i=b(n,["ttl"]);e!==void 0&&i!=null&&T(e,["ttl"],i);const o=b(n,["expireTime"]);return e!==void 0&&o!=null&&T(e,["expireTime"],o),t}function lN(n,e){const t={},i=b(e,["name"]);i!=null&&T(t,["_url","name"],Io(n,i));const o=b(e,["config"]);return o!=null&&oN(o,t),t}function cN(n,e){const t={},i=b(e,["name"]);i!=null&&T(t,["_url","name"],Io(n,i));const o=b(e,["config"]);return o!=null&&aN(o,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uN extends No{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new dl(To.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=UC(this.apiClient,e);return y=et("cachedContents",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json()),f.then(A=>A)}else{const x=LC(this.apiClient,e);return y=et("cachedContents",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json()),f.then(A=>A)}}async get(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=WC(this.apiClient,e);return y=et("{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json()),f.then(A=>A)}else{const x=YC(this.apiClient,e);return y=et("{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json()),f.then(A=>A)}}async delete(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=FC(this.apiClient,e);return y=et("{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=VC(A),R=new Pv;return Object.assign(R,N),R})}else{const x=BC(this.apiClient,e);return y=et("{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=jC(A),R=new Pv;return Object.assign(R,N),R})}}async update(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=cN(this.apiClient,e);return y=et("{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json()),f.then(A=>A)}else{const x=lN(this.apiClient,e);return y=et("{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json()),f.then(A=>A)}}async listInternal(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=ZC(e);return y=et("cachedContents",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=tN(A),R=new Lv;return Object.assign(R,N),R})}else{const x=QC(e);return y=et("cachedContents",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=eN(A),R=new Lv;return Object.assign(R,N),R})}}}function Ah(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}function Hv(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function It(n){return this instanceof It?(this.v=n,this):new It(n)}function vr(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,c=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),y("next"),y("throw"),y("return",f),o[Symbol.asyncIterator]=function(){return this},o;function f(k){return function(H){return Promise.resolve(H).then(k,N)}}function y(k,H){i[k]&&(o[k]=function(W){return new Promise(function(K,te){c.push([k,W,K,te])>1||w(k,W)})},H&&(o[k]=H(o[k])))}function w(k,H){try{x(i[k](H))}catch(W){R(c[0][3],W)}}function x(k){k.value instanceof It?Promise.resolve(k.value.v).then(A,N):R(c[0][2],k)}function A(k){w("next",k)}function N(k){w("throw",k)}function R(k,H){k(H),c.shift(),c.length&&w(c[0][0],c[0][1])}}function wr(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Hv=="function"?Hv(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=n[c]&&function(f){return new Promise(function(y,w){f=n[c](f),o(y,w,f.done,f.value)})}}function o(c,f,y,w){Promise.resolve(w).then(function(x){c({value:x,done:y})},f)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dN(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:AE(t)}function AE(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function hN(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function zv(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const o=[];let c=!0;for(;i<t&&n[i].role==="model";)o.push(n[i]),c&&!AE(n[i])&&(c=!1),i++;c?e.push(...o):e.pop()}return e}class fN{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new mN(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class mN{constructor(e,t,i,o={},c=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=o,this.history=c,this.sendPromise=Promise.resolve(),hN(c)}async sendMessage(e){var t;await this.sendPromise;const i=ts(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var c,f,y;const w=await o,x=(f=(c=w.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content,A=w.automaticFunctionCallingHistory,N=this.getHistory(!0).length;let R=[];A!=null&&(R=(y=A.slice(N))!==null&&y!==void 0?y:[]);const k=x?[x]:[];this.recordHistory(i,k,R)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var t;await this.sendPromise;const i=ts(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const c=await o;return this.processStreamResponse(c,i)}getHistory(e=!1){const t=e?zv(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return vr(this,arguments,function*(){var o,c,f,y,w,x;const A=[];try{for(var N=!0,R=wr(e),k;k=yield It(R.next()),o=k.done,!o;N=!0){y=k.value,N=!1;const H=y;if(dN(H)){const W=(x=(w=H.candidates)===null||w===void 0?void 0:w[0])===null||x===void 0?void 0:x.content;W!==void 0&&A.push(W)}yield yield It(H)}}catch(H){c={error:H}}finally{try{!N&&!o&&(f=R.return)&&(yield It(f.call(R)))}finally{if(c)throw c.error}}this.recordHistory(t,A)})}recordHistory(e,t,i){let o=[];t.length>0&&t.every(c=>c.role!==void 0)?o=t:o.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...zv(i)):this.history.push(e),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wh extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Wh.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gN(n){const e={},t=b(n,["file"]);return t!=null&&T(e,["file"],t),e}function pN(n){const e={},t=b(n,["sdkHttpResponse"]);return t!=null&&T(e,["sdkHttpResponse"],t),e}function xN(n){const e={},t=b(n,["name"]);return t!=null&&T(e,["_url","file"],yE(t)),e}function yN(n){const e={},t=b(n,["sdkHttpResponse"]);return t!=null&&T(e,["sdkHttpResponse"],t),e}function vN(n){const e={},t=b(n,["name"]);return t!=null&&T(e,["_url","file"],yE(t)),e}function wN(n,e){const t={},i=b(n,["pageSize"]);e!==void 0&&i!=null&&T(e,["_query","pageSize"],i);const o=b(n,["pageToken"]);return e!==void 0&&o!=null&&T(e,["_query","pageToken"],o),t}function bN(n){const e={},t=b(n,["config"]);return t!=null&&wN(t,e),e}function EN(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["nextPageToken"]);i!=null&&T(e,["nextPageToken"],i);const o=b(n,["files"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>f)),T(e,["files"],c)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _N extends No{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new dl(To.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=bN(e);return c=et("files",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json().then(x=>{const A=x;return A.sdkHttpResponse={headers:w.headers},A})),o.then(w=>{const x=EN(w),A=new CS;return Object.assign(A,x),A})}}async createInternal(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=gN(e);return c=et("upload/v1beta/files",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json()),o.then(w=>{const x=pN(w),A=new NS;return Object.assign(A,x),A})}}async get(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=vN(e);return c=et("files/{file}",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json()),o.then(w=>w)}}async delete(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=xN(e);return c=et("files/{file}",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json().then(x=>{const A=x;return A.sdkHttpResponse={headers:w.headers},A})),o.then(w=>{const x=yN(w),A=new IS;return Object.assign(A,x),A})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uh(n){const e={},t=b(n,["data"]);if(t!=null&&T(e,["data"],t),b(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=b(n,["mimeType"]);return i!=null&&T(e,["mimeType"],i),e}function TN(n){const e={},t=b(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(c=>jN(c))),T(e,["parts"],o)}const i=b(n,["role"]);return i!=null&&T(e,["role"],i),e}function AN(n){const e={};if(b(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=b(n,["fileUri"]);t!=null&&T(e,["fileUri"],t);const i=b(n,["mimeType"]);return i!=null&&T(e,["mimeType"],i),e}function SN(n){const e={},t=b(n,["id"]);t!=null&&T(e,["id"],t);const i=b(n,["args"]);i!=null&&T(e,["args"],i);const o=b(n,["name"]);if(o!=null&&T(e,["name"],o),b(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(b(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function CN(n){const e={};if(b(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=b(n,["description"]);t!=null&&T(e,["description"],t);const i=b(n,["name"]);i!=null&&T(e,["name"],i);const o=b(n,["parameters"]);o!=null&&T(e,["parameters"],o);const c=b(n,["parametersJsonSchema"]);c!=null&&T(e,["parametersJsonSchema"],c);const f=b(n,["response"]);f!=null&&T(e,["response"],f);const y=b(n,["responseJsonSchema"]);return y!=null&&T(e,["responseJsonSchema"],y),e}function NN(n){const e={},t=b(n,["modelSelectionConfig"]);t!=null&&T(e,["modelConfig"],t);const i=b(n,["responseJsonSchema"]);i!=null&&T(e,["responseJsonSchema"],i);const o=b(n,["audioTimestamp"]);o!=null&&T(e,["audioTimestamp"],o);const c=b(n,["candidateCount"]);c!=null&&T(e,["candidateCount"],c);const f=b(n,["enableAffectiveDialog"]);f!=null&&T(e,["enableAffectiveDialog"],f);const y=b(n,["frequencyPenalty"]);y!=null&&T(e,["frequencyPenalty"],y);const w=b(n,["logprobs"]);w!=null&&T(e,["logprobs"],w);const x=b(n,["maxOutputTokens"]);x!=null&&T(e,["maxOutputTokens"],x);const A=b(n,["mediaResolution"]);A!=null&&T(e,["mediaResolution"],A);const N=b(n,["presencePenalty"]);N!=null&&T(e,["presencePenalty"],N);const R=b(n,["responseLogprobs"]);R!=null&&T(e,["responseLogprobs"],R);const k=b(n,["responseMimeType"]);k!=null&&T(e,["responseMimeType"],k);const H=b(n,["responseModalities"]);H!=null&&T(e,["responseModalities"],H);const W=b(n,["responseSchema"]);W!=null&&T(e,["responseSchema"],W);const K=b(n,["routingConfig"]);K!=null&&T(e,["routingConfig"],K);const te=b(n,["seed"]);te!=null&&T(e,["seed"],te);const le=b(n,["speechConfig"]);le!=null&&T(e,["speechConfig"],le);const ee=b(n,["stopSequences"]);ee!=null&&T(e,["stopSequences"],ee);const de=b(n,["temperature"]);de!=null&&T(e,["temperature"],de);const Ee=b(n,["thinkingConfig"]);Ee!=null&&T(e,["thinkingConfig"],Ee);const me=b(n,["topK"]);me!=null&&T(e,["topK"],me);const U=b(n,["topP"]);if(U!=null&&T(e,["topP"],U),b(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function IN(n){const e={};if(b(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=b(n,["enableWidget"]);return t!=null&&T(e,["enableWidget"],t),e}function RN(n){const e={};if(b(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(b(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=b(n,["timeRangeFilter"]);return t!=null&&T(e,["timeRangeFilter"],t),e}function MN(n,e){const t={},i=b(n,["generationConfig"]);e!==void 0&&i!=null&&T(e,["setup","generationConfig"],i);const o=b(n,["responseModalities"]);e!==void 0&&o!=null&&T(e,["setup","generationConfig","responseModalities"],o);const c=b(n,["temperature"]);e!==void 0&&c!=null&&T(e,["setup","generationConfig","temperature"],c);const f=b(n,["topP"]);e!==void 0&&f!=null&&T(e,["setup","generationConfig","topP"],f);const y=b(n,["topK"]);e!==void 0&&y!=null&&T(e,["setup","generationConfig","topK"],y);const w=b(n,["maxOutputTokens"]);e!==void 0&&w!=null&&T(e,["setup","generationConfig","maxOutputTokens"],w);const x=b(n,["mediaResolution"]);e!==void 0&&x!=null&&T(e,["setup","generationConfig","mediaResolution"],x);const A=b(n,["seed"]);e!==void 0&&A!=null&&T(e,["setup","generationConfig","seed"],A);const N=b(n,["speechConfig"]);e!==void 0&&N!=null&&T(e,["setup","generationConfig","speechConfig"],Ng(N));const R=b(n,["thinkingConfig"]);e!==void 0&&R!=null&&T(e,["setup","generationConfig","thinkingConfig"],R);const k=b(n,["enableAffectiveDialog"]);e!==void 0&&k!=null&&T(e,["setup","generationConfig","enableAffectiveDialog"],k);const H=b(n,["systemInstruction"]);e!==void 0&&H!=null&&T(e,["setup","systemInstruction"],TN(ts(H)));const W=b(n,["tools"]);if(e!==void 0&&W!=null){let me=xc(W);Array.isArray(me)&&(me=me.map(U=>GN(pc(U)))),T(e,["setup","tools"],me)}const K=b(n,["sessionResumption"]);e!==void 0&&K!=null&&T(e,["setup","sessionResumption"],VN(K));const te=b(n,["inputAudioTranscription"]);e!==void 0&&te!=null&&T(e,["setup","inputAudioTranscription"],te);const le=b(n,["outputAudioTranscription"]);e!==void 0&&le!=null&&T(e,["setup","outputAudioTranscription"],le);const ee=b(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&T(e,["setup","realtimeInputConfig"],ee);const de=b(n,["contextWindowCompression"]);e!==void 0&&de!=null&&T(e,["setup","contextWindowCompression"],de);const Ee=b(n,["proactivity"]);if(e!==void 0&&Ee!=null&&T(e,["setup","proactivity"],Ee),b(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function DN(n,e){const t={},i=b(n,["generationConfig"]);e!==void 0&&i!=null&&T(e,["setup","generationConfig"],NN(i));const o=b(n,["responseModalities"]);e!==void 0&&o!=null&&T(e,["setup","generationConfig","responseModalities"],o);const c=b(n,["temperature"]);e!==void 0&&c!=null&&T(e,["setup","generationConfig","temperature"],c);const f=b(n,["topP"]);e!==void 0&&f!=null&&T(e,["setup","generationConfig","topP"],f);const y=b(n,["topK"]);e!==void 0&&y!=null&&T(e,["setup","generationConfig","topK"],y);const w=b(n,["maxOutputTokens"]);e!==void 0&&w!=null&&T(e,["setup","generationConfig","maxOutputTokens"],w);const x=b(n,["mediaResolution"]);e!==void 0&&x!=null&&T(e,["setup","generationConfig","mediaResolution"],x);const A=b(n,["seed"]);e!==void 0&&A!=null&&T(e,["setup","generationConfig","seed"],A);const N=b(n,["speechConfig"]);e!==void 0&&N!=null&&T(e,["setup","generationConfig","speechConfig"],Ng(N));const R=b(n,["thinkingConfig"]);e!==void 0&&R!=null&&T(e,["setup","generationConfig","thinkingConfig"],R);const k=b(n,["enableAffectiveDialog"]);e!==void 0&&k!=null&&T(e,["setup","generationConfig","enableAffectiveDialog"],k);const H=b(n,["systemInstruction"]);e!==void 0&&H!=null&&T(e,["setup","systemInstruction"],ts(H));const W=b(n,["tools"]);if(e!==void 0&&W!=null){let U=xc(W);Array.isArray(U)&&(U=U.map(V=>HN(pc(V)))),T(e,["setup","tools"],U)}const K=b(n,["sessionResumption"]);e!==void 0&&K!=null&&T(e,["setup","sessionResumption"],K);const te=b(n,["inputAudioTranscription"]);e!==void 0&&te!=null&&T(e,["setup","inputAudioTranscription"],te);const le=b(n,["outputAudioTranscription"]);e!==void 0&&le!=null&&T(e,["setup","outputAudioTranscription"],le);const ee=b(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&T(e,["setup","realtimeInputConfig"],ee);const de=b(n,["contextWindowCompression"]);e!==void 0&&de!=null&&T(e,["setup","contextWindowCompression"],de);const Ee=b(n,["proactivity"]);e!==void 0&&Ee!=null&&T(e,["setup","proactivity"],Ee);const me=b(n,["explicitVadSignal"]);return e!==void 0&&me!=null&&T(e,["setup","explicitVadSignal"],me),t}function ON(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["setup","model"],gn(n,i));const o=b(e,["config"]);return o!=null&&T(t,["config"],MN(o,t)),t}function kN(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["setup","model"],gn(n,i));const o=b(e,["config"]);return o!=null&&T(t,["config"],DN(o,t)),t}function PN(n){const e={},t=b(n,["musicGenerationConfig"]);return t!=null&&T(e,["musicGenerationConfig"],t),e}function LN(n){const e={},t=b(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),T(e,["weightedPrompts"],i)}return e}function UN(n){const e={},t=b(n,["media"]);if(t!=null){let x=fE(t);Array.isArray(x)&&(x=x.map(A=>uh(A))),T(e,["mediaChunks"],x)}const i=b(n,["audio"]);i!=null&&T(e,["audio"],uh(gE(i)));const o=b(n,["audioStreamEnd"]);o!=null&&T(e,["audioStreamEnd"],o);const c=b(n,["video"]);c!=null&&T(e,["video"],uh(mE(c)));const f=b(n,["text"]);f!=null&&T(e,["text"],f);const y=b(n,["activityStart"]);y!=null&&T(e,["activityStart"],y);const w=b(n,["activityEnd"]);return w!=null&&T(e,["activityEnd"],w),e}function BN(n){const e={},t=b(n,["media"]);if(t!=null){let x=fE(t);Array.isArray(x)&&(x=x.map(A=>A)),T(e,["mediaChunks"],x)}const i=b(n,["audio"]);i!=null&&T(e,["audio"],gE(i));const o=b(n,["audioStreamEnd"]);o!=null&&T(e,["audioStreamEnd"],o);const c=b(n,["video"]);c!=null&&T(e,["video"],mE(c));const f=b(n,["text"]);f!=null&&T(e,["text"],f);const y=b(n,["activityStart"]);y!=null&&T(e,["activityStart"],y);const w=b(n,["activityEnd"]);return w!=null&&T(e,["activityEnd"],w),e}function FN(n){const e={},t=b(n,["setupComplete"]);t!=null&&T(e,["setupComplete"],t);const i=b(n,["serverContent"]);i!=null&&T(e,["serverContent"],i);const o=b(n,["toolCall"]);o!=null&&T(e,["toolCall"],o);const c=b(n,["toolCallCancellation"]);c!=null&&T(e,["toolCallCancellation"],c);const f=b(n,["usageMetadata"]);f!=null&&T(e,["usageMetadata"],zN(f));const y=b(n,["goAway"]);y!=null&&T(e,["goAway"],y);const w=b(n,["sessionResumptionUpdate"]);w!=null&&T(e,["sessionResumptionUpdate"],w);const x=b(n,["voiceActivityDetectionSignal"]);return x!=null&&T(e,["voiceActivityDetectionSignal"],x),e}function jN(n){const e={},t=b(n,["mediaResolution"]);t!=null&&T(e,["mediaResolution"],t);const i=b(n,["codeExecutionResult"]);i!=null&&T(e,["codeExecutionResult"],i);const o=b(n,["executableCode"]);o!=null&&T(e,["executableCode"],o);const c=b(n,["fileData"]);c!=null&&T(e,["fileData"],AN(c));const f=b(n,["functionCall"]);f!=null&&T(e,["functionCall"],SN(f));const y=b(n,["functionResponse"]);y!=null&&T(e,["functionResponse"],y);const w=b(n,["inlineData"]);w!=null&&T(e,["inlineData"],uh(w));const x=b(n,["text"]);x!=null&&T(e,["text"],x);const A=b(n,["thought"]);A!=null&&T(e,["thought"],A);const N=b(n,["thoughtSignature"]);N!=null&&T(e,["thoughtSignature"],N);const R=b(n,["videoMetadata"]);return R!=null&&T(e,["videoMetadata"],R),e}function VN(n){const e={},t=b(n,["handle"]);if(t!=null&&T(e,["handle"],t),b(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function GN(n){const e={},t=b(n,["functionDeclarations"]);if(t!=null){let A=t;Array.isArray(A)&&(A=A.map(N=>N)),T(e,["functionDeclarations"],A)}if(b(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=b(n,["googleSearchRetrieval"]);i!=null&&T(e,["googleSearchRetrieval"],i);const o=b(n,["computerUse"]);o!=null&&T(e,["computerUse"],o);const c=b(n,["fileSearch"]);c!=null&&T(e,["fileSearch"],c);const f=b(n,["codeExecution"]);if(f!=null&&T(e,["codeExecution"],f),b(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const y=b(n,["googleMaps"]);y!=null&&T(e,["googleMaps"],IN(y));const w=b(n,["googleSearch"]);w!=null&&T(e,["googleSearch"],RN(w));const x=b(n,["urlContext"]);return x!=null&&T(e,["urlContext"],x),e}function HN(n){const e={},t=b(n,["functionDeclarations"]);if(t!=null){let N=t;Array.isArray(N)&&(N=N.map(R=>CN(R))),T(e,["functionDeclarations"],N)}const i=b(n,["retrieval"]);i!=null&&T(e,["retrieval"],i);const o=b(n,["googleSearchRetrieval"]);o!=null&&T(e,["googleSearchRetrieval"],o);const c=b(n,["computerUse"]);if(c!=null&&T(e,["computerUse"],c),b(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const f=b(n,["codeExecution"]);f!=null&&T(e,["codeExecution"],f);const y=b(n,["enterpriseWebSearch"]);y!=null&&T(e,["enterpriseWebSearch"],y);const w=b(n,["googleMaps"]);w!=null&&T(e,["googleMaps"],w);const x=b(n,["googleSearch"]);x!=null&&T(e,["googleSearch"],x);const A=b(n,["urlContext"]);return A!=null&&T(e,["urlContext"],A),e}function zN(n){const e={},t=b(n,["promptTokenCount"]);t!=null&&T(e,["promptTokenCount"],t);const i=b(n,["cachedContentTokenCount"]);i!=null&&T(e,["cachedContentTokenCount"],i);const o=b(n,["candidatesTokenCount"]);o!=null&&T(e,["responseTokenCount"],o);const c=b(n,["toolUsePromptTokenCount"]);c!=null&&T(e,["toolUsePromptTokenCount"],c);const f=b(n,["thoughtsTokenCount"]);f!=null&&T(e,["thoughtsTokenCount"],f);const y=b(n,["totalTokenCount"]);y!=null&&T(e,["totalTokenCount"],y);const w=b(n,["promptTokensDetails"]);if(w!=null){let k=w;Array.isArray(k)&&(k=k.map(H=>H)),T(e,["promptTokensDetails"],k)}const x=b(n,["cacheTokensDetails"]);if(x!=null){let k=x;Array.isArray(k)&&(k=k.map(H=>H)),T(e,["cacheTokensDetails"],k)}const A=b(n,["candidatesTokensDetails"]);if(A!=null){let k=A;Array.isArray(k)&&(k=k.map(H=>H)),T(e,["responseTokensDetails"],k)}const N=b(n,["toolUsePromptTokensDetails"]);if(N!=null){let k=N;Array.isArray(k)&&(k=k.map(H=>H)),T(e,["toolUsePromptTokensDetails"],k)}const R=b(n,["trafficType"]);return R!=null&&T(e,["trafficType"],R),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qN(n){const e={},t=b(n,["data"]);if(t!=null&&T(e,["data"],t),b(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=b(n,["mimeType"]);return i!=null&&T(e,["mimeType"],i),e}function YN(n){const e={},t=b(n,["content"]);t!=null&&T(e,["content"],t);const i=b(n,["citationMetadata"]);i!=null&&T(e,["citationMetadata"],WN(i));const o=b(n,["tokenCount"]);o!=null&&T(e,["tokenCount"],o);const c=b(n,["finishReason"]);c!=null&&T(e,["finishReason"],c);const f=b(n,["avgLogprobs"]);f!=null&&T(e,["avgLogprobs"],f);const y=b(n,["groundingMetadata"]);y!=null&&T(e,["groundingMetadata"],y);const w=b(n,["index"]);w!=null&&T(e,["index"],w);const x=b(n,["logprobsResult"]);x!=null&&T(e,["logprobsResult"],x);const A=b(n,["safetyRatings"]);if(A!=null){let R=A;Array.isArray(R)&&(R=R.map(k=>k)),T(e,["safetyRatings"],R)}const N=b(n,["urlContextMetadata"]);return N!=null&&T(e,["urlContextMetadata"],N),e}function WN(n){const e={},t=b(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),T(e,["citations"],i)}return e}function XN(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["contents"]);if(o!=null){let c=lr(o);Array.isArray(c)&&(c=c.map(f=>f)),T(t,["contents"],c)}return t}function KN(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["tokensInfo"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(c=>c)),T(e,["tokensInfo"],o)}return e}function $N(n){const e={},t=b(n,["values"]);t!=null&&T(e,["values"],t);const i=b(n,["statistics"]);return i!=null&&T(e,["statistics"],JN(i)),e}function JN(n){const e={},t=b(n,["truncated"]);t!=null&&T(e,["truncated"],t);const i=b(n,["token_count"]);return i!=null&&T(e,["tokenCount"],i),e}function Xh(n){const e={},t=b(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(c=>oR(c))),T(e,["parts"],o)}const i=b(n,["role"]);return i!=null&&T(e,["role"],i),e}function QN(n){const e={},t=b(n,["controlType"]);t!=null&&T(e,["controlType"],t);const i=b(n,["enableControlImageComputation"]);return i!=null&&T(e,["computeControl"],i),e}function ZN(n){const e={};if(b(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(b(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(b(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function eI(n,e){const t={},i=b(n,["systemInstruction"]);e!==void 0&&i!=null&&T(e,["systemInstruction"],ts(i));const o=b(n,["tools"]);if(e!==void 0&&o!=null){let f=o;Array.isArray(f)&&(f=f.map(y=>IE(y))),T(e,["tools"],f)}const c=b(n,["generationConfig"]);return e!==void 0&&c!=null&&T(e,["generationConfig"],qI(c)),t}function tI(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["contents"]);if(o!=null){let f=lr(o);Array.isArray(f)&&(f=f.map(y=>Xh(y))),T(t,["contents"],f)}const c=b(e,["config"]);return c!=null&&ZN(c),t}function nI(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["contents"]);if(o!=null){let f=lr(o);Array.isArray(f)&&(f=f.map(y=>y)),T(t,["contents"],f)}const c=b(e,["config"]);return c!=null&&eI(c,t),t}function iI(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["totalTokens"]);i!=null&&T(e,["totalTokens"],i);const o=b(n,["cachedContentTokenCount"]);return o!=null&&T(e,["cachedContentTokenCount"],o),e}function sI(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["totalTokens"]);return i!=null&&T(e,["totalTokens"],i),e}function rI(n,e){const t={},i=b(e,["model"]);return i!=null&&T(t,["_url","name"],gn(n,i)),t}function oI(n,e){const t={},i=b(e,["model"]);return i!=null&&T(t,["_url","name"],gn(n,i)),t}function aI(n){const e={},t=b(n,["sdkHttpResponse"]);return t!=null&&T(e,["sdkHttpResponse"],t),e}function lI(n){const e={},t=b(n,["sdkHttpResponse"]);return t!=null&&T(e,["sdkHttpResponse"],t),e}function cI(n,e){const t={},i=b(n,["outputGcsUri"]);e!==void 0&&i!=null&&T(e,["parameters","storageUri"],i);const o=b(n,["negativePrompt"]);e!==void 0&&o!=null&&T(e,["parameters","negativePrompt"],o);const c=b(n,["numberOfImages"]);e!==void 0&&c!=null&&T(e,["parameters","sampleCount"],c);const f=b(n,["aspectRatio"]);e!==void 0&&f!=null&&T(e,["parameters","aspectRatio"],f);const y=b(n,["guidanceScale"]);e!==void 0&&y!=null&&T(e,["parameters","guidanceScale"],y);const w=b(n,["seed"]);e!==void 0&&w!=null&&T(e,["parameters","seed"],w);const x=b(n,["safetyFilterLevel"]);e!==void 0&&x!=null&&T(e,["parameters","safetySetting"],x);const A=b(n,["personGeneration"]);e!==void 0&&A!=null&&T(e,["parameters","personGeneration"],A);const N=b(n,["includeSafetyAttributes"]);e!==void 0&&N!=null&&T(e,["parameters","includeSafetyAttributes"],N);const R=b(n,["includeRaiReason"]);e!==void 0&&R!=null&&T(e,["parameters","includeRaiReason"],R);const k=b(n,["language"]);e!==void 0&&k!=null&&T(e,["parameters","language"],k);const H=b(n,["outputMimeType"]);e!==void 0&&H!=null&&T(e,["parameters","outputOptions","mimeType"],H);const W=b(n,["outputCompressionQuality"]);e!==void 0&&W!=null&&T(e,["parameters","outputOptions","compressionQuality"],W);const K=b(n,["addWatermark"]);e!==void 0&&K!=null&&T(e,["parameters","addWatermark"],K);const te=b(n,["labels"]);e!==void 0&&te!=null&&T(e,["labels"],te);const le=b(n,["editMode"]);e!==void 0&&le!=null&&T(e,["parameters","editMode"],le);const ee=b(n,["baseSteps"]);return e!==void 0&&ee!=null&&T(e,["parameters","editConfig","baseSteps"],ee),t}function uI(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["prompt"]);o!=null&&T(t,["instances[0]","prompt"],o);const c=b(e,["referenceImages"]);if(c!=null){let y=c;Array.isArray(y)&&(y=y.map(w=>hR(w))),T(t,["instances[0]","referenceImages"],y)}const f=b(e,["config"]);return f!=null&&cI(f,t),t}function dI(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(c=>Kh(c))),T(e,["generatedImages"],o)}return e}function hI(n,e){const t={},i=b(n,["taskType"]);e!==void 0&&i!=null&&T(e,["requests[]","taskType"],i);const o=b(n,["title"]);e!==void 0&&o!=null&&T(e,["requests[]","title"],o);const c=b(n,["outputDimensionality"]);if(e!==void 0&&c!=null&&T(e,["requests[]","outputDimensionality"],c),b(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(b(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function fI(n,e){const t={},i=b(n,["taskType"]);e!==void 0&&i!=null&&T(e,["instances[]","task_type"],i);const o=b(n,["title"]);e!==void 0&&o!=null&&T(e,["instances[]","title"],o);const c=b(n,["outputDimensionality"]);e!==void 0&&c!=null&&T(e,["parameters","outputDimensionality"],c);const f=b(n,["mimeType"]);e!==void 0&&f!=null&&T(e,["instances[]","mimeType"],f);const y=b(n,["autoTruncate"]);return e!==void 0&&y!=null&&T(e,["parameters","autoTruncate"],y),t}function mI(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["contents"]);if(o!=null){let y=Ag(n,o);Array.isArray(y)&&(y=y.map(w=>w)),T(t,["requests[]","content"],y)}const c=b(e,["config"]);c!=null&&hI(c,t);const f=b(e,["model"]);return f!==void 0&&T(t,["requests[]","model"],gn(n,f)),t}function gI(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["contents"]);if(o!=null){let f=Ag(n,o);Array.isArray(f)&&(f=f.map(y=>y)),T(t,["instances[]","content"],f)}const c=b(e,["config"]);return c!=null&&fI(c,t),t}function pI(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["embeddings"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>f)),T(e,["embeddings"],c)}const o=b(n,["metadata"]);return o!=null&&T(e,["metadata"],o),e}function xI(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["predictions[]","embeddings"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>$N(f))),T(e,["embeddings"],c)}const o=b(n,["metadata"]);return o!=null&&T(e,["metadata"],o),e}function yI(n){const e={},t=b(n,["endpoint"]);t!=null&&T(e,["name"],t);const i=b(n,["deployedModelId"]);return i!=null&&T(e,["deployedModelId"],i),e}function vI(n){const e={};if(b(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=b(n,["fileUri"]);t!=null&&T(e,["fileUri"],t);const i=b(n,["mimeType"]);return i!=null&&T(e,["mimeType"],i),e}function wI(n){const e={},t=b(n,["id"]);t!=null&&T(e,["id"],t);const i=b(n,["args"]);i!=null&&T(e,["args"],i);const o=b(n,["name"]);if(o!=null&&T(e,["name"],o),b(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(b(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function bI(n){const e={},t=b(n,["mode"]);t!=null&&T(e,["mode"],t);const i=b(n,["allowedFunctionNames"]);if(i!=null&&T(e,["allowedFunctionNames"],i),b(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function EI(n){const e={};if(b(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=b(n,["description"]);t!=null&&T(e,["description"],t);const i=b(n,["name"]);i!=null&&T(e,["name"],i);const o=b(n,["parameters"]);o!=null&&T(e,["parameters"],o);const c=b(n,["parametersJsonSchema"]);c!=null&&T(e,["parametersJsonSchema"],c);const f=b(n,["response"]);f!=null&&T(e,["response"],f);const y=b(n,["responseJsonSchema"]);return y!=null&&T(e,["responseJsonSchema"],y),e}function _I(n,e,t){const i={},o=b(e,["systemInstruction"]);t!==void 0&&o!=null&&T(t,["systemInstruction"],Xh(ts(o)));const c=b(e,["temperature"]);c!=null&&T(i,["temperature"],c);const f=b(e,["topP"]);f!=null&&T(i,["topP"],f);const y=b(e,["topK"]);y!=null&&T(i,["topK"],y);const w=b(e,["candidateCount"]);w!=null&&T(i,["candidateCount"],w);const x=b(e,["maxOutputTokens"]);x!=null&&T(i,["maxOutputTokens"],x);const A=b(e,["stopSequences"]);A!=null&&T(i,["stopSequences"],A);const N=b(e,["responseLogprobs"]);N!=null&&T(i,["responseLogprobs"],N);const R=b(e,["logprobs"]);R!=null&&T(i,["logprobs"],R);const k=b(e,["presencePenalty"]);k!=null&&T(i,["presencePenalty"],k);const H=b(e,["frequencyPenalty"]);H!=null&&T(i,["frequencyPenalty"],H);const W=b(e,["seed"]);W!=null&&T(i,["seed"],W);const K=b(e,["responseMimeType"]);K!=null&&T(i,["responseMimeType"],K);const te=b(e,["responseSchema"]);te!=null&&T(i,["responseSchema"],Sg(te));const le=b(e,["responseJsonSchema"]);if(le!=null&&T(i,["responseJsonSchema"],le),b(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(b(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const ee=b(e,["safetySettings"]);if(t!==void 0&&ee!=null){let z=ee;Array.isArray(z)&&(z=z.map(_e=>fR(_e))),T(t,["safetySettings"],z)}const de=b(e,["tools"]);if(t!==void 0&&de!=null){let z=xc(de);Array.isArray(z)&&(z=z.map(_e=>wR(pc(_e)))),T(t,["tools"],z)}const Ee=b(e,["toolConfig"]);if(t!==void 0&&Ee!=null&&T(t,["toolConfig"],vR(Ee)),b(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const me=b(e,["cachedContent"]);t!==void 0&&me!=null&&T(t,["cachedContent"],Io(n,me));const U=b(e,["responseModalities"]);U!=null&&T(i,["responseModalities"],U);const V=b(e,["mediaResolution"]);V!=null&&T(i,["mediaResolution"],V);const F=b(e,["speechConfig"]);if(F!=null&&T(i,["speechConfig"],Cg(F)),b(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=b(e,["thinkingConfig"]);Q!=null&&T(i,["thinkingConfig"],Q);const Y=b(e,["imageConfig"]);Y!=null&&T(i,["imageConfig"],$I(Y));const $=b(e,["enableEnhancedCivicAnswers"]);return $!=null&&T(i,["enableEnhancedCivicAnswers"],$),i}function TI(n,e,t){const i={},o=b(e,["systemInstruction"]);t!==void 0&&o!=null&&T(t,["systemInstruction"],ts(o));const c=b(e,["temperature"]);c!=null&&T(i,["temperature"],c);const f=b(e,["topP"]);f!=null&&T(i,["topP"],f);const y=b(e,["topK"]);y!=null&&T(i,["topK"],y);const w=b(e,["candidateCount"]);w!=null&&T(i,["candidateCount"],w);const x=b(e,["maxOutputTokens"]);x!=null&&T(i,["maxOutputTokens"],x);const A=b(e,["stopSequences"]);A!=null&&T(i,["stopSequences"],A);const N=b(e,["responseLogprobs"]);N!=null&&T(i,["responseLogprobs"],N);const R=b(e,["logprobs"]);R!=null&&T(i,["logprobs"],R);const k=b(e,["presencePenalty"]);k!=null&&T(i,["presencePenalty"],k);const H=b(e,["frequencyPenalty"]);H!=null&&T(i,["frequencyPenalty"],H);const W=b(e,["seed"]);W!=null&&T(i,["seed"],W);const K=b(e,["responseMimeType"]);K!=null&&T(i,["responseMimeType"],K);const te=b(e,["responseSchema"]);te!=null&&T(i,["responseSchema"],Sg(te));const le=b(e,["responseJsonSchema"]);le!=null&&T(i,["responseJsonSchema"],le);const ee=b(e,["routingConfig"]);ee!=null&&T(i,["routingConfig"],ee);const de=b(e,["modelSelectionConfig"]);de!=null&&T(i,["modelConfig"],de);const Ee=b(e,["safetySettings"]);if(t!==void 0&&Ee!=null){let ne=Ee;Array.isArray(ne)&&(ne=ne.map(ie=>ie)),T(t,["safetySettings"],ne)}const me=b(e,["tools"]);if(t!==void 0&&me!=null){let ne=xc(me);Array.isArray(ne)&&(ne=ne.map(ie=>IE(pc(ie)))),T(t,["tools"],ne)}const U=b(e,["toolConfig"]);t!==void 0&&U!=null&&T(t,["toolConfig"],U);const V=b(e,["labels"]);t!==void 0&&V!=null&&T(t,["labels"],V);const F=b(e,["cachedContent"]);t!==void 0&&F!=null&&T(t,["cachedContent"],Io(n,F));const Q=b(e,["responseModalities"]);Q!=null&&T(i,["responseModalities"],Q);const Y=b(e,["mediaResolution"]);Y!=null&&T(i,["mediaResolution"],Y);const $=b(e,["speechConfig"]);$!=null&&T(i,["speechConfig"],Cg($));const z=b(e,["audioTimestamp"]);z!=null&&T(i,["audioTimestamp"],z);const _e=b(e,["thinkingConfig"]);_e!=null&&T(i,["thinkingConfig"],_e);const he=b(e,["imageConfig"]);if(he!=null&&T(i,["imageConfig"],JI(he)),b(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return i}function qv(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["contents"]);if(o!=null){let f=lr(o);Array.isArray(f)&&(f=f.map(y=>Xh(y))),T(t,["contents"],f)}const c=b(e,["config"]);return c!=null&&T(t,["generationConfig"],_I(n,c,t)),t}function Yv(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["contents"]);if(o!=null){let f=lr(o);Array.isArray(f)&&(f=f.map(y=>y)),T(t,["contents"],f)}const c=b(e,["config"]);return c!=null&&T(t,["generationConfig"],TI(n,c,t)),t}function Wv(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["candidates"]);if(i!=null){let w=i;Array.isArray(w)&&(w=w.map(x=>YN(x))),T(e,["candidates"],w)}const o=b(n,["modelVersion"]);o!=null&&T(e,["modelVersion"],o);const c=b(n,["promptFeedback"]);c!=null&&T(e,["promptFeedback"],c);const f=b(n,["responseId"]);f!=null&&T(e,["responseId"],f);const y=b(n,["usageMetadata"]);return y!=null&&T(e,["usageMetadata"],y),e}function Xv(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["candidates"]);if(i!=null){let x=i;Array.isArray(x)&&(x=x.map(A=>A)),T(e,["candidates"],x)}const o=b(n,["createTime"]);o!=null&&T(e,["createTime"],o);const c=b(n,["modelVersion"]);c!=null&&T(e,["modelVersion"],c);const f=b(n,["promptFeedback"]);f!=null&&T(e,["promptFeedback"],f);const y=b(n,["responseId"]);y!=null&&T(e,["responseId"],y);const w=b(n,["usageMetadata"]);return w!=null&&T(e,["usageMetadata"],w),e}function AI(n,e){const t={};if(b(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(b(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=b(n,["numberOfImages"]);e!==void 0&&i!=null&&T(e,["parameters","sampleCount"],i);const o=b(n,["aspectRatio"]);e!==void 0&&o!=null&&T(e,["parameters","aspectRatio"],o);const c=b(n,["guidanceScale"]);if(e!==void 0&&c!=null&&T(e,["parameters","guidanceScale"],c),b(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const f=b(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&T(e,["parameters","safetySetting"],f);const y=b(n,["personGeneration"]);e!==void 0&&y!=null&&T(e,["parameters","personGeneration"],y);const w=b(n,["includeSafetyAttributes"]);e!==void 0&&w!=null&&T(e,["parameters","includeSafetyAttributes"],w);const x=b(n,["includeRaiReason"]);e!==void 0&&x!=null&&T(e,["parameters","includeRaiReason"],x);const A=b(n,["language"]);e!==void 0&&A!=null&&T(e,["parameters","language"],A);const N=b(n,["outputMimeType"]);e!==void 0&&N!=null&&T(e,["parameters","outputOptions","mimeType"],N);const R=b(n,["outputCompressionQuality"]);if(e!==void 0&&R!=null&&T(e,["parameters","outputOptions","compressionQuality"],R),b(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(b(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const k=b(n,["imageSize"]);if(e!==void 0&&k!=null&&T(e,["parameters","sampleImageSize"],k),b(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function SI(n,e){const t={},i=b(n,["outputGcsUri"]);e!==void 0&&i!=null&&T(e,["parameters","storageUri"],i);const o=b(n,["negativePrompt"]);e!==void 0&&o!=null&&T(e,["parameters","negativePrompt"],o);const c=b(n,["numberOfImages"]);e!==void 0&&c!=null&&T(e,["parameters","sampleCount"],c);const f=b(n,["aspectRatio"]);e!==void 0&&f!=null&&T(e,["parameters","aspectRatio"],f);const y=b(n,["guidanceScale"]);e!==void 0&&y!=null&&T(e,["parameters","guidanceScale"],y);const w=b(n,["seed"]);e!==void 0&&w!=null&&T(e,["parameters","seed"],w);const x=b(n,["safetyFilterLevel"]);e!==void 0&&x!=null&&T(e,["parameters","safetySetting"],x);const A=b(n,["personGeneration"]);e!==void 0&&A!=null&&T(e,["parameters","personGeneration"],A);const N=b(n,["includeSafetyAttributes"]);e!==void 0&&N!=null&&T(e,["parameters","includeSafetyAttributes"],N);const R=b(n,["includeRaiReason"]);e!==void 0&&R!=null&&T(e,["parameters","includeRaiReason"],R);const k=b(n,["language"]);e!==void 0&&k!=null&&T(e,["parameters","language"],k);const H=b(n,["outputMimeType"]);e!==void 0&&H!=null&&T(e,["parameters","outputOptions","mimeType"],H);const W=b(n,["outputCompressionQuality"]);e!==void 0&&W!=null&&T(e,["parameters","outputOptions","compressionQuality"],W);const K=b(n,["addWatermark"]);e!==void 0&&K!=null&&T(e,["parameters","addWatermark"],K);const te=b(n,["labels"]);e!==void 0&&te!=null&&T(e,["labels"],te);const le=b(n,["imageSize"]);e!==void 0&&le!=null&&T(e,["parameters","sampleImageSize"],le);const ee=b(n,["enhancePrompt"]);return e!==void 0&&ee!=null&&T(e,["parameters","enhancePrompt"],ee),t}function CI(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["prompt"]);o!=null&&T(t,["instances[0]","prompt"],o);const c=b(e,["config"]);return c!=null&&AI(c,t),t}function NI(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["prompt"]);o!=null&&T(t,["instances[0]","prompt"],o);const c=b(e,["config"]);return c!=null&&SI(c,t),t}function II(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["predictions"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>VI(f))),T(e,["generatedImages"],c)}const o=b(n,["positivePromptSafetyAttributes"]);return o!=null&&T(e,["positivePromptSafetyAttributes"],CE(o)),e}function RI(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["predictions"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>Kh(f))),T(e,["generatedImages"],c)}const o=b(n,["positivePromptSafetyAttributes"]);return o!=null&&T(e,["positivePromptSafetyAttributes"],NE(o)),e}function MI(n,e){const t={},i=b(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&T(e,["parameters","sampleCount"],i),b(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(b(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=b(n,["durationSeconds"]);if(e!==void 0&&o!=null&&T(e,["parameters","durationSeconds"],o),b(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=b(n,["aspectRatio"]);e!==void 0&&c!=null&&T(e,["parameters","aspectRatio"],c);const f=b(n,["resolution"]);e!==void 0&&f!=null&&T(e,["parameters","resolution"],f);const y=b(n,["personGeneration"]);if(e!==void 0&&y!=null&&T(e,["parameters","personGeneration"],y),b(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const w=b(n,["negativePrompt"]);e!==void 0&&w!=null&&T(e,["parameters","negativePrompt"],w);const x=b(n,["enhancePrompt"]);if(e!==void 0&&x!=null&&T(e,["parameters","enhancePrompt"],x),b(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const A=b(n,["lastFrame"]);e!==void 0&&A!=null&&T(e,["instances[0]","lastFrame"],$h(A));const N=b(n,["referenceImages"]);if(e!==void 0&&N!=null){let R=N;Array.isArray(R)&&(R=R.map(k=>OR(k))),T(e,["instances[0]","referenceImages"],R)}if(b(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(b(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function DI(n,e){const t={},i=b(n,["numberOfVideos"]);e!==void 0&&i!=null&&T(e,["parameters","sampleCount"],i);const o=b(n,["outputGcsUri"]);e!==void 0&&o!=null&&T(e,["parameters","storageUri"],o);const c=b(n,["fps"]);e!==void 0&&c!=null&&T(e,["parameters","fps"],c);const f=b(n,["durationSeconds"]);e!==void 0&&f!=null&&T(e,["parameters","durationSeconds"],f);const y=b(n,["seed"]);e!==void 0&&y!=null&&T(e,["parameters","seed"],y);const w=b(n,["aspectRatio"]);e!==void 0&&w!=null&&T(e,["parameters","aspectRatio"],w);const x=b(n,["resolution"]);e!==void 0&&x!=null&&T(e,["parameters","resolution"],x);const A=b(n,["personGeneration"]);e!==void 0&&A!=null&&T(e,["parameters","personGeneration"],A);const N=b(n,["pubsubTopic"]);e!==void 0&&N!=null&&T(e,["parameters","pubsubTopic"],N);const R=b(n,["negativePrompt"]);e!==void 0&&R!=null&&T(e,["parameters","negativePrompt"],R);const k=b(n,["enhancePrompt"]);e!==void 0&&k!=null&&T(e,["parameters","enhancePrompt"],k);const H=b(n,["generateAudio"]);e!==void 0&&H!=null&&T(e,["parameters","generateAudio"],H);const W=b(n,["lastFrame"]);e!==void 0&&W!=null&&T(e,["instances[0]","lastFrame"],Er(W));const K=b(n,["referenceImages"]);if(e!==void 0&&K!=null){let ee=K;Array.isArray(ee)&&(ee=ee.map(de=>kR(de))),T(e,["instances[0]","referenceImages"],ee)}const te=b(n,["mask"]);e!==void 0&&te!=null&&T(e,["instances[0]","mask"],DR(te));const le=b(n,["compressionQuality"]);return e!==void 0&&le!=null&&T(e,["parameters","compressionQuality"],le),t}function OI(n){const e={},t=b(n,["name"]);t!=null&&T(e,["name"],t);const i=b(n,["metadata"]);i!=null&&T(e,["metadata"],i);const o=b(n,["done"]);o!=null&&T(e,["done"],o);const c=b(n,["error"]);c!=null&&T(e,["error"],c);const f=b(n,["response","generateVideoResponse"]);return f!=null&&T(e,["response"],UI(f)),e}function kI(n){const e={},t=b(n,["name"]);t!=null&&T(e,["name"],t);const i=b(n,["metadata"]);i!=null&&T(e,["metadata"],i);const o=b(n,["done"]);o!=null&&T(e,["done"],o);const c=b(n,["error"]);c!=null&&T(e,["error"],c);const f=b(n,["response"]);return f!=null&&T(e,["response"],BI(f)),e}function PI(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["prompt"]);o!=null&&T(t,["instances[0]","prompt"],o);const c=b(e,["image"]);c!=null&&T(t,["instances[0]","image"],$h(c));const f=b(e,["video"]);f!=null&&T(t,["instances[0]","video"],RE(f));const y=b(e,["source"]);y!=null&&FI(y,t);const w=b(e,["config"]);return w!=null&&MI(w,t),t}function LI(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["prompt"]);o!=null&&T(t,["instances[0]","prompt"],o);const c=b(e,["image"]);c!=null&&T(t,["instances[0]","image"],Er(c));const f=b(e,["video"]);f!=null&&T(t,["instances[0]","video"],ME(f));const y=b(e,["source"]);y!=null&&jI(y,t);const w=b(e,["config"]);return w!=null&&DI(w,t),t}function UI(n){const e={},t=b(n,["generatedSamples"]);if(t!=null){let c=t;Array.isArray(c)&&(c=c.map(f=>HI(f))),T(e,["generatedVideos"],c)}const i=b(n,["raiMediaFilteredCount"]);i!=null&&T(e,["raiMediaFilteredCount"],i);const o=b(n,["raiMediaFilteredReasons"]);return o!=null&&T(e,["raiMediaFilteredReasons"],o),e}function BI(n){const e={},t=b(n,["videos"]);if(t!=null){let c=t;Array.isArray(c)&&(c=c.map(f=>zI(f))),T(e,["generatedVideos"],c)}const i=b(n,["raiMediaFilteredCount"]);i!=null&&T(e,["raiMediaFilteredCount"],i);const o=b(n,["raiMediaFilteredReasons"]);return o!=null&&T(e,["raiMediaFilteredReasons"],o),e}function FI(n,e){const t={},i=b(n,["prompt"]);e!==void 0&&i!=null&&T(e,["instances[0]","prompt"],i);const o=b(n,["image"]);e!==void 0&&o!=null&&T(e,["instances[0]","image"],$h(o));const c=b(n,["video"]);return e!==void 0&&c!=null&&T(e,["instances[0]","video"],RE(c)),t}function jI(n,e){const t={},i=b(n,["prompt"]);e!==void 0&&i!=null&&T(e,["instances[0]","prompt"],i);const o=b(n,["image"]);e!==void 0&&o!=null&&T(e,["instances[0]","image"],Er(o));const c=b(n,["video"]);return e!==void 0&&c!=null&&T(e,["instances[0]","video"],ME(c)),t}function VI(n){const e={},t=b(n,["_self"]);t!=null&&T(e,["image"],QI(t));const i=b(n,["raiFilteredReason"]);i!=null&&T(e,["raiFilteredReason"],i);const o=b(n,["_self"]);return o!=null&&T(e,["safetyAttributes"],CE(o)),e}function Kh(n){const e={},t=b(n,["_self"]);t!=null&&T(e,["image"],SE(t));const i=b(n,["raiFilteredReason"]);i!=null&&T(e,["raiFilteredReason"],i);const o=b(n,["_self"]);o!=null&&T(e,["safetyAttributes"],NE(o));const c=b(n,["prompt"]);return c!=null&&T(e,["enhancedPrompt"],c),e}function GI(n){const e={},t=b(n,["_self"]);t!=null&&T(e,["mask"],SE(t));const i=b(n,["labels"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(c=>c)),T(e,["labels"],o)}return e}function HI(n){const e={},t=b(n,["video"]);return t!=null&&T(e,["video"],RR(t)),e}function zI(n){const e={},t=b(n,["_self"]);return t!=null&&T(e,["video"],MR(t)),e}function qI(n){const e={},t=b(n,["modelSelectionConfig"]);t!=null&&T(e,["modelConfig"],t);const i=b(n,["responseJsonSchema"]);i!=null&&T(e,["responseJsonSchema"],i);const o=b(n,["audioTimestamp"]);o!=null&&T(e,["audioTimestamp"],o);const c=b(n,["candidateCount"]);c!=null&&T(e,["candidateCount"],c);const f=b(n,["enableAffectiveDialog"]);f!=null&&T(e,["enableAffectiveDialog"],f);const y=b(n,["frequencyPenalty"]);y!=null&&T(e,["frequencyPenalty"],y);const w=b(n,["logprobs"]);w!=null&&T(e,["logprobs"],w);const x=b(n,["maxOutputTokens"]);x!=null&&T(e,["maxOutputTokens"],x);const A=b(n,["mediaResolution"]);A!=null&&T(e,["mediaResolution"],A);const N=b(n,["presencePenalty"]);N!=null&&T(e,["presencePenalty"],N);const R=b(n,["responseLogprobs"]);R!=null&&T(e,["responseLogprobs"],R);const k=b(n,["responseMimeType"]);k!=null&&T(e,["responseMimeType"],k);const H=b(n,["responseModalities"]);H!=null&&T(e,["responseModalities"],H);const W=b(n,["responseSchema"]);W!=null&&T(e,["responseSchema"],W);const K=b(n,["routingConfig"]);K!=null&&T(e,["routingConfig"],K);const te=b(n,["seed"]);te!=null&&T(e,["seed"],te);const le=b(n,["speechConfig"]);le!=null&&T(e,["speechConfig"],le);const ee=b(n,["stopSequences"]);ee!=null&&T(e,["stopSequences"],ee);const de=b(n,["temperature"]);de!=null&&T(e,["temperature"],de);const Ee=b(n,["thinkingConfig"]);Ee!=null&&T(e,["thinkingConfig"],Ee);const me=b(n,["topK"]);me!=null&&T(e,["topK"],me);const U=b(n,["topP"]);if(U!=null&&T(e,["topP"],U),b(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function YI(n,e){const t={},i=b(e,["model"]);return i!=null&&T(t,["_url","name"],gn(n,i)),t}function WI(n,e){const t={},i=b(e,["model"]);return i!=null&&T(t,["_url","name"],gn(n,i)),t}function XI(n){const e={};if(b(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=b(n,["enableWidget"]);return t!=null&&T(e,["enableWidget"],t),e}function KI(n){const e={};if(b(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(b(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=b(n,["timeRangeFilter"]);return t!=null&&T(e,["timeRangeFilter"],t),e}function $I(n){const e={},t=b(n,["aspectRatio"]);t!=null&&T(e,["aspectRatio"],t);const i=b(n,["imageSize"]);if(i!=null&&T(e,["imageSize"],i),b(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(b(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function JI(n){const e={},t=b(n,["aspectRatio"]);t!=null&&T(e,["aspectRatio"],t);const i=b(n,["imageSize"]);i!=null&&T(e,["imageSize"],i);const o=b(n,["outputMimeType"]);o!=null&&T(e,["imageOutputOptions","mimeType"],o);const c=b(n,["outputCompressionQuality"]);return c!=null&&T(e,["imageOutputOptions","compressionQuality"],c),e}function QI(n){const e={},t=b(n,["bytesBase64Encoded"]);t!=null&&T(e,["imageBytes"],Ca(t));const i=b(n,["mimeType"]);return i!=null&&T(e,["mimeType"],i),e}function SE(n){const e={},t=b(n,["gcsUri"]);t!=null&&T(e,["gcsUri"],t);const i=b(n,["bytesBase64Encoded"]);i!=null&&T(e,["imageBytes"],Ca(i));const o=b(n,["mimeType"]);return o!=null&&T(e,["mimeType"],o),e}function $h(n){const e={};if(b(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=b(n,["imageBytes"]);t!=null&&T(e,["bytesBase64Encoded"],Ca(t));const i=b(n,["mimeType"]);return i!=null&&T(e,["mimeType"],i),e}function Er(n){const e={},t=b(n,["gcsUri"]);t!=null&&T(e,["gcsUri"],t);const i=b(n,["imageBytes"]);i!=null&&T(e,["bytesBase64Encoded"],Ca(i));const o=b(n,["mimeType"]);return o!=null&&T(e,["mimeType"],o),e}function ZI(n,e,t){const i={},o=b(e,["pageSize"]);t!==void 0&&o!=null&&T(t,["_query","pageSize"],o);const c=b(e,["pageToken"]);t!==void 0&&c!=null&&T(t,["_query","pageToken"],c);const f=b(e,["filter"]);t!==void 0&&f!=null&&T(t,["_query","filter"],f);const y=b(e,["queryBase"]);return t!==void 0&&y!=null&&T(t,["_url","models_url"],vE(n,y)),i}function eR(n,e,t){const i={},o=b(e,["pageSize"]);t!==void 0&&o!=null&&T(t,["_query","pageSize"],o);const c=b(e,["pageToken"]);t!==void 0&&c!=null&&T(t,["_query","pageToken"],c);const f=b(e,["filter"]);t!==void 0&&f!=null&&T(t,["_query","filter"],f);const y=b(e,["queryBase"]);return t!==void 0&&y!=null&&T(t,["_url","models_url"],vE(n,y)),i}function tR(n,e){const t={},i=b(e,["config"]);return i!=null&&ZI(n,i,t),t}function nR(n,e){const t={},i=b(e,["config"]);return i!=null&&eR(n,i,t),t}function iR(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["nextPageToken"]);i!=null&&T(e,["nextPageToken"],i);const o=b(n,["_self"]);if(o!=null){let c=wE(o);Array.isArray(c)&&(c=c.map(f=>Lm(f))),T(e,["models"],c)}return e}function sR(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["nextPageToken"]);i!=null&&T(e,["nextPageToken"],i);const o=b(n,["_self"]);if(o!=null){let c=wE(o);Array.isArray(c)&&(c=c.map(f=>Um(f))),T(e,["models"],c)}return e}function rR(n){const e={},t=b(n,["maskMode"]);t!=null&&T(e,["maskMode"],t);const i=b(n,["segmentationClasses"]);i!=null&&T(e,["maskClasses"],i);const o=b(n,["maskDilation"]);return o!=null&&T(e,["dilation"],o),e}function Lm(n){const e={},t=b(n,["name"]);t!=null&&T(e,["name"],t);const i=b(n,["displayName"]);i!=null&&T(e,["displayName"],i);const o=b(n,["description"]);o!=null&&T(e,["description"],o);const c=b(n,["version"]);c!=null&&T(e,["version"],c);const f=b(n,["_self"]);f!=null&&T(e,["tunedModelInfo"],bR(f));const y=b(n,["inputTokenLimit"]);y!=null&&T(e,["inputTokenLimit"],y);const w=b(n,["outputTokenLimit"]);w!=null&&T(e,["outputTokenLimit"],w);const x=b(n,["supportedGenerationMethods"]);x!=null&&T(e,["supportedActions"],x);const A=b(n,["temperature"]);A!=null&&T(e,["temperature"],A);const N=b(n,["maxTemperature"]);N!=null&&T(e,["maxTemperature"],N);const R=b(n,["topP"]);R!=null&&T(e,["topP"],R);const k=b(n,["topK"]);k!=null&&T(e,["topK"],k);const H=b(n,["thinking"]);return H!=null&&T(e,["thinking"],H),e}function Um(n){const e={},t=b(n,["name"]);t!=null&&T(e,["name"],t);const i=b(n,["displayName"]);i!=null&&T(e,["displayName"],i);const o=b(n,["description"]);o!=null&&T(e,["description"],o);const c=b(n,["versionId"]);c!=null&&T(e,["version"],c);const f=b(n,["deployedModels"]);if(f!=null){let N=f;Array.isArray(N)&&(N=N.map(R=>yI(R))),T(e,["endpoints"],N)}const y=b(n,["labels"]);y!=null&&T(e,["labels"],y);const w=b(n,["_self"]);w!=null&&T(e,["tunedModelInfo"],ER(w));const x=b(n,["defaultCheckpointId"]);x!=null&&T(e,["defaultCheckpointId"],x);const A=b(n,["checkpoints"]);if(A!=null){let N=A;Array.isArray(N)&&(N=N.map(R=>R)),T(e,["checkpoints"],N)}return e}function oR(n){const e={},t=b(n,["mediaResolution"]);t!=null&&T(e,["mediaResolution"],t);const i=b(n,["codeExecutionResult"]);i!=null&&T(e,["codeExecutionResult"],i);const o=b(n,["executableCode"]);o!=null&&T(e,["executableCode"],o);const c=b(n,["fileData"]);c!=null&&T(e,["fileData"],vI(c));const f=b(n,["functionCall"]);f!=null&&T(e,["functionCall"],wI(f));const y=b(n,["functionResponse"]);y!=null&&T(e,["functionResponse"],y);const w=b(n,["inlineData"]);w!=null&&T(e,["inlineData"],qN(w));const x=b(n,["text"]);x!=null&&T(e,["text"],x);const A=b(n,["thought"]);A!=null&&T(e,["thought"],A);const N=b(n,["thoughtSignature"]);N!=null&&T(e,["thoughtSignature"],N);const R=b(n,["videoMetadata"]);return R!=null&&T(e,["videoMetadata"],R),e}function aR(n){const e={},t=b(n,["productImage"]);return t!=null&&T(e,["image"],Er(t)),e}function lR(n,e){const t={},i=b(n,["numberOfImages"]);e!==void 0&&i!=null&&T(e,["parameters","sampleCount"],i);const o=b(n,["baseSteps"]);e!==void 0&&o!=null&&T(e,["parameters","baseSteps"],o);const c=b(n,["outputGcsUri"]);e!==void 0&&c!=null&&T(e,["parameters","storageUri"],c);const f=b(n,["seed"]);e!==void 0&&f!=null&&T(e,["parameters","seed"],f);const y=b(n,["safetyFilterLevel"]);e!==void 0&&y!=null&&T(e,["parameters","safetySetting"],y);const w=b(n,["personGeneration"]);e!==void 0&&w!=null&&T(e,["parameters","personGeneration"],w);const x=b(n,["addWatermark"]);e!==void 0&&x!=null&&T(e,["parameters","addWatermark"],x);const A=b(n,["outputMimeType"]);e!==void 0&&A!=null&&T(e,["parameters","outputOptions","mimeType"],A);const N=b(n,["outputCompressionQuality"]);e!==void 0&&N!=null&&T(e,["parameters","outputOptions","compressionQuality"],N);const R=b(n,["enhancePrompt"]);e!==void 0&&R!=null&&T(e,["parameters","enhancePrompt"],R);const k=b(n,["labels"]);return e!==void 0&&k!=null&&T(e,["labels"],k),t}function cR(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["source"]);o!=null&&dR(o,t);const c=b(e,["config"]);return c!=null&&lR(c,t),t}function uR(n){const e={},t=b(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>Kh(o))),T(e,["generatedImages"],i)}return e}function dR(n,e){const t={},i=b(n,["prompt"]);e!==void 0&&i!=null&&T(e,["instances[0]","prompt"],i);const o=b(n,["personImage"]);e!==void 0&&o!=null&&T(e,["instances[0]","personImage","image"],Er(o));const c=b(n,["productImages"]);if(e!==void 0&&c!=null){let f=c;Array.isArray(f)&&(f=f.map(y=>aR(y))),T(e,["instances[0]","productImages"],f)}return t}function hR(n){const e={},t=b(n,["referenceImage"]);t!=null&&T(e,["referenceImage"],Er(t));const i=b(n,["referenceId"]);i!=null&&T(e,["referenceId"],i);const o=b(n,["referenceType"]);o!=null&&T(e,["referenceType"],o);const c=b(n,["maskImageConfig"]);c!=null&&T(e,["maskImageConfig"],rR(c));const f=b(n,["controlImageConfig"]);f!=null&&T(e,["controlImageConfig"],QN(f));const y=b(n,["styleImageConfig"]);y!=null&&T(e,["styleImageConfig"],y);const w=b(n,["subjectImageConfig"]);return w!=null&&T(e,["subjectImageConfig"],w),e}function CE(n){const e={},t=b(n,["safetyAttributes","categories"]);t!=null&&T(e,["categories"],t);const i=b(n,["safetyAttributes","scores"]);i!=null&&T(e,["scores"],i);const o=b(n,["contentType"]);return o!=null&&T(e,["contentType"],o),e}function NE(n){const e={},t=b(n,["safetyAttributes","categories"]);t!=null&&T(e,["categories"],t);const i=b(n,["safetyAttributes","scores"]);i!=null&&T(e,["scores"],i);const o=b(n,["contentType"]);return o!=null&&T(e,["contentType"],o),e}function fR(n){const e={},t=b(n,["category"]);if(t!=null&&T(e,["category"],t),b(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=b(n,["threshold"]);return i!=null&&T(e,["threshold"],i),e}function mR(n){const e={},t=b(n,["image"]);return t!=null&&T(e,["image"],Er(t)),e}function gR(n,e){const t={},i=b(n,["mode"]);e!==void 0&&i!=null&&T(e,["parameters","mode"],i);const o=b(n,["maxPredictions"]);e!==void 0&&o!=null&&T(e,["parameters","maxPredictions"],o);const c=b(n,["confidenceThreshold"]);e!==void 0&&c!=null&&T(e,["parameters","confidenceThreshold"],c);const f=b(n,["maskDilation"]);e!==void 0&&f!=null&&T(e,["parameters","maskDilation"],f);const y=b(n,["binaryColorThreshold"]);e!==void 0&&y!=null&&T(e,["parameters","binaryColorThreshold"],y);const w=b(n,["labels"]);return e!==void 0&&w!=null&&T(e,["labels"],w),t}function pR(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["source"]);o!=null&&yR(o,t);const c=b(e,["config"]);return c!=null&&gR(c,t),t}function xR(n){const e={},t=b(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>GI(o))),T(e,["generatedMasks"],i)}return e}function yR(n,e){const t={},i=b(n,["prompt"]);e!==void 0&&i!=null&&T(e,["instances[0]","prompt"],i);const o=b(n,["image"]);e!==void 0&&o!=null&&T(e,["instances[0]","image"],Er(o));const c=b(n,["scribbleImage"]);return e!==void 0&&c!=null&&T(e,["instances[0]","scribble"],mR(c)),t}function vR(n){const e={},t=b(n,["functionCallingConfig"]);t!=null&&T(e,["functionCallingConfig"],bI(t));const i=b(n,["retrievalConfig"]);return i!=null&&T(e,["retrievalConfig"],i),e}function wR(n){const e={},t=b(n,["functionDeclarations"]);if(t!=null){let A=t;Array.isArray(A)&&(A=A.map(N=>N)),T(e,["functionDeclarations"],A)}if(b(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=b(n,["googleSearchRetrieval"]);i!=null&&T(e,["googleSearchRetrieval"],i);const o=b(n,["computerUse"]);o!=null&&T(e,["computerUse"],o);const c=b(n,["fileSearch"]);c!=null&&T(e,["fileSearch"],c);const f=b(n,["codeExecution"]);if(f!=null&&T(e,["codeExecution"],f),b(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const y=b(n,["googleMaps"]);y!=null&&T(e,["googleMaps"],XI(y));const w=b(n,["googleSearch"]);w!=null&&T(e,["googleSearch"],KI(w));const x=b(n,["urlContext"]);return x!=null&&T(e,["urlContext"],x),e}function IE(n){const e={},t=b(n,["functionDeclarations"]);if(t!=null){let N=t;Array.isArray(N)&&(N=N.map(R=>EI(R))),T(e,["functionDeclarations"],N)}const i=b(n,["retrieval"]);i!=null&&T(e,["retrieval"],i);const o=b(n,["googleSearchRetrieval"]);o!=null&&T(e,["googleSearchRetrieval"],o);const c=b(n,["computerUse"]);if(c!=null&&T(e,["computerUse"],c),b(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const f=b(n,["codeExecution"]);f!=null&&T(e,["codeExecution"],f);const y=b(n,["enterpriseWebSearch"]);y!=null&&T(e,["enterpriseWebSearch"],y);const w=b(n,["googleMaps"]);w!=null&&T(e,["googleMaps"],w);const x=b(n,["googleSearch"]);x!=null&&T(e,["googleSearch"],x);const A=b(n,["urlContext"]);return A!=null&&T(e,["urlContext"],A),e}function bR(n){const e={},t=b(n,["baseModel"]);t!=null&&T(e,["baseModel"],t);const i=b(n,["createTime"]);i!=null&&T(e,["createTime"],i);const o=b(n,["updateTime"]);return o!=null&&T(e,["updateTime"],o),e}function ER(n){const e={},t=b(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&T(e,["baseModel"],t);const i=b(n,["createTime"]);i!=null&&T(e,["createTime"],i);const o=b(n,["updateTime"]);return o!=null&&T(e,["updateTime"],o),e}function _R(n,e){const t={},i=b(n,["displayName"]);e!==void 0&&i!=null&&T(e,["displayName"],i);const o=b(n,["description"]);e!==void 0&&o!=null&&T(e,["description"],o);const c=b(n,["defaultCheckpointId"]);return e!==void 0&&c!=null&&T(e,["defaultCheckpointId"],c),t}function TR(n,e){const t={},i=b(n,["displayName"]);e!==void 0&&i!=null&&T(e,["displayName"],i);const o=b(n,["description"]);e!==void 0&&o!=null&&T(e,["description"],o);const c=b(n,["defaultCheckpointId"]);return e!==void 0&&c!=null&&T(e,["defaultCheckpointId"],c),t}function AR(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","name"],gn(n,i));const o=b(e,["config"]);return o!=null&&_R(o,t),t}function SR(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["config"]);return o!=null&&TR(o,t),t}function CR(n,e){const t={},i=b(n,["outputGcsUri"]);e!==void 0&&i!=null&&T(e,["parameters","storageUri"],i);const o=b(n,["safetyFilterLevel"]);e!==void 0&&o!=null&&T(e,["parameters","safetySetting"],o);const c=b(n,["personGeneration"]);e!==void 0&&c!=null&&T(e,["parameters","personGeneration"],c);const f=b(n,["includeRaiReason"]);e!==void 0&&f!=null&&T(e,["parameters","includeRaiReason"],f);const y=b(n,["outputMimeType"]);e!==void 0&&y!=null&&T(e,["parameters","outputOptions","mimeType"],y);const w=b(n,["outputCompressionQuality"]);e!==void 0&&w!=null&&T(e,["parameters","outputOptions","compressionQuality"],w);const x=b(n,["enhanceInputImage"]);e!==void 0&&x!=null&&T(e,["parameters","upscaleConfig","enhanceInputImage"],x);const A=b(n,["imagePreservationFactor"]);e!==void 0&&A!=null&&T(e,["parameters","upscaleConfig","imagePreservationFactor"],A);const N=b(n,["labels"]);e!==void 0&&N!=null&&T(e,["labels"],N);const R=b(n,["numberOfImages"]);e!==void 0&&R!=null&&T(e,["parameters","sampleCount"],R);const k=b(n,["mode"]);return e!==void 0&&k!=null&&T(e,["parameters","mode"],k),t}function NR(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["_url","model"],gn(n,i));const o=b(e,["image"]);o!=null&&T(t,["instances[0]","image"],Er(o));const c=b(e,["upscaleFactor"]);c!=null&&T(t,["parameters","upscaleConfig","upscaleFactor"],c);const f=b(e,["config"]);return f!=null&&CR(f,t),t}function IR(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(c=>Kh(c))),T(e,["generatedImages"],o)}return e}function RR(n){const e={},t=b(n,["uri"]);t!=null&&T(e,["uri"],t);const i=b(n,["encodedVideo"]);i!=null&&T(e,["videoBytes"],Ca(i));const o=b(n,["encoding"]);return o!=null&&T(e,["mimeType"],o),e}function MR(n){const e={},t=b(n,["gcsUri"]);t!=null&&T(e,["uri"],t);const i=b(n,["bytesBase64Encoded"]);i!=null&&T(e,["videoBytes"],Ca(i));const o=b(n,["mimeType"]);return o!=null&&T(e,["mimeType"],o),e}function DR(n){const e={},t=b(n,["image"]);t!=null&&T(e,["_self"],Er(t));const i=b(n,["maskMode"]);return i!=null&&T(e,["maskMode"],i),e}function OR(n){const e={},t=b(n,["image"]);t!=null&&T(e,["image"],$h(t));const i=b(n,["referenceType"]);return i!=null&&T(e,["referenceType"],i),e}function kR(n){const e={},t=b(n,["image"]);t!=null&&T(e,["image"],Er(t));const i=b(n,["referenceType"]);return i!=null&&T(e,["referenceType"],i),e}function RE(n){const e={},t=b(n,["uri"]);t!=null&&T(e,["uri"],t);const i=b(n,["videoBytes"]);i!=null&&T(e,["encodedVideo"],Ca(i));const o=b(n,["mimeType"]);return o!=null&&T(e,["encoding"],o),e}function ME(n){const e={},t=b(n,["uri"]);t!=null&&T(e,["gcsUri"],t);const i=b(n,["videoBytes"]);i!=null&&T(e,["bytesBase64Encoded"],Ca(i));const o=b(n,["mimeType"]);return o!=null&&T(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PR(n,e){const t={},i=b(n,["displayName"]);return e!==void 0&&i!=null&&T(e,["displayName"],i),t}function LR(n){const e={},t=b(n,["config"]);return t!=null&&PR(t,e),e}function UR(n,e){const t={},i=b(n,["force"]);return e!==void 0&&i!=null&&T(e,["_query","force"],i),t}function BR(n){const e={},t=b(n,["name"]);t!=null&&T(e,["_url","name"],t);const i=b(n,["config"]);return i!=null&&UR(i,e),e}function FR(n){const e={},t=b(n,["name"]);return t!=null&&T(e,["_url","name"],t),e}function jR(n,e){const t={},i=b(n,["customMetadata"]);if(e!==void 0&&i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>f)),T(e,["customMetadata"],c)}const o=b(n,["chunkingConfig"]);return e!==void 0&&o!=null&&T(e,["chunkingConfig"],o),t}function VR(n){const e={},t=b(n,["name"]);t!=null&&T(e,["name"],t);const i=b(n,["metadata"]);i!=null&&T(e,["metadata"],i);const o=b(n,["done"]);o!=null&&T(e,["done"],o);const c=b(n,["error"]);c!=null&&T(e,["error"],c);const f=b(n,["response"]);return f!=null&&T(e,["response"],HR(f)),e}function GR(n){const e={},t=b(n,["fileSearchStoreName"]);t!=null&&T(e,["_url","file_search_store_name"],t);const i=b(n,["fileName"]);i!=null&&T(e,["fileName"],i);const o=b(n,["config"]);return o!=null&&jR(o,e),e}function HR(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["parent"]);i!=null&&T(e,["parent"],i);const o=b(n,["documentName"]);return o!=null&&T(e,["documentName"],o),e}function zR(n,e){const t={},i=b(n,["pageSize"]);e!==void 0&&i!=null&&T(e,["_query","pageSize"],i);const o=b(n,["pageToken"]);return e!==void 0&&o!=null&&T(e,["_query","pageToken"],o),t}function qR(n){const e={},t=b(n,["config"]);return t!=null&&zR(t,e),e}function YR(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["nextPageToken"]);i!=null&&T(e,["nextPageToken"],i);const o=b(n,["fileSearchStores"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>f)),T(e,["fileSearchStores"],c)}return e}function DE(n,e){const t={},i=b(n,["mimeType"]);e!==void 0&&i!=null&&T(e,["mimeType"],i);const o=b(n,["displayName"]);e!==void 0&&o!=null&&T(e,["displayName"],o);const c=b(n,["customMetadata"]);if(e!==void 0&&c!=null){let y=c;Array.isArray(y)&&(y=y.map(w=>w)),T(e,["customMetadata"],y)}const f=b(n,["chunkingConfig"]);return e!==void 0&&f!=null&&T(e,["chunkingConfig"],f),t}function WR(n){const e={},t=b(n,["fileSearchStoreName"]);t!=null&&T(e,["_url","file_search_store_name"],t);const i=b(n,["config"]);return i!=null&&DE(i,e),e}function XR(n){const e={},t=b(n,["sdkHttpResponse"]);return t!=null&&T(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KR="Content-Type",$R="X-Server-Timeout",JR="User-Agent",Bm="x-goog-api-client",QR="1.34.0",ZR=`google-genai-sdk/${QR}`,e3="v1beta1",t3="v1beta";class n3{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:e3,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:t3,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const o=[this.getRequestUrlInternal(t)];return i&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[f,y]of Object.entries(e.queryParams))o.searchParams.append(f,String(y));let c={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else c.body=e.body;return c=await this.includeExtraHttpOptionsToRequestInit(c,t,o.toString(),e.abortSignal),this.unaryApiCall(o,c,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[o,c]of Object.entries(t))typeof c=="object"?i[o]=Object.assign(Object.assign({},i[o]),c):c!==void 0&&(i[o]=c);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,i);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let c={};return c.body=e.body,c=await this.includeExtraHttpOptionsToRequestInit(c,t,o.toString(),e.abortSignal),this.streamApiCall(o,c,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,o){if(t&&t.timeout||o){const c=new AbortController,f=c.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const y=setTimeout(()=>c.abort(),t.timeout);y&&typeof y.unref=="function"&&y.unref()}o&&o.addEventListener("abort",()=>{c.abort()}),e.signal=f}return t&&t.extraBody!==null&&i3(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async o=>(await Kv(o),new Om(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async o=>(await Kv(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){return vr(this,arguments,function*(){var i;const o=(i=e==null?void 0:e.body)===null||i===void 0?void 0:i.getReader(),c=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let f="";const y="data:",w=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:x,value:A}=yield It(o.read());if(x){if(f.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const N=c.decode(A,{stream:!0});try{const H=JSON.parse(N);if("error"in H){const W=JSON.parse(JSON.stringify(H.error)),K=W.status,te=W.code,le=`got status: ${K}. ${JSON.stringify(H)}`;if(te>=400&&te<600)throw new Wh({message:le,status:te})}}catch(H){if(H.name==="ApiError")throw H}f+=N;let R=-1,k=0;for(;;){R=-1,k=0;for(const K of w){const te=f.indexOf(K);te!==-1&&(R===-1||te<R)&&(R=te,k=K.length)}if(R===-1)break;const H=f.substring(0,R);f=f.substring(R+k);const W=H.trim();if(W.startsWith(y)){const K=W.substring(y.length).trim();try{const te=new Response(K,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield It(new Om(te))}catch(te){throw new Error(`exception parsing stream chunk ${K}. ${te}`)}}}}}finally{o.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=ZR+" "+this.clientOptions.userAgentExtra;return e[JR]=t,e[Bm]=t,e[KR]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[o,c]of Object.entries(e.headers))i.append(o,c);e.timeout&&e.timeout>0&&i.append($R,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const o={};t!=null&&(o.mimeType=t.mimeType,o.name=t.name,o.displayName=t.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const c=this.clientOptions.uploader,f=await c.stat(e);o.sizeBytes=String(f.size);const y=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:f.type;if(y===void 0||y==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=y;const w={file:o},x=this.getFileName(e),A=et("upload/v1beta/files",w._url),N=await this.fetchUploadUrl(A,o.sizeBytes,o.mimeType,x,w,t==null?void 0:t.httpOptions);return c.upload(e,N,this)}async uploadFileToFileSearchStore(e,t,i){var o;const c=this.clientOptions.uploader,f=await c.stat(t),y=String(f.size),w=(o=i==null?void 0:i.mimeType)!==null&&o!==void 0?o:f.type;if(w===void 0||w==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const x=`upload/v1beta/${e}:uploadToFileSearchStore`,A=this.getFileName(t),N={};i!=null&&DE(i,N);const R=await this.fetchUploadUrl(x,y,w,A,N,i==null?void 0:i.httpOptions);return c.uploadToFileSearchStore(t,R,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,o,c,f){var y;let w={};f?w=f:w={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},o?{"X-Goog-Upload-File-Name":o}:{})};const x=await this.request({path:e,body:JSON.stringify(c),httpMethod:"POST",httpOptions:w});if(!x||!(x!=null&&x.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const A=(y=x==null?void 0:x.headers)===null||y===void 0?void 0:y["x-goog-upload-url"];if(A===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return A}}async function Kv(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const o=JSON.stringify(i);throw t>=400&&t<600?new Wh({message:o,status:t}):new Error(o)}}function i3(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const c=JSON.parse(n.body);if(typeof c=="object"&&c!==null&&!Array.isArray(c))t=c;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(c,f){const y=Object.assign({},c);for(const w in f)if(Object.prototype.hasOwnProperty.call(f,w)){const x=f[w],A=y[w];x&&typeof x=="object"&&!Array.isArray(x)&&A&&typeof A=="object"&&!Array.isArray(A)?y[w]=i(A,x):(A&&x&&typeof A!=typeof x&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${w}". Original type: ${typeof A}, New type: ${typeof x}. Overwriting.`),y[w]=x)}return y}const o=i(t,e);n.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const s3="mcp_used/unknown";let r3=!1;function OE(n){for(const e of n)if(o3(e)||typeof e=="object"&&"inputSchema"in e)return!0;return r3}function kE(n){var e;const t=(e=n[Bm])!==null&&e!==void 0?e:"";n[Bm]=(t+` ${s3}`).trimStart()}function o3(n){return n!==null&&typeof n=="object"&&n instanceof Ig}function a3(n){return vr(this,arguments,function*(t,i=100){let o,c=0;for(;c<i;){const f=yield It(t.listTools({cursor:o}));for(const y of f.tools)yield yield It(y),c++;if(!f.nextCursor)break;o=f.nextCursor}})}class Ig{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Ig(e,t)}async initialize(){var e,t,i,o;if(this.mcpTools.length>0)return;const c={},f=[];for(const A of this.mcpClients)try{for(var y=!0,w=(t=void 0,wr(a3(A))),x;x=await w.next(),e=x.done,!e;y=!0){o=x.value,y=!1;const N=o;f.push(N);const R=N.name;if(c[R])throw new Error(`Duplicate function name ${R} found in MCP tools. Please ensure function names are unique.`);c[R]=A}}catch(N){t={error:N}}finally{try{!y&&!e&&(i=w.return)&&await i.call(w)}finally{if(t)throw t.error}}this.mcpTools=f,this.functionNameToMcpClient=c}async tool(){return await this.initialize(),FS(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[i.name];let c;this.config.timeout&&(c={timeout:this.config.timeout});const f=await o.callTool({name:i.name,arguments:i.args},void 0,c);t.push({functionResponse:{name:i.name,response:f.isError?{error:f}:f}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function l3(n,e,t){const i=new MS;let o;t.data instanceof Blob?o=JSON.parse(await t.data.text()):o=JSON.parse(t.data),Object.assign(i,o),e(i)}class c3{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion(),f=h3(this.apiClient.getDefaultHeaders()),y=this.apiClient.getApiKey(),w=`${o}/ws/google.ai.generativelanguage.${c}.GenerativeService.BidiGenerateMusic?key=${y}`;let x=()=>{};const A=new Promise(ee=>{x=ee}),N=e.callbacks,R=function(){x({})},k=this.apiClient,H={onopen:R,onmessage:ee=>{l3(k,N.onmessage,ee)},onerror:(t=N==null?void 0:N.onerror)!==null&&t!==void 0?t:function(ee){},onclose:(i=N==null?void 0:N.onclose)!==null&&i!==void 0?i:function(ee){}},W=this.webSocketFactory.create(w,d3(f),H);W.connect(),await A;const le={setup:{model:gn(this.apiClient,e.model)}};return W.send(JSON.stringify(le)),new u3(W,this.apiClient)}}class u3{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=LN(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=PN(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Xl.PLAY)}pause(){this.sendPlaybackControl(Xl.PAUSE)}stop(){this.sendPlaybackControl(Xl.STOP)}resetContext(){this.sendPlaybackControl(Xl.RESET_CONTEXT)}close(){this.conn.close()}}function d3(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function h3(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const f3="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function m3(n,e,t){const i=new RS;let o;t.data instanceof Blob?o=await t.data.text():t.data instanceof ArrayBuffer?o=new TextDecoder().decode(t.data):o=t.data;const c=JSON.parse(o);if(n.isVertexAI()){const f=FN(c);Object.assign(i,f)}else Object.assign(i,c);e(i)}class g3{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new c3(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,o,c,f,y;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const w=this.apiClient.getWebsocketBaseUrl(),x=this.apiClient.getApiVersion();let A;const N=this.apiClient.getHeaders();e.config&&e.config.tools&&OE(e.config.tools)&&kE(N);const R=v3(N);if(this.apiClient.isVertexAI())A=`${w}/ws/google.cloud.aiplatform.${x}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(R,A);else{const F=this.apiClient.getApiKey();let Q="BidiGenerateContent",Y="key";F!=null&&F.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),x!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),Q="BidiGenerateContentConstrained",Y="access_token"),A=`${w}/ws/google.ai.generativelanguage.${x}.GenerativeService.${Q}?${Y}=${F}`}let k=()=>{};const H=new Promise(F=>{k=F}),W=e.callbacks,K=function(){var F;(F=W==null?void 0:W.onopen)===null||F===void 0||F.call(W),k({})},te=this.apiClient,le={onopen:K,onmessage:F=>{m3(te,W.onmessage,F)},onerror:(t=W==null?void 0:W.onerror)!==null&&t!==void 0?t:function(F){},onclose:(i=W==null?void 0:W.onclose)!==null&&i!==void 0?i:function(F){}},ee=this.webSocketFactory.create(A,y3(R),le);ee.connect(),await H;let de=gn(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&de.startsWith("publishers/")){const F=this.apiClient.getProject(),Q=this.apiClient.getLocation();de=`projects/${F}/locations/${Q}/`+de}let Ee={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Tu.AUDIO]}:e.config.responseModalities=[Tu.AUDIO]),!((c=e.config)===null||c===void 0)&&c.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const me=(y=(f=e.config)===null||f===void 0?void 0:f.tools)!==null&&y!==void 0?y:[],U=[];for(const F of me)if(this.isCallableTool(F)){const Q=F;U.push(await Q.tool())}else U.push(F);U.length>0&&(e.config.tools=U);const V={model:de,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?Ee=kN(this.apiClient,V):Ee=ON(this.apiClient,V),delete Ee.config,ee.send(JSON.stringify(Ee)),new x3(ee,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const p3={turnComplete:!0};class x3{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=lr(t.turns),e.isVertexAI()||(i=i.map(o=>Xh(o)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const c of i){if(typeof c!="object"||c===null||!("name"in c)||!("response"in c))throw new Error(`Could not parse function response, type '${typeof c}'.`);if(!e.isVertexAI()&&!("id"in c))throw new Error(f3)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},p3),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:BN(e)}:t={realtimeInput:UN(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function y3(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function v3(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $v=10;function Jv(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(const f of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(Zl(f)){o=!0;break}if(!o)return!0;const c=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return c&&(c<0||!Number.isInteger(c))||c==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",c),!0):!1}function Zl(n){return"callTool"in n&&typeof n.callTool=="function"}function w3(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>Zl(o)))!==null&&i!==void 0?i:!1}function Qv(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,o)=>{if(Zl(i))return;const c=i;c.functionDeclarations&&c.functionDeclarations.length>0&&t.push(o)}),t}function Zv(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class b3 extends No{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,o,c,f,y;const w=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!w3(t)||Jv(t.config))return await this.generateContentInternal(w);const x=Qv(t);if(x.length>0){const W=x.map(K=>`tools[${K}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${W}.`)}let A,N;const R=lr(w.contents),k=(c=(o=(i=w.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&c!==void 0?c:$v;let H=0;for(;H<k&&(A=await this.generateContentInternal(w),!(!A.functionCalls||A.functionCalls.length===0));){const W=A.candidates[0].content,K=[];for(const te of(y=(f=t.config)===null||f===void 0?void 0:f.tools)!==null&&y!==void 0?y:[])if(Zl(te)){const ee=await te.callTool(A.functionCalls);K.push(...ee)}H++,N={role:"user",parts:K},w.contents=lr(w.contents),w.contents.push(W),w.contents.push(N),Zv(w.config)&&(R.push(W),R.push(N))}return Zv(w.config)&&(A.automaticFunctionCallingHistory=R),A},this.generateContentStream=async t=>{var i,o,c,f,y;if(this.maybeMoveToResponseJsonSchem(t),Jv(t.config)){const N=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(N)}const w=Qv(t);if(w.length>0){const N=w.map(R=>`tools[${R}]`).join(", ");throw new Error(`Incompatible tools found at ${N}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const x=(c=(o=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||o===void 0?void 0:o.functionCallingConfig)===null||c===void 0?void 0:c.streamFunctionCallArguments,A=(y=(f=t==null?void 0:t.config)===null||f===void 0?void 0:f.automaticFunctionCalling)===null||y===void 0?void 0:y.disable;if(x&&!A)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var o;let c;const f=[];if(i!=null&&i.generatedImages)for(const w of i.generatedImages)w&&(w!=null&&w.safetyAttributes)&&((o=w==null?void 0:w.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?c=w==null?void 0:w.safetyAttributes:f.push(w);let y;return c?y={generatedImages:f,positivePromptSafetyAttributes:c,sdkHttpResponse:i.sdkHttpResponse}:y={generatedImages:f,sdkHttpResponse:i.sdkHttpResponse},y}),this.list=async t=>{var i;const f={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!f.config.queryBase){if(!((i=f.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");f.config.filter="labels.tune-type:*"}return new dl(To.PAGED_ITEM_MODELS,y=>this.listInternal(y),await this.listInternal(f),f)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const o={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(o)},this.generateVideos=async t=>{var i,o,c,f,y,w;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((o=t.video)===null||o===void 0)&&o.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((f=(c=t.source)===null||c===void 0?void 0:c.video)===null||f===void 0)&&f.uri&&(!((w=(y=t.source)===null||y===void 0?void 0:y.video)===null||w===void 0)&&w.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,o;const c=(t=e.config)===null||t===void 0?void 0:t.tools;if(!c)return e;const f=await Promise.all(c.map(async w=>Zl(w)?await w.tool():w)),y={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:f})};if(y.config.tools=f,e.config&&e.config.tools&&OE(e.config.tools)){const w=(o=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&o!==void 0?o:{};let x=Object.assign({},w);Object.keys(x).length===0&&(x=this.apiClient.getDefaultHeaders()),kE(x),y.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:x})}return y}async initAfcToolsMap(e){var t,i,o;const c=new Map;for(const f of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(Zl(f)){const y=f,w=await y.tool();for(const x of(o=w.functionDeclarations)!==null&&o!==void 0?o:[]){if(!x.name)throw new Error("Function declaration name is required.");if(c.has(x.name))throw new Error(`Duplicate tool declaration name: ${x.name}`);c.set(x.name,y)}}return c}async processAfcStream(e){var t,i,o;const c=(o=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:$v;let f=!1,y=0;const w=await this.initAfcToolsMap(e);return(function(x,A,N){return vr(this,arguments,function*(){for(var R,k,H,W,K,te;y<c;){f&&(y++,f=!1);const Ee=yield It(x.processParamsMaybeAddMcpUsage(N)),me=yield It(x.generateContentStreamInternal(Ee)),U=[],V=[];try{for(var le=!0,ee=(k=void 0,wr(me)),de;de=yield It(ee.next()),R=de.done,!R;le=!0){W=de.value,le=!1;const F=W;if(yield yield It(F),F.candidates&&(!((K=F.candidates[0])===null||K===void 0)&&K.content)){V.push(F.candidates[0].content);for(const Q of(te=F.candidates[0].content.parts)!==null&&te!==void 0?te:[])if(y<c&&Q.functionCall){if(!Q.functionCall.name)throw new Error("Function call name was not returned by the model.");if(A.has(Q.functionCall.name)){const Y=yield It(A.get(Q.functionCall.name).callTool([Q.functionCall]));U.push(...Y)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${A.keys()}, mising tool: ${Q.functionCall.name}`)}}}}catch(F){k={error:F}}finally{try{!le&&!R&&(H=ee.return)&&(yield It(H.call(ee)))}finally{if(k)throw k.error}}if(U.length>0){f=!0;const F=new lu;F.candidates=[{content:{role:"user",parts:U}}],yield yield It(F);const Q=[];Q.push(...V),Q.push({role:"user",parts:U});const Y=lr(N.contents).concat(Q);N.contents=Y}else break}})})(this,w,e)}async generateContentInternal(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=Yv(this.apiClient,e);return y=et("{model}:generateContent",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=Xv(A),R=new lu;return Object.assign(R,N),R})}else{const x=qv(this.apiClient,e);return y=et("{model}:generateContent",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=Wv(A),R=new lu;return Object.assign(R,N),R})}}async generateContentStreamInternal(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=Yv(this.apiClient,e);return y=et("{model}:streamGenerateContent?alt=sse",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.requestStream({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),f.then(function(N){return vr(this,arguments,function*(){var R,k,H,W;try{for(var K=!0,te=wr(N),le;le=yield It(te.next()),R=le.done,!R;K=!0){W=le.value,K=!1;const ee=W,de=Xv(yield It(ee.json()));de.sdkHttpResponse={headers:ee.headers};const Ee=new lu;Object.assign(Ee,de),yield yield It(Ee)}}catch(ee){k={error:ee}}finally{try{!K&&!R&&(H=te.return)&&(yield It(H.call(te)))}finally{if(k)throw k.error}}})})}else{const x=qv(this.apiClient,e);return y=et("{model}:streamGenerateContent?alt=sse",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.requestStream({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}),f.then(function(N){return vr(this,arguments,function*(){var R,k,H,W;try{for(var K=!0,te=wr(N),le;le=yield It(te.next()),R=le.done,!R;K=!0){W=le.value,K=!1;const ee=W,de=Wv(yield It(ee.json()));de.sdkHttpResponse={headers:ee.headers};const Ee=new lu;Object.assign(Ee,de),yield yield It(Ee)}}catch(ee){k={error:ee}}finally{try{!K&&!R&&(H=te.return)&&(yield It(H.call(te)))}finally{if(k)throw k.error}}})})}}async embedContent(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=gI(this.apiClient,e);return y=et("{model}:predict",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=xI(A),R=new Nv;return Object.assign(R,N),R})}else{const x=mI(this.apiClient,e);return y=et("{model}:batchEmbedContents",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=pI(A),R=new Nv;return Object.assign(R,N),R})}}async generateImagesInternal(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=NI(this.apiClient,e);return y=et("{model}:predict",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=RI(A),R=new Iv;return Object.assign(R,N),R})}else{const x=CI(this.apiClient,e);return y=et("{model}:predict",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=II(A),R=new Iv;return Object.assign(R,N),R})}}async editImageInternal(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI()){const y=uI(this.apiClient,e);return c=et("{model}:predict",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json().then(x=>{const A=x;return A.sdkHttpResponse={headers:w.headers},A})),o.then(w=>{const x=dI(w),A=new vS;return Object.assign(A,x),A})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI()){const y=NR(this.apiClient,e);return c=et("{model}:predict",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json().then(x=>{const A=x;return A.sdkHttpResponse={headers:w.headers},A})),o.then(w=>{const x=IR(w),A=new wS;return Object.assign(A,x),A})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI()){const y=cR(this.apiClient,e);return c=et("{model}:predict",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json()),o.then(w=>{const x=uR(w),A=new bS;return Object.assign(A,x),A})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI()){const y=pR(this.apiClient,e);return c=et("{model}:predict",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json()),o.then(w=>{const x=xR(w),A=new ES;return Object.assign(A,x),A})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=WI(this.apiClient,e);return y=et("{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json()),f.then(A=>Um(A))}else{const x=YI(this.apiClient,e);return y=et("{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json()),f.then(A=>Lm(A))}}async listInternal(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=nR(this.apiClient,e);return y=et("{models_url}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=sR(A),R=new Rv;return Object.assign(R,N),R})}else{const x=tR(this.apiClient,e);return y=et("{models_url}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=iR(A),R=new Rv;return Object.assign(R,N),R})}}async update(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=SR(this.apiClient,e);return y=et("{model}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json()),f.then(A=>Um(A))}else{const x=AR(this.apiClient,e);return y=et("{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json()),f.then(A=>Lm(A))}}async delete(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=oI(this.apiClient,e);return y=et("{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=lI(A),R=new Mv;return Object.assign(R,N),R})}else{const x=rI(this.apiClient,e);return y=et("{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=aI(A),R=new Mv;return Object.assign(R,N),R})}}async countTokens(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=nI(this.apiClient,e);return y=et("{model}:countTokens",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=sI(A),R=new Dv;return Object.assign(R,N),R})}else{const x=tI(this.apiClient,e);return y=et("{model}:countTokens",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=iI(A),R=new Dv;return Object.assign(R,N),R})}}async computeTokens(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI()){const y=XN(this.apiClient,e);return c=et("{model}:computeTokens",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json().then(x=>{const A=x;return A.sdkHttpResponse={headers:w.headers},A})),o.then(w=>{const x=KN(w),A=new _S;return Object.assign(A,x),A})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=LI(this.apiClient,e);return y=et("{model}:predictLongRunning",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json()),f.then(A=>{const N=kI(A),R=new _h;return Object.assign(R,N),R})}else{const x=PI(this.apiClient,e);return y=et("{model}:predictLongRunning",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json()),f.then(A=>{const N=OI(A),R=new _h;return Object.assign(R,N),R})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class E3 extends No{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let c;i&&"httpOptions"in i&&(c=i.httpOptions);const f=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:c}});return t._fromAPIResponse({apiResponse:f,_isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let c;i&&"httpOptions"in i&&(c=i.httpOptions);const f=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:c}});return t._fromAPIResponse({apiResponse:f,_isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=fS(e);return y=et("{operationName}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json()),f}else{const x=hS(e);return y=et("{operationName}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json()),f}}async fetchPredictVideosOperationInternal(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI()){const y=rS(e);return c=et("{resourceName}:fetchPredictOperation",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json()),o}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _3(n){const e={},t=b(n,["data"]);if(t!=null&&T(e,["data"],t),b(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=b(n,["mimeType"]);return i!=null&&T(e,["mimeType"],i),e}function T3(n){const e={},t=b(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(c=>O3(c))),T(e,["parts"],o)}const i=b(n,["role"]);return i!=null&&T(e,["role"],i),e}function A3(n,e,t){const i={},o=b(e,["expireTime"]);t!==void 0&&o!=null&&T(t,["expireTime"],o);const c=b(e,["newSessionExpireTime"]);t!==void 0&&c!=null&&T(t,["newSessionExpireTime"],c);const f=b(e,["uses"]);t!==void 0&&f!=null&&T(t,["uses"],f);const y=b(e,["liveConnectConstraints"]);t!==void 0&&y!=null&&T(t,["bidiGenerateContentSetup"],D3(n,y));const w=b(e,["lockAdditionalFields"]);return t!==void 0&&w!=null&&T(t,["fieldMask"],w),i}function S3(n,e){const t={},i=b(e,["config"]);return i!=null&&T(t,["config"],A3(n,i,t)),t}function C3(n){const e={};if(b(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=b(n,["fileUri"]);t!=null&&T(e,["fileUri"],t);const i=b(n,["mimeType"]);return i!=null&&T(e,["mimeType"],i),e}function N3(n){const e={},t=b(n,["id"]);t!=null&&T(e,["id"],t);const i=b(n,["args"]);i!=null&&T(e,["args"],i);const o=b(n,["name"]);if(o!=null&&T(e,["name"],o),b(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(b(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function I3(n){const e={};if(b(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=b(n,["enableWidget"]);return t!=null&&T(e,["enableWidget"],t),e}function R3(n){const e={};if(b(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(b(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=b(n,["timeRangeFilter"]);return t!=null&&T(e,["timeRangeFilter"],t),e}function M3(n,e){const t={},i=b(n,["generationConfig"]);e!==void 0&&i!=null&&T(e,["setup","generationConfig"],i);const o=b(n,["responseModalities"]);e!==void 0&&o!=null&&T(e,["setup","generationConfig","responseModalities"],o);const c=b(n,["temperature"]);e!==void 0&&c!=null&&T(e,["setup","generationConfig","temperature"],c);const f=b(n,["topP"]);e!==void 0&&f!=null&&T(e,["setup","generationConfig","topP"],f);const y=b(n,["topK"]);e!==void 0&&y!=null&&T(e,["setup","generationConfig","topK"],y);const w=b(n,["maxOutputTokens"]);e!==void 0&&w!=null&&T(e,["setup","generationConfig","maxOutputTokens"],w);const x=b(n,["mediaResolution"]);e!==void 0&&x!=null&&T(e,["setup","generationConfig","mediaResolution"],x);const A=b(n,["seed"]);e!==void 0&&A!=null&&T(e,["setup","generationConfig","seed"],A);const N=b(n,["speechConfig"]);e!==void 0&&N!=null&&T(e,["setup","generationConfig","speechConfig"],Ng(N));const R=b(n,["thinkingConfig"]);e!==void 0&&R!=null&&T(e,["setup","generationConfig","thinkingConfig"],R);const k=b(n,["enableAffectiveDialog"]);e!==void 0&&k!=null&&T(e,["setup","generationConfig","enableAffectiveDialog"],k);const H=b(n,["systemInstruction"]);e!==void 0&&H!=null&&T(e,["setup","systemInstruction"],T3(ts(H)));const W=b(n,["tools"]);if(e!==void 0&&W!=null){let me=xc(W);Array.isArray(me)&&(me=me.map(U=>P3(pc(U)))),T(e,["setup","tools"],me)}const K=b(n,["sessionResumption"]);e!==void 0&&K!=null&&T(e,["setup","sessionResumption"],k3(K));const te=b(n,["inputAudioTranscription"]);e!==void 0&&te!=null&&T(e,["setup","inputAudioTranscription"],te);const le=b(n,["outputAudioTranscription"]);e!==void 0&&le!=null&&T(e,["setup","outputAudioTranscription"],le);const ee=b(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&T(e,["setup","realtimeInputConfig"],ee);const de=b(n,["contextWindowCompression"]);e!==void 0&&de!=null&&T(e,["setup","contextWindowCompression"],de);const Ee=b(n,["proactivity"]);if(e!==void 0&&Ee!=null&&T(e,["setup","proactivity"],Ee),b(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function D3(n,e){const t={},i=b(e,["model"]);i!=null&&T(t,["setup","model"],gn(n,i));const o=b(e,["config"]);return o!=null&&T(t,["config"],M3(o,t)),t}function O3(n){const e={},t=b(n,["mediaResolution"]);t!=null&&T(e,["mediaResolution"],t);const i=b(n,["codeExecutionResult"]);i!=null&&T(e,["codeExecutionResult"],i);const o=b(n,["executableCode"]);o!=null&&T(e,["executableCode"],o);const c=b(n,["fileData"]);c!=null&&T(e,["fileData"],C3(c));const f=b(n,["functionCall"]);f!=null&&T(e,["functionCall"],N3(f));const y=b(n,["functionResponse"]);y!=null&&T(e,["functionResponse"],y);const w=b(n,["inlineData"]);w!=null&&T(e,["inlineData"],_3(w));const x=b(n,["text"]);x!=null&&T(e,["text"],x);const A=b(n,["thought"]);A!=null&&T(e,["thought"],A);const N=b(n,["thoughtSignature"]);N!=null&&T(e,["thoughtSignature"],N);const R=b(n,["videoMetadata"]);return R!=null&&T(e,["videoMetadata"],R),e}function k3(n){const e={},t=b(n,["handle"]);if(t!=null&&T(e,["handle"],t),b(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function P3(n){const e={},t=b(n,["functionDeclarations"]);if(t!=null){let A=t;Array.isArray(A)&&(A=A.map(N=>N)),T(e,["functionDeclarations"],A)}if(b(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=b(n,["googleSearchRetrieval"]);i!=null&&T(e,["googleSearchRetrieval"],i);const o=b(n,["computerUse"]);o!=null&&T(e,["computerUse"],o);const c=b(n,["fileSearch"]);c!=null&&T(e,["fileSearch"],c);const f=b(n,["codeExecution"]);if(f!=null&&T(e,["codeExecution"],f),b(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const y=b(n,["googleMaps"]);y!=null&&T(e,["googleMaps"],I3(y));const w=b(n,["googleSearch"]);w!=null&&T(e,["googleSearch"],R3(w));const x=b(n,["urlContext"]);return x!=null&&T(e,["urlContext"],x),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function L3(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const o=Object.keys(i).map(c=>`${t}.${c}`);e.push(...o)}else e.push(t)}return e.join(",")}function U3(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const c=i.setup;typeof c=="object"&&c!==null?(n.bidiGenerateContentSetup=c,t=c):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const o=n.fieldMask;if(t){const c=L3(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)c?n.fieldMask=c:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const f=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let y=[];o.length>0&&(y=o.map(x=>f.includes(x)?`generationConfig.${x}`:x));const w=[];c&&w.push(c),y.length>0&&w.push(...y),w.length>0?n.fieldMask=w.join(","):delete n.fieldMask}else delete n.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?n.fieldMask=o.join(","):delete n.fieldMask;return n}class B3 extends No{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const y=S3(this.apiClient,e);c=et("auth_tokens",y._url),f=y._query,delete y.config,delete y._url,delete y._query;const w=U3(y,e.config);return o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(w),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),o.then(x=>x)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function F3(n,e){const t={},i=b(n,["force"]);return e!==void 0&&i!=null&&T(e,["_query","force"],i),t}function j3(n){const e={},t=b(n,["name"]);t!=null&&T(e,["_url","name"],t);const i=b(n,["config"]);return i!=null&&F3(i,e),e}function V3(n){const e={},t=b(n,["name"]);return t!=null&&T(e,["_url","name"],t),e}function G3(n,e){const t={},i=b(n,["pageSize"]);e!==void 0&&i!=null&&T(e,["_query","pageSize"],i);const o=b(n,["pageToken"]);return e!==void 0&&o!=null&&T(e,["_query","pageToken"],o),t}function H3(n){const e={},t=b(n,["parent"]);t!=null&&T(e,["_url","parent"],t);const i=b(n,["config"]);return i!=null&&G3(i,e),e}function z3(n){const e={},t=b(n,["sdkHttpResponse"]);t!=null&&T(e,["sdkHttpResponse"],t);const i=b(n,["nextPageToken"]);i!=null&&T(e,["nextPageToken"],i);const o=b(n,["documents"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>f)),T(e,["documents"],c)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class q3 extends No{constructor(e){super(),this.apiClient=e,this.list=async t=>new dl(To.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=V3(e);return c=et("{name}",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json()),o.then(w=>w)}}async delete(e){var t,i;let o="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=j3(e);o=et("{name}",f._url),c=f._query,delete f._url,delete f._query,await this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=H3(e);return c=et("{parent}/documents",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json()),o.then(w=>{const x=z3(w),A=new TS;return Object.assign(A,x),A})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Y3 extends No{constructor(e,t=new q3(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new dl(To.PAGED_ITEM_FILE_SEARCH_STORES,o=>this.listInternal(o),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=LR(e);return c=et("fileSearchStores",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json()),o.then(w=>w)}}async get(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=FR(e);return c=et("{name}",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json()),o.then(w=>w)}}async delete(e){var t,i;let o="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=BR(e);o=et("{name}",f._url),c=f._query,delete f._url,delete f._query,await this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=qR(e);return c=et("fileSearchStores",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json()),o.then(w=>{const x=YR(w),A=new AS;return Object.assign(A,x),A})}}async uploadToFileSearchStoreInternal(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=WR(e);return c=et("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json()),o.then(w=>{const x=XR(w),A=new SS;return Object.assign(A,x),A})}}async importFile(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=GR(e);return c=et("{file_search_store_name}:importFile",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json()),o.then(w=>{const x=VR(w),A=new _g;return Object.assign(A,x),A})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let PE=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return PE=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^t()&15>>+i/4).toString(16))};const W3=()=>PE();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Fm(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const jm=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cr extends Error{}class gs extends cr{constructor(e,t,i,o){super(`${gs.makeMessage(e,t,i)}`),this.status=e,this.headers=o,this.error=t}static makeMessage(e,t,i){const o=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):i;return e&&o?`${e} ${o}`:e?`${e} status code (no body)`:o||"(no status code or body)"}static generate(e,t,i,o){if(!e||!o)return new Jh({message:i,cause:jm(t)});const c=t;return e===400?new UE(e,c,i,o):e===401?new BE(e,c,i,o):e===403?new FE(e,c,i,o):e===404?new jE(e,c,i,o):e===409?new VE(e,c,i,o):e===422?new GE(e,c,i,o):e===429?new HE(e,c,i,o):e>=500?new zE(e,c,i,o):new gs(e,c,i,o)}}class Vm extends gs{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Jh extends gs{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class LE extends Jh{constructor({message:e}={}){super({message:e??"Request timed out."})}}class UE extends gs{}class BE extends gs{}class FE extends gs{}class jE extends gs{}class VE extends gs{}class GE extends gs{}class HE extends gs{}class zE extends gs{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const X3=/^[a-z][a-z0-9+.-]*:/i,K3=n=>X3.test(n);let Gm=n=>(Gm=Array.isArray,Gm(n));const $3=Gm;let J3=$3;const ew=J3;function Q3(n){if(!n)return!0;for(const e in n)return!1;return!0}function Z3(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const e4=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new cr(`${n} must be an integer`);if(e<0)throw new cr(`${n} must be a positive integer`);return e},t4=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const n4=n=>new Promise(e=>setTimeout(e,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Hl="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function i4(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const s4=()=>{var n,e,t,i,o;const c=i4();if(c==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hl,"X-Stainless-OS":nw(Deno.build.os),"X-Stainless-Arch":tw(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(c==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hl,"X-Stainless-OS":nw((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":tw((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(o=globalThis.process.version)!==null&&o!==void 0?o:"unknown"};const f=r4();return f?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${f.browser}`,"X-Stainless-Runtime-Version":f.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function r4(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const i=t.exec(navigator.userAgent);if(i){const o=i[1]||0,c=i[2]||0,f=i[3]||0;return{browser:e,version:`${o}.${c}.${f}`}}}return null}const tw=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",nw=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Qd;const o4=()=>Qd??(Qd=s4());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function a4(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function qE(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function l4(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return qE({start(){},async pull(t){const{done:i,value:o}=await e.next();i?t.close():t.enqueue(o)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function YE(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function c4(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const i=n.getReader(),o=i.cancel();i.releaseLock(),await o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const u4=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WE=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((n=e==null?void 0:e.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function fm(n,e,t){return WE(),new File(n,e??"unknown_file",t)}function d4(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const h4=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const XE=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",f4=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&XE(n),m4=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function g4(n,e,t){if(WE(),n=await n,f4(n))return n instanceof File?n:fm([await n.arrayBuffer()],n.name);if(m4(n)){const o=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),fm(await Hm(o),e,t)}const i=await Hm(n);if(e||(e=d4(n)),!(t!=null&&t.type)){const o=i.find(c=>typeof c=="object"&&"type"in c&&c.type);typeof o=="string"&&(t=Object.assign(Object.assign({},t),{type:o}))}return fm(i,e,t)}async function Hm(n){var e,t,i,o,c;let f=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)f.push(n);else if(XE(n))f.push(n instanceof Blob?n:await n.arrayBuffer());else if(h4(n))try{for(var y=!0,w=wr(n),x;x=await w.next(),e=x.done,!e;y=!0){o=x.value,y=!1;const A=o;f.push(...await Hm(A))}}catch(A){t={error:A}}finally{try{!y&&!e&&(i=w.return)&&await i.call(w)}finally{if(t)throw t.error}}else{const A=(c=n==null?void 0:n.constructor)===null||c===void 0?void 0:c.name;throw new Error(`Unexpected data type: ${typeof n}${A?`; constructor: ${A}`:""}${p4(n)}`)}return f}function p4(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class KE{constructor(e){this._client=e}}KE._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $E(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const iw=Object.freeze(Object.create(null)),x4=(n=$E)=>(function(t,...i){if(t.length===1)return t[0];let o=!1;const c=[],f=t.reduce((A,N,R)=>{var k,H,W;/[?#]/.test(N)&&(o=!0);const K=i[R];let te=(o?encodeURIComponent:n)(""+K);return R!==i.length&&(K==null||typeof K=="object"&&K.toString===((W=Object.getPrototypeOf((H=Object.getPrototypeOf((k=K.hasOwnProperty)!==null&&k!==void 0?k:iw))!==null&&H!==void 0?H:iw))===null||W===void 0?void 0:W.toString))&&(te=K+"",c.push({start:A.length+N.length,length:te.length,error:`Value of type ${Object.prototype.toString.call(K).slice(8,-1)} is not a valid path parameter`})),A+N+(R===i.length?"":te)},""),y=f.split(/[?#]/,1)[0],w=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let x;for(;(x=w.exec(y))!==null;)c.push({start:x.index,length:x[0].length,error:`Value "${x[0]}" can't be safely passed as a path parameter`});if(c.sort((A,N)=>A.start-N.start),c.length>0){let A=0;const N=c.reduce((R,k)=>{const H=" ".repeat(k.start-A),W="^".repeat(k.length);return A=k.start+k.length,R+H+W},"");throw new cr(`Path parameters result in path with invalid segments:
${c.map(R=>R.error).join(`
`)}
${f}
${N}`)}return f}),Zd=x4($E);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JE extends KE{create(e,t){var i;const{api_version:o=this._client.apiVersion}=e,c=Ah(e,["api_version"]);if("model"in c&&"agent_config"in c)throw new cr("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in c&&"generation_config"in c)throw new cr("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Zd`/${o}/interactions`,Object.assign(Object.assign({body:c},t),{stream:(i=e.stream)!==null&&i!==void 0?i:!1}))}delete(e,t={},i){const{api_version:o=this._client.apiVersion}=t??{};return this._client.delete(Zd`/${o}/interactions/${e}`,i)}cancel(e,t={},i){const{api_version:o=this._client.apiVersion}=t??{};return this._client.post(Zd`/${o}/interactions/${e}/cancel`,i)}get(e,t={},i){var o;const c=t??{},{api_version:f=this._client.apiVersion}=c,y=Ah(c,["api_version"]);return this._client.get(Zd`/${f}/interactions/${e}`,Object.assign(Object.assign({query:y},i),{stream:(o=t==null?void 0:t.stream)!==null&&o!==void 0?o:!1}))}}JE._key=Object.freeze(["interactions"]);class QE extends JE{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function y4(n){let e=0;for(const o of n)e+=o.length;const t=new Uint8Array(e);let i=0;for(const o of n)t.set(o,i),i+=o.length;return t}let eh;function Rg(n){let e;return(eh??(e=new globalThis.TextEncoder,eh=e.encode.bind(e)))(n)}let th;function sw(n){let e;return(th??(e=new globalThis.TextDecoder,th=e.decode.bind(e)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qh{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Rg(e):e;this.buffer=y4([this.buffer,t]);const i=[];let o;for(;(o=v4(this.buffer,this.carriageReturnIndex))!=null;){if(o.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=o.index;continue}if(this.carriageReturnIndex!=null&&(o.index!==this.carriageReturnIndex+1||o.carriage)){i.push(sw(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const c=this.carriageReturnIndex!==null?o.preceding-1:o.preceding,f=sw(this.buffer.subarray(0,c));i.push(f),this.buffer=this.buffer.subarray(o.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}Qh.NEWLINE_CHARS=new Set([`
`,"\r"]);Qh.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function v4(n,e){for(let o=e??0;o<n.length;o++){if(n[o]===10)return{preceding:o,index:o+1,carriage:!1};if(n[o]===13)return{preceding:o,index:o+1,carriage:!0}}return null}function w4(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Sh={off:0,error:200,warn:300,info:400,debug:500},rw=(n,e,t)=>{if(n){if(Z3(Sh,n))return n;hs(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Sh))}`)}};function uu(){}function nh(n,e,t){return!e||Sh[n]>Sh[t]?uu:e[n].bind(e)}const b4={error:uu,warn:uu,info:uu,debug:uu};let ow=new WeakMap;function hs(n){var e;const t=n.logger,i=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return b4;const o=ow.get(t);if(o&&o[0]===i)return o[1];const c={error:nh("error",t,i),warn:nh("warn",t,i),info:nh("info",t,i),debug:nh("debug",t,i)};return ow.set(t,[i,c]),c}const el=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kl{constructor(e,t,i){this.iterator=e,this.controller=t,this.client=i}static fromSSEResponse(e,t,i){let o=!1;const c=i?hs(i):console;function f(){return vr(this,arguments,function*(){var w,x,A,N;if(o)throw new cr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let R=!1;try{try{for(var k=!0,H=wr(E4(e,t)),W;W=yield It(H.next()),w=W.done,!w;k=!0){N=W.value,k=!1;const K=N;if(!R)if(K.data.startsWith("[DONE]")){R=!0;continue}else try{yield yield It(JSON.parse(K.data))}catch(te){throw c.error("Could not parse message into JSON:",K.data),c.error("From chunk:",K.raw),te}}}catch(K){x={error:K}}finally{try{!k&&!w&&(A=H.return)&&(yield It(A.call(H)))}finally{if(x)throw x.error}}R=!0}catch(K){if(Fm(K))return yield It(void 0);throw K}finally{R||t.abort()}})}return new Kl(f,t,i)}static fromReadableStream(e,t,i){let o=!1;function c(){return vr(this,arguments,function*(){var w,x,A,N;const R=new Qh,k=YE(e);try{for(var H=!0,W=wr(k),K;K=yield It(W.next()),w=K.done,!w;H=!0){N=K.value,H=!1;const te=N;for(const le of R.decode(te))yield yield It(le)}}catch(te){x={error:te}}finally{try{!H&&!w&&(A=W.return)&&(yield It(A.call(W)))}finally{if(x)throw x.error}}for(const te of R.flush())yield yield It(te)})}function f(){return vr(this,arguments,function*(){var w,x,A,N;if(o)throw new cr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let R=!1;try{try{for(var k=!0,H=wr(c()),W;W=yield It(H.next()),w=W.done,!w;k=!0){N=W.value,k=!1;const K=N;R||K&&(yield yield It(JSON.parse(K)))}}catch(K){x={error:K}}finally{try{!k&&!w&&(A=H.return)&&(yield It(A.call(H)))}finally{if(x)throw x.error}}R=!0}catch(K){if(Fm(K))return yield It(void 0);throw K}finally{R||t.abort()}})}return new Kl(f,t,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],i=this.iterator(),o=c=>({next:()=>{if(c.length===0){const f=i.next();e.push(f),t.push(f)}return c.shift()}});return[new Kl(()=>o(e),this.controller,this.client),new Kl(()=>o(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return qE({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{const{value:o,done:c}=await t.next();if(c)return i.close();const f=Rg(JSON.stringify(o)+`
`);i.enqueue(f)}catch(o){i.error(o)}},async cancel(){var i;await((i=t.return)===null||i===void 0?void 0:i.call(t))}})}}function E4(n,e){return vr(this,arguments,function*(){var i,o,c,f;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new cr("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new cr("Attempted to iterate over a response with no body");const y=new T4,w=new Qh,x=YE(n.body);try{for(var A=!0,N=wr(_4(x)),R;R=yield It(N.next()),i=R.done,!i;A=!0){f=R.value,A=!1;const k=f;for(const H of w.decode(k)){const W=y.decode(H);W&&(yield yield It(W))}}}catch(k){o={error:k}}finally{try{!A&&!i&&(c=N.return)&&(yield It(c.call(N)))}finally{if(o)throw o.error}}for(const k of w.flush()){const H=y.decode(k);H&&(yield yield It(H))}})}function _4(n){return vr(this,arguments,function*(){var t,i,o,c;let f=new Uint8Array;try{for(var y=!0,w=wr(n),x;x=yield It(w.next()),t=x.done,!t;y=!0){c=x.value,y=!1;const A=c;if(A==null)continue;const N=A instanceof ArrayBuffer?new Uint8Array(A):typeof A=="string"?Rg(A):A;let R=new Uint8Array(f.length+N.length);R.set(f),R.set(N,f.length),f=R;let k;for(;(k=w4(f))!==-1;)yield yield It(f.slice(0,k)),f=f.slice(k)}}catch(A){i={error:A}}finally{try{!y&&!t&&(o=w.return)&&(yield It(o.call(w)))}finally{if(i)throw i.error}}f.length>0&&(yield yield It(f))})}class T4{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const c={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],c}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,i,o]=A4(e,":");return o.startsWith(" ")&&(o=o.substring(1)),t==="event"?this.event=o:t==="data"&&this.data.push(o),null}}function A4(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function S4(n,e){const{response:t,requestLogID:i,retryOfRequestLogID:o,startTime:c}=e,f=await(async()=>{var y;if(e.options.stream)return hs(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):Kl.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const w=t.headers.get("content-type"),x=(y=w==null?void 0:w.split(";")[0])===null||y===void 0?void 0:y.trim();return(x==null?void 0:x.includes("application/json"))||(x==null?void 0:x.endsWith("+json"))?await t.json():await t.text()})();return hs(n).debug(`[${i}] response parsed`,el({retryOfRequestLogID:o,url:t.url,status:t.status,body:f,durationMs:Date.now()-c})),f}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Mg extends Promise{constructor(e,t,i=S4){super(o=>{o(null)}),this.responsePromise=t,this.parseResponse=i,this.client=e}_thenUnwrap(e){return new Mg(this.client,this.responsePromise,async(t,i)=>e(await this.parseResponse(t,i),i))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ZE=Symbol("brand.privateNullableHeaders");function*C4(n){if(!n)return;if(ZE in n){const{values:i,nulls:o}=n;yield*i.entries();for(const c of o)yield[c,null];return}let e=!1,t;n instanceof Headers?t=n.entries():ew(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let i of t){const o=i[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");const c=ew(i[1])?i[1]:[i[1]];let f=!1;for(const y of c)y!==void 0&&(e&&!f&&(f=!0,yield[o,null]),yield[o,y])}}const cu=n=>{const e=new Headers,t=new Set;for(const i of n){const o=new Set;for(const[c,f]of C4(i)){const y=c.toLowerCase();o.has(y)||(e.delete(c),o.add(y)),f===null?(e.delete(c),t.add(y)):(e.append(c,f),t.delete(y))}}return{[ZE]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const mm=n=>{var e,t,i,o,c,f;if(typeof globalThis.process<"u")return(i=(t=(e=ZA)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(f=(c=(o=globalThis.Deno.env)===null||o===void 0?void 0:o.get)===null||c===void 0?void 0:c.call(o,n))===null||f===void 0?void 0:f.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var e2;class Zh{constructor(e){var t,i,o,c,f,y,w,{baseURL:x=mm("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:A=(t=mm("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:N="v1beta"}=e,R=Ah(e,["baseURL","apiKey","apiVersion"]);const k=Object.assign(Object.assign({apiKey:A,apiVersion:N},R),{baseURL:x||"https://generativelanguage.googleapis.com"});this.baseURL=k.baseURL,this.timeout=(i=k.timeout)!==null&&i!==void 0?i:Zh.DEFAULT_TIMEOUT,this.logger=(o=k.logger)!==null&&o!==void 0?o:console;const H="warn";this.logLevel=H,this.logLevel=(f=(c=rw(k.logLevel,"ClientOptions.logLevel",this))!==null&&c!==void 0?c:rw(mm("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&f!==void 0?f:H,this.fetchOptions=k.fetchOptions,this.maxRetries=(y=k.maxRetries)!==null&&y!==void 0?y:2,this.fetch=(w=k.fetch)!==null&&w!==void 0?w:a4(),this.encoder=u4,this._options=k,this.apiKey=A,this.apiVersion=N,this.clientAdapter=k.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=cu([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return cu([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return cu([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,i])=>typeof i<"u").map(([t,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(t)}=`;throw new cr(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Hl}`}defaultIdempotencyKey(){return`stainless-node-retry-${W3()}`}makeStatusError(e,t,i,o){return gs.generate(e,t,i,o)}buildURL(e,t,i){const o=!this.baseURLOverridden()&&i||this.baseURL,c=K3(e)?new URL(e):new URL(o+(o.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),f=this.defaultQuery();return Q3(f)||(t=Object.assign(Object.assign({},f),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(c.search=this.stringifyQuery(t)),c.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:i}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,i){return this.request(Promise.resolve(i).then(o=>Object.assign({method:e,path:t},o)))}request(e,t=null){return new Mg(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,i){var o,c,f;const y=await e,w=(o=y.maxRetries)!==null&&o!==void 0?o:this.maxRetries;t==null&&(t=w),await this.prepareOptions(y);const{req:x,url:A,timeout:N}=await this.buildRequest(y,{retryCount:w-t});await this.prepareRequest(x,{url:A,options:y});const R="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),k=i===void 0?"":`, retryOf: ${i}`,H=Date.now();if(hs(this).debug(`[${R}] sending request`,el({retryOfRequestLogID:i,method:y.method,url:A,options:y,headers:x.headers})),!((c=y.signal)===null||c===void 0)&&c.aborted)throw new Vm;const W=new AbortController,K=await this.fetchWithTimeout(A,x,N,W).catch(jm),te=Date.now();if(K instanceof globalThis.Error){const ee=`retrying, ${t} attempts remaining`;if(!((f=y.signal)===null||f===void 0)&&f.aborted)throw new Vm;const de=Fm(K)||/timed? ?out/i.test(String(K)+("cause"in K?String(K.cause):""));if(t)return hs(this).info(`[${R}] connection ${de?"timed out":"failed"} - ${ee}`),hs(this).debug(`[${R}] connection ${de?"timed out":"failed"} (${ee})`,el({retryOfRequestLogID:i,url:A,durationMs:te-H,message:K.message})),this.retryRequest(y,t,i??R);throw hs(this).info(`[${R}] connection ${de?"timed out":"failed"} - error; no more retries left`),hs(this).debug(`[${R}] connection ${de?"timed out":"failed"} (error; no more retries left)`,el({retryOfRequestLogID:i,url:A,durationMs:te-H,message:K.message})),de?new LE:new Jh({cause:K})}const le=`[${R}${k}] ${x.method} ${A} ${K.ok?"succeeded":"failed"} with status ${K.status} in ${te-H}ms`;if(!K.ok){const ee=await this.shouldRetry(K);if(t&&ee){const F=`retrying, ${t} attempts remaining`;return await c4(K.body),hs(this).info(`${le} - ${F}`),hs(this).debug(`[${R}] response error (${F})`,el({retryOfRequestLogID:i,url:K.url,status:K.status,headers:K.headers,durationMs:te-H})),this.retryRequest(y,t,i??R,K.headers)}const de=ee?"error; no more retries left":"error; not retryable";hs(this).info(`${le} - ${de}`);const Ee=await K.text().catch(F=>jm(F).message),me=t4(Ee),U=me?void 0:Ee;throw hs(this).debug(`[${R}] response error (${de})`,el({retryOfRequestLogID:i,url:K.url,status:K.status,headers:K.headers,message:U,durationMs:Date.now()-H})),this.makeStatusError(K.status,me,U,K.headers)}return hs(this).info(le),hs(this).debug(`[${R}] response start`,el({retryOfRequestLogID:i,url:K.url,status:K.status,headers:K.headers,durationMs:te-H})),{response:K,options:y,controller:W,requestLogID:R,retryOfRequestLogID:i,startTime:H}}async fetchWithTimeout(e,t,i,o){const c=t||{},{signal:f,method:y}=c,w=Ah(c,["signal","method"]);f&&f.addEventListener("abort",()=>o.abort());const x=setTimeout(()=>o.abort(),i),A=globalThis.ReadableStream&&w.body instanceof globalThis.ReadableStream||typeof w.body=="object"&&w.body!==null&&Symbol.asyncIterator in w.body,N=Object.assign(Object.assign(Object.assign({signal:o.signal},A?{duplex:"half"}:{}),{method:"GET"}),w);y&&(N.method=y.toUpperCase());try{return await this.fetch.call(void 0,e,N)}finally{clearTimeout(x)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,i,o){var c;let f;const y=o==null?void 0:o.get("retry-after-ms");if(y){const x=parseFloat(y);Number.isNaN(x)||(f=x)}const w=o==null?void 0:o.get("retry-after");if(w&&!f){const x=parseFloat(w);Number.isNaN(x)?f=Date.parse(w)-Date.now():f=x*1e3}if(!(f&&0<=f&&f<60*1e3)){const x=(c=e.maxRetries)!==null&&c!==void 0?c:this.maxRetries;f=this.calculateDefaultRetryTimeoutMillis(t,x)}return await n4(f),this.makeRequest(e,t-1,i)}calculateDefaultRetryTimeoutMillis(e,t){const c=t-e,f=Math.min(.5*Math.pow(2,c),8),y=1-Math.random()*.25;return f*y*1e3}async buildRequest(e,{retryCount:t=0}={}){var i,o,c;const f=Object.assign({},e),{method:y,path:w,query:x,defaultBaseURL:A}=f,N=this.buildURL(w,x,A);"timeout"in f&&e4("timeout",f.timeout),f.timeout=(i=f.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:R,body:k}=this.buildBody({options:f}),H=await this.buildHeaders({options:e,method:y,bodyHeaders:R,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:y,headers:H},f.signal&&{signal:f.signal}),globalThis.ReadableStream&&k instanceof globalThis.ReadableStream&&{duplex:"half"}),k&&{body:k}),(o=this.fetchOptions)!==null&&o!==void 0?o:{}),(c=f.fetchOptions)!==null&&c!==void 0?c:{}),url:N,timeout:f.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:i,retryCount:o}){let c={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),c[this.idempotencyHeader]=e.idempotencyKey);const f=await this.authHeaders(e);let y=cu([c,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),o4()),this._options.defaultHeaders,i,e.headers,f]);return this.validateHeaders(y),y.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const i=cu([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&i.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:l4(e)}:this.encoder({body:e,headers:i})}}Zh.DEFAULT_TIMEOUT=6e4;class Ii extends Zh{constructor(){super(...arguments),this.interactions=new QE(this)}}e2=Ii;Ii.GeminiNextGenAPIClient=e2;Ii.GeminiNextGenAPIClientError=cr;Ii.APIError=gs;Ii.APIConnectionError=Jh;Ii.APIConnectionTimeoutError=LE;Ii.APIUserAbortError=Vm;Ii.NotFoundError=jE;Ii.ConflictError=VE;Ii.RateLimitError=HE;Ii.BadRequestError=UE;Ii.AuthenticationError=BE;Ii.InternalServerError=zE;Ii.PermissionDeniedError=FE;Ii.UnprocessableEntityError=GE;Ii.toFile=g4;Ii.Interactions=QE;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function N4(n,e){const t={},i=b(n,["name"]);return i!=null&&T(t,["_url","name"],i),t}function I4(n,e){const t={},i=b(n,["name"]);return i!=null&&T(t,["_url","name"],i),t}function R4(n,e){const t={},i=b(n,["sdkHttpResponse"]);return i!=null&&T(t,["sdkHttpResponse"],i),t}function M4(n,e){const t={},i=b(n,["sdkHttpResponse"]);return i!=null&&T(t,["sdkHttpResponse"],i),t}function D4(n,e,t){const i={};if(b(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const o=b(n,["tunedModelDisplayName"]);if(e!==void 0&&o!=null&&T(e,["displayName"],o),b(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const c=b(n,["epochCount"]);e!==void 0&&c!=null&&T(e,["tuningTask","hyperparameters","epochCount"],c);const f=b(n,["learningRateMultiplier"]);if(f!=null&&T(i,["tuningTask","hyperparameters","learningRateMultiplier"],f),b(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(b(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(b(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const y=b(n,["batchSize"]);e!==void 0&&y!=null&&T(e,["tuningTask","hyperparameters","batchSize"],y);const w=b(n,["learningRate"]);if(e!==void 0&&w!=null&&T(e,["tuningTask","hyperparameters","learningRate"],w),b(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(b(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function O4(n,e,t){const i={};let o=b(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const k=b(n,["validationDataset"]);e!==void 0&&k!=null&&T(e,["supervisedTuningSpec"],aw(k))}else if(o==="PREFERENCE_TUNING"){const k=b(n,["validationDataset"]);e!==void 0&&k!=null&&T(e,["preferenceOptimizationSpec"],aw(k))}const c=b(n,["tunedModelDisplayName"]);e!==void 0&&c!=null&&T(e,["tunedModelDisplayName"],c);const f=b(n,["description"]);e!==void 0&&f!=null&&T(e,["description"],f);let y=b(t,["config","method"]);if(y===void 0&&(y="SUPERVISED_FINE_TUNING"),y==="SUPERVISED_FINE_TUNING"){const k=b(n,["epochCount"]);e!==void 0&&k!=null&&T(e,["supervisedTuningSpec","hyperParameters","epochCount"],k)}else if(y==="PREFERENCE_TUNING"){const k=b(n,["epochCount"]);e!==void 0&&k!=null&&T(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],k)}let w=b(t,["config","method"]);if(w===void 0&&(w="SUPERVISED_FINE_TUNING"),w==="SUPERVISED_FINE_TUNING"){const k=b(n,["learningRateMultiplier"]);e!==void 0&&k!=null&&T(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],k)}else if(w==="PREFERENCE_TUNING"){const k=b(n,["learningRateMultiplier"]);e!==void 0&&k!=null&&T(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],k)}let x=b(t,["config","method"]);if(x===void 0&&(x="SUPERVISED_FINE_TUNING"),x==="SUPERVISED_FINE_TUNING"){const k=b(n,["exportLastCheckpointOnly"]);e!==void 0&&k!=null&&T(e,["supervisedTuningSpec","exportLastCheckpointOnly"],k)}else if(x==="PREFERENCE_TUNING"){const k=b(n,["exportLastCheckpointOnly"]);e!==void 0&&k!=null&&T(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],k)}let A=b(t,["config","method"]);if(A===void 0&&(A="SUPERVISED_FINE_TUNING"),A==="SUPERVISED_FINE_TUNING"){const k=b(n,["adapterSize"]);e!==void 0&&k!=null&&T(e,["supervisedTuningSpec","hyperParameters","adapterSize"],k)}else if(A==="PREFERENCE_TUNING"){const k=b(n,["adapterSize"]);e!==void 0&&k!=null&&T(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],k)}if(b(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(b(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const N=b(n,["labels"]);e!==void 0&&N!=null&&T(e,["labels"],N);const R=b(n,["beta"]);return e!==void 0&&R!=null&&T(e,["preferenceOptimizationSpec","hyperParameters","beta"],R),i}function k4(n,e){const t={},i=b(n,["baseModel"]);i!=null&&T(t,["baseModel"],i);const o=b(n,["preTunedModel"]);o!=null&&T(t,["preTunedModel"],o);const c=b(n,["trainingDataset"]);c!=null&&q4(c);const f=b(n,["config"]);return f!=null&&D4(f,t),t}function P4(n,e){const t={},i=b(n,["baseModel"]);i!=null&&T(t,["baseModel"],i);const o=b(n,["preTunedModel"]);o!=null&&T(t,["preTunedModel"],o);const c=b(n,["trainingDataset"]);c!=null&&Y4(c,t,e);const f=b(n,["config"]);return f!=null&&O4(f,t,e),t}function L4(n,e){const t={},i=b(n,["name"]);return i!=null&&T(t,["_url","name"],i),t}function U4(n,e){const t={},i=b(n,["name"]);return i!=null&&T(t,["_url","name"],i),t}function B4(n,e,t){const i={},o=b(n,["pageSize"]);e!==void 0&&o!=null&&T(e,["_query","pageSize"],o);const c=b(n,["pageToken"]);e!==void 0&&c!=null&&T(e,["_query","pageToken"],c);const f=b(n,["filter"]);return e!==void 0&&f!=null&&T(e,["_query","filter"],f),i}function F4(n,e,t){const i={},o=b(n,["pageSize"]);e!==void 0&&o!=null&&T(e,["_query","pageSize"],o);const c=b(n,["pageToken"]);e!==void 0&&c!=null&&T(e,["_query","pageToken"],c);const f=b(n,["filter"]);return e!==void 0&&f!=null&&T(e,["_query","filter"],f),i}function j4(n,e){const t={},i=b(n,["config"]);return i!=null&&B4(i,t),t}function V4(n,e){const t={},i=b(n,["config"]);return i!=null&&F4(i,t),t}function G4(n,e){const t={},i=b(n,["sdkHttpResponse"]);i!=null&&T(t,["sdkHttpResponse"],i);const o=b(n,["nextPageToken"]);o!=null&&T(t,["nextPageToken"],o);const c=b(n,["tunedModels"]);if(c!=null){let f=c;Array.isArray(f)&&(f=f.map(y=>t2(y))),T(t,["tuningJobs"],f)}return t}function H4(n,e){const t={},i=b(n,["sdkHttpResponse"]);i!=null&&T(t,["sdkHttpResponse"],i);const o=b(n,["nextPageToken"]);o!=null&&T(t,["nextPageToken"],o);const c=b(n,["tuningJobs"]);if(c!=null){let f=c;Array.isArray(f)&&(f=f.map(y=>zm(y))),T(t,["tuningJobs"],f)}return t}function z4(n,e){const t={},i=b(n,["name"]);i!=null&&T(t,["model"],i);const o=b(n,["name"]);return o!=null&&T(t,["endpoint"],o),t}function q4(n,e){const t={};if(b(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(b(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=b(n,["examples"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(c=>c)),T(t,["examples","examples"],o)}return t}function Y4(n,e,t){const i={};let o=b(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const f=b(n,["gcsUri"]);e!==void 0&&f!=null&&T(e,["supervisedTuningSpec","trainingDatasetUri"],f)}else if(o==="PREFERENCE_TUNING"){const f=b(n,["gcsUri"]);e!==void 0&&f!=null&&T(e,["preferenceOptimizationSpec","trainingDatasetUri"],f)}let c=b(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const f=b(n,["vertexDatasetResource"]);e!==void 0&&f!=null&&T(e,["supervisedTuningSpec","trainingDatasetUri"],f)}else if(c==="PREFERENCE_TUNING"){const f=b(n,["vertexDatasetResource"]);e!==void 0&&f!=null&&T(e,["preferenceOptimizationSpec","trainingDatasetUri"],f)}if(b(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function t2(n,e){const t={},i=b(n,["sdkHttpResponse"]);i!=null&&T(t,["sdkHttpResponse"],i);const o=b(n,["name"]);o!=null&&T(t,["name"],o);const c=b(n,["state"]);c!=null&&T(t,["state"],xE(c));const f=b(n,["createTime"]);f!=null&&T(t,["createTime"],f);const y=b(n,["tuningTask","startTime"]);y!=null&&T(t,["startTime"],y);const w=b(n,["tuningTask","completeTime"]);w!=null&&T(t,["endTime"],w);const x=b(n,["updateTime"]);x!=null&&T(t,["updateTime"],x);const A=b(n,["description"]);A!=null&&T(t,["description"],A);const N=b(n,["baseModel"]);N!=null&&T(t,["baseModel"],N);const R=b(n,["_self"]);return R!=null&&T(t,["tunedModel"],z4(R)),t}function zm(n,e){const t={},i=b(n,["sdkHttpResponse"]);i!=null&&T(t,["sdkHttpResponse"],i);const o=b(n,["name"]);o!=null&&T(t,["name"],o);const c=b(n,["state"]);c!=null&&T(t,["state"],xE(c));const f=b(n,["createTime"]);f!=null&&T(t,["createTime"],f);const y=b(n,["startTime"]);y!=null&&T(t,["startTime"],y);const w=b(n,["endTime"]);w!=null&&T(t,["endTime"],w);const x=b(n,["updateTime"]);x!=null&&T(t,["updateTime"],x);const A=b(n,["error"]);A!=null&&T(t,["error"],A);const N=b(n,["description"]);N!=null&&T(t,["description"],N);const R=b(n,["baseModel"]);R!=null&&T(t,["baseModel"],R);const k=b(n,["tunedModel"]);k!=null&&T(t,["tunedModel"],k);const H=b(n,["preTunedModel"]);H!=null&&T(t,["preTunedModel"],H);const W=b(n,["supervisedTuningSpec"]);W!=null&&T(t,["supervisedTuningSpec"],W);const K=b(n,["preferenceOptimizationSpec"]);K!=null&&T(t,["preferenceOptimizationSpec"],K);const te=b(n,["tuningDataStats"]);te!=null&&T(t,["tuningDataStats"],te);const le=b(n,["encryptionSpec"]);le!=null&&T(t,["encryptionSpec"],le);const ee=b(n,["partnerModelTuningSpec"]);ee!=null&&T(t,["partnerModelTuningSpec"],ee);const de=b(n,["customBaseModel"]);de!=null&&T(t,["customBaseModel"],de);const Ee=b(n,["experiment"]);Ee!=null&&T(t,["experiment"],Ee);const me=b(n,["labels"]);me!=null&&T(t,["labels"],me);const U=b(n,["outputUri"]);U!=null&&T(t,["outputUri"],U);const V=b(n,["pipelineJob"]);V!=null&&T(t,["pipelineJob"],V);const F=b(n,["serviceAccount"]);F!=null&&T(t,["serviceAccount"],F);const Q=b(n,["tunedModelDisplayName"]);Q!=null&&T(t,["tunedModelDisplayName"],Q);const Y=b(n,["veoTuningSpec"]);return Y!=null&&T(t,["veoTuningSpec"],Y),t}function W4(n,e){const t={},i=b(n,["sdkHttpResponse"]);i!=null&&T(t,["sdkHttpResponse"],i);const o=b(n,["name"]);o!=null&&T(t,["name"],o);const c=b(n,["metadata"]);c!=null&&T(t,["metadata"],c);const f=b(n,["done"]);f!=null&&T(t,["done"],f);const y=b(n,["error"]);return y!=null&&T(t,["error"],y),t}function aw(n,e){const t={},i=b(n,["gcsUri"]);i!=null&&T(t,["validationDatasetUri"],i);const o=b(n,["vertexDatasetResource"]);return o!=null&&T(t,["validationDatasetUri"],o),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class X4 extends No{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new dl(To.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const o={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(o.checkpointId=t.config.preTunedModelCheckpointId);const c=Object.assign(Object.assign({},t),{preTunedModel:o});return c.baseModel=void 0,await this.tuneInternal(c)}else{const o=Object.assign({},t);return await this.tuneInternal(o)}else{const o=Object.assign({},t),c=await this.tuneMldevInternal(o);let f="";return c.metadata!==void 0&&c.metadata.tunedModel!==void 0?f=c.metadata.tunedModel:c.name!==void 0&&c.name.includes("/operations/")&&(f=c.name.split("/operations/")[0]),{name:f,state:Dm.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=U4(e);return y=et("{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>zm(A))}else{const x=L4(e);return y=et("{name}",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>t2(A))}}async listInternal(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=V4(e);return y=et("tuningJobs",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=H4(A),R=new Ov;return Object.assign(R,N),R})}else{const x=j4(e);return y=et("tunedModels",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=G4(A),R=new Ov;return Object.assign(R,N),R})}}async cancel(e){var t,i,o,c;let f,y="",w={};if(this.apiClient.isVertexAI()){const x=I4(e);return y=et("{name}:cancel",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=M4(A),R=new kv;return Object.assign(R,N),R})}else{const x=N4(e);return y=et("{name}:cancel",x._url),w=x._query,delete x._url,delete x._query,f=this.apiClient.request({path:y,queryParams:w,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(A=>A.json().then(N=>{const R=N;return R.sdkHttpResponse={headers:A.headers},R})),f.then(A=>{const N=R4(A),R=new kv;return Object.assign(R,N),R})}}async tuneInternal(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI()){const y=P4(e,e);return c=et("tuningJobs",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json().then(x=>{const A=x;return A.sdkHttpResponse={headers:w.headers},A})),o.then(w=>zm(w))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let o,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=k4(e);return c=et("tunedModels",y._url),f=y._query,delete y._url,delete y._query,o=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(w=>w.json().then(x=>{const A=x;return A.sdkHttpResponse={headers:w.headers},A})),o.then(w=>W4(w))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class K4{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const $4=1024*1024*8,J4=3,Q4=1e3,Z4=2,Ch="x-goog-upload-status";async function e6(n,e,t){var i;const o=await n2(n,e,t),c=await(o==null?void 0:o.json());if(((i=o==null?void 0:o.headers)===null||i===void 0?void 0:i[Ch])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return c.file}async function t6(n,e,t){var i;const o=await n2(n,e,t),c=await(o==null?void 0:o.json());if(((i=o==null?void 0:o.headers)===null||i===void 0?void 0:i[Ch])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const f=dE(c),y=new Tg;return Object.assign(y,f),y}async function n2(n,e,t){var i,o;let c=0,f=0,y=new Om(new Response),w="upload";for(c=n.size;f<c;){const x=Math.min($4,c-f),A=n.slice(f,f+x);f+x>=c&&(w+=", finalize");let N=0,R=Q4;for(;N<J4&&(y=await t.request({path:"",body:A,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":w,"X-Goog-Upload-Offset":String(f),"Content-Length":String(x)}}}),!(!((i=y==null?void 0:y.headers)===null||i===void 0)&&i[Ch]));)N++,await i6(R),R=R*Z4;if(f+=x,((o=y==null?void 0:y.headers)===null||o===void 0?void 0:o[Ch])!=="active")break;if(c<=f)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return y}async function n6(n){return{size:n.size,type:n.type}}function i6(n){return new Promise(e=>setTimeout(e,n))}class s6{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await e6(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await t6(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await n6(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class r6{create(e,t,i){return new o6(e,t,i)}}class o6{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lw="x-goog-api-key";class a6{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(lw)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(lw,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const l6="gl-node/";class Dg{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new Ii({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=iS(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const o=new a6(this.apiKey);this.apiClient=new n3({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:l6+"web",uploader:new s6,downloader:new K4}),this.models=new b3(this.apiClient),this.live=new g3(this.apiClient,o,new r6),this.batches=new DC(this.apiClient),this.chats=new fN(this.models,this.apiClient),this.caches=new uN(this.apiClient),this.files=new _N(this.apiClient),this.operations=new E3(this.apiClient),this.authTokens=new B3(this.apiClient),this.tunings=new X4(this.apiClient),this.fileSearchStores=new Y3(this.apiClient)}}const i2=async n=>({inlineData:{data:await new Promise(t=>{const i=new FileReader;i.onloadend=()=>t(i.result.split(",")[1]),i.readAsDataURL(n)}),mimeType:n.type}}),zs=async n=>{try{let i=(await new Dg({apiKey:void 0}).models.generateContent(n)).text||"{}";return i.trim().startsWith("```")&&(i=i.replace(/^```json\s*/,"").replace(/^```\s*/,"").replace(/\s*```$/,"")),JSON.parse(i)}catch(e){throw console.error("Gemini API Error:",e),new Error("Failed to generate content")}},c6=async(n,e)=>zs({model:"gemini-3-flash-preview",contents:[{parts:[{text:`Create a simple recipe appropriate for a baby who is ${e} months old using these ingredients: "${n}".`}]}],config:{systemInstruction:"You are a world-class pediatric chef and nutritionist.",responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{title:{type:We.STRING},ingredients:{type:We.STRING,description:"Bulleted list of ingredients"},instructions:{type:We.STRING,description:"Numbered list of steps"}},required:["title","ingredients","instructions"]}}}),u6=async n=>{const e=await i2(n);return zs({model:"gemini-2.5-flash-image",contents:[{parts:[{text:"Extract the recipe details from this image."},e]}],config:{responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{title:{type:We.STRING},ingredients:{type:We.STRING},instructions:{type:We.STRING}},required:["title","ingredients","instructions"]}}})},d6=async n=>{try{const e=await i2(n),t=ac.join(", ");return(await zs({model:"gemini-2.5-flash-image",contents:[{parts:[{text:`Identify the single main food item in this image. Match against: [${t}].`},e]}],config:{responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{foodName:{type:We.STRING,nullable:!0}}}}})).foodName}catch(e){return console.error("Error identifying food:",e),null}},h6=async n=>{const e=n.length>0?n.join(", "):"starter baby foods";return{pairings:(await zs({model:"gemini-3-flash-preview",contents:[{parts:[{text:`Suggest 3 creative pairings using: ${e}.`}]}],config:{systemInstruction:"You are Sage, a baby flavor sommelier.",responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{pairings:{type:We.ARRAY,items:{type:We.OBJECT,properties:{title:{type:We.STRING},description:{type:We.STRING},ingredients:{type:We.ARRAY,items:{type:We.STRING}}}}}}}}})).pairings||[]}},f6=async(n,e)=>{var i,o,c;const t=n.map(f=>({role:f.role==="model"?"model":"user",parts:[{text:f.text}]}));t.push({role:"user",parts:[{text:e}]});try{const y=await new Dg({apiKey:void 0}).models.generateContent({model:"gemini-3-flash-preview",contents:t,config:{systemInstruction:"You are Sage, a research assistant for parents. Base your answers on authoritative sources. Use a thinking budget to ensure high quality. Return JSON with 'answer' (markdown), 'suggestedQuestions' (array of 3), and 'thinking' (your reasoning).",tools:[{googleSearch:{}}],thinkingConfig:{thinkingBudget:4e3},responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{answer:{type:We.STRING},suggestedQuestions:{type:We.ARRAY,items:{type:We.STRING}},thinking:{type:We.STRING}},required:["answer","suggestedQuestions"]}}});let w=y.text||"{}";w.trim().startsWith("```")&&(w=w.replace(/^```json\s*/,"").replace(/^```\s*/,"").replace(/\s*```$/,""));const x=JSON.parse(w),A=((c=(o=(i=y.candidates)==null?void 0:i[0])==null?void 0:o.groundingMetadata)==null?void 0:c.groundingChunks)??[];return{answer:x.answer,sources:A,suggestedQuestions:x.suggestedQuestions||[]}}catch(f){throw console.error("Error asking research assistant:",f),new Error("Failed to get a research-backed answer.")}},m6=async n=>zs({model:"gemini-3-flash-preview",contents:[{parts:[{text:`Analyze "${n}" for a baby (6-12 months).`}]}],config:{responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{safety_rating:{type:We.STRING,enum:["Safe","Use Caution","Avoid"]},allergen_info:{type:We.STRING},texture_recommendation:{type:We.STRING},nutrition_highlight:{type:We.STRING},emoji:{type:We.STRING},category:{type:We.STRING}},required:["safety_rating","allergen_info","texture_recommendation","nutrition_highlight","emoji","category"]}}}),g6=async(n,e,t="Unknown")=>{const i=await zs({model:"gemini-3-flash-preview",contents:[{parts:[{text:`Target Food: ${n}
Safe Foods: ${e}
The "Ick" Factor: ${t}.`}]}],config:{systemInstruction:"You are Sage, a pediatric nutritionist. Suggest 3 approaches to bridge the gap. Use thinkingBudget for deep empathy.",thinkingConfig:{thinkingBudget:4e3},responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{strategies:{type:We.ARRAY,items:{type:We.OBJECT,properties:{type:{type:We.STRING},title:{type:We.STRING},why_it_works:{type:We.STRING},ingredients:{type:We.ARRAY,items:{type:We.STRING}},instructions:{type:We.STRING}}}},parent_tip:{type:We.STRING}}}}});return i.strategies?i:{strategies:[],parent_tip:"Try again later."}},p6=async(n,e,t)=>zs({model:"gemini-3-flash-preview",contents:[{parts:[{text:`Current: ${n}
Last Wake: ${e}
Summary: ${t}`}]}],config:{systemInstruction:"Predict the next Sleep Sweet Spot.",responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{prediction_status:{type:We.STRING,enum:["Ready","Needs More Data"]},next_sweet_spot_start:{type:We.STRING},average_wake_window_minutes:{type:We.NUMBER},reasoning_summary:{type:We.STRING},troubleshooting_tip:{type:We.STRING}}}}}),x6=async(n,e)=>zs({model:"gemini-3-flash-preview",contents:[{parts:[{text:`Baby Age: ${n}. Totals: ${JSON.stringify(e)}.`}]}],config:{systemInstruction:"Analyze daily totals against WHO/AAP guidelines.",responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{overall_status:{type:We.STRING,enum:["Normal","Watch Closely","Contact Pediatrician"]},data_points:{type:We.ARRAY,items:{type:We.OBJECT,properties:{metric:{type:We.STRING},value_logged:{type:We.NUMBER},normal_range:{type:We.STRING},status:{type:We.STRING,enum:["Normal","Low","High"]},guidance:{type:We.STRING}}}},disclaimer_warning:{type:We.STRING}}}}}),y6=async n=>{try{const e=await zs({model:"gemini-3-flash-preview",contents:[{parts:[{text:`Categorize these shopping items: ${n.join(", ")}.`}]}],config:{responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{categories:{type:We.ARRAY,items:{type:We.OBJECT,properties:{name:{type:We.STRING},items:{type:We.ARRAY,items:{type:We.STRING}}},required:["name","items"]}}}}}}),t={};return e.categories&&Array.isArray(e.categories)&&e.categories.forEach(i=>{i.name&&Array.isArray(i.items)&&(t[i.name]=i.items)}),Object.keys(t).length>0?t:{Groceries:n}}catch(e){return console.error("Error categorizing list:",e),{Uncategorized:n}}},v6=async(n,e)=>{try{return(await zs({model:"gemini-3-flash-preview",contents:[{parts:[{text:`Suggest 3 baby-safe substitutes for "${n}" for a ${e} month old.`}]}],config:{responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{substitutes:{type:We.ARRAY,items:{type:We.OBJECT,properties:{name:{type:We.STRING},reason:{type:We.STRING}},required:["name","reason"]}}}}}})).substitutes||[]}catch{return[]}},w6=async(n,e)=>zs({model:"gemini-3-flash-preview",contents:[{parts:[{text:`Analyze this packaged product for a baby (6-12 months). Product: ${n}, Ingredients: ${e}`}]}],config:{responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{safety_rating:{type:We.STRING,enum:["Safe","Use Caution","Avoid"]},allergen_info:{type:We.STRING},texture_recommendation:{type:We.STRING},nutrition_highlight:{type:We.STRING},emoji:{type:We.STRING},category:{type:We.STRING}},required:["safety_rating","allergen_info","texture_recommendation","nutrition_highlight","emoji","category"]}}}),b6=async(n,e)=>zs({model:"gemini-3-flash-preview",contents:[{parts:[{text:`Suggest foods rich in ${n} for a toddler. Context: ${e}`}]}],config:{responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{suggestions:{type:We.ARRAY,items:{type:We.OBJECT,properties:{food:{type:We.STRING},prep_time:{type:We.STRING},why:{type:We.STRING}},required:["food","prep_time","why"]}},quick_tip:{type:We.STRING}}}}}),E6=async(n,e)=>zs({model:"gemini-3-flash-preview",contents:[{parts:[{text:`Provide safety instructions for giving ${n} to a baby weighing ${e}.`}]}],config:{systemInstruction:"You are a pediatric medical assistant. Provide cautious, general guidance and ALWAYS advise consulting a doctor for dosage.",responseMimeType:"application/json",responseSchema:{type:We.OBJECT,properties:{medicine_name:{type:We.STRING},safe_administration_checklist:{type:We.ARRAY,items:{type:We.STRING}},critical_warning:{type:We.STRING},source_tip:{type:We.STRING}},required:["medicine_name","safe_administration_checklist","critical_warning","source_tip"]}}}),Ou=({illustration:n,title:e,message:t,children:i})=>h.jsxs("div",{className:"text-center py-10 px-4 flex flex-col items-center",children:[h.jsx("div",{className:"w-40 h-40 sm:w-48 sm:h-48 mx-auto text-gray-300",children:n}),h.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:e}),h.jsx("p",{className:"mt-1 text-sm text-gray-500 max-w-sm mx-auto",children:t}),i&&h.jsx("div",{className:"mt-6",children:i})]}),gm=({name:n,emoji:e,category:t,isTried:i,isAllergic:o,isCustom:c,onClick:f,onInfoClick:y,baseColor:w})=>{const x=i?"is-tried":"",A=Jl[n]||[];return h.jsxs("div",{className:`food-card relative group ${t.color} ${t.textColor} h-auto min-h-[8rem] rounded-lg shadow-sm border ${t.borderColor} ${x} transition-all duration-200 hover:shadow-md hover:scale-105`,children:[h.jsxs("button",{onClick:f,className:"w-full h-full p-3 flex flex-col items-center justify-start cursor-pointer focus:outline-none rounded-lg",type:"button",children:[h.jsx("span",{className:"text-3xl mb-1 mt-1",children:e}),h.jsx("span",{className:"text-sm font-medium text-center leading-tight line-clamp-2",children:n}),h.jsxs("div",{className:"flex flex-wrap justify-center gap-1 mt-2",children:[A.slice(0,3).map(N=>{const R=Yh[N]||{text:"text-gray-800",border:"border-gray-200",label:N};return h.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-[9px] font-bold border bg-white/80 backdrop-blur-sm ${R.text} ${R.border}`,children:R.label},N)}),c&&h.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-[9px] font-bold border bg-white/80 backdrop-blur-sm bg-violet-50 text-violet-700 border-violet-200",children:"Custom"})]})]}),o&&!i&&h.jsx("div",{className:"absolute top-1 left-1 bg-white rounded-full p-0.5 shadow-sm z-10",title:"Contains known allergen",children:h.jsx(ue,{name:"alert-triangle",className:"w-4 h-4 text-red-500 fill-red-50"})}),h.jsx("button",{onClick:N=>{N.stopPropagation(),y(N)},className:`absolute top-1 right-1 p-1.5 rounded-full bg-white/60 hover:bg-white text-${w}-700 shadow-sm transition-colors opacity-80 hover:opacity-100 z-10`,title:"How to Serve Guide",children:h.jsx(ue,{name:"chef-hat",className:"w-3.5 h-3.5"})}),h.jsx("div",{className:"check-overlay absolute inset-0 bg-white/70 flex items-center justify-center rounded-lg pointer-events-none z-0",children:h.jsx(ue,{name:"check-circle-2",className:`w-12 h-12 text-${w}-600`})})]})},pm=({filter:n,currentFilter:e,onClick:t,children:i,baseColor:o})=>{const c=n===e,f="filter-btn flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors duration-150",y=`bg-${o}-600 text-white`;return h.jsx("button",{onClick:()=>t(n),className:`${f} ${c?y:"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:i})},cw=({category:n,triedCount:e})=>{const t=n.items.length,i=t>0?e/t*100:0,c=`bg-${n.color.replace("bg-","").replace("-100","")}-500`;return h.jsxs("div",{className:"mb-2",children:[h.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[h.jsx("span",{className:`font-medium ${n.textColor}`,children:n.category}),h.jsxs("span",{className:"text-gray-500",children:[e,"/",t]})]}),h.jsx("div",{className:"w-full bg-gray-100 rounded-full h-2",children:h.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${c}`,style:{width:`${i}%`}})})]})},_6=()=>h.jsxs("svg",{viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M 25 20 H 75 V 80 H 25 Z",strokeDasharray:"5 5",rx:"5"}),h.jsx("circle",{cx:"50",cy:"50",r:"15",strokeWidth:"2.5"}),h.jsx("line",{x1:"62",y1:"62",x2:"75",y2:"75",strokeWidth:"2.5"}),h.jsx("line",{x1:"40",y1:"60",x2:"60",y2:"40",strokeWidth:"1.5"})]}),uw=({triedFoods:n,customFoods:e=[],onFoodClick:t,userProfile:i,onShowGuide:o,onAddCustomFood:c,onScanBarcode:f,baseColor:y="teal"})=>{const[w,x]=oe.useState("all"),[A,N]=oe.useState(""),[R,k]=oe.useState(!1),[H,W]=oe.useState(!0),[K,te]=oe.useState(!1),le=oe.useRef(null),ee=oe.useMemo(()=>new Set(n.map(ne=>ne.id)),[n]),de=ee.size,Ee=$A+e.length,me=Ee>0?de/Ee*100:0,U=Array.isArray(i==null?void 0:i.knownAllergies)?i==null?void 0:i.knownAllergies:[],V=e.filter(ne=>{const ie=ee.has(ne.name);return A&&!ne.name.toLowerCase().includes(A.toLowerCase())?!1:w==="all"?!0:w==="to_try"?!ie:w==="tried"?ie:!1}),F=Ns.map(ne=>{const ie=ne.items.filter(Me=>{const ze=ee.has(Me.name);return A&&!Me.name.toLowerCase().includes(A.toLowerCase())?!1:w==="all"?!0:w==="to_try"?!ze:w==="tried"?ze:!1});return{...ne,items:ie}}).filter(ne=>ne.items.length>0),Q=F.length>0||V.length>0,Y=ne=>{const ie=Eh[ne];return ie?ie.some(Me=>U.includes(Me)):!1},$=oe.useMemo(()=>{const ne=new Map;return[...n].sort((ie,Me)=>new Date(Me.date).getTime()-new Date(ie.date).getTime()).forEach(ie=>{ne.has(ie.id)||ne.set(ie.id,ie)}),Array.from(ne.values()).slice(0,5)},[n]),z=()=>{var ne;(ne=le.current)==null||ne.click()},_e=async ne=>{var Me;const ie=(Me=ne.target.files)==null?void 0:Me[0];if(ie){te(!0);try{const ze=await d6(ie);if(ze){let ct;for(const ae of Ns){const Ie=ae.items.find(Ae=>Ae.name===ze);if(Ie){ct=Ie;break}}ct||(ct=e.find(ae=>ae.name===ze)),ct?t(ct):alert(`AI identified this as "${ze}", but it's not in our tracked 100 foods list yet.`)}else alert("Could not identify a tracked food in this image. Try taking a closer photo.")}catch(ze){console.error(ze),alert("Error analyzing image.")}finally{te(!1),le.current&&(le.current.value="")}}},he={category:"Custom",color:"bg-white",textColor:"text-violet-800",borderColor:"border-violet-200",items:[]};return h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"My 100 Foods"}),h.jsx("input",{type:"file",accept:"image/*",ref:le,onChange:_e,className:"hidden",capture:"environment"})]}),h.jsxs("div",{className:"mb-4 flex gap-2",children:[h.jsxs("div",{className:"relative flex-grow",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(ue,{name:"search",className:"h-5 w-5 text-gray-400"})}),h.jsx("input",{type:"text",placeholder:"Search foods...",value:A,onChange:ne=>N(ne.target.value),className:`block w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-${y}-500 focus:border-${y}-500 sm:text-sm transition duration-150 ease-in-out shadow-sm`}),A&&h.jsx("button",{onClick:()=>N(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:h.jsx(ue,{name:"x",className:"h-4 w-4"})})]}),f&&h.jsx("button",{onClick:f,className:"flex-shrink-0 bg-indigo-600 text-white p-2 rounded-md shadow-sm hover:bg-indigo-700 transition-colors flex items-center justify-center gap-1 min-w-[2.5rem]",title:"Scan Barcode",children:h.jsx(ue,{name:"scan-barcode",className:"h-5 w-5"})}),c&&h.jsx("button",{onClick:()=>c(""),className:"flex-shrink-0 bg-violet-600 text-white p-2 rounded-md shadow-sm hover:bg-violet-700 transition-colors flex items-center justify-center gap-1 min-w-[2.5rem]",title:"Add Custom Food",children:h.jsx(ue,{name:"plus",className:"h-5 w-5"})}),h.jsx("button",{onClick:z,disabled:K,className:`flex-shrink-0 bg-${y}-600 text-white p-2 rounded-md shadow-sm hover:bg-${y}-700 disabled:opacity-50 transition-colors`,title:"Identify food from photo",children:K?h.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):h.jsx(ue,{name:"camera",className:"h-5 w-5"})})]}),$.length>0&&!A&&w!=="to_try"&&h.jsxs("div",{className:"mb-6",children:[h.jsxs("button",{onClick:()=>W(!H),className:"flex items-center justify-between w-full text-left mb-3 group focus:outline-none bg-gray-50 p-2 rounded-md hover:bg-gray-100 transition-colors border border-gray-100",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(ue,{name:"clock",className:`w-4 h-4 text-${y}-600`}),h.jsx("h3",{className:`text-sm font-semibold text-gray-700 uppercase tracking-wider group-hover:text-${y}-700`,children:"Recently Tried"})]}),h.jsx(ue,{name:"chevron-down",className:`w-4 h-4 text-gray-400 transform transition-transform duration-200 ${H?"rotate-180":""}`})]}),h.jsx("div",{className:`transition-all duration-300 ease-in-out overflow-hidden ${H?"max-h-[500px] opacity-100":"max-h-0 opacity-0"}`,children:h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-3 pt-1",children:$.map(ne=>{let ie,Me;for(const ze of Ns){const ct=ze.items.find(ae=>ae.name===ne.id);if(ct){Me=ct,ie=ze;break}}return Me||(Me=e.find(ze=>ze.name===ne.id),Me&&(ie=he)),!Me||!ie?null:h.jsx(gm,{name:Me.name,emoji:Me.emoji,category:ie,isTried:!0,isAllergic:Y(Me.name),isCustom:Me.isCustom,onClick:()=>t(Me),onInfoClick:ze=>{ze.stopPropagation(),o(Me)},baseColor:y},`recent-${ne.id}`)})})})]}),h.jsxs("div",{className:"flex space-x-2 mb-4",children:[h.jsx(pm,{filter:"all",currentFilter:w,onClick:x,baseColor:y,children:"All"}),h.jsx(pm,{filter:"to_try",currentFilter:w,onClick:x,baseColor:y,children:"To Try"}),h.jsx(pm,{filter:"tried",currentFilter:w,onClick:x,baseColor:y,children:"Tried"})]}),h.jsxs("div",{className:"bg-white p-4 rounded-lg shadow mb-6",children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsx("span",{className:`text-lg font-semibold text-${y}-700`,children:"Food Journey Progress"}),h.jsxs("span",{className:`text-lg font-bold text-${y}-700`,children:[de," / ",Ee]})]}),h.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4",children:h.jsx("div",{className:`bg-${y}-600 h-4 rounded-full transition-all duration-500`,style:{width:`${me}%`}})}),h.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-100",children:[h.jsxs("button",{onClick:()=>k(!R),className:"flex items-center justify-between w-full text-left group focus:outline-none",children:[h.jsx("h4",{className:`text-xs font-semibold text-gray-500 uppercase tracking-wider group-hover:text-${y}-600 transition-colors`,children:"Breakdown by Category"}),h.jsx(ue,{name:"chevron-down",className:`w-4 h-4 text-gray-400 transform transition-transform duration-200 ${R?"rotate-180":""}`})]}),h.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-1 transition-all duration-300 ease-in-out overflow-hidden ${R?"max-h-[1000px] opacity-100 mt-3":"max-h-0 opacity-0"}`,children:[Ns.map(ne=>{const ie=ne.items.filter(Me=>ee.has(Me.name)).length;return h.jsx(cw,{category:ne,triedCount:ie},ne.category)}),e.length>0&&h.jsx(cw,{category:he,triedCount:e.filter(ne=>ee.has(ne.name)).length})]})]})]}),Q?h.jsxs(h.Fragment,{children:[F.map(ne=>h.jsxs("div",{children:[h.jsx("h2",{className:`text-2xl font-semibold ${ne.textColor} mt-8 mb-4`,children:ne.category}),h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3 sm:gap-4",children:ne.items.map(ie=>h.jsx(gm,{name:ie.name,emoji:ie.emoji,category:ne,isTried:ee.has(ie.name),isAllergic:Y(ie.name),isCustom:!1,onClick:()=>t(ie),onInfoClick:Me=>{Me.stopPropagation(),o(ie)},baseColor:y},ie.name))})]},ne.category)),V.length>0&&h.jsxs("div",{className:"mb-8 p-4 bg-white rounded-xl border border-gray-100 shadow-sm mt-8",children:[h.jsxs("h2",{className:"text-xl font-bold text-violet-900 mb-4 flex items-center gap-2",children:[h.jsx("div",{className:"p-1.5 bg-violet-50 rounded-full border border-violet-100 shadow-sm",children:h.jsx(ue,{name:"scan-barcode",className:"w-5 h-5 text-violet-600"})}),"Custom & Scanned Items"]}),h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3 sm:gap-4",children:V.map(ne=>h.jsx(gm,{name:ne.name,emoji:ne.emoji,category:he,isTried:ee.has(ne.name),isAllergic:Y(ne.name),isCustom:!0,onClick:()=>t(ne),onInfoClick:ie=>{ie.stopPropagation(),o(ne)},baseColor:y},ne.name))})]})]}):h.jsx(Ou,{illustration:h.jsx(_6,{}),title:"No Foods Found",message:`We couldn't find "${A}" in our database.`,children:A&&c&&h.jsxs("div",{className:"mt-4",children:[h.jsxs("button",{onClick:()=>c(A),className:"inline-flex items-center gap-2 px-4 py-2 bg-violet-600 text-white rounded-md shadow-md hover:bg-violet-700 transition-colors font-semibold",children:[h.jsx(ue,{name:"plus-circle",className:"w-4 h-4"}),'Add "',A,'" Manually']}),h.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"We'll use AI to generate safety & serving info!"})]})})]})},s2=({title:n,icon:e,defaultOpen:t=!1,children:i,baseColor:o="teal"})=>{const[c,f]=oe.useState(t);return h.jsxs("div",{className:`accordion-item bg-white shadow-sm rounded-lg border border-gray-200 ${c?"is-open":""}`,children:[h.jsxs("button",{className:"accordion-toggle flex justify-between items-center w-full p-4 text-left",onClick:()=>f(!c),children:[h.jsxs("span",{className:"flex items-center gap-3",children:[h.jsx(ue,{name:e,className:`w-5 h-5 text-${o}-600`}),h.jsx("span",{className:"text-md font-medium text-gray-700",children:n})]}),h.jsx(ue,{name:"chevron-down",className:`w-5 h-5 text-gray-400 accordion-arrow transition-transform ${c?"rotate-180":""}`})]}),h.jsx("div",{className:"accordion-content",children:h.jsx("div",{className:"p-4 pt-0 text-gray-600 text-sm",children:i})})]})},T6=n=>{const e=new Date(n),t=new Date;let i=t.getFullYear()-e.getFullYear(),o=t.getMonth()-e.getMonth(),c=t.getDate()-e.getDate();c<0&&(o--,c+=new Date(t.getFullYear(),t.getMonth(),0).getDate()),o<0&&(i--,o+=12);const f=i*12+o;let y="12_plus";f<6?y="too_young":f===6?y="6_months":f>=7&&f<=8?y="7_8_months":f>=9&&f<=11&&(y="9_11_months");let w="";return i>0&&(w+=`${i} year${i>1?"s":""}, `),w+=`${o} month${o!==1?"s":""}, and ${c} day${c!==1?"s":""}`,{ageString:w,ageKey:y,totalMonths:f}},dw=({food:n,isTried:e,isAllergic:t,onClick:i,onSubstitutesClick:o,baseColor:c})=>{const f=Ns.find(w=>w.items.some(x=>x.name===n.name));if(!f)return null;const y=e?"is-tried":"";return h.jsxs("div",{className:`food-card relative ${f.color} ${f.textColor} rounded-lg shadow-sm font-medium text-sm text-center border ${f.borderColor} ${y} transition-all duration-200 hover:shadow-md`,children:[h.jsxs("button",{onClick:i,className:`w-full p-3 h-24 flex flex-col items-center justify-center cursor-pointer focus:outline-none focus:ring-2 focus:ring-${c}-500 rounded-lg`,type:"button","aria-label":`Log ${n.name}`,children:[h.jsx("span",{className:"text-3xl",children:n.emoji}),h.jsx("span",{className:"mt-1 text-center leading-tight",children:n.name})]}),t&&!e&&h.jsx("div",{className:"absolute top-1 right-1 bg-white rounded-full p-0.5 shadow-sm z-10",title:"Contains known allergen",children:h.jsx(ue,{name:"alert-triangle",className:"w-4 h-4 text-red-500 fill-red-50"})}),h.jsx("div",{className:"check-overlay absolute inset-0 bg-white/70 flex items-center justify-center rounded-lg pointer-events-none",children:h.jsx(ue,{name:"check-circle-2",className:`w-12 h-12 text-${c}-600`})}),!e&&h.jsx("button",{onClick:w=>{w.stopPropagation(),o()},className:`substitute-btn absolute bottom-1 right-1 bg-white/80 hover:bg-white text-${c}-700 rounded-full p-1.5 text-xs font-medium flex items-center gap-1 shadow-sm border border-${c}-200 z-10 transition-colors`,title:"Find Substitutes","aria-label":`Find substitutes for ${n.name}`,children:h.jsx(ue,{name:"replace",className:"w-4 h-4"})})]})},A6=({userProfile:n,triedFoods:e,onSaveProfile:t,onFoodClick:i,onShowSubstitutes:o,onShowFlavorPairing:c,baseColor:f="teal"})=>{const[y,w]=oe.useState((n==null?void 0:n.pediatricianApproved)||!1),x=()=>{w(!0),t({...n,pediatricianApproved:!0})},A=()=>{if(!(n!=null&&n.birthDate))return h.jsx("p",{className:"text-gray-500 text-center py-4 bg-white p-6 rounded-lg shadow",children:"Please set your baby's birth date in the Profile tab to see recommendations."});const{ageString:N,ageKey:R}=T6(n.birthDate),k=Array.isArray(n.knownAllergies)?n.knownAllergies:[];if(R==="too_young"&&!y)return h.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:[h.jsx("h3",{className:"text-lg font-semibold text-yellow-800",children:"Note: Baby is Under 6 Months"}),h.jsx("p",{className:"text-yellow-700 mt-2",children:hm.too_young.message}),h.jsx("p",{className:"text-gray-700 font-medium mt-4",children:"Has your pediatrician specifically approved starting solids early?"}),h.jsx("div",{className:"mt-3",children:h.jsx("button",{onClick:x,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Yes, we are approved"})})]});const H=new Set(e.map(te=>te.id)),W=R==="too_young"&&y?"6_months":R,K=te=>{const le=Eh[te];return le?le.some(ee=>k.includes(ee)):!1};return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:`mt-6 p-4 bg-${f}-50 rounded-md`,children:h.jsxs("p",{className:`text-lg font-medium text-${f}-800`,children:[h.jsx("span",{className:"font-normal",children:n.babyName?`${n.babyName}'s Age:`:"Baby's Age:"})," ",h.jsx("span",{className:"font-bold",children:N})]})}),e.length>2&&h.jsxs("div",{className:"mt-4 p-5 bg-gradient-to-r from-violet-50 to-purple-50 rounded-xl border border-violet-100 flex items-center justify-between shadow-sm relative overflow-hidden group",children:[h.jsxs("div",{className:"relative z-10",children:[h.jsxs("h3",{className:"text-lg font-bold text-violet-800 flex items-center gap-2",children:[h.jsx(ue,{name:"sparkles",className:"w-5 h-5 text-violet-600"}),"Sage's Flavor Sommelier"]}),h.jsxs("p",{className:"text-sm text-violet-700 mt-1 max-w-sm",children:["You've tried ",e.length,' foods! Tap to get custom pairing ideas from "Sage" based on what ',n.babyName||"baby"," likes."]}),h.jsxs("button",{onClick:c,className:"mt-3 inline-flex items-center gap-1.5 px-4 py-2 bg-white text-violet-700 text-xs font-bold rounded-full shadow hover:bg-violet-50 transition-colors border border-violet-200",children:["Get Pairing Ideas ",h.jsx(ue,{name:"arrow-right",className:"w-3.5 h-3.5"})]})]}),h.jsx("div",{className:"absolute right-[-10px] top-[-10px] text-violet-200 opacity-20 transform rotate-12 group-hover:scale-110 transition-transform",children:h.jsx(ue,{name:"chef-hat",className:"w-40 h-40"})})]}),h.jsx("div",{className:"mt-6 space-y-3",children:Object.keys(hm).filter(te=>te!=="too_young").map(te=>{const le=hm[te],ee=le.foods.map(U=>Ns.flatMap(V=>V.items).find(V=>V.name===U)).filter(Boolean),de=ee.filter(U=>H.has(U.name)),Ee=ee.filter(U=>!H.has(U.name)),me=h.jsxs(h.Fragment,{children:[h.jsx("p",{className:"text-sm text-gray-600 mb-4",dangerouslySetInnerHTML:{__html:le.message}}),Ee.length>0&&h.jsxs(h.Fragment,{children:[h.jsx("h4",{className:"text-md font-medium text-green-700 mb-3",children:"New Foods to Try:"}),h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 sm:gap-4",children:Ee.map(U=>h.jsx(dw,{food:U,isTried:!1,isAllergic:K(U.name),onClick:()=>i(U),onSubstitutesClick:()=>o(U),baseColor:f},U.name))})]}),de.length>0&&h.jsxs(h.Fragment,{children:[h.jsx("h4",{className:"text-md font-medium text-gray-500 mt-6 mb-3",children:"Foods Tried This Stage:"}),h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 sm:gap-4",children:de.map(U=>h.jsx(dw,{food:U,isTried:!0,isAllergic:K(U.name),onClick:()=>i(U),onSubstitutesClick:()=>o(U),baseColor:f},U.name))})]})]});return h.jsx(s2,{title:`${le.title} (${de.length}/${ee.length} tried)`,icon:"star",defaultOpen:te===W,baseColor:f,children:me},te)})})]})};return h.jsx("div",{className:"space-y-6",children:h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Food Recommendations"}),A()]})})},hw=n=>n.toISOString().split("T")[0],S6=["serving","tbsp","cup","oz","slice","piece","bowl","pouch","handful"],C6=["The Bridge","The Stealth Mode","The Fun Factor","Repeated Exposure","Food Chaining"],fw=(n,e=[])=>{const t=Ns.flatMap(o=>o.items).find(o=>o.name===n);if(t)return t.emoji;const i=e.find(o=>o.name===n);return(i==null?void 0:i.emoji)||""},N6=({recipes:n,customFoods:e=[],savedStrategies:t=[],onSave:i,onCreateRecipe:o,onEditRecipe:c,onDeleteRecipe:f,onDeleteCustomFood:y,onAddCustomFood:w,onScanBarcode:x,baseColor:A,date:N,setDate:R,setMode:k,editingLog:H,onCancelEdit:W,onUpdateLog:K})=>{const[te,le]=oe.useState("lunch"),[ee,de]=oe.useState([]),[Ee,me]=oe.useState(""),[U,V]=oe.useState("all"),[F,Q]=oe.useState(null),[Y,$]=oe.useState(null),[z,_e]=oe.useState(""),[he,ne]=oe.useState(""),[ie,Me]=oe.useState(""),[ze,ct]=oe.useState(!1);oe.useEffect(()=>{var De,ot,ht;if(H){R(H.originalDate),le(H.originalMeal),_e(((De=H.items[0])==null?void 0:De.notes)||""),$(((ot=H.items[0])==null?void 0:ot.messyFaceImage)||null),ne(((ht=H.items[0])==null?void 0:ht.usedStrategy)||"");const Qe=H.items.map(nt=>({food:nt.id,status:"eaten",tags:[],behavioralTags:nt.behavioralTags||[],portion:nt.portion,consumption:nt.consumption}));de(Qe)}},[H,R]);const ae=oe.useMemo(()=>{let De=Ns.flatMap(Qe=>Qe.items.map(nt=>({...nt,category:Qe.category})));const ot=e.map(Qe=>({...Qe,category:Qe.category||"Snacks"}));De=[...De,...ot],Ee?De=De.filter(Qe=>Qe.name.toLowerCase().includes(Ee.toLowerCase())):U!=="all"&&U!=="saved_plates"&&(U==="Meat"?De=De.filter(Qe=>Qe.category==="Meat"||Qe.category==="Plant Protein"||Qe.category==="Protein"):De=De.filter(Qe=>Qe.category===U));const ht=new Set;return De.filter(Qe=>{const nt=ht.has(Qe.name);return ht.add(Qe.name),!nt})},[Ee,U,e]),Ie=De=>{ee.some(ot=>ot.food===De.name)||de(ot=>[...ot,{food:De.name,status:"eaten",tags:[],behavioralTags:[],portion:"1 serving",consumption:"all"}])},Ae=De=>{const ot=De.ingredients.split(`
`).map(Qe=>Qe.replace(/^[-\*]\s*/,"").trim()),ht=[];ot.forEach(Qe=>{const nt=ae.find(Ze=>Qe.toLowerCase().includes(Ze.name.toLowerCase())),xn=nt?nt.name:Qe;ee.some(Ze=>Ze.food===xn)||ht.push({food:xn,status:"eaten",tags:[],behavioralTags:[],portion:"1 serving",consumption:"all"})}),ht.length>0&&de(Qe=>[...Qe,...ht])},je=(De,ot)=>{de(ht=>ht.map((Qe,nt)=>nt===De?{...Qe,...ot}:Qe))},rt=(De,ot,ht)=>{const Qe=`${ot} ${ht}`.trim();je(De,{portion:Qe})},pe=De=>{if(!De)return{amount:"1",unit:"serving"};const ot=De.split(" ");return ot.length>=2?{amount:ot[0],unit:ot.slice(1).join(" ")}:{amount:ot[0],unit:"serving"}},Ve=(De,ot)=>{const Qe=ee[De].behavioralTags||[],nt=Qe.includes(ot)?Qe.filter(xn=>xn!==ot):[...Qe,ot];je(De,{behavioralTags:nt})},Ke=De=>{de(ot=>ot.filter((ht,Qe)=>Qe!==De)),F===De&&Q(null)},it=(De,ot)=>{window.confirm(`Delete "${ot}"?`)&&f&&f(De)},Mn=De=>{var ht;const ot=(ht=De.target.files)==null?void 0:ht[0];if(ot){const Qe=new FileReader;Qe.onloadend=()=>$(Qe.result),Qe.readAsDataURL(ot)}},kt=()=>{if(ee.length===0)return;if(ze&&ie&&o){const ot=ee.map(ht=>ht.food).join(`
`);o({title:ie,ingredients:ot,instructions:"Saved Plate",tags:["Toddler Plate",te],mealTypes:[te]})}const De=ee.map(ot=>{let ht="eaten";return ot.consumption==="none"&&(ht="refused"),ot.consumption==="some"&&(ht="touched"),{...ot,status:ht}});H&&K?(K(H.originalDate,H.originalMeal,De,N,te,Y||void 0,z,he),alert("Log Updated!")):(i(De,N,te,Y||void 0,z,he),alert("Meal Logged!")),de([]),$(null),_e(""),Me(""),ct(!1),k("history")},Dn=[...bh.touched,...bh.refused],St=[{id:"all",label:"All",icon:"grid-2x2"},{id:"saved_plates",label:"Saved Plates",icon:"book"},{id:"Fruits",label:"Fruits",icon:"apple"},{id:"Vegetables",label:"Veggies",icon:"carrot"},{id:"Meat",label:"Protein",icon:"drumstick"},{id:"Grains",label:"Carbs",icon:"croissant"},{id:"Dairy & Eggs",label:"Dairy",icon:"milk"},{id:"Snacks",label:"Snacks",icon:"cookie"}],Pn=[{label:"All",value:"all",icon:"check-circle",color:"text-green-600",bg:"bg-green-100"},{label:"Most",value:"most",icon:"pie-chart",color:"text-blue-600",bg:"bg-blue-100"},{label:"Some",value:"some",icon:"bar-chart-2",color:"text-yellow-600",bg:"bg-yellow-100"},{label:"None",value:"none",icon:"x-circle",color:"text-red-600",bg:"bg-red-100"}];return h.jsxs("div",{className:"flex flex-col h-[calc(100dvh-120px)] sm:h-[calc(100vh-140px)] bg-gray-50 rounded-xl overflow-hidden shadow-sm border border-gray-200",children:[h.jsxs("div",{className:`bg-white p-3 border-b flex justify-between items-center shrink-0 ${H?"bg-orange-50 border-orange-200":""}`,children:[h.jsxs("div",{className:"flex gap-2 items-center",children:[H&&h.jsx("span",{className:"text-xs font-bold text-orange-600 bg-orange-100 px-2 py-1 rounded hidden sm:inline",children:"EDITING"}),h.jsx("input",{type:"date",value:N,onChange:De=>R(De.target.value),className:"text-sm border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 py-1.5 w-32 sm:w-auto"}),h.jsx("select",{value:te,onChange:De=>le(De.target.value),className:"text-sm border-gray-300 rounded-lg capitalize focus:ring-indigo-500 focus:border-indigo-500 py-1.5",children:["breakfast","lunch","dinner","snack"].map(De=>h.jsx("option",{value:De,children:De},De))})]}),h.jsxs("div",{className:"flex gap-2",children:[H&&W&&h.jsx("button",{onClick:W,className:"text-sm text-gray-500 underline",children:"Cancel"}),x&&h.jsx("button",{onClick:x,className:"p-2 bg-indigo-100 text-indigo-600 rounded-full hover:bg-indigo-200",children:h.jsx(ue,{name:"scan-barcode",className:"w-5 h-5"})})]})]}),h.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[h.jsxs("div",{className:"w-full md:w-5/12 p-4 flex flex-col items-center border-b md:border-b-0 md:border-r bg-white overflow-y-auto flex-shrink-0 max-h-[50vh] md:max-h-full",children:[ee.length===0?h.jsx("div",{className:"relative w-48 h-48 sm:w-64 sm:h-64 rounded-full border-4 border-gray-100 shadow-inner bg-gray-50 flex flex-wrap content-center justify-center gap-2 p-6 mb-4 transition-all shrink-0",children:h.jsxs("div",{className:"text-center text-gray-300",children:[h.jsx(ue,{name:"utensils",className:"w-12 h-12 mx-auto mb-2 opacity-50"}),h.jsx("p",{className:"text-sm font-medium",children:"Tap foods to build plate"})]})}):h.jsxs("div",{className:"w-full mb-4",children:[h.jsx("div",{className:"flex gap-2 overflow-x-auto pb-4 pt-2 px-1 no-scrollbar snap-x",children:ee.map((De,ot)=>{var ht,Qe;return h.jsxs("button",{onClick:()=>Q(ot),className:`relative shrink-0 w-16 h-16 bg-white rounded-full shadow-md flex items-center justify-center border-2 transition-transform snap-center ${F===ot?"border-indigo-500 ring-2 ring-indigo-200 scale-110 z-10":"border-gray-100"}`,children:[h.jsx("span",{className:"text-2xl",children:fw(De.food,e)}),h.jsx("div",{className:`absolute -top-1 -right-1 w-5 h-5 rounded-full border border-white flex items-center justify-center shadow-sm ${De.consumption==="none"?"bg-red-500":"bg-green-500"}`,children:h.jsx("span",{className:"text-[9px] text-white font-bold",children:(Qe=(ht=De.consumption)==null?void 0:ht[0])==null?void 0:Qe.toUpperCase()})}),De.behavioralTags&&De.behavioralTags.length>0&&h.jsx("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-orange-500 rounded-full border border-white flex items-center justify-center shadow-sm",children:h.jsx("span",{className:"text-[10px] text-white font-bold",children:"!"})})]},`${De.food}-${ot}`)})}),h.jsx("p",{className:"text-xs text-center text-gray-400 mt-1",children:"Scroll to see all"})]}),F!==null&&ee[F]&&h.jsxs("div",{className:"w-full bg-indigo-50 rounded-xl p-4 mb-4 animate-fadeIn border border-indigo-100",children:[h.jsxs("div",{className:"flex justify-between items-center mb-3",children:[h.jsxs("span",{className:"font-bold text-indigo-900 flex items-center gap-2",children:[fw(ee[F].food,e)," ",ee[F].food]}),h.jsx("button",{onClick:()=>Ke(F),className:"text-red-500 p-1 hover:bg-red-50 rounded",children:h.jsx(ue,{name:"trash-2",className:"w-4 h-4"})})]}),h.jsxs("div",{className:"mb-3",children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-indigo-400 mb-1 block",children:"Portion Served"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{type:"number",className:"w-20 text-sm rounded border border-gray-300 focus:ring-indigo-500 py-1",placeholder:"1",value:pe(ee[F].portion).amount,onChange:De=>rt(F,De.target.value,pe(ee[F].portion).unit)}),h.jsx("select",{className:"flex-1 text-sm rounded border border-gray-300 focus:ring-indigo-500 py-1",value:pe(ee[F].portion).unit,onChange:De=>rt(F,pe(ee[F].portion).amount,De.target.value),children:S6.map(De=>h.jsx("option",{value:De,children:De},De))})]})]}),h.jsxs("div",{className:"mb-3",children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-indigo-400 mb-1 block",children:"Amount Eaten"}),h.jsx("div",{className:"grid grid-cols-4 gap-2",children:Pn.map(De=>{const ot=ee[F].consumption===De.value;return h.jsxs("button",{onClick:()=>je(F,{consumption:De.value}),className:`flex flex-col items-center justify-center p-2 rounded-lg border transition-all ${ot?`${De.bg} ${De.color} border-current ring-1`:"bg-white border-gray-200 text-gray-400 hover:bg-gray-50"}`,children:[h.jsx(ue,{name:De.icon,className:"w-4 h-4 mb-1"}),h.jsx("span",{className:"text-[9px] font-bold",children:De.label})]},De.value)})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-indigo-400 mb-1 block",children:"Behavior (Optional)"}),h.jsx("div",{className:"flex flex-wrap gap-1",children:Dn.map(De=>{var ht;const ot=(ht=ee[F].behavioralTags)==null?void 0:ht.includes(De);return h.jsx("button",{onClick:()=>Ve(F,De),className:`text-[10px] px-2 py-1 rounded-full border transition-colors ${ot?"bg-orange-100 text-orange-800 border-orange-200":"bg-white text-gray-500 border-gray-200"}`,children:De},De)})})]})]}),h.jsxs("div",{className:"w-full space-y-3 mt-auto",children:[h.jsx("button",{onClick:()=>{var De;return(De=document.getElementById("plate-photo-input"))==null?void 0:De.click()},className:"w-full py-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-400 text-xs font-bold hover:bg-gray-50 flex items-center justify-center gap-2",children:Y?h.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[h.jsx(ue,{name:"check",className:"w-3 h-3"})," Photo Added"]}):h.jsxs(h.Fragment,{children:[h.jsx(ue,{name:"camera",className:"w-3 h-3"})," Add Plate Photo"]})}),h.jsx("input",{id:"plate-photo-input",type:"file",accept:"image/*",onChange:Mn,className:"hidden"}),h.jsx("input",{value:z,onChange:De=>_e(De.target.value),placeholder:"Any notes?",className:"w-full text-xs border-gray-200 rounded-lg bg-gray-50 focus:bg-white transition-colors"}),h.jsxs("div",{className:"relative",children:[h.jsxs("select",{value:he,onChange:De=>ne(De.target.value),className:"w-full text-xs border-gray-200 rounded-lg bg-gray-50 focus:bg-white text-gray-600 appearance-none py-2 px-3",children:[h.jsx("option",{value:"",children:"Did you use a strategy?"}),h.jsx("optgroup",{label:"My Saved Strategies",children:t.map(De=>h.jsxs("option",{value:De.title,children:[De.title," (",De.type,")"]},De.id))}),h.jsx("optgroup",{label:"Strategy Types",children:C6.map(De=>h.jsx("option",{value:De,children:De},De))})]}),h.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:h.jsx(ue,{name:"chevron-down",className:"w-3 h-3 text-gray-400"})})]}),!H&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("input",{type:"checkbox",id:"savePreset",checked:ze,onChange:De=>ct(De.target.checked),className:"rounded text-indigo-600"}),h.jsx("label",{htmlFor:"savePreset",className:"text-xs text-gray-600",children:"Save as Preset?"})]}),ze&&h.jsx("input",{value:ie,onChange:De=>Me(De.target.value),placeholder:"e.g. Monday Pasta",className:"w-full text-xs border-indigo-200 rounded-lg focus:ring-indigo-500"}),h.jsxs("button",{onClick:kt,disabled:ee.length===0,className:`w-full py-3 rounded-xl font-bold text-white shadow-md transition-all flex items-center justify-center gap-2 ${ee.length>0?`bg-${A}-600 hover:bg-${A}-700`:"bg-gray-300"}`,children:[h.jsx(ue,{name:H?"refresh-cw":"check",className:"w-5 h-5"})," ",H?"Update Log":"Log Meal"]})]})]}),h.jsxs("div",{className:"w-full md:w-7/12 flex flex-col bg-gray-50/50 flex-1 overflow-hidden",children:[h.jsxs("div",{className:"p-3 bg-white border-b space-y-3",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("div",{className:"relative flex-1",children:[h.jsx(ue,{name:"search",className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),h.jsx("input",{type:"text",placeholder:"Search food...",value:Ee,onChange:De=>me(De.target.value),className:"w-full pl-9 py-2 text-sm border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500"})]}),w&&h.jsx("button",{onClick:()=>w(Ee),className:"p-2 bg-indigo-100 text-indigo-600 rounded-lg hover:bg-indigo-200",children:h.jsx(ue,{name:"plus",className:"w-5 h-5"})})]}),h.jsx("div",{className:"flex gap-2 overflow-x-auto no-scrollbar pb-1",children:St.map(De=>h.jsxs("button",{onClick:()=>V(De.id),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-colors border ${U===De.id?`bg-${A}-600 text-white border-${A}-600`:"bg-white text-gray-600 border-gray-200 hover:bg-gray-50"}`,children:[h.jsx(ue,{name:De.icon,className:"w-3 h-3"}),De.label]},De.id))})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-3",children:[(U==="saved_plates"||U==="all"&&!Ee)&&n.length>0&&h.jsxs("div",{className:"mb-6",children:[h.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 px-1",children:"Saved Plates"}),h.jsx("div",{className:"grid grid-cols-2 gap-2",children:n.map(De=>h.jsxs("div",{className:"relative group",children:[h.jsxs("button",{onClick:()=>Ae(De),className:"w-full text-left p-3 bg-white border border-indigo-100 rounded-xl shadow-sm hover:border-indigo-300 transition-colors",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsx("h5",{className:"font-bold text-gray-800 text-sm group-hover:text-indigo-700",children:De.title}),h.jsx(ue,{name:"plus-circle",className:"w-4 h-4 text-indigo-400 group-hover:text-indigo-600"})]}),h.jsx("p",{className:"text-[10px] text-gray-500 mt-1 line-clamp-1",children:De.ingredients.replace(/\n/g,", ")})]}),h.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 z-10",children:[c&&h.jsx("button",{onClick:ot=>{ot.stopPropagation(),c(De)},className:"p-1 bg-white border border-gray-200 rounded hover:bg-indigo-50 text-gray-400 hover:text-indigo-600 shadow-sm",children:h.jsx(ue,{name:"edit-2",className:"w-3 h-3"})}),f&&h.jsx("button",{onClick:ot=>{ot.stopPropagation(),it(De.id,De.title)},className:"p-1 bg-white border border-gray-200 rounded hover:bg-red-50 text-gray-400 hover:text-red-500 shadow-sm",children:h.jsx(ue,{name:"trash-2",className:"w-3 h-3"})})]})]},De.id))})]}),U!=="saved_plates"&&h.jsxs(h.Fragment,{children:[h.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 px-1",children:"Foods"}),h.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-2",children:ae.map(De=>{const ot=e.some(ht=>ht.name===De.name);return h.jsxs("div",{className:"relative group",children:[h.jsxs("button",{onClick:()=>Ie(De),className:"w-full flex flex-col items-center justify-center p-3 bg-white border border-gray-200 rounded-xl hover:border-indigo-400 hover:shadow-sm transition-all active:scale-95",children:[h.jsx("span",{className:"text-2xl mb-1",children:De.emoji}),h.jsx("span",{className:"text-[10px] font-bold text-gray-700 text-center leading-tight line-clamp-2",children:De.name})]}),ot&&y&&h.jsx("button",{onClick:ht=>{ht.stopPropagation(),y(De.name)},className:"absolute -top-1 -right-1 bg-white border border-gray-200 rounded-full p-1 text-gray-400 hover:text-red-500 hover:border-red-200 shadow-sm z-10",title:"Delete Custom Food",children:h.jsx(ue,{name:"trash-2",className:"w-3 h-3"})})]},De.name)})}),ae.length===0&&h.jsxs("div",{className:"text-center py-8",children:[h.jsx("p",{className:"text-sm text-gray-400",children:"No foods found."}),Ee&&w&&h.jsxs("button",{onClick:()=>w(Ee),className:"mt-2 text-indigo-600 font-bold text-sm",children:['Create "',Ee,'"']})]})]})]})]})]})]})},I6=({mealPlan:n,onAdd:e,onRemove:t,baseColor:i})=>{const o=Array.from({length:7},(f,y)=>{const w=new Date;return w.setDate(w.getDate()+y),w}),c=["breakfast","lunch","dinner","snack"];return h.jsxs("div",{className:"h-full overflow-y-auto pb-24 space-y-4 px-2 sm:px-4",children:[h.jsxs("div",{className:"bg-gradient-to-r from-teal-50 to-white p-4 rounded-xl border border-teal-100 flex justify-between items-center mb-4",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-teal-900",children:"Weekly Meal Plan"}),h.jsx("p",{className:"text-xs text-teal-700",children:"Tap a slot to add a recipe."})]}),h.jsx(ue,{name:"calendar",className:"w-8 h-8 text-teal-200"})]}),o.map(f=>{const y=hw(f),w=n[y]||{},x=y===hw(new Date);return h.jsxs("div",{className:`bg-white rounded-xl border shadow-sm overflow-hidden ${x?"border-teal-300 ring-1 ring-teal-100":"border-gray-200"}`,children:[h.jsx("div",{className:`px-4 py-2 border-b flex justify-between items-center ${x?"bg-teal-50":"bg-gray-50"}`,children:h.jsxs("h4",{className:`font-bold text-sm ${x?"text-teal-800":"text-gray-700"}`,children:[f.toLocaleDateString(void 0,{weekday:"long",month:"short",day:"numeric"}),x&&h.jsx("span",{className:"ml-2 text-[10px] bg-teal-200 text-teal-800 px-2 py-0.5 rounded-full uppercase font-bold",children:"Today"})]})}),h.jsx("div",{className:"grid grid-cols-2 gap-px bg-gray-100",children:c.map(A=>{const N=w[A];return h.jsxs("div",{className:"bg-white p-3 flex flex-col justify-center min-h-[80px] relative group",children:[h.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1",children:A}),N?h.jsxs("div",{className:"flex-1 flex items-center justify-between",children:[h.jsx("span",{className:"text-xs font-semibold text-gray-800 line-clamp-2",children:N.title}),t&&h.jsx("button",{onClick:()=>t(y,A),className:"text-gray-300 hover:text-red-500 p-1",children:h.jsx(ue,{name:"trash-2",className:"w-3 h-3"})})]}):h.jsxs("button",{onClick:()=>e(y,A),className:"flex-1 flex items-center gap-1 text-gray-300 hover:text-teal-600 transition-colors",children:[h.jsx(ue,{name:"plus-circle",className:"w-4 h-4"}),h.jsx("span",{className:"text-xs font-medium",children:"Add"})]})]},A)})})]},y)})]})},R6=({triedFoods:n,baseColor:e,onAddToPlan:t,onEditLog:i})=>{const o=oe.useMemo(()=>{const c={};return n.forEach(f=>{const y=`${f.date}-${f.meal}`;c[y]||(c[y]=[]),c[y].push(f)}),Object.entries(c).sort((f,y)=>y[0].localeCompare(f[0]))},[n]);return h.jsx("div",{className:"space-y-4",children:o.map(([c,f])=>{var A;const y=f[0].date,w=f[0].meal,x=(A=f.find(N=>N.messyFaceImage))==null?void 0:A.messyFaceImage;return h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4",children:[h.jsxs("div",{className:"flex justify-between items-start mb-3",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[x?h.jsx("div",{className:"w-12 h-12 rounded-lg bg-gray-100 overflow-hidden",children:h.jsx("img",{src:x,className:"w-full h-full object-cover"})}):h.jsx("div",{className:`w-12 h-12 rounded-lg bg-${e}-100 flex items-center justify-center text-${e}-600`,children:h.jsx("span",{className:"text-xl capitalize",children:w[0]})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-bold text-gray-800 capitalize",children:w}),h.jsx("p",{className:"text-xs text-gray-500",children:new Date(y).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})})]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>i(f),className:"text-gray-400 hover:text-indigo-600 p-1.5 hover:bg-indigo-50 rounded transition-colors",title:"Edit Log",children:h.jsx(ue,{name:"edit-3",className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>t(f),className:`text-xs bg-${e}-50 text-${e}-700 px-3 py-1.5 rounded-full font-bold hover:bg-${e}-100`,children:"Plan This"})]})]}),h.jsx("div",{className:"space-y-2",children:f.map((N,R)=>h.jsxs("div",{className:"flex justify-between items-center text-sm border-b border-gray-50 last:border-0 pb-1 last:pb-0",children:[h.jsx("span",{className:"text-gray-700",children:N.id}),h.jsxs("div",{className:"flex items-center gap-2",children:[N.portion&&h.jsx("span",{className:"text-[10px] text-gray-400 bg-gray-50 px-1.5 rounded",children:N.portion}),N.consumption&&h.jsx("span",{className:`text-[10px] font-bold uppercase ${N.consumption==="none"?"text-red-500":N.consumption==="all"?"text-green-500":"text-blue-500"}`,children:N.consumption})]})]},R))})]},c)})})},M6=n=>{const e=n.appMode==="TODDLER",[t,i]=oe.useState(()=>e?"log":"recipes");oe.useEffect(()=>{!e&&(t==="log"||t==="history")&&i("recipes")},[e,t]);const[o,c]=oe.useState(new Date().toISOString().split("T")[0]),[f,y]=oe.useState(null),[w,x]=oe.useState(null),A=n.baseColor||"teal",N=W=>{if(!W||W.length===0)return;const K=W[0];y({originalDate:K.date,originalMeal:K.meal,items:W}),c(K.date),i("log")},R=()=>{y(null),i("history")},k=W=>{x(W)},H=()=>{if(!w||!w.length)return;const W=w[0].meal,K=`${W} copy from ${w[0].date}`,te=w.map(le=>le.id).join(`
`);n.onCreateRecipe&&(n.onCreateRecipe({title:K,ingredients:te,instructions:"Planned from history",tags:["Planned"],mealTypes:[W]}),alert(`Created recipe "${K}". Go to Meal Plan tab to assign it!`)),x(null)};return h.jsxs("div",{className:"h-full flex flex-col",children:[h.jsxs("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-xl mb-4 shrink-0 mx-2 mt-2 sm:mx-0 sm:mt-0 overflow-x-auto no-scrollbar",children:[e&&h.jsxs("button",{onClick:()=>{i("log"),y(null)},className:`flex-1 py-2.5 text-xs sm:text-sm font-bold rounded-lg transition-all flex items-center justify-center gap-1.5 whitespace-nowrap px-2 ${t==="log"?"bg-white text-gray-900 shadow-sm ring-1 ring-black/5":"text-gray-500 hover:text-gray-700"}`,children:[h.jsx(ue,{name:"utensils",className:"w-4 h-4"})," ",h.jsx("span",{className:"hidden sm:inline",children:"Plate"})," Builder"]}),h.jsxs("button",{onClick:()=>i("plan"),className:`flex-1 py-2.5 text-xs sm:text-sm font-bold rounded-lg transition-all flex items-center justify-center gap-1.5 whitespace-nowrap px-2 ${t==="plan"?"bg-white text-gray-900 shadow-sm ring-1 ring-black/5":"text-gray-500 hover:text-gray-700"}`,children:[h.jsx(ue,{name:"calendar",className:"w-4 h-4"})," Plan"]}),e&&h.jsxs("button",{onClick:()=>i("history"),className:`flex-1 py-2.5 text-xs sm:text-sm font-bold rounded-lg transition-all flex items-center justify-center gap-1.5 whitespace-nowrap px-2 ${t==="history"?"bg-white text-gray-900 shadow-sm ring-1 ring-black/5":"text-gray-500 hover:text-gray-700"}`,children:[h.jsx(ue,{name:"clock",className:"w-4 h-4"})," History"]}),h.jsxs("button",{onClick:()=>i("recipes"),className:`flex-1 py-2.5 text-xs sm:text-sm font-bold rounded-lg transition-all flex items-center justify-center gap-1.5 whitespace-nowrap px-2 ${t==="recipes"?"bg-white text-gray-900 shadow-sm ring-1 ring-black/5":"text-gray-500 hover:text-gray-700"}`,children:[h.jsx(ue,{name:"book",className:"w-4 h-4"})," Recipes"]})]}),h.jsxs("div",{className:"flex-1 overflow-hidden relative px-2 sm:px-0",children:[t==="log"&&e&&h.jsx(N6,{recipes:n.recipes,customFoods:n.customFoods,savedStrategies:n.savedStrategies,onSave:n.onBatchLog||(()=>{}),onCreateRecipe:n.onCreateRecipe,onEditRecipe:W=>{n.onEditRecipe&&n.onEditRecipe(W)},onDeleteRecipe:n.onDeleteRecipe,onDeleteCustomFood:n.onDeleteCustomFood,onAddCustomFood:n.onAddCustomFood,onScanBarcode:n.onScanBarcode,baseColor:A,date:o,setDate:c,setMode:i,editingLog:f,onCancelEdit:R,onUpdateLog:n.onUpdateBatchLog}),t==="plan"&&h.jsx(I6,{mealPlan:n.mealPlan,onAdd:n.onAddToPlan,onRemove:n.onRemoveFromPlan,baseColor:A}),t==="history"&&e&&h.jsx("div",{className:"h-full overflow-y-auto pb-24",children:h.jsx(R6,{triedFoods:n.triedFoods||[],baseColor:A,onAddToPlan:k,onEditLog:N})}),t==="recipes"&&h.jsxs("div",{className:"h-full overflow-y-auto pb-24 space-y-4",children:[h.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-white p-4 rounded-xl border border-indigo-100 flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-indigo-900",children:"Your Recipe Box"}),h.jsxs("p",{className:"text-xs text-indigo-700",children:[n.recipes.length," recipes saved"]})]}),h.jsx("button",{onClick:n.onShowAddRecipe,className:"px-3 py-1.5 bg-indigo-600 text-white text-xs font-bold rounded-lg shadow-sm hover:bg-indigo-700",children:"+ New"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.jsxs("button",{onClick:n.onShowSuggestRecipe,className:"p-3 bg-purple-50 text-purple-700 rounded-xl border border-purple-100 font-bold text-xs flex flex-col items-center gap-2 hover:bg-purple-100 transition-colors",children:[h.jsx(ue,{name:"sparkles",className:"w-6 h-6"})," AI Chef"]}),h.jsxs("button",{onClick:n.onShowImportRecipe,className:"p-3 bg-blue-50 text-blue-700 rounded-xl border border-blue-100 font-bold text-xs flex flex-col items-center gap-2 hover:bg-blue-100 transition-colors",children:[h.jsx(ue,{name:"camera",className:"w-6 h-6"})," Scan Recipe"]})]}),n.recipes.length===0?h.jsxs("div",{className:"text-center py-10",children:[h.jsx(ue,{name:"book-dashed",className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),h.jsx("p",{className:"text-sm text-gray-400",children:"No recipes yet."})]}):h.jsx("div",{className:"space-y-3",children:n.recipes.map(W=>h.jsxs("div",{onClick:()=>n.onViewRecipe(W),className:"bg-white p-3 rounded-xl border border-gray-200 shadow-sm flex justify-between items-center cursor-pointer hover:border-indigo-300 transition-all",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center text-xl",children:""}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-bold text-sm text-gray-800",children:W.title}),h.jsxs("p",{className:"text-[10px] text-gray-500",children:[W.ingredients.split(`
`).length," ingredients"]})]})]}),h.jsx(ue,{name:"chevron-right",className:"w-4 h-4 text-gray-300"})]},W.id))}),h.jsxs("button",{onClick:n.onShowShoppingList,className:"w-full py-3 bg-white border border-gray-200 text-gray-700 font-bold text-sm rounded-xl shadow-sm hover:bg-gray-50 flex items-center justify-center gap-2",children:[h.jsx(ue,{name:"shopping-cart",className:"w-4 h-4"})," View Shopping List"]})]})]}),w&&h.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-sm w-full",children:[h.jsx("h3",{className:"text-lg font-bold mb-2",children:"Plan for Later?"}),h.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Convert this meal log into a saved recipe so you can add it to your Meal Plan."}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:()=>x(null),className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),h.jsx("button",{onClick:H,className:`flex-1 py-2 bg-${A}-600 text-white rounded-lg font-bold`,children:"Save as Recipe"})]})]})})]})},D6=(n,e="teal")=>{if(!n)return"";let t=n.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>");return t=t.replace(/\[(\d+)\]/g,`<sup><a href="#source-$1" class="text-${e}-600 no-underline hover:underline font-bold">[$1]</a></sup>`),t.split(`
`).map(i=>i.trim()).filter(i=>i.length>0).map(i=>`<p>${i}</p>`).join("")},O6=({sources:n,baseColor:e})=>{const[t,i]=oe.useState(!1),o=Array.isArray(n)?n.filter(c=>c&&c.web&&c.web.uri):[];return o.length===0?null:h.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-200/50",children:[h.jsxs("button",{onClick:()=>i(!t),className:`flex items-center gap-1.5 text-xs font-semibold text-gray-500 hover:text-${e}-600 transition-colors mb-1 focus:outline-none`,children:[h.jsx(ue,{name:t?"chevron-down":"chevron-right",className:"w-3.5 h-3.5"}),h.jsx("span",{children:t?"Hide Sources":`Show Research Sources (${o.length})`})]}),t&&h.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:o.map((c,f)=>h.jsxs("a",{id:`source-${f+1}`,href:c.web.uri,target:"_blank",rel:"noopener noreferrer",className:`inline-flex items-center gap-2 bg-white/80 border border-gray-200 hover:border-${e}-400 hover:bg-white rounded-md px-2.5 py-1.5 transition-all text-left no-underline group max-w-full`,children:[h.jsx("span",{className:`flex-shrink-0 flex items-center justify-center w-4 h-4 rounded-full bg-${e}-100 text-[9px] font-bold text-${e}-700`,children:f+1}),h.jsx("span",{className:`text-[11px] text-gray-600 truncate max-w-[180px] group-hover:text-${e}-800 font-medium`,children:c.web.title||"Source"})]},`${c.web.uri}-${f}`))})]})},k6=({mode:n,baseColor:e="teal",onStartLiveSage:t})=>{const[i,o]=oe.useState(""),[c,f]=oe.useState(!1),[y,w]=oe.useState([]),x=oe.useRef(null),A=QA[n]||{guides:[]};oe.useEffect(()=>{const R=x.current;if(!R)return;if(c||y.length===0){R.scrollTo({top:R.scrollHeight,behavior:"smooth"});return}const k=y[y.length-1];k.role==="user"?R.scrollTo({top:R.scrollHeight,behavior:"smooth"}):k.role==="model"&&setTimeout(()=>{const H=document.getElementById(`msg-${k.id}`);H&&R.scrollTo({top:H.offsetTop-24,behavior:"smooth"})},100)},[y,c]);const N=async R=>{const k=R||i;if(!k.trim())return;const H={id:Date.now().toString(),role:"user",text:k};w(W=>[...W,H]),o(""),f(!0);try{const W=y.map(le=>({role:le.role,text:le.text})),K=await f6(W,k),te={id:(Date.now()+1).toString(),role:"model",text:K.answer,sources:K.sources,suggestedQuestions:K.suggestedQuestions};w(le=>[...le,te])}catch(W){const K={id:(Date.now()+1).toString(),role:"model",text:"I encountered an error. Please try again."};w(te=>[...te,K]),console.error(W)}finally{f(!1)}};return h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{className:"bg-gradient-to-br from-violet-600 to-fuchsia-600 rounded-2xl p-6 shadow-xl text-white relative overflow-hidden group",children:[h.jsx("div",{className:"absolute top-0 right-0 -mr-8 -mt-8 opacity-20 group-hover:scale-110 transition-transform duration-700",children:h.jsx(ue,{name:"mic",className:"w-48 h-48"})}),h.jsxs("div",{className:"relative z-10 flex flex-col sm:flex-row items-center gap-6",children:[h.jsx("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-md flex items-center justify-center animate-pulse",children:h.jsx(ue,{name:"mic",className:"w-8 h-8 text-white"})}),h.jsxs("div",{className:"text-center sm:text-left flex-1",children:[h.jsx("h3",{className:"text-2xl font-black mb-2 leading-tight",children:"Try Sage Live"}),h.jsx("p",{className:"text-violet-100 text-sm font-medium mb-4",children:"Hands messy? Talk to Sage in real-time about feeding safety, portions, and quick recipes."}),h.jsx("button",{onClick:t,className:"bg-white text-violet-600 px-6 py-2.5 rounded-full font-bold text-sm shadow-lg hover:bg-violet-50 transition-colors active:scale-95",children:"Start Voice Assistant"})]})]})]}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Research Lab"}),h.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden flex flex-col h-[500px]",children:[h.jsxs("div",{className:"p-4 bg-gray-50 border-b flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-violet-100 rounded-full",children:h.jsx(ue,{name:"brain-circuit",className:"w-5 h-5 text-violet-600"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Ask Sage"}),h.jsx("p",{className:"text-xs text-gray-500",children:"Research-backed answers for every stage."})]})]}),h.jsxs("div",{ref:x,className:"flex-1 overflow-y-auto p-4 space-y-4 bg-white scroll-smooth relative",children:[y.length===0&&h.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-gray-400 p-8",children:[h.jsx(ue,{name:"message-square",className:"w-12 h-12 mb-3 opacity-20"}),h.jsx("p",{className:"text-sm font-medium text-gray-500",children:"I'm Sage, your research assistant."}),h.jsx("p",{className:"text-xs mt-2 max-w-xs mx-auto",children:'Try asking: "What foods are high in iron?" or "How do I serve steak safely?"'})]}),y.map(R=>h.jsx("div",{id:`msg-${R.id}`,className:`flex ${R.role==="user"?"justify-end":"justify-start"}`,children:h.jsx("div",{className:`max-w-[85%] sm:max-w-[75%] rounded-2xl px-4 py-3 text-sm ${R.role==="user"?`bg-${e}-600 text-white rounded-tr-none`:"bg-gray-100 text-gray-800 rounded-tl-none"}`,children:R.role==="user"?h.jsx("p",{children:R.text}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"prose-static prose-sm max-w-none prose-p:my-1",dangerouslySetInnerHTML:{__html:D6(R.text,e)}}),R.sources&&R.sources.length>0&&h.jsx(O6,{sources:R.sources,baseColor:e}),R.suggestedQuestions&&R.suggestedQuestions.length>0&&h.jsxs("div",{className:"mt-4 pt-2 border-t border-gray-200/50",children:[h.jsx("p",{className:"text-[10px] uppercase font-bold text-gray-400 mb-2 tracking-wider",children:"Suggested Questions"}),h.jsx("div",{className:"flex flex-col gap-2",children:R.suggestedQuestions.map((k,H)=>h.jsx("button",{onClick:()=>N(k),className:"text-left text-xs bg-white border border-violet-200 hover:bg-violet-50 hover:border-violet-300 text-violet-700 px-3 py-2 rounded-lg transition-colors shadow-sm",children:k},H))})]})]})})},R.id)),c&&h.jsx("div",{className:"flex justify-start",children:h.jsxs("div",{className:"bg-gray-100 rounded-2xl rounded-tl-none px-4 py-3 flex items-center gap-1",children:[h.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0s"}}),h.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),h.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})})]}),h.jsx("div",{className:"p-4 bg-white border-t border-gray-100",children:h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{type:"text",value:i,onChange:R=>o(R.target.value),onKeyPress:R=>R.key==="Enter"&&N(),placeholder:"Type your question...",className:"flex-grow block w-full rounded-full border-gray-300 shadow-sm focus:border-violet-500 focus:ring-violet-500 text-sm px-4 py-3",disabled:c}),h.jsx("button",{onClick:()=>N(),disabled:c||!i.trim(),className:"inline-flex justify-center items-center p-3 border border-transparent rounded-full shadow-sm text-white bg-violet-600 hover:bg-violet-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h.jsx(ue,{name:"send",className:"w-5 h-5"})})]})})]})]}),h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[h.jsx(ue,{name:"book-open",className:`w-5 h-5 text-${e}-600`})," Resource Library"]}),h.jsx("div",{className:"space-y-3",children:A.guides.map((R,k)=>h.jsx(s2,{title:R.title,icon:R.icon,defaultOpen:!1,baseColor:e,children:h.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:R.content}})},`guide-${k}`))})]})]})},P6=({onClose:n})=>h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[501]",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg mx-auto",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4",children:[h.jsx("h2",{className:"text-xl font-semibold",children:"Syncing Data Across Devices"}),h.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:h.jsx(ue,{name:"x"})})]}),h.jsxs("div",{className:"p-6 modal-scroll-content prose-static",children:[h.jsx("p",{children:"You can keep your Tiny Tastes data in sync between your phone, tablet, and computer by using a cloud storage service like iCloud Drive or Google Drive."}),h.jsx("h4",{className:"font-semibold mt-4",children:"How it works:"}),h.jsxs("ol",{className:"list-decimal list-outside pl-5 space-y-2",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"First-Time Save:"}),h.jsx("br",{}),"On your primary device, tap ",h.jsx("strong",{children:'"Download Backup"'}),". When your device asks where to save the ",h.jsx("code",{children:"tiny-tastes-backup.json"})," file, choose a location inside your ",h.jsx("strong",{children:"iCloud Drive"})," or ",h.jsx("strong",{children:"Google Drive"}),"."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Loading on Another Device:"}),h.jsx("br",{}),"On your second device, open the app and tap ",h.jsx("strong",{children:'"Load from Backup File"'})," on this page. Navigate to your cloud drive and select the ",h.jsx("code",{children:".json"})," file you saved. Your data will now be loaded."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Updating Your Backup:"}),h.jsx("br",{}),"After logging new foods or recipes, save your progress by tapping ",h.jsx("strong",{children:'"Update Backup File"'}),". Select the ",h.jsx("em",{children:"same"})," ",h.jsx("code",{children:".json"})," file in your cloud drive to overwrite it with your latest data."]})]}),h.jsx("p",{className:"text-xs text-gray-500 mt-4",children:'Note: The "Update Backup File" feature requires a modern browser like Chrome or Edge.'})]})]})}),L6=({userProfile:n,onSaveProfile:e,onResetData:t,baseColor:i})=>{var Q;const[o,c]=oe.useState((n==null?void 0:n.babyName)||""),[f,y]=oe.useState((n==null?void 0:n.birthDate)||""),[w,x]=oe.useState(n==null?void 0:n.gender),[A,N]=oe.useState(Array.isArray(n==null?void 0:n.knownAllergies)?n.knownAllergies:[]),[R,k]=oe.useState((n==null?void 0:n.currentTextureStage)||"puree"),[H,W]=oe.useState((n==null?void 0:n.preferredMode)||"AUTO"),[K,te]=oe.useState(!1),le="showSaveFilePicker"in window;oe.useEffect(()=>{c((n==null?void 0:n.babyName)||""),y((n==null?void 0:n.birthDate)||""),x(n==null?void 0:n.gender),N(Array.isArray(n==null?void 0:n.knownAllergies)?n.knownAllergies:[]),k((n==null?void 0:n.currentTextureStage)||"puree"),W((n==null?void 0:n.preferredMode)||"AUTO")},[n]);const ee=()=>{e({...n,babyName:o,birthDate:f,gender:w,knownAllergies:A,currentTextureStage:R,preferredMode:H==="AUTO"?void 0:H}),alert("Profile saved!")},de=Y=>{N($=>$.includes(Y)?$.filter(z=>z!==Y):[...$,Y])},Ee=()=>({profile:JSON.parse(localStorage.getItem("tiny-tastes-tracker-profile")||"null"),triedFoods:JSON.parse(localStorage.getItem("tiny-tastes-tracker-triedFoods")||"[]"),recipes:JSON.parse(localStorage.getItem("tiny-tastes-tracker-recipes")||"[]"),mealPlan:JSON.parse(localStorage.getItem("tiny-tastes-tracker-mealPlan")||"{}"),milestones:JSON.parse(localStorage.getItem("tiny-tastes-tracker-milestones")||"[]")}),me=()=>{try{const Y=Ee(),$=JSON.stringify(Y,null,2),z=new Blob([$],{type:"application/json"}),_e=URL.createObjectURL(z),he=document.createElement("a");he.href=_e,he.download="tiny-tastes-backup.json",document.body.appendChild(he),he.click(),document.body.removeChild(he),URL.revokeObjectURL(_e)}catch(Y){console.error("Failed to export data:",Y),alert("Sorry, there was an error exporting your data.")}},U=async()=>{try{const Y=Ee(),$=JSON.stringify(Y,null,2),z=new Blob([$],{type:"application/json"}),he=await(await window.showSaveFilePicker({suggestedName:"tiny-tastes-backup.json",types:[{description:"JSON Files",accept:{"application/json":[".json"]}}]})).createWritable();await he.write(z),await he.close(),alert("Backup file updated successfully!")}catch(Y){Y instanceof DOMException&&Y.name==="AbortError"?console.log("User cancelled the save dialog."):(console.error("Failed to save data:",Y),alert("Sorry, there was an error saving your data."))}},V=Y=>{var _e;const $=(_e=Y.target.files)==null?void 0:_e[0];if(!$)return;const z=new FileReader;z.onload=he=>{var ne;try{const ie=(ne=he.target)==null?void 0:ne.result;if(typeof ie!="string")throw new Error("File is not readable");const Me=JSON.parse(ie);if(!("profile"in Me&&"triedFoods"in Me))throw new Error("Invalid data file format. The file must be a valid export from Tiny Tastes Tracker.");window.confirm("This will overwrite all existing data on this device. This action cannot be undone. Are you sure you want to continue?")&&(localStorage.setItem("tiny-tastes-tracker-profile",JSON.stringify(Me.profile||null)),localStorage.setItem("tiny-tastes-tracker-triedFoods",JSON.stringify(Me.triedFoods||[])),localStorage.setItem("tiny-tastes-tracker-recipes",JSON.stringify(Me.recipes||[])),localStorage.setItem("tiny-tastes-tracker-mealPlan",JSON.stringify(Me.mealPlan||{})),localStorage.setItem("tiny-tastes-tracker-milestones",JSON.stringify(Me.milestones||[])),alert("Data imported successfully! The app will now reload to apply the changes."),window.location.reload())}catch(ie){const Me=ie instanceof Error?ie.message:"Unknown error";alert(`Error importing data: ${Me}`)}},z.readAsText($),Y.target.value=""},F=()=>{var Y;(Y=document.getElementById("import-file-input"))==null||Y.click()};return h.jsxs("div",{className:"space-y-6",children:[K&&h.jsx(P6,{onClose:()=>te(!1)}),h.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"My Baby's Profile"}),h.jsx("p",{className:"text-sm text-gray-600 mt-1 mb-4",children:"Personalize the app with your baby's name, birth date, and any known allergies."}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"baby-name-input",className:"block text-sm font-medium text-gray-700",children:"Baby's Name:"}),h.jsx("input",{type:"text",id:"baby-name-input",value:o,onChange:Y=>c(Y.target.value),placeholder:"e.g., Alex",className:`mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-${i}-500 focus:ring-${i}-500 sm:text-sm`})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"birth-date-input",className:"block text-sm font-medium text-gray-700",children:"Baby's Birth Date:"}),h.jsx("input",{type:"date",id:"birth-date-input",value:f,onChange:Y=>y(Y.target.value),className:`mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-${i}-500 focus:ring-${i}-500 sm:text-sm`})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender (For Growth Charts):"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>x("boy"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium border transition-colors ${w==="boy"?`bg-${i}-100 border-${i}-500 text-${i}-700`:"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:"Boy"}),h.jsx("button",{onClick:()=>x("girl"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium border transition-colors ${w==="girl"?`bg-${i}-100 border-${i}-500 text-${i}-700`:"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:"Girl"})]})]})]}),h.jsxs("div",{className:"mt-4",children:[h.jsx("label",{htmlFor:"app-mode-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"App Experience Mode"}),h.jsxs("select",{id:"app-mode-select",value:H,onChange:Y=>W(Y.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-${i}-500 focus:ring-${i}-500 sm:text-sm`,children:[h.jsx("option",{value:"AUTO",children:"Auto (Based on Age)"}),h.jsx("option",{value:"NEWBORN",children:"Newborn Mode (0-6m)"}),h.jsx("option",{value:"EXPLORER",children:"Explorer Mode (Solids Tracking)"}),h.jsx("option",{value:"TODDLER",children:"Toddler Mode (Recipes & Balance)"})]}),h.jsx("p",{className:"text-xs text-gray-500 mt-1",children:H==="AUTO"?"Automatically adjusts based on birth date or doctor approval.":"Manually overrides the default experience."})]}),h.jsxs("div",{className:"mt-8 border-t pt-6",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Current Texture Stage"}),h.jsxs("div",{className:"relative flex justify-between",children:[h.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-1 bg-gray-200 -z-10 -translate-y-1/2 rounded"}),dm.map((Y,$)=>{const z=R===Y.id,_e=dm.findIndex(ne=>ne.id===R),he=$<=_e;return h.jsxs("button",{onClick:()=>k(Y.id),className:"group flex flex-col items-center focus:outline-none",children:[h.jsx("div",{className:`
                                        w-10 h-10 rounded-full flex items-center justify-center border-2 transition-all duration-300
                                        ${he?`bg-${i}-600 border-${i}-600 text-white`:"bg-white border-gray-300 text-gray-400"}
                                        ${z?`ring-4 ring-${i}-100 scale-110`:""}
                                    `,children:h.jsx(ue,{name:Y.icon,className:"w-5 h-5"})}),h.jsx("span",{className:`mt-2 text-xs font-semibold ${z?`text-${i}-700`:"text-gray-500"}`,children:Y.title})]},Y.id)})]}),h.jsx("div",{className:"mt-3 text-center bg-gray-50 p-2 rounded text-xs text-gray-600 italic",children:(Q=dm.find(Y=>Y.id===R))==null?void 0:Q.desc})]}),h.jsxs("div",{className:"mt-8",children:[h.jsxs("div",{className:"flex items-center mb-2",children:[h.jsx(ue,{name:"alert-triangle",className:"w-4 h-4 text-orange-500 mr-2"}),h.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Known Allergies"})]}),h.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Select any allergens your baby has been diagnosed with. These will be flagged across the app."}),h.jsx("div",{className:"flex flex-wrap gap-2",children:KA.map(Y=>{const $=A.includes(Y);return h.jsxs("button",{onClick:()=>de(Y),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors border ${$?"bg-red-50 border-red-200 text-red-700 shadow-sm":"bg-gray-100 border-gray-200 text-gray-600 hover:bg-gray-200"}`,children:[$&&h.jsx(ue,{name:"check",className:"w-3 h-3 inline-block mr-1.5 -mt-0.5"}),Y]},Y)})})]}),h.jsx("button",{onClick:ee,className:`mt-6 w-full inline-flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-${i}-600 hover:bg-${i}-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-${i}-500`,children:"Save Profile"})]}),h.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Account & Data"}),h.jsx("button",{onClick:()=>te(!0),title:"Learn how to sync data",className:"text-gray-400 hover:text-gray-600",children:h.jsx(ue,{name:"info",className:"w-5 h-5"})})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[h.jsx("h4",{className:"font-medium text-gray-800",children:"Backup & Restore Data"}),h.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Save your data to a file to transfer between devices or keep as a backup."}),h.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[h.jsxs("button",{onClick:me,className:"w-full inline-flex justify-center items-center gap-2 py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[h.jsx(ue,{name:"download",className:"w-4 h-4"})," Download Backup"]}),h.jsxs("button",{onClick:F,className:"w-full inline-flex justify-center items-center gap-2 py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[h.jsx(ue,{name:"folder-open",className:"w-4 h-4"})," Load Backup"]}),le&&h.jsxs("button",{onClick:U,className:"sm:col-span-2 w-full inline-flex justify-center items-center gap-2 py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[h.jsx(ue,{name:"save",className:"w-4 h-4"})," Update Existing Backup File..."]}),h.jsx("input",{type:"file",id:"import-file-input",accept:".json",onChange:V,className:"hidden"})]})]}),h.jsxs("div",{className:"p-4 bg-red-50 rounded-lg border border-red-200",children:[h.jsx("h4",{className:"font-medium text-red-800",children:"Reset App Data"}),h.jsx("p",{className:"text-sm text-red-700 mt-1",children:"This will permanently delete all your data from this device. Use this if you want to start over."}),h.jsx("div",{className:"mt-3",children:h.jsxs("button",{onClick:t,className:"w-full sm:w-auto inline-flex justify-center items-center gap-2 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700",children:[h.jsx(ue,{name:"trash-2",className:"w-4 h-4"})," Reset All Data"]})})]})]})]})]})},U6=()=>h.jsxs("svg",{viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("rect",{x:"20",y:"10",width:"60",height:"80",rx:"5"}),h.jsx("rect",{x:"28",y:"10",width:"15",height:"10",strokeWidth:"2.5"}),h.jsx("path",{d:"M 30 30 H 70 M 30 40 H 70 M 30 50 H 50"}),h.jsx("circle",{cx:"50",cy:"65",r:"12",strokeDasharray:"4 4"}),h.jsx("path",{d:"M 45 65 H 55 M 50 60 V 70"})]}),B6=({triedFoods:n,babyName:e,onShowDoctorReport:t,baseColor:i})=>{const o=y=>y<=2?{emoji:"",text:"Hated it"}:y<=4?{emoji:"",text:"Meh"}:y>=7?{emoji:"",text:"Loved it!"}:{emoji:"",text:"Liked it"},c=y=>({breakfast:"",lunch:"",dinner:"",snack:""})[y==null?void 0:y.toLowerCase()]||"",f=oe.useMemo(()=>{const y={};return n.forEach(w=>{const x=`${w.date}-${w.meal}`;y[x]||(y[x]=[]),y[x].push(w)}),Object.entries(y).map(([w,x])=>({key:w,date:x[0].date,meal:x[0].meal,items:x})).sort((w,x)=>new Date(x.date).getTime()-new Date(w.date).getTime())},[n]);return h.jsxs("div",{children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center mb-4 gap-4",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Summary of Tried Foods"}),h.jsx("div",{className:"flex-shrink-0",children:h.jsxs("button",{onClick:t,className:`inline-flex items-center gap-2 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-${i}-600 hover:bg-${i}-700 transition-all`,children:[h.jsx(ue,{name:"file-text",className:"w-4 h-4"})," Share Report"]})})]}),h.jsx("div",{className:"space-y-4",children:f.length===0?h.jsx(Ou,{illustration:h.jsx(U6,{}),title:"No Foods Logged Yet",message:"When you log a food from the 'Tracker' tab, your detailed entry will appear here."}):f.map(y=>h.jsxs("div",{className:"bg-white shadow-sm rounded-xl p-4 border border-gray-100",children:[h.jsxs("div",{className:"flex justify-between items-center mb-3 pb-2 border-b border-gray-50",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xl",children:c(y.meal)}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-800 capitalize",children:y.meal}),h.jsx("p",{className:"text-xs text-gray-500",children:new Date(y.date).toLocaleDateString()})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[y.items[0].messyFaceImage&&h.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden border border-gray-200",children:h.jsx("img",{src:y.items[0].messyFaceImage,alt:"Meal",className:"w-full h-full object-cover"})}),h.jsxs("span",{className:"text-xs font-medium bg-gray-100 px-2 py-1 rounded-full text-gray-600",children:[y.items.length," items"]})]})]}),h.jsx("div",{className:"space-y-2",children:y.items.map(w=>h.jsxs("div",{className:"flex justify-between items-center text-sm",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:`w-1.5 h-1.5 rounded-full bg-${i}-400`}),h.jsx("span",{className:"text-gray-700",children:w.id}),w.notes&&h.jsx(ue,{name:"message-square",className:"w-3 h-3 text-gray-300"})]}),h.jsx("span",{className:"text-xs text-gray-400",children:o(w.reaction).emoji})]},w.id))})]},y.key))})]})},F6=({milestones:n,onUpdate:e,baseColor:t})=>h.jsx("div",{className:"space-y-4",children:n.map(i=>h.jsx("div",{className:`p-4 rounded-lg border transition-all ${i.isAchieved?`bg-${t}-50 border-${t}-200 shadow-sm`:"bg-white border-gray-200 shadow-sm"}`,children:h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:`flex-shrink-0 p-3 rounded-full flex items-center justify-center h-12 w-12 ${i.isAchieved?`bg-${t}-100 text-${t}-600`:"bg-gray-100 text-gray-400"}`,children:h.jsx(ue,{name:i.icon,className:"w-6 h-6"})}),h.jsxs("div",{className:"flex-grow",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{children:[h.jsx("h4",{className:`font-semibold text-lg ${i.isAchieved?`text-${t}-900`:"text-gray-800"}`,children:i.title}),h.jsx("p",{className:"text-sm text-gray-600 mt-1 leading-snug",children:i.description})]}),h.jsx("input",{type:"checkbox",checked:i.isAchieved,onChange:o=>{const c=o.target.checked;e({...i,isAchieved:c,dateAchieved:c?new Date().toISOString().split("T")[0]:void 0})},className:`h-6 w-6 text-${t}-600 rounded focus:ring-${t}-500 border-gray-300 cursor-pointer ml-3 mt-1`})]}),i.isAchieved&&h.jsxs("div",{className:`mt-4 pt-4 border-t border-${t}-100 grid grid-cols-1 sm:grid-cols-2 gap-4 animate-fadeIn`,children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Date Achieved"}),h.jsx("input",{type:"date",value:i.dateAchieved||"",onChange:o=>e({...i,dateAchieved:o.target.value}),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-${t}-500 focus:ring-${t}-500 sm:text-sm bg-white`})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Notes / Memories"}),h.jsx("input",{type:"text",value:i.notes||"",onChange:o=>e({...i,notes:o.target.value}),placeholder:"e.g. Grandma was watching!",className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-${t}-500 focus:ring-${t}-500 sm:text-sm bg-white`})]})]})]})]})},i.id))}),j6=({userProfile:n,onShowCertificate:e,baseColor:t})=>{var y;const i=(n==null?void 0:n.badges)||uE,o=i.filter(w=>w.isUnlocked).length,c=o/i.length*100,f=(y=i.find(w=>w.id==="100_club"))==null?void 0:y.isUnlocked;return h.jsx("div",{className:"space-y-6",children:h.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Trophy Case"}),h.jsxs("span",{className:`text-sm font-bold text-${t}-600`,children:[o," / ",i.length," Unlocked"]})]}),h.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mb-6",children:h.jsx("div",{className:`bg-${t}-600 h-2.5 rounded-full transition-all duration-500`,style:{width:`${c}%`}})}),h.jsx("div",{className:"grid grid-cols-2 gap-4",children:i.map(w=>h.jsxs("div",{className:`p-4 rounded-xl border flex flex-col items-center text-center transition-all ${w.isUnlocked?w.color+" shadow-sm":"bg-gray-50 border-gray-200 text-gray-400 grayscale"}`,children:[h.jsx("div",{className:`p-3 rounded-full mb-3 ${w.isUnlocked?"bg-white bg-opacity-60":"bg-gray-200"}`,children:h.jsx(ue,{name:w.icon,className:"w-8 h-8"})}),h.jsx("h4",{className:"font-bold text-sm mb-1",children:w.title}),h.jsx("p",{className:"text-xs opacity-90",children:w.description}),w.isUnlocked&&w.dateUnlocked&&h.jsxs("span",{className:"mt-2 text-[10px] font-mono opacity-70",children:["Unlocked: ",w.dateUnlocked]})]},w.id))}),f&&h.jsx("div",{className:"mt-6 text-center animate-bounce",children:h.jsxs("button",{onClick:e,className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-yellow-400 to-yellow-600 text-white font-bold rounded-full shadow-lg hover:from-yellow-500 hover:to-yellow-700 transform transition hover:scale-105",children:[h.jsx(ue,{name:"award",className:"w-6 h-6"}),"View Completion Certificate"]})})]})})},V6=({triedFoods:n})=>{const e=n.filter(t=>t.messyFaceImage);return h.jsxs("div",{className:"bg-white p-6 rounded-lg shadow min-h-[400px]",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-1",children:"Messy Face Gallery"}),h.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"A collection of those precious first reactions."}),e.length>0?h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:e.map(t=>h.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden border border-gray-200 group",children:[h.jsx("img",{src:t.messyFaceImage,alt:`${t.id} reaction`,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}),h.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-3",children:[h.jsx("p",{className:"text-white font-bold text-sm",children:t.id}),h.jsx("p",{className:"text-white/80 text-xs",children:t.date})]})]},t.id))}):h.jsx(Ou,{illustration:h.jsx(ue,{name:"camera-off",className:"w-20 h-20 text-gray-300"}),title:"No Photos Yet",message:"Next time you log a food, tap the camera icon to snap a messy face!"})]})},G6=({userProfile:n,triedFoods:e,milestones:t,onSaveProfile:i,onResetData:o,onShowDoctorReport:c,onUpdateMilestone:f,onShowCertificate:y,baseColor:w="teal"})=>{const[x,A]=oe.useState("profile"),N=R=>{const k="flex-1 py-3 px-2 text-sm font-medium border-b-2 transition-all whitespace-nowrap",H=`border-${w}-600 text-${w}-600`;return`${k} ${x===R?H:"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`};return h.jsxs(h.Fragment,{children:[h.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Profile & Memories"}),h.jsx("div",{className:"border-b border-gray-200 mb-6 overflow-x-auto",children:h.jsxs("nav",{className:"flex min-w-max sm:min-w-0",children:[h.jsxs("button",{onClick:()=>A("profile"),className:N("profile"),children:[h.jsx(ue,{name:"user-cog",className:"w-4 h-4 inline-block -mt-1 mr-1"})," Profile"]}),h.jsxs("button",{onClick:()=>A("log"),className:N("log"),children:[h.jsx(ue,{name:"clipboard-list",className:"w-4 h-4 inline-block -mt-1 mr-1"})," Log"]}),h.jsxs("button",{onClick:()=>A("milestones"),className:N("milestones"),children:[h.jsx(ue,{name:"award",className:"w-4 h-4 inline-block -mt-1 mr-1"})," Milestones"]}),h.jsxs("button",{onClick:()=>A("badges"),className:N("badges"),children:[h.jsx(ue,{name:"trophy",className:"w-4 h-4 inline-block -mt-1 mr-1"})," Badges"]}),h.jsxs("button",{onClick:()=>A("gallery"),className:N("gallery"),children:[h.jsx(ue,{name:"image",className:"w-4 h-4 inline-block -mt-1 mr-1"})," Gallery"]})]})}),x==="profile"&&h.jsx(L6,{userProfile:n,onSaveProfile:i,onResetData:o,baseColor:w}),x==="log"&&h.jsx(B6,{triedFoods:e,babyName:n==null?void 0:n.babyName,onShowDoctorReport:c,baseColor:w}),x==="milestones"&&h.jsx(F6,{milestones:t,onUpdate:f,baseColor:w}),x==="badges"&&h.jsx(j6,{userProfile:n,onShowCertificate:y,baseColor:w}),x==="gallery"&&h.jsx(V6,{triedFoods:e})]})},H6=({baseColor:n="indigo",savedStrategies:e=[],onSaveStrategy:t,onDeleteStrategy:i,safeFoods:o=[],onUpdateSafeFoods:c})=>{const[f,y]=oe.useState("ask"),[w,x]=oe.useState(""),[A,N]=oe.useState(o.length>0?o[0]:""),[R,k]=oe.useState(""),[H,W]=oe.useState(null),[K,te]=oe.useState(!1),[le,ee]=oe.useState(null),de=V=>{if(!t)return;const F={...V,id:crypto.randomUUID(),targetFood:w,safeFood:A,dateSaved:new Date().toISOString().split("T")[0]};t(F)},Ee=async()=>{if(!w.trim()||!A.trim()){ee("Please fill in both food fields.");return}te(!0),ee(null);try{const V=await g6(w,A,R||"Not sure");W(V)}catch{ee("Sage is having trouble thinking right now. Try again later.")}finally{te(!1)}},me=()=>{if(!A.trim()||!c)return;const V=o||[],F=A.trim();V.includes(F)?c(V.filter(Q=>Q!==F)):c([...V,F])},U=o.includes(A.trim());return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[h.jsxs("button",{onClick:()=>y("ask"),className:`flex-1 py-3 text-sm font-medium border-b-2 transition-colors ${f==="ask"?`border-${n}-600 text-${n}-600`:"border-transparent text-gray-500 hover:text-gray-700"}`,children:[h.jsx(ue,{name:"sparkles",className:"w-4 h-4 inline-block mr-2 -mt-1"}),"Ask Sage"]}),h.jsxs("button",{onClick:()=>y("playbook"),className:`flex-1 py-3 text-sm font-medium border-b-2 transition-colors ${f==="playbook"?`border-${n}-600 text-${n}-600`:"border-transparent text-gray-500 hover:text-gray-700"}`,children:[h.jsx(ue,{name:"book-open",className:"w-4 h-4 inline-block mr-2 -mt-1"}),"My Playbook"]})]}),f==="ask"?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:`bg-${n}-50 border border-${n}-100 p-5 rounded-xl shadow-sm`,children:[h.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[h.jsx("div",{className:`bg-${n}-100 p-2 rounded-full`,children:h.jsx(ue,{name:"chef-hat",className:`w-6 h-6 text-${n}-600`})}),h.jsx("h2",{className:`text-lg font-bold text-${n}-900`,children:"Picky Eater Rescue"})]}),h.jsxs("p",{className:`text-sm text-${n}-700 mb-5 leading-relaxed`,children:["Tell Sage what they ",h.jsx("strong",{className:`text-${n}-900`,children:"refuse to eat"})," and what they ",h.jsx("strong",{className:`text-${n}-900`,children:"love"}),". We'll find a way to bridge the gap."]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold uppercase text-gray-500 tracking-wider",children:'The "Enemy" (Refused Food)'}),h.jsx("input",{className:`w-full mt-1 border-gray-300 rounded-lg shadow-sm focus:ring-${n}-500 focus:border-${n}-500 text-sm py-2.5`,placeholder:"e.g. Broccoli",value:w,onChange:V=>x(V.target.value)})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold uppercase text-gray-500 tracking-wider",children:'The "Safe" Food (Loves It)'}),h.jsxs("div",{className:"relative mt-1",children:[h.jsx("input",{className:`w-full border-gray-300 rounded-lg shadow-sm focus:ring-${n}-500 focus:border-${n}-500 text-sm py-2.5 pr-10`,placeholder:"e.g. Chicken Nuggets",value:A,onChange:V=>N(V.target.value)}),A&&c&&h.jsx("button",{onClick:me,className:"absolute right-2 top-2 p-1 rounded-full hover:bg-gray-100 transition-colors",title:U?"Remove from favorites":"Save to favorites",children:h.jsx(ue,{name:"heart",className:`w-4 h-4 ${U?"text-red-500 fill-red-500":"text-gray-400"}`})})]}),o.length>0&&h.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[h.jsx("span",{className:"text-[10px] text-gray-400 font-medium self-center mr-1",children:"Favorites:"}),o.map(V=>h.jsx("button",{onClick:()=>N(V),className:`text-xs px-2 py-0.5 rounded-full border transition-all ${A===V?`bg-${n}-100 border-${n}-300 text-${n}-700`:"bg-white border-gray-200 text-gray-600 hover:border-gray-300"}`,children:V},V))]})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold uppercase text-gray-500 tracking-wider",children:"Why do they hate it? (Optional)"}),h.jsx("input",{className:`w-full mt-1 border-gray-300 rounded-lg shadow-sm focus:ring-${n}-500 focus:border-${n}-500 text-sm py-2.5`,placeholder:"e.g. Too slimy, green color, texture...",value:R,onChange:V=>k(V.target.value)})]}),le&&h.jsx("p",{className:"text-sm text-red-600 font-medium",children:le}),h.jsx("button",{onClick:Ee,disabled:K||!w,className:`w-full bg-${n}-600 text-white font-bold py-3 rounded-xl shadow-md hover:bg-${n}-700 active:scale-95 transition-all disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2`,children:K?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Consulting Chef Sage..."]}):h.jsxs(h.Fragment,{children:[h.jsx(ue,{name:"sparkles",className:"w-4 h-4"}),"Find a Strategy"]})})]})]}),H&&h.jsxs("div",{className:"space-y-5 animate-fadeIn pb-20",children:[H.strategies.map((V,F)=>{const Q=["link","ghost","smile"],Y=["bg-teal-600","bg-violet-600","bg-orange-500"],$=e.some(z=>z.title===V.title);return h.jsxs("div",{className:"bg-white border border-gray-200 shadow-md rounded-xl overflow-hidden",children:[h.jsxs("div",{className:`${Y[F]} px-4 py-3 flex justify-between items-center text-white`,children:[h.jsx("span",{className:"font-bold text-sm tracking-wide uppercase",children:V.type}),h.jsx("div",{className:"bg-white/20 p-1.5 rounded-full",children:h.jsx(ue,{name:Q[F],className:"w-4 h-4"})})]}),h.jsxs("div",{className:"p-5",children:[h.jsxs("div",{className:"flex justify-between items-start mb-2",children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800",children:V.title}),t&&h.jsx("button",{onClick:()=>de(V),className:`transition-colors p-1 ${$?"text-red-500":"text-gray-400 hover:text-red-400"}`,title:"Save to Playbook",disabled:$,children:h.jsx(ue,{name:"bookmark",className:`w-6 h-6 ${$?"fill-current":""}`})})]}),h.jsxs("p",{className:`text-xs font-medium text-${n}-600 bg-${n}-50 inline-block px-2 py-1 rounded mb-4`,children:["Why: ",V.why_it_works]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100",children:[h.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase mb-1",children:"Ingredients"}),h.jsx("div",{className:"flex flex-wrap gap-1.5",children:V.ingredients.map((z,_e)=>h.jsx("span",{className:"text-xs bg-white border border-gray-200 px-2 py-0.5 rounded text-gray-700",children:z},_e))})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase mb-1",children:"Preparation"}),h.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:V.instructions})]})]})]})]},F)}),h.jsxs("div",{className:"bg-yellow-50 p-5 rounded-xl border border-yellow-200 flex gap-4 items-start shadow-sm",children:[h.jsx("div",{className:"bg-yellow-100 p-2 rounded-full flex-shrink-0",children:h.jsx(ue,{name:"heart",className:"w-5 h-5 text-yellow-600"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-bold text-yellow-800 text-sm mb-1",children:"Sage's Parent Tip"}),h.jsxs("p",{className:"text-sm text-yellow-800 italic leading-relaxed",children:['"',H.parent_tip,'"']})]})]})]})]}):h.jsx("div",{className:"space-y-4 pb-20",children:e.length===0?h.jsx(Ou,{illustration:h.jsx(ue,{name:"book-dashed",className:"w-20 h-20 text-gray-300"}),title:"Playbook is Empty",message:"Use the 'Ask Sage' tab to generate ideas, then save your favorites here!"}):e.map(V=>h.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl overflow-hidden group",children:[h.jsxs("div",{className:"bg-gray-50 px-4 py-3 flex justify-between items-center border-b border-gray-100",children:[h.jsxs("div",{children:[h.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider text-${n}-600 bg-${n}-50 px-2 py-0.5 rounded`,children:V.type}),h.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["For: ",h.jsx("span",{className:"font-bold text-gray-700",children:V.targetFood})]})]}),i&&h.jsx("button",{onClick:()=>i(V.id),className:"text-gray-400 hover:text-red-500 transition-colors p-2",title:"Delete Strategy",children:h.jsx(ue,{name:"trash-2",className:"w-4 h-4"})})]}),h.jsxs("div",{className:"p-4",children:[h.jsx("h3",{className:"font-bold text-gray-800 mb-2",children:V.title}),h.jsx("p",{className:"text-xs text-gray-500 mb-3 italic",children:V.why_it_works}),h.jsxs("div",{className:"text-sm text-gray-700 border-t border-gray-100 pt-3",children:[h.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase mb-1",children:"Ingredients"}),h.jsx("p",{className:"mb-3",children:V.ingredients.join(", ")}),h.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase mb-1",children:"Instructions"}),h.jsx("p",{children:V.instructions})]})]})]},V.id))})]})},z6={Carbs:"#fcd34d",Protein:"#f87171",FruitVeg:"#4ade80",Dairy:"#60a5fa"},mw=["Iron","Calcium","Vitamin C","Omega-3","Protein"],q6=({triedFoods:n,baseColor:e="teal"})=>{const[t,i]=oe.useState(!1),[o,c]=oe.useState(null),f=oe.useMemo(()=>{const A=new Date,N=new Date(A.setDate(A.getDate()-7)),R=n.filter(Ee=>new Date(Ee.date)>=N),H=new Set(R.map(Ee=>`${Ee.date}-${Ee.meal}`)).size,W={Carbs:0,Protein:0,FruitVeg:0,Dairy:0},K=new Set,te=new Set,le={Vegetables:"FruitVeg",Fruits:"FruitVeg",Grains:"Carbs",Meat:"Protein","Plant Protein":"Protein","Dairy & Eggs":"Dairy",Other:"Carbs"},ee=(Ee,me)=>{const U=me.toUpperCase().trim();return Ee[U]?U:U.endsWith("S")&&Ee[U.slice(0,-1)]?U.slice(0,-1):Ee[U+"S"]?U+"S":null};R.forEach(Ee=>{const me=Ee.id,U=me.toLowerCase().trim();let V="Other";for(const $ of Ns)if($.items.some(z=>z.name.toLowerCase()===U)){V=$.category;break}const F=le[V];F&&W[F]++;const Q=ee(um,me);Q&&um[Q]&&K.add(um[Q]);const Y=ee(Jl,me);Y&&Jl[Y]&&Jl[Y].forEach(z=>te.add(z))});const de=mw.find(Ee=>!te.has(Ee))||"None";return{totalMeals:H,distribution:W,colorsEaten:Array.from(K),nutrientsConsumed:te,missingNutrient:de}},[n]),y=oe.useMemo(()=>{const A=Math.max(1,Object.values(f.distribution).reduce((R,k)=>R+k,0));let N=0;return Object.entries(f.distribution).map(([R,k])=>{const H=k,W=H/A*100,K=H/A*360,te={category:R,pct:Math.round(W),color:z6[R],start:N,end:N+K};return N+=K,te})},[f]),w=y.map(A=>`${A.color} ${A.start}deg ${A.end}deg`).join(", "),x=async()=>{i(!0);try{const A=Object.entries(f.distribution).sort(([,R],[,k])=>k-R).map(([R,k])=>`${R} (${k})`).join(", "),N=await b6(f.missingNutrient==="None"?"Iron":f.missingNutrient,`Toddler eating mostly: ${A}`);c(N)}catch{alert("Sage is busy right now.")}finally{i(!1)}};return h.jsxs("div",{className:"space-y-6 pb-24",children:[h.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"The Weekly Plate"}),h.jsx("span",{className:"text-xs font-medium bg-gray-100 text-gray-500 px-2 py-1 rounded-full",children:"Last 7 Days"})]}),h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsx("div",{className:"w-48 h-48 rounded-full relative flex items-center justify-center shadow-inner mb-6",style:{background:f.totalMeals>0?`conic-gradient(${w})`:"#f3f4f6"},children:h.jsxs("div",{className:"w-32 h-32 bg-white rounded-full flex flex-col items-center justify-center shadow-sm z-10",children:[h.jsx("span",{className:"text-3xl font-black text-gray-800",children:f.totalMeals}),h.jsx("span",{className:"text-xs text-gray-400 uppercase tracking-wide",children:"Meals Logged"})]})}),h.jsxs("div",{className:"w-full bg-gray-50 rounded-xl p-4 mb-6",children:[h.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 text-center",children:"Critical Nutrients"}),h.jsx("div",{className:"flex justify-between px-2",children:mw.map(A=>{const N=f.nutrientsConsumed.has(A),R=Yh[A]||{icon:"star",label:A},k=R.label||A.split(" ")[0];return h.jsxs("div",{className:"flex flex-col items-center gap-1",title:A,children:[h.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border transition-all ${N?`bg-${e}-100 border-${e}-200`:"bg-white border-gray-200 grayscale opacity-50"}`,children:h.jsx(ue,{name:R.icon,className:`w-4 h-4 ${N?`text-${e}-600`:"text-gray-300"}`})}),h.jsx("span",{className:`text-[9px] font-bold ${N?"text-gray-700":"text-gray-300"}`,children:k})]},A)})})]}),h.jsx("div",{className:"grid grid-cols-2 gap-4 w-full",children:y.map(A=>h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:A.color}}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"text-xs font-bold text-gray-700",children:A.category}),h.jsxs("span",{className:"text-[10px] text-gray-400",children:[A.pct,"%"]})]})]},A.category))})]})]}),h.jsxs("div",{className:`bg-gradient-to-br from-${e}-50 to-white rounded-2xl shadow-sm border border-${e}-100 p-6`,children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx(ue,{name:"palette",className:`w-5 h-5 text-${e}-500`}),h.jsx("h2",{className:`text-lg font-bold text-${e}-900`,children:"Eat the Rainbow"})]}),h.jsx("p",{className:`text-xs text-${e}-600 mb-6`,children:"Hit 5 colors this week to unlock a badge!"}),h.jsx("div",{className:"flex justify-between px-2",children:[{color:"red",label:"Red",bg:"bg-red-500"},{color:"orange",label:"Org",bg:"bg-orange-400"},{color:"yellow",label:"Yel",bg:"bg-yellow-400"},{color:"green",label:"Grn",bg:"bg-green-500"},{color:"purple",label:"Pur",bg:"bg-purple-500"}].map(A=>{const N=f.colorsEaten.includes(A.color);return h.jsxs("div",{className:"flex flex-col items-center gap-2",children:[h.jsx("div",{className:`w-10 h-10 rounded-full border-2 border-white shadow-sm flex items-center justify-center transition-all ${N?A.bg:"bg-gray-200 grayscale"}`,children:N&&h.jsx(ue,{name:"check",className:"w-5 h-5 text-white"})}),h.jsx("span",{className:`text-[10px] font-bold ${N?"text-gray-700":"text-gray-300"}`,children:A.label})]},A.color)})})]}),h.jsxs("div",{className:`bg-${e}-50 rounded-2xl border border-${e}-100 p-5`,children:[h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:`bg-${e}-100 p-2 rounded-full`,children:h.jsx(ue,{name:"zap",className:`w-6 h-6 text-${e}-600`})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:`font-bold text-${e}-900 text-sm`,children:f.missingNutrient!=="None"?`Nutrient Gap: ${f.missingNutrient}`:"Looking Good!"}),h.jsx("p",{className:`text-xs text-${e}-700 mt-1 mb-3`,children:f.missingNutrient!=="None"?`We haven't seen much ${f.missingNutrient} this week. Need quick ideas?`:"Your weekly log covers the main nutrient groups well! Ask Sage for more fun snack ideas anytime."}),!o&&h.jsx("button",{onClick:x,disabled:t,className:`bg-${e}-600 text-white text-xs font-bold px-4 py-2 rounded-lg shadow-sm hover:bg-${e}-700 disabled:opacity-50 transition-colors flex items-center gap-2`,children:t?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Asking Sage..."]}):`Ask Sage for ${f.missingNutrient!=="None"?f.missingNutrient:"Snack"} Ideas`})]})]}),o&&h.jsxs("div",{className:`mt-5 animate-fadeIn space-y-3 pt-4 border-t border-${e}-100`,children:[o.suggestions.map((A,N)=>h.jsxs("div",{className:`bg-white p-3 rounded-lg border border-${e}-100 shadow-sm`,children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsx("h4",{className:`font-bold text-${e}-800 text-sm`,children:A.food}),h.jsx("span",{className:`text-[10px] font-medium bg-${e}-50 text-${e}-600 px-2 py-0.5 rounded-full`,children:A.prep_time})]}),h.jsx("p",{className:"text-xs text-gray-600 mt-1",children:A.why})]},N)),h.jsxs("div",{className:"bg-yellow-50 p-2 rounded text-[10px] text-yellow-800 flex gap-2 items-center",children:[h.jsx(ue,{name:"lightbulb",className:"w-3 h-3 flex-shrink-0"}),o.quick_tip]})]})]})]})},ku=n=>{if(!n)return 6;const e=new Date(n),t=new Date;let i=t.getFullYear()-e.getFullYear(),o=t.getMonth()-e.getMonth();return t.getDate()<e.getDate()&&o--,o<0&&(i--,o+=12),Math.max(0,i*12+o)},Y6=(n,e=300)=>new Promise((t,i)=>{const o=new FileReader;o.onload=c=>{var y;const f=new Image;f.onload=()=>{const w=document.createElement("canvas");let x=f.width,A=f.height;x>e&&(A=Math.round(A*e/x),x=e),w.width=x,w.height=A;const N=w.getContext("2d");N?(N.drawImage(f,0,0,x,A),t(w.toDataURL("image/jpeg",.7))):i(new Error("Failed to get canvas context"))},f.src=(y=c.target)==null?void 0:y.result},o.onerror=c=>i(c),o.readAsDataURL(n)}),r2=n=>{if(n!=null&&n.preferredMode)return n.preferredMode;const e=n==null?void 0:n.birthDate;if(!e)return"EXPLORER";const t=ku(e);return t<6&&(n!=null&&n.pediatricianApproved)?"EXPLORER":t<6?"NEWBORN":t>=12?"TODDLER":"EXPLORER"},W6=n=>{switch(n){case"NEWBORN":return{themeColor:"bg-rose-500",textColor:"text-rose-600",borderColor:"border-rose-200",navItems:[{id:"feed",label:"Log",icon:"clipboard-list"},{id:"health_check",label:"Is it Normal?",icon:"activity"},{id:"sleep_growth",label:"Sleep & Growth",icon:"ruler"},{id:"learn",label:"Learn",icon:"book-open"},{id:"profile",label:"Profile",icon:"user"}],homeTitle:"Tiny Tastes",showFoodTracker:!1};case"TODDLER":return{themeColor:"bg-indigo-500",textColor:"text-indigo-600",borderColor:"border-indigo-200",navItems:[{id:"recipes",label:"Meal",icon:"utensils"},{id:"picky_eater",label:"Picky Eater",icon:"frown"},{id:"balance",label:"Balance",icon:"scale"},{id:"learn",label:"Learn",icon:"book-open"},{id:"profile",label:"Profile",icon:"user"}],homeTitle:"Tiny Tastes",showFoodTracker:!1};default:return{themeColor:"bg-teal-600",textColor:"text-teal-600",borderColor:"border-teal-200",navItems:[{id:"tracker",label:"Tracker",icon:"grid-3x3"},{id:"recommendations",label:"Recs",icon:"lightbulb"},{id:"recipes",label:"Recipes",icon:"notebook-pen"},{id:"learn",label:"Learn",icon:"book-open"},{id:"profile",label:"Profile",icon:"user"}],homeTitle:"Tiny Tastes",showFoodTracker:!0}}},X6={boy:{weight:[{m:0,l:.3487,m_val:3.346,s:.146},{m:1,l:.2646,m_val:4.471,s:.134},{m:2,l:.2096,m_val:5.576,s:.125},{m:3,l:.1748,m_val:6.421,s:.119},{m:4,l:.1485,m_val:7.045,s:.116},{m:6,l:.0908,m_val:7.939,s:.114},{m:9,l:.0528,m_val:8.895,s:.113},{m:12,l:.0322,m_val:9.637,s:.113},{m:18,l:.0322,m_val:10.9,s:.113},{m:24,l:.0322,m_val:12.15,s:.11}],length:[{m:0,l:1,m_val:49.88,s:.038},{m:1,l:1,m_val:54.72,s:.036},{m:2,l:1,m_val:58.42,s:.035},{m:3,l:1,m_val:61.44,s:.034},{m:6,l:1,m_val:67.62,s:.034},{m:12,l:1,m_val:75.75,s:.034},{m:24,l:1,m_val:87.8,s:.035}]},girl:{weight:[{m:0,l:.3957,m_val:3.232,s:.142},{m:1,l:.3236,m_val:4.187,s:.131},{m:2,l:.2725,m_val:5.128,s:.122},{m:3,l:.2319,m_val:5.835,s:.118},{m:4,l:.197,m_val:6.422,s:.116},{m:6,l:.1268,m_val:7.297,s:.115},{m:9,l:.082,m_val:8.205,s:.114},{m:12,l:.045,m_val:8.913,s:.115},{m:18,l:.045,m_val:10.2,s:.115},{m:24,l:.045,m_val:11.48,s:.114}],length:[{m:0,l:1,m_val:49.15,s:.038},{m:1,l:1,m_val:53.7,s:.036},{m:2,l:1,m_val:57.07,s:.035},{m:3,l:1,m_val:59.8,s:.034},{m:6,l:1,m_val:65.73,s:.035},{m:12,l:1,m_val:74.02,s:.035},{m:24,l:1,m_val:86.4,s:.036}]}};function K6(n){var e=1/(1+.2316419*Math.abs(n)),t=.3989423*Math.exp(-n*n/2),i=t*e*(.3193815+e*(-.3565638+e*(1.781478+e*(-1.821256+e*1.330274))));return n>0&&(i=1-i),i}const gw=(n,e,t,i)=>{const o=X6[t][e==="weight"?"weight":"length"];let c=o[0],f=o[o.length-1];for(let k=0;k<o.length-1;k++)if(i>=o[k].m&&i<=o[k+1].m){c=o[k],f=o[k+1];break}if(!c||!f)return null;const y=(i-c.m)/Math.max(1,f.m-c.m),w=c.l+(f.l-c.l)*y,x=c.m_val+(f.m_val-c.m_val)*y,A=c.s+(f.s-c.s)*y;if(w===0)return null;const N=(Math.pow(n/x,w)-1)/(w*A),R=K6(N)*100;return Math.round(R)},pw=({data:n,color:e,unit:t,label:i})=>{if(n.length<2)return h.jsxs("div",{className:"h-40 flex items-center justify-center bg-gray-50 rounded-xl border border-gray-100 text-gray-400 text-xs",children:["Not enough data for ",i," chart"]});const o=n.map(N=>N.value),c=Math.min(...o)*.95,y=Math.max(...o)*1.05-c||1,w=150,x=300,A=n.map((N,R)=>{const k=R/(n.length-1)*x,H=w-(N.value-c)/y*w;return`${k},${H}`}).join(" ");return h.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:[h.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide mb-4",children:[i," Trend"]}),h.jsx("div",{className:"relative h-[150px] w-full overflow-hidden",children:h.jsxs("svg",{viewBox:`0 0 ${x} ${w+20}`,className:"w-full h-full overflow-visible",preserveAspectRatio:"none",children:[h.jsx("line",{x1:"0",y1:"0",x2:x,y2:"0",stroke:"#f3f4f6",strokeWidth:"1"}),h.jsx("line",{x1:"0",y1:w/2,x2:x,y2:w/2,stroke:"#f3f4f6",strokeWidth:"1"}),h.jsx("line",{x1:"0",y1:w,x2:x,y2:w,stroke:"#f3f4f6",strokeWidth:"1"}),h.jsx("polyline",{fill:"none",stroke:e,strokeWidth:"3",points:A,strokeLinecap:"round",strokeLinejoin:"round"}),n.map((N,R)=>{const k=R/(n.length-1)*x,H=w-(N.value-c)/y*w;return h.jsxs("g",{children:[h.jsx("circle",{cx:k,cy:H,r:"4",fill:"white",stroke:e,strokeWidth:"2"}),R===n.length-1&&h.jsxs("text",{x:k,y:H-10,textAnchor:"middle",fontSize:"12",fill:e,fontWeight:"bold",children:[N.value,t]})]},R)})]})})]})},o2=({logs:n,onSave:e,onDelete:t,baseColor:i,userProfile:o})=>{const[c,f]=oe.useState(!1),[y,w]=oe.useState((o==null?void 0:o.gender)||"boy");oe.useEffect(()=>{o!=null&&o.gender&&w(o.gender)},[o==null?void 0:o.gender]);const[x,A]=oe.useState(new Date().toISOString().split("T")[0]),[N,R]=oe.useState(""),[k,H]=oe.useState(""),[W,K]=oe.useState(""),[te,le]=oe.useState(""),[ee,de]=oe.useState(""),Ee=oe.useMemo(()=>[...n].sort((_e,he)=>new Date(he.date).getTime()-new Date(_e.date).getTime()),[n]),me=Ee[0],U=oe.useMemo(()=>Ee.filter(_e=>_e.weightLb!==void 0).map(_e=>({date:_e.date,value:parseFloat(((_e.weightLb||0)+(_e.weightOz||0)/16).toFixed(2))})).reverse(),[Ee]),V=oe.useMemo(()=>Ee.filter(_e=>_e.heightIn!==void 0&&_e.heightIn>0).map(_e=>({date:_e.date,value:_e.heightIn||0})).reverse(),[Ee]),F=()=>{if(!N&&!W&&!te){alert("Please enter at least one measurement.");return}const _e={id:crypto.randomUUID(),date:x,weightLb:N?parseFloat(N):void 0,weightOz:k?parseFloat(k):void 0,heightIn:W?parseFloat(W):void 0,headCircumferenceIn:te?parseFloat(te):void 0,notes:ee};e(_e),f(!1),R(""),H(""),K(""),le(""),de("")},Q=o!=null&&o.birthDate?ku(o.birthDate):0,Y=oe.useMemo(()=>{if(!me||me.weightLb===void 0)return null;const _e=(me.weightLb||0)*.453592+(me.weightOz||0)*.0283495;return gw(_e,"weight",y,Q)},[me,y,Q]),$=oe.useMemo(()=>{if(!me||!me.heightIn)return null;const _e=me.heightIn*2.54;return gw(_e,"height",y,Q)},[me,y,Q]),z=_e=>_e<5||_e>95?"text-orange-600 bg-orange-50":`text-${i}-600 bg-${i}-50`;return h.jsxs("div",{className:"space-y-6 pb-24",children:[!(o!=null&&o.gender)&&h.jsx("div",{className:"flex justify-center mb-4",children:h.jsxs("div",{className:"bg-gray-100 p-1 rounded-lg inline-flex",children:[h.jsx("button",{onClick:()=>w("boy"),className:`px-4 py-1.5 text-xs font-bold rounded-md transition-all ${y==="boy"?"bg-white text-blue-600 shadow-sm":"text-gray-500"}`,children:"Boy"}),h.jsx("button",{onClick:()=>w("girl"),className:`px-4 py-1.5 text-xs font-bold rounded-md transition-all ${y==="girl"?"bg-white text-pink-600 shadow-sm":"text-gray-500"}`,children:"Girl"})]})}),h.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[h.jsxs("div",{className:`bg-${i}-50 p-4 rounded-xl border border-${i}-100 flex flex-col justify-center items-center shadow-sm relative overflow-hidden`,children:[h.jsx("div",{className:"p-2 bg-white rounded-full mb-2 shadow-sm relative z-10",children:h.jsx(ue,{name:"scale",className:`w-5 h-5 text-${i}-600`})}),h.jsx("span",{className:`text-[10px] uppercase font-bold text-${i}-400 tracking-wider relative z-10`,children:"Weight"}),h.jsx("span",{className:`text-xl font-black text-${i}-800 mt-1 relative z-10`,children:me!=null&&me.weightLb?`${me.weightLb}lb ${me.weightOz?`${me.weightOz}oz`:""}`:"--"}),Y!==null&&h.jsxs("span",{className:`mt-2 text-[10px] font-bold px-2 py-0.5 rounded-full ${z(Y)} relative z-10`,children:[Y,"th %"]})]}),h.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100 flex flex-col justify-center items-center shadow-sm relative overflow-hidden",children:[h.jsx("div",{className:"p-2 bg-white rounded-full mb-2 shadow-sm relative z-10",children:h.jsx(ue,{name:"ruler",className:"w-5 h-5 text-blue-600"})}),h.jsx("span",{className:"text-[10px] uppercase font-bold text-blue-400 tracking-wider relative z-10",children:"Height"}),h.jsx("span",{className:"text-xl font-black text-blue-800 mt-1 relative z-10",children:me!=null&&me.heightIn?`${me.heightIn} in`:"--"}),$!==null&&h.jsxs("span",{className:`mt-2 text-[10px] font-bold px-2 py-0.5 rounded-full ${z($)} relative z-10 text-blue-700 bg-blue-100`,children:[$,"th %"]})]})]}),c?h.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm animate-fadeIn",children:[h.jsx("h3",{className:"font-bold text-gray-800 mb-4",children:"New Measurement"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date"}),h.jsx("input",{type:"date",value:x,onChange:_e=>A(_e.target.value),className:"w-full mt-1 border-gray-300 rounded-lg text-sm"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Weight"}),h.jsxs("div",{className:"flex gap-2 mt-1",children:[h.jsx("input",{type:"number",placeholder:"lb",value:N,onChange:_e=>R(_e.target.value),className:"w-full border-gray-300 rounded-lg text-sm"}),h.jsx("input",{type:"number",placeholder:"oz",value:k,onChange:_e=>H(_e.target.value),className:"w-full border-gray-300 rounded-lg text-sm"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Height (in)"}),h.jsx("input",{type:"number",placeholder:"inches",value:W,onChange:_e=>K(_e.target.value),className:"w-full mt-1 border-gray-300 rounded-lg text-sm"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Head Circumference (in)"}),h.jsx("input",{type:"number",placeholder:"inches (optional)",value:te,onChange:_e=>le(_e.target.value),className:"w-full mt-1 border-gray-300 rounded-lg text-sm"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Notes"}),h.jsx("input",{type:"text",placeholder:"e.g. 6 month checkup",value:ee,onChange:_e=>de(_e.target.value),className:"w-full mt-1 border-gray-300 rounded-lg text-sm"})]}),h.jsxs("div",{className:"flex gap-3 pt-2",children:[h.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-2 text-gray-600 font-bold bg-gray-100 rounded-lg",children:"Cancel"}),h.jsx("button",{onClick:F,className:`flex-1 py-2 text-white font-bold bg-${i}-600 rounded-lg`,children:"Save"})]})]})]}):h.jsxs("button",{onClick:()=>f(!0),className:`w-full py-3 bg-${i}-600 text-white font-bold rounded-xl shadow-md flex items-center justify-center gap-2 hover:bg-${i}-700 transition-colors`,children:[h.jsx(ue,{name:"plus",className:"w-5 h-5"})," Log Measurements"]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(pw,{data:U,color:"#0d9488",unit:"lb",label:"Weight"}),V.length>1&&h.jsx(pw,{data:V,color:"#3b82f6",unit:"in",label:"Height"})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-sm font-bold text-gray-500 mb-3 px-1 uppercase tracking-wide",children:"Measurement History"}),Ee.length===0?h.jsx("p",{className:"text-center text-gray-400 py-4 text-sm italic",children:"No measurements logged yet."}):h.jsx("div",{className:"space-y-2",children:Ee.map(_e=>h.jsxs("div",{className:"bg-white p-3 rounded-xl border border-gray-100 shadow-sm flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-gray-400 font-bold mb-0.5",children:new Date(_e.date).toLocaleDateString()}),h.jsxs("div",{className:"flex gap-3 text-sm text-gray-800 font-medium",children:[_e.weightLb&&h.jsxs("span",{children:[_e.weightLb,"lb ",_e.weightOz,"oz"]}),_e.heightIn&&h.jsxs("span",{children:[_e.heightIn,'"']}),_e.headCircumferenceIn&&h.jsxs("span",{className:"text-gray-500 text-xs",children:["Head: ",_e.headCircumferenceIn,'"']})]}),_e.notes&&h.jsxs("p",{className:"text-xs text-gray-500 mt-1 italic",children:['"',_e.notes,'"']})]}),h.jsx("button",{onClick:()=>{confirm("Delete this entry?")&&t(_e.id)},className:"p-2 text-gray-300 hover:text-red-500 transition-colors",children:h.jsx(ue,{name:"trash-2",className:"w-4 h-4"})})]},_e.id))})]})]})},xw=({className:n})=>h.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,xmlns:"http://www.w3.org/2000/svg",children:[h.jsx("path",{d:"M19 16.5c.6.8 1 1.7 1 2.5 0 2.5-3.6 4.5-8 4.5s-8-2-8-4.5c0-.8.4-1.7 1-2.5"}),h.jsx("path",{d:"M6.5 12.5c-1 .8-1.5 1.7-1.5 2.5 0 2 3.1 3.5 7 3.5s7-1.5 7-3.5c0-.8-.5-1.7-1.5-2.5"}),h.jsx("path",{d:"M8.5 9c-.8.6-1.5 1.3-1.5 2 0 1.7 2.2 3 5 3s5-1.3 5-3c0-.7-.7-1.4-1.5-2"}),h.jsx("path",{d:"M12 3c0 2.5-3 3-3 5 0 1.5 1.3 2.5 3 2.5s3-1 3-2.5c0-2-1.5-3.5-3-5z"})]}),yw=n=>{const e=Math.floor((new Date().getTime()-new Date(n).getTime())/1e3);if(e<60)return"Just now";const t=Math.floor(e/60);if(t<60)return`${t}m ago`;const i=Math.floor(t/60);return i<24?`${i}h ${t%60}m ago`:`${Math.floor(i/24)}d ago`},xm=n=>{const e=Math.floor(n/60),t=n%60;return`${e}:${t<10?"0":""}${t}`},$6=({onClose:n,onSave:e,lastSide:t})=>{const[i,o]=oe.useState("timer"),[c,f]=oe.useState(null),[y,w]=oe.useState(0),[x,A]=oe.useState(0),N=oe.useRef(null),R=()=>{const U=new Date;return U.setMinutes(U.getMinutes()-U.getTimezoneOffset()),U.toISOString().slice(0,16)},[k,H]=oe.useState(R()),[W,K]=oe.useState(0),[te,le]=oe.useState(0);oe.useEffect(()=>(c?N.current=window.setInterval(()=>{c==="left"&&w(U=>U+1),c==="right"&&A(U=>U+1)},1e3):N.current&&clearInterval(N.current),()=>{N.current&&clearInterval(N.current)}),[c]);const ee=U=>{f(c===U?null:U)},de=()=>{const U=y+x;if(U===0){n();return}let V="left";y>0&&x>0?V="both":x>y&&(V="right"),e({type:"breast",side:V,durationSeconds:U,leftDuration:y,rightDuration:x,timestamp:new Date().toISOString()}),n()},Ee=()=>{const U=W*60,V=te*60,F=U+V;if(F===0){alert("Please enter a duration for at least one side.");return}let Q="left";U>0&&V>0?Q="both":V>U&&(Q="right"),e({type:"breast",side:Q,durationSeconds:F,leftDuration:U,rightDuration:V,timestamp:new Date(k).toISOString()}),n()},me=y+x;return h.jsxs("div",{className:"fixed inset-0 bg-rose-900/95 z-[1000] flex flex-col items-center justify-center p-6 text-white overflow-y-auto",children:[h.jsxs("div",{className:"w-full max-w-sm mb-6 flex justify-center bg-white/10 rounded-lg p-1",children:[h.jsx("button",{onClick:()=>o("timer"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-colors ${i==="timer"?"bg-white text-rose-900 shadow-sm":"text-white/70 hover:text-white hover:bg-white/5"}`,children:"Timer"}),h.jsx("button",{onClick:()=>o("manual"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-colors ${i==="manual"?"bg-white text-rose-900 shadow-sm":"text-white/70 hover:text-white hover:bg-white/5"}`,children:"Manual Entry"})]}),i==="timer"?h.jsxs(h.Fragment,{children:[h.jsx("h2",{className:"text-2xl font-bold mb-2 opacity-80",children:"Nursing Timer"}),h.jsx("div",{className:"text-7xl font-mono font-bold mb-8 tracking-wider tabular-nums",children:xm(me)}),h.jsxs("div",{className:"flex gap-4 w-full max-w-sm mb-12",children:[h.jsxs("button",{onClick:()=>ee("left"),className:`flex-1 aspect-square rounded-full flex flex-col items-center justify-center border-4 transition-all relative ${c==="left"?"bg-white text-rose-600 border-white scale-105 shadow-[0_0_30px_rgba(255,255,255,0.4)]":"border-white/30 text-white hover:bg-white/10"}`,children:[h.jsx("span",{className:"text-4xl font-bold mb-1",children:"L"}),h.jsx("span",{className:"text-lg font-mono font-bold",children:xm(y)}),c==="left"&&h.jsx("span",{className:"absolute bottom-4 text-[10px] font-bold uppercase animate-pulse",children:"Active"}),t==="left"&&c!=="left"&&h.jsx("span",{className:"absolute -top-3 bg-rose-500 text-white text-[10px] px-2 py-0.5 rounded-full border border-white font-bold shadow-sm",children:"Last Side"})]}),h.jsxs("button",{onClick:()=>ee("right"),className:`flex-1 aspect-square rounded-full flex flex-col items-center justify-center border-4 transition-all relative ${c==="right"?"bg-white text-rose-600 border-white scale-105 shadow-[0_0_30px_rgba(255,255,255,0.4)]":"border-white/30 text-white hover:bg-white/10"}`,children:[h.jsx("span",{className:"text-4xl font-bold mb-1",children:"R"}),h.jsx("span",{className:"text-lg font-mono font-bold",children:xm(x)}),c==="right"&&h.jsx("span",{className:"absolute bottom-4 text-[10px] font-bold uppercase animate-pulse",children:"Active"}),t==="right"&&c!=="right"&&h.jsx("span",{className:"absolute -top-3 bg-rose-500 text-white text-[10px] px-2 py-0.5 rounded-full border border-white font-bold shadow-sm",children:"Last Side"})]})]}),h.jsxs("div",{className:"flex gap-4 w-full max-w-sm",children:[h.jsx("button",{onClick:n,className:"flex-1 py-4 rounded-xl font-bold border border-white/30 text-white hover:bg-white/10",children:"Discard"}),h.jsx("button",{onClick:de,className:"flex-[2] py-4 rounded-xl font-bold bg-white text-rose-600 shadow-lg hover:bg-rose-50 transition-colors",children:"Finish Feed"})]})]}):h.jsxs("div",{className:"w-full max-w-sm bg-white/10 p-6 rounded-2xl backdrop-blur-md border border-white/20",children:[h.jsx("h3",{className:"text-xl font-bold mb-6 text-center",children:"Add Past Feed"}),h.jsxs("div",{className:"space-y-6 mb-8",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs uppercase font-bold text-white/70 mb-1.5",children:"Date & Time"}),h.jsx("input",{type:"datetime-local",value:k,onChange:U=>H(U.target.value),className:"w-full bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white text-sm focus:ring-rose-400 focus:border-rose-400 placeholder-white/30"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs uppercase font-bold text-white/70 mb-1.5 text-center",children:"Left (min)"}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("button",{onClick:()=>K(Math.max(0,W-1)),className:"w-8 h-12 bg-white/10 rounded-l-xl flex items-center justify-center hover:bg-white/20",children:"-"}),h.jsx("input",{type:"number",value:W,onChange:U=>K(parseInt(U.target.value)||0),className:"w-full bg-black/20 border-y border-x-0 border-white/10 py-3 text-white text-xl font-mono text-center focus:ring-0"}),h.jsx("button",{onClick:()=>K(W+1),className:"w-8 h-12 bg-white/10 rounded-r-xl flex items-center justify-center hover:bg-white/20",children:"+"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs uppercase font-bold text-white/70 mb-1.5 text-center",children:"Right (min)"}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("button",{onClick:()=>le(Math.max(0,te-1)),className:"w-8 h-12 bg-white/10 rounded-l-xl flex items-center justify-center hover:bg-white/20",children:"-"}),h.jsx("input",{type:"number",value:te,onChange:U=>le(parseInt(U.target.value)||0),className:"w-full bg-black/20 border-y border-x-0 border-white/10 py-3 text-white text-xl font-mono text-center focus:ring-0"}),h.jsx("button",{onClick:()=>le(te+1),className:"w-8 h-12 bg-white/10 rounded-r-xl flex items-center justify-center hover:bg-white/20",children:"+"})]})]})]})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:n,className:"flex-1 py-3 rounded-xl font-bold border border-white/30 text-white hover:bg-white/10",children:"Cancel"}),h.jsx("button",{onClick:Ee,className:"flex-[2] py-3 rounded-xl font-bold bg-white text-rose-600 shadow-lg hover:bg-rose-50",children:"Save Entry"})]})]})]})},J6=({onClose:n,onSave:e})=>{const[t,i]=oe.useState(2);return h.jsx("div",{className:"fixed inset-0 bg-black/60 z-[1000] flex items-end sm:items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white w-full max-w-sm rounded-2xl p-6 animate-popIn",children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-6 text-center",children:"Bottle Feed"}),h.jsxs("div",{className:"flex items-center justify-center gap-6 mb-8",children:[h.jsx("button",{onClick:()=>i(Math.max(.5,t-.5)),className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center text-2xl font-bold text-gray-600",children:"-"}),h.jsxs("div",{className:"text-center",children:[h.jsx("span",{className:"text-5xl font-bold text-rose-600",children:t}),h.jsx("span",{className:"text-gray-500 font-medium ml-1",children:"oz"})]}),h.jsx("button",{onClick:()=>i(t+.5),className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center text-2xl font-bold text-gray-600",children:"+"})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:n,className:"flex-1 py-3 text-gray-600 font-bold bg-gray-100 rounded-xl",children:"Cancel"}),h.jsx("button",{onClick:()=>{e({type:"bottle",amount:t}),n()},className:"flex-1 py-3 text-white font-bold bg-rose-600 rounded-xl shadow-md",children:"Log Feed"})]})]})})},Q6=({onClose:n,onSave:e})=>{const[t,i]=oe.useState(0),[o,c]=oe.useState(0),f=t+o,y=(w,x)=>{w==="left"&&i(Math.max(0,t+x)),w==="right"&&c(Math.max(0,o+x))};return h.jsx("div",{className:"fixed inset-0 bg-black/60 z-[1000] flex items-end sm:items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white w-full max-w-sm rounded-2xl p-6 animate-popIn",children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 text-center",children:"Pumping Session"}),h.jsx("p",{className:"text-center text-gray-500 text-sm mb-6",children:"Log expressed milk from each side"}),h.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[h.jsxs("div",{className:"bg-purple-50 p-3 rounded-xl border border-purple-100 flex flex-col items-center",children:[h.jsx("span",{className:"text-xs font-bold text-purple-400 uppercase mb-2",children:"Left Breast"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>y("left",-.5),className:"w-8 h-8 rounded-full bg-white border border-purple-100 font-bold text-purple-600 shadow-sm",children:"-"}),h.jsxs("div",{className:"text-center min-w-[50px]",children:[h.jsx("span",{className:"text-2xl font-bold text-purple-700",children:t}),h.jsx("span",{className:"text-xs text-purple-400 ml-0.5",children:"oz"})]}),h.jsx("button",{onClick:()=>y("left",.5),className:"w-8 h-8 rounded-full bg-white border border-purple-100 font-bold text-purple-600 shadow-sm",children:"+"})]})]}),h.jsxs("div",{className:"bg-purple-50 p-3 rounded-xl border border-purple-100 flex flex-col items-center",children:[h.jsx("span",{className:"text-xs font-bold text-purple-400 uppercase mb-2",children:"Right Breast"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>y("right",-.5),className:"w-8 h-8 rounded-full bg-white border border-purple-100 font-bold text-purple-600 shadow-sm",children:"-"}),h.jsxs("div",{className:"text-center min-w-[50px]",children:[h.jsx("span",{className:"text-2xl font-bold text-purple-700",children:o}),h.jsx("span",{className:"text-xs text-purple-400 ml-0.5",children:"oz"})]}),h.jsx("button",{onClick:()=>y("right",.5),className:"w-8 h-8 rounded-full bg-white border border-purple-100 font-bold text-purple-600 shadow-sm",children:"+"})]})]})]}),h.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl mb-6 text-center border border-gray-100 flex justify-between items-center px-6",children:[h.jsx("span",{className:"text-sm text-gray-500 font-medium",children:"Total Yield"}),h.jsxs("span",{className:"text-2xl font-black text-purple-600",children:[f," oz"]})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:n,className:"flex-1 py-3 text-gray-600 font-bold bg-gray-100 rounded-xl",children:"Cancel"}),h.jsx("button",{onClick:()=>{e({type:"pump",amount:f,leftAmount:t,rightAmount:o}),n()},className:"flex-1 py-3 text-white font-bold bg-purple-600 rounded-xl shadow-md",children:"Log Pump"})]})]})})},Z6=({onClose:n,onSave:e})=>h.jsx("div",{className:"fixed inset-0 bg-black/60 z-[1000] flex items-end sm:items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white w-full max-w-sm rounded-2xl p-6 animate-popIn",children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-6 text-center",children:"Diaper Check"}),h.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[h.jsxs("button",{onClick:()=>{e("wet"),n()},className:"aspect-square rounded-xl bg-blue-50 border-2 border-blue-100 flex flex-col items-center justify-center gap-2 hover:bg-blue-100 transition-colors group",children:[h.jsx(ue,{name:"droplet",className:"w-10 h-10 text-blue-500 group-hover:scale-110 transition-transform"}),h.jsx("span",{className:"font-bold text-blue-700",children:"Wet"})]}),h.jsxs("button",{onClick:()=>{e("dirty"),n()},className:"aspect-square rounded-xl bg-orange-50 border-2 border-orange-100 flex flex-col items-center justify-center gap-2 hover:bg-orange-100 transition-colors group",children:[h.jsx(xw,{className:"w-10 h-10 text-orange-700 group-hover:scale-110 transition-transform"}),h.jsx("span",{className:"font-bold text-orange-800",children:"Dirty"})]}),h.jsxs("button",{onClick:()=>{e("mixed"),n()},className:"aspect-square rounded-xl bg-purple-50 border-2 border-purple-100 flex flex-col items-center justify-center gap-2 hover:bg-purple-100 transition-colors group",children:[h.jsxs("div",{className:"flex gap-1 group-hover:scale-110 transition-transform",children:[h.jsx(ue,{name:"droplet",className:"w-5 h-5 text-blue-500"}),h.jsx(xw,{className:"w-5 h-5 text-orange-700"})]}),h.jsx("span",{className:"font-bold text-purple-700",children:"Both"})]})]}),h.jsx("button",{onClick:n,className:"w-full py-3 text-gray-500 font-bold hover:bg-gray-50 rounded-xl transition-colors",children:"Cancel"})]})}),eM=({onClose:n,onSave:e})=>{const[t,i]=oe.useState(""),[o,c]=oe.useState(""),[f,y]=oe.useState(""),[w,x]=oe.useState(null),[A,N]=oe.useState(!1),[R,k]=oe.useState(null),H=async()=>{if(!t.trim()||!o.trim()){k("Please enter medicine name and baby's weight.");return}N(!0),k(null);try{const K=await E6(t,o);x(K)}catch{k("Could not retrieve safety info. Please consult your doctor.")}finally{N(!1)}},W=()=>{t.trim()&&(e({id:crypto.randomUUID(),medicineName:t,amount:f,timestamp:new Date().toISOString(),notes:`Weight at time of dose: ${o}`}),n())};return h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-90 flex items-center justify-center p-4 z-[1000]",children:h.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl p-6 animate-popIn flex flex-col max-h-[90vh]",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsxs("h3",{className:"text-xl font-bold text-teal-800 flex items-center gap-2",children:[h.jsx(ue,{name:"pill",className:"w-6 h-6"})," Medicine Tracker"]}),h.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:h.jsx(ue,{name:"x"})})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 pr-1",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Medicine Name"}),h.jsx("input",{value:t,onChange:K=>i(K.target.value),placeholder:"e.g. Infant Tylenol",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 text-sm"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Baby's Weight (required for safety check)"}),h.jsx("input",{value:o,onChange:K=>c(K.target.value),placeholder:"e.g. 15 lbs or 7 kg",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 text-sm"})]}),!w&&h.jsxs("button",{onClick:H,disabled:A||!t||!o,className:"w-full py-2 bg-teal-100 text-teal-700 rounded-lg font-bold text-sm hover:bg-teal-200 transition-colors disabled:opacity-50 flex justify-center items-center gap-2",children:[A?h.jsx("div",{className:"spinner w-4 h-4 border-teal-600"}):h.jsx(ue,{name:"shield-check",className:"w-4 h-4"})," Get Safety Info"]}),R&&h.jsx("p",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:R}),w&&h.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 space-y-3 text-sm animate-fadeIn",children:[h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsx(ue,{name:"alert-triangle",className:"w-5 h-5 text-orange-600 shrink-0 mt-0.5"}),h.jsx("p",{className:"font-bold text-orange-800 text-xs leading-relaxed",children:w.critical_warning})]}),h.jsxs("div",{className:"bg-white/60 p-2 rounded border border-orange-100",children:[h.jsx("p",{className:"text-xs font-bold text-orange-700 uppercase mb-1",children:"Safe Administration Checklist:"}),h.jsx("ul",{className:"list-disc pl-4 space-y-1 text-gray-700 text-xs",children:w.safe_administration_checklist.map((K,te)=>h.jsx("li",{children:K},te))})]}),w.source_tip&&h.jsxs("p",{className:"text-[10px] text-gray-500 italic border-t border-orange-200 pt-2 flex items-center gap-1",children:[h.jsx(ue,{name:"phone",className:"w-3 h-3"})," ",w.source_tip]})]}),h.jsxs("div",{className:"border-t pt-4",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dosage Given (Optional)"}),h.jsx("input",{value:f,onChange:K=>y(K.target.value),placeholder:"e.g. 2.5 ml",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 text-sm"}),h.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Only enter after confirming safe dosage with a doctor."})]})]}),h.jsxs("div",{className:"mt-6 pt-4 border-t flex gap-3",children:[h.jsx("button",{onClick:n,className:"flex-1 py-2 text-gray-600 font-bold bg-gray-100 rounded-lg",children:"Cancel"}),h.jsx("button",{onClick:W,className:"flex-1 py-2 text-white font-bold bg-teal-600 rounded-lg shadow-md hover:bg-teal-700",children:"Log Dose"})]})]})})},tM=({feedLogs:n,diaperLogs:e,userProfile:t})=>{const[i,o]=oe.useState(null),[c,f]=oe.useState(!1),[y,w]=oe.useState(null),x=oe.useMemo(()=>{const R=new Date,k=new Date(R.getTime()-1440*60*1e3),H=n.filter(Q=>new Date(Q.timestamp)>=k),W=e.filter(Q=>new Date(Q.timestamp)>=k),K=W.filter(Q=>Q.type==="wet"||Q.type==="mixed").length,te=W.filter(Q=>Q.type==="dirty"||Q.type==="mixed").length,le=H.filter(Q=>Q.type==="bottle").reduce((Q,Y)=>Q+(Y.amount||0),0),ee=H.length,de=new Date;de.setHours(0,0,0,0);const Ee=new Date(de);Ee.setDate(de.getDate()-1);const me=n.filter(Q=>Q.type==="breast"&&new Date(Q.timestamp)>=de),U=n.filter(Q=>Q.type==="breast"&&new Date(Q.timestamp)>=Ee&&new Date(Q.timestamp)<de),V=Math.round(me.reduce((Q,Y)=>Q+(Y.durationSeconds||0),0)/60),F=Math.round(U.reduce((Q,Y)=>Q+(Y.durationSeconds||0),0)/60);return{wetDiapers:K,dirtyDiapers:te,totalFeedOz:le,totalFeeds:ee,todayNursingMinutes:V,yesterdayNursingMinutes:F}},[n,e]),A=async()=>{f(!0),w(null);try{const k=`${t!=null&&t.birthDate?ku(t.birthDate):3} months old`,H=await x6(k,x);o(H)}catch(R){console.error(R),w("Sage couldn't connect to safety databases or parse the response right now.")}finally{f(!1)}},N=R=>R==="Normal"?"bg-green-100 text-green-800 border-green-200":R==="Watch Closely"||R==="Low"||R==="High"?"bg-yellow-100 text-yellow-800 border-yellow-200":R==="Contact Pediatrician"?"bg-red-100 text-red-800 border-red-200":"bg-gray-100 text-gray-800";return h.jsx("div",{className:"space-y-6 pb-24",children:h.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"p-2 bg-teal-100 rounded-full",children:h.jsx(ue,{name:"activity",className:"w-6 h-6 text-teal-600"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Daily Safety Check"}),h.jsx("p",{className:"text-xs text-gray-500",children:"Compare your last 24h totals against medical guidelines."})]})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-6",children:[h.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-center",children:[h.jsx("span",{className:"block text-xl font-bold text-gray-800",children:x.wetDiapers}),h.jsx("span",{className:"text-[10px] uppercase font-bold text-gray-400",children:"Wet Diapers"})]}),h.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-center",children:[h.jsx("span",{className:"block text-xl font-bold text-gray-800",children:x.dirtyDiapers}),h.jsx("span",{className:"text-[10px] uppercase font-bold text-gray-400",children:"Dirty Diapers"})]}),h.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-center",children:[h.jsx("span",{className:"block text-xl font-bold text-gray-800",children:x.totalFeedOz>0?`${x.totalFeedOz}oz`:`${x.totalFeeds}x`}),h.jsx("span",{className:"text-[10px] uppercase font-bold text-gray-400",children:"Intake (24h)"})]})]}),h.jsxs("div",{className:"bg-rose-50 border border-rose-100 rounded-xl p-4 mb-6",children:[h.jsxs("h4",{className:"text-xs font-bold text-rose-800 uppercase tracking-wide mb-3 flex items-center gap-2",children:[h.jsx(ue,{name:"clock",className:"w-3 h-3"})," Nursing Duration (Today vs Yesterday)"]}),h.jsx("div",{className:"flex items-end gap-2 mb-1",children:h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[h.jsx("span",{className:"text-rose-700 font-medium",children:"Today"}),h.jsxs("span",{className:"text-rose-900 font-bold",children:[x.todayNursingMinutes,"m"]})]}),h.jsx("div",{className:"w-full bg-rose-200 rounded-full h-2",children:h.jsx("div",{className:"bg-rose-500 h-2 rounded-full",style:{width:`${Math.min(100,x.todayNursingMinutes/(Math.max(x.yesterdayNursingMinutes,1)*1.5)*100)}%`}})})]})}),h.jsx("div",{className:"flex items-end gap-2 opacity-60",children:h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[h.jsx("span",{className:"text-rose-700 font-medium",children:"Yesterday"}),h.jsxs("span",{className:"text-rose-900 font-bold",children:[x.yesterdayNursingMinutes,"m"]})]}),h.jsx("div",{className:"w-full bg-rose-200 rounded-full h-2",children:h.jsx("div",{className:"bg-rose-500 h-2 rounded-full",style:{width:`${Math.min(100,x.yesterdayNursingMinutes/(Math.max(x.todayNursingMinutes,1)*1.5)*100)}%`}})})]})})]}),i?h.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[h.jsxs("div",{className:`p-4 rounded-xl border text-center ${N(i.overall_status)}`,children:[h.jsx("p",{className:"text-xs font-bold uppercase tracking-wider mb-1",children:"Overall Assessment"}),h.jsx("p",{className:"text-2xl font-black",children:i.overall_status})]}),h.jsx("div",{className:"space-y-3",children:i.data_points.map((R,k)=>h.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm",children:[h.jsxs("div",{className:"flex justify-between items-start mb-2",children:[h.jsx("h4",{className:"font-bold text-gray-800",children:R.metric}),h.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded-full ${N(R.status)}`,children:R.status})]}),h.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-2",children:[h.jsxs("span",{children:["Your value: ",h.jsx("strong",{children:R.value_logged})]}),h.jsxs("span",{children:["Normal: ",R.normal_range]})]}),h.jsx("p",{className:"text-xs text-gray-500 bg-gray-50 p-2 rounded",children:R.guidance})]},k))}),h.jsxs("div",{className:"p-3 bg-orange-50 border border-orange-100 rounded-lg flex gap-2 items-start",children:[h.jsx(ue,{name:"alert-triangle",className:"w-4 h-4 text-orange-500 mt-0.5 flex-shrink-0"}),h.jsx("p",{className:"text-xs text-orange-800 font-medium",children:i.disclaimer_warning})]}),h.jsx("button",{onClick:A,className:"w-full py-2 text-sm text-teal-600 font-bold hover:bg-teal-50 rounded-lg transition-colors",children:"Refresh Check"})]}):h.jsx("button",{onClick:A,disabled:c,className:"w-full py-3 bg-teal-600 text-white font-bold rounded-xl shadow-md hover:bg-teal-700 flex items-center justify-center gap-2 disabled:opacity-50",children:c?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"})," Checking Guidelines..."]}):h.jsxs(h.Fragment,{children:[h.jsx(ue,{name:"shield-check",className:"w-5 h-5"})," Is This Normal?"]})}),y&&h.jsx("p",{className:"text-sm text-red-600 mt-4 text-center bg-red-50 p-2 rounded",children:y})]})})},nM=({sleepLogs:n,growthLogs:e,onLogGrowth:t,onDeleteGrowth:i,userProfile:o})=>{const[c,f]=oe.useState("sleep"),[y,w]=oe.useState(null),[x,A]=oe.useState(!1),[N,R]=oe.useState(null),k=async()=>{A(!0),R(null);try{const H=new Date(Date.now()-1728e5),W=n.filter(Ee=>new Date(Ee.startTime)>=H&&Ee.endTime).sort((Ee,me)=>new Date(Ee.startTime).getTime()-new Date(me.startTime).getTime()),te=[...n].sort((Ee,me)=>new Date(me.startTime).getTime()-new Date(Ee.startTime).getTime())[0];if(te&&!te.endTime){R("Baby is currently sleeping! Wake them up to predict the next nap."),A(!1);return}const le=te?te.endTime:new Date().toISOString(),ee=W.map(Ee=>`Sleep: ${new Date(Ee.startTime).toLocaleTimeString()} - Wake: ${new Date(Ee.endTime).toLocaleTimeString()}`).join(`
`),de=await p6(new Date().toLocaleTimeString(),new Date(le).toLocaleTimeString(),ee||"No recent sleep data found.");w(de)}catch(H){console.error(H),R("Sage is having trouble predicting right now.")}finally{A(!1)}};return h.jsxs("div",{className:"space-y-4 pb-24",children:[h.jsxs("div",{className:"flex border border-indigo-100 rounded-xl overflow-hidden bg-white p-1",children:[h.jsx("button",{onClick:()=>f("sleep"),className:`flex-1 py-2 text-sm font-bold rounded-lg transition-all ${c==="sleep"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Sleep"}),h.jsx("button",{onClick:()=>f("growth"),className:`flex-1 py-2 text-sm font-bold rounded-lg transition-all ${c==="growth"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Growth"})]}),c==="sleep"?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 p-6 rounded-2xl shadow-sm relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:h.jsx(ue,{name:"moon",className:"w-32 h-32 text-indigo-900"})}),h.jsx("h2",{className:"text-xl font-bold text-indigo-900 mb-2 relative z-10",children:"Sleep Sweet Spot"}),h.jsx("p",{className:"text-sm text-indigo-700 mb-6 relative z-10 max-w-xs",children:"Sage analyzes your recent logs to find the perfect window for the next nap."}),y?h.jsx("div",{className:"bg-white rounded-xl p-5 shadow-sm relative z-10 animate-fadeIn border border-indigo-100",children:y.prediction_status==="Ready"?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Target Nap Time"}),h.jsx("p",{className:"text-3xl font-black text-indigo-600 mt-1",children:y.next_sweet_spot_start})]}),h.jsxs("div",{className:"bg-indigo-50 p-2 rounded-lg text-center min-w-[80px]",children:[h.jsx("p",{className:"text-[10px] text-indigo-400 uppercase font-bold",children:"Avg Window"}),h.jsxs("p",{className:"text-lg font-bold text-indigo-700",children:[y.average_wake_window_minutes,"m"]})]})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex gap-2 items-start",children:[h.jsx(ue,{name:"info",className:"w-4 h-4 text-indigo-500 mt-0.5 flex-shrink-0"}),h.jsx("p",{className:"text-sm text-gray-600",children:y.reasoning_summary})]}),h.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg border border-yellow-100 flex gap-2 items-start",children:[h.jsx(ue,{name:"lightbulb",className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),h.jsx("p",{className:"text-xs text-yellow-800 font-medium",children:y.troubleshooting_tip})]})]}),h.jsx("button",{onClick:k,className:"w-full mt-4 py-2 text-xs font-bold text-indigo-400 hover:text-indigo-600 border-t border-gray-100",children:"Refresh Prediction"})]}):h.jsxs("div",{className:"text-center py-4",children:[h.jsx(ue,{name:"alert-circle",className:"w-8 h-8 text-orange-400 mx-auto mb-2"}),h.jsx("h3",{className:"font-bold text-gray-700",children:"Needs More Data"}),h.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Keep logging sleeps! We need about 48 hours of consistent data to find the pattern."})]})}):h.jsx("button",{onClick:k,disabled:x,className:"w-full bg-indigo-600 text-white font-bold py-3 rounded-xl shadow-md hover:bg-indigo-700 transition-all flex items-center justify-center gap-2 relative z-10",children:x?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"})," Analyzing Patterns..."]}):h.jsxs(h.Fragment,{children:[h.jsx(ue,{name:"sparkles",className:"w-4 h-4"})," Predict Next Nap"]})}),N&&h.jsx("p",{className:"text-sm text-red-600 font-medium mt-3 bg-red-50 p-2 rounded relative z-10 text-center",children:N})]}),h.jsxs("div",{className:"px-1",children:[h.jsx("h3",{className:"text-sm font-bold text-gray-500 mb-3 px-1 uppercase tracking-wide",children:"Recent Sleep Logs"}),n.length===0?h.jsx("div",{className:"text-center py-8 bg-gray-50 rounded-xl border border-dashed border-gray-300",children:h.jsx("p",{className:"text-sm text-gray-400",children:"No sleep logs yet."})}):n.slice(0,10).map(H=>h.jsxs("div",{className:"flex items-center justify-between p-4 mb-2 bg-white rounded-xl border border-gray-100 shadow-sm",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${H.endTime?"bg-indigo-50 text-indigo-500":"bg-green-50 text-green-600 animate-pulse"}`,children:h.jsx(ue,{name:"moon",className:"w-5 h-5"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-bold text-gray-800 text-sm",children:H.endTime?"Nap":"Sleeping Now..."}),h.jsxs("p",{className:"text-xs text-gray-500",children:[new Date(H.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),H.endTime&&` - ${new Date(H.endTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`]})]})]}),H.endTime&&h.jsxs("span",{className:"text-xs font-bold text-indigo-400 bg-indigo-50 px-2 py-1 rounded",children:[Math.round((new Date(H.endTime).getTime()-new Date(H.startTime).getTime())/6e4),"m"]})]},H.id))]})]}):h.jsx(o2,{logs:e,onSave:t,onDelete:i,baseColor:"indigo",userProfile:o})]})},iM=({currentPage:n,feedLogs:e,diaperLogs:t,sleepLogs:i,medicineLogs:o=[],growthLogs:c=[],onLogFeed:f,onLogDiaper:y,onLogSleep:w,onUpdateSleepLog:x,onLogMedicine:A,onLogGrowth:N=()=>{},onDeleteGrowth:R=()=>{},baseColor:k="rose",userProfile:H,onUpdateProfile:W})=>{const[K,te]=oe.useState(!1),[le,ee]=oe.useState(!1),[de,Ee]=oe.useState(!1),[me,U]=oe.useState(!1),[V,F]=oe.useState(!1),[Q,Y]=oe.useState(!1),$=(H==null?void 0:H.feedIntervalHours)||3,z=e.find(Ae=>Ae.type!=="pump"),_e=t[0],he=i[0];o[0];const ne=he&&!he.endTime,ie=z?new Date(new Date(z.timestamp).getTime()+$*60*60*1e3):null,Me=()=>{navigator.vibrate&&navigator.vibrate(50)},ze=()=>{Me(),Y(!0)},ct=()=>{Me(),ne&&x?x({...he,endTime:new Date().toISOString()}):w({id:crypto.randomUUID(),type:"sleep",startTime:new Date().toISOString()})},ae=Ae=>{W&&H&&W({...H,feedIntervalHours:Number(Ae.target.value)})},Ie=Ae=>Ae.type==="bottle"?`${Ae.amount}oz`:Ae.type==="breast"?Ae.side==="both"?"Both Sides":Ae.side?`${Ae.side.charAt(0).toUpperCase()+Ae.side.slice(1)} Side`:`${Math.floor((Ae.durationSeconds||0)/60)}m`:"";return n==="sleep_growth"||n==="growth"?h.jsx(nM,{sleepLogs:i,growthLogs:c,onLogGrowth:N,onDeleteGrowth:R,userProfile:H||null}):n==="health_check"||n==="diapers"||n==="health"?h.jsx(tM,{feedLogs:e,diaperLogs:t,userProfile:H||null}):h.jsxs("div",{className:"flex flex-col h-[calc(100vh-140px)] relative",children:[h.jsxs("div",{className:"bg-gradient-to-r from-rose-50 to-white p-5 rounded-2xl shadow-sm border border-rose-100 mb-6",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsx("h2",{className:"text-lg font-bold text-rose-900",children:"Baby Status"}),h.jsx("span",{className:"text-xs font-semibold bg-white px-2 py-1 rounded-full text-rose-400 shadow-sm border border-rose-50",children:new Date().toLocaleDateString()})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[h.jsxs("div",{className:`p-4 rounded-xl border shadow-inner flex items-center justify-between transition-colors ${ne?"bg-indigo-100 border-indigo-200":"bg-gray-50 border-gray-100"} col-span-2 sm:col-span-1`,children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`p-2 rounded-full ${ne?"bg-indigo-200 text-indigo-700":"bg-amber-100 text-amber-500"}`,children:h.jsx(ue,{name:ne?"moon":"sun",className:"w-5 h-5"})}),h.jsxs("div",{children:[h.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wide block ${ne?"text-indigo-700":"text-gray-400"}`,children:"Status"}),h.jsx("span",{className:`text-base font-bold ${ne?"text-indigo-900":"text-gray-800"}`,children:ne?"Asleep":"Awake"})]})]}),ne&&h.jsx("span",{className:"text-xs font-bold text-indigo-600 animate-pulse",children:"Zzz..."})]}),h.jsxs("div",{className:"bg-white p-4 rounded-xl border border-rose-100 shadow-sm flex flex-col justify-center col-span-2 sm:col-span-1",children:[h.jsxs("div",{className:"flex justify-between items-center mb-1",children:[h.jsx("span",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-wide",children:"Next Feed"}),h.jsxs("div",{className:"relative",children:[h.jsxs("select",{value:$,onChange:ae,className:"appearance-none bg-rose-50 text-rose-600 text-[10px] font-bold py-0.5 pl-2 pr-4 rounded border border-rose-100 cursor-pointer focus:outline-none focus:ring-1 focus:ring-rose-300",children:[h.jsx("option",{value:"1.5",children:"1.5h"}),h.jsx("option",{value:"2",children:"2h"}),h.jsx("option",{value:"2.5",children:"2.5h"}),h.jsx("option",{value:"3",children:"3h"}),h.jsx("option",{value:"3.5",children:"3.5h"}),h.jsx("option",{value:"4",children:"4h"})]}),h.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-1 text-rose-500",children:h.jsx(ue,{name:"chevron-down",className:"w-2.5 h-2.5"})})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(ue,{name:"clock",className:"w-4 h-4 text-rose-300"}),h.jsx("span",{className:"text-lg font-bold text-gray-800",children:ie?ie.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--:--"})]})]}),h.jsxs("div",{className:"bg-white p-3 rounded-xl border border-rose-50 shadow-sm flex flex-col justify-center",children:[h.jsx("span",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-wide mb-1",children:"Last Fed"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(ue,{name:"milk",className:"w-4 h-4 text-rose-400"}),h.jsx("span",{className:"text-sm font-bold text-gray-800",children:z?yw(z.timestamp):"--"})]}),z&&h.jsx("span",{className:"text-[10px] text-gray-400 mt-0.5 ml-6",children:Ie(z)})]}),h.jsxs("div",{className:"bg-white p-3 rounded-xl border border-blue-50 shadow-sm flex flex-col justify-center",children:[h.jsx("span",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-wide mb-1",children:"Last Diaper"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(ue,{name:"baby",className:"w-4 h-4 text-blue-400"}),h.jsx("span",{className:"text-sm font-bold text-gray-800",children:_e?yw(_e.timestamp):"--"})]}),_e&&h.jsx("span",{className:"text-[10px] text-gray-400 mt-0.5 ml-6 capitalize",children:_e.type})]})]})]}),h.jsxs("div",{className:"grid grid-cols-4 gap-3 mb-6",children:[h.jsxs("button",{onClick:ze,className:"flex flex-col items-center gap-2 p-3 bg-white border border-rose-100 rounded-xl shadow-sm hover:bg-rose-50 transition-colors active:scale-95",children:[h.jsx("div",{className:"w-10 h-10 bg-rose-100 rounded-full flex items-center justify-center text-rose-600",children:h.jsx(ue,{name:"milk",className:"w-5 h-5"})}),h.jsx("span",{className:"text-xs font-bold text-gray-700",children:"Feed"})]}),h.jsxs("button",{onClick:()=>{Me(),Ee(!0)},className:"flex flex-col items-center gap-2 p-3 bg-white border border-blue-100 rounded-xl shadow-sm hover:bg-blue-50 transition-colors active:scale-95",children:[h.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600",children:h.jsx(ue,{name:"droplet",className:"w-5 h-5"})}),h.jsx("span",{className:"text-xs font-bold text-gray-700",children:"Diaper"})]}),h.jsxs("button",{onClick:ct,className:"flex flex-col items-center gap-2 p-3 bg-white border border-indigo-100 rounded-xl shadow-sm hover:bg-indigo-50 transition-colors active:scale-95",children:[h.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${ne?"bg-indigo-600 text-white":"bg-indigo-100 text-indigo-600"}`,children:h.jsx(ue,{name:ne?"sun":"moon",className:"w-5 h-5"})}),h.jsx("span",{className:"text-xs font-bold text-gray-700",children:ne?"Wake":"Sleep"})]}),h.jsxs("button",{onClick:()=>{Me(),U(!0)},className:"flex flex-col items-center gap-2 p-3 bg-white border border-teal-100 rounded-xl shadow-sm hover:bg-teal-50 transition-colors active:scale-95",children:[h.jsx("div",{className:"w-10 h-10 bg-teal-100 rounded-full flex items-center justify-center text-teal-600",children:h.jsx(ue,{name:"pill",className:"w-5 h-5"})}),h.jsx("span",{className:"text-xs font-bold text-gray-700",children:"Meds"})]})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto -mx-4 px-4 pb-20",children:[h.jsx("h3",{className:"text-sm font-bold text-gray-500 mb-3 px-1",children:"Today's Logs"}),[...e,...t,...i,...o].sort((Ae,je)=>new Date(je.timestamp||je.startTime).getTime()-new Date(Ae.timestamp||Ae.startTime).getTime()).slice(0,20).map(Ae=>{let je="circle",rt="text-gray-400",pe="bg-gray-50",Ve="Event",Ke="";return Ae.amount!==void 0&&Ae.medicineName?(je="pill",rt="text-teal-600",pe="bg-teal-50",Ve=Ae.medicineName,Ke=Ae.amount||"Dose Logged"):Ae.amount!==void 0||Ae.durationSeconds!==void 0?Ae.type==="pump"?(je="activity",rt="text-purple-500",pe="bg-purple-50",Ve="Pumping Session",Ae.leftAmount>0&&Ae.rightAmount>0?Ke=`L: ${Ae.leftAmount}oz, R: ${Ae.rightAmount}oz`:Ae.leftAmount>0?Ke=`L: ${Ae.leftAmount}oz`:Ae.rightAmount>0?Ke=`R: ${Ae.rightAmount}oz`:Ke=`${Ae.amount}oz`):(je="milk",rt="text-rose-500",pe="bg-rose-50",Ve=Ae.type==="breast"?`Nursing (${Ae.side==="both"?"Both":Ae.side})`:"Bottle",Ke=Ae.type==="bottle"?`${Ae.amount}oz`:`${Math.floor(Ae.durationSeconds/60)}m`):Ae.type==="wet"||Ae.type==="dirty"||Ae.type==="mixed"?(je="baby",rt="text-blue-500",pe="bg-blue-50",Ve="Diaper",Ke=Ae.type):Ae.type==="sleep"&&(je="moon",rt="text-indigo-500",pe="bg-indigo-50",Ve="Sleep",Ke=Ae.endTime?`${Math.round((new Date(Ae.endTime).getTime()-new Date(Ae.startTime).getTime())/6e4)}m nap`:"Sleeping..."),h.jsxs("div",{className:"flex items-center gap-3 p-3 mb-2 bg-white rounded-xl border border-gray-100 shadow-sm",children:[h.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${pe}`,children:h.jsx(ue,{name:je,className:`w-5 h-5 ${rt}`})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h4",{className:"font-bold text-gray-800 text-sm",children:Ve}),h.jsx("p",{className:"text-xs text-gray-500 capitalize",children:Ke})]}),h.jsx("span",{className:"text-xs text-gray-400 font-medium",children:new Date(Ae.timestamp||Ae.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},Ae.id)})]}),Q&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 p-4",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-gray-100 w-full max-w-sm overflow-hidden animate-popIn",children:[h.jsxs("div",{className:"p-4 bg-rose-50 border-b border-rose-100 flex justify-between items-center",children:[h.jsx("h4",{className:"text-sm font-bold text-rose-800 uppercase",children:"Select Feed Type"}),h.jsx("button",{onClick:()=>Y(!1),className:"text-gray-400 hover:text-gray-600",children:h.jsx(ue,{name:"x"})})]}),h.jsxs("div",{className:"p-2",children:[h.jsxs("button",{onClick:()=>{Y(!1),te(!0)},className:"w-full text-left p-3 hover:bg-gray-50 rounded-lg flex items-center gap-3 transition-colors",children:[h.jsx("div",{className:"p-2 bg-rose-100 text-rose-600 rounded-full",children:h.jsx(ue,{name:"clock",className:"w-5 h-5"})}),h.jsxs("div",{children:[h.jsx("span",{className:"block font-bold text-gray-800",children:"Breastfeeding Timer"}),h.jsx("span",{className:"text-xs text-gray-500",children:"Track duration and side"})]})]}),h.jsxs("button",{onClick:()=>{Y(!1),ee(!0)},className:"w-full text-left p-3 hover:bg-gray-50 rounded-lg flex items-center gap-3 transition-colors",children:[h.jsx("div",{className:"p-2 bg-rose-100 text-rose-600 rounded-full",children:h.jsx(ue,{name:"milk",className:"w-5 h-5"})}),h.jsxs("div",{children:[h.jsx("span",{className:"block font-bold text-gray-800",children:"Bottle Log"}),h.jsx("span",{className:"text-xs text-gray-500",children:"Track amount in oz/ml"})]})]}),h.jsxs("button",{onClick:()=>{Y(!1),F(!0)},className:"w-full text-left p-3 hover:bg-gray-50 rounded-lg flex items-center gap-3 transition-colors",children:[h.jsx("div",{className:"p-2 bg-purple-100 text-purple-600 rounded-full",children:h.jsx(ue,{name:"activity",className:"w-5 h-5"})}),h.jsxs("div",{children:[h.jsx("span",{className:"block font-bold text-gray-800",children:"Pumping Session"}),h.jsx("span",{className:"text-xs text-gray-500",children:"Log expressed output"})]})]})]})]})}),K&&h.jsx($6,{onClose:()=>te(!1),onSave:Ae=>f({id:crypto.randomUUID(),timestamp:new Date().toISOString(),...Ae}),lastSide:(z==null?void 0:z.type)==="breast"?z.side:void 0}),le&&h.jsx(J6,{onClose:()=>ee(!1),onSave:Ae=>f({id:crypto.randomUUID(),timestamp:new Date().toISOString(),...Ae})}),V&&h.jsx(Q6,{onClose:()=>F(!1),onSave:Ae=>f({id:crypto.randomUUID(),timestamp:new Date().toISOString(),...Ae})}),de&&h.jsx(Z6,{onClose:()=>Ee(!1),onSave:Ae=>y({id:crypto.randomUUID(),timestamp:new Date().toISOString(),type:Ae})}),me&&A&&h.jsx(eM,{onClose:()=>U(!1),onSave:A})]})},sM=({growthLogs:n,onLogGrowth:e,onDeleteGrowth:t,baseColor:i="indigo",userProfile:o})=>h.jsxs("div",{className:"h-full overflow-y-auto",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Growth Tracker"}),h.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Track height and weight milestones."}),h.jsx(o2,{logs:n,onSave:e,onDelete:t,baseColor:i,userProfile:o})]}),rM=[{value:1,emoji:"",text:"Hated it"},{value:3,emoji:"",text:"Meh"},{value:5,emoji:"",text:"Liked it"},{value:7,emoji:"",text:"Loved it!"}],oM=["none","hives","vomiting","swelling","gas","other"],aM=["breakfast","lunch","dinner","snack"],lM=[{value:"no",text:"Just a taste",icon:"minus-circle"},{value:"yes",text:"More than 1 bite",icon:"plus-circle"}],cM=["Refused to Sit","Threw Food","Touched but didn't eat","Spat out"],uM=n=>n<=2?{emoji:"",text:"Hated it"}:n<=4?{emoji:"",text:"Meh"}:n>=7?{emoji:"",text:"Loved it!"}:{emoji:"",text:"Liked it"},dM=({food:n,existingLog:e,onSave:t,onClose:i,baseColor:o,appMode:c})=>{const[f,y]=oe.useState((e==null?void 0:e.meal)||""),[w,x]=oe.useState((e==null?void 0:e.reaction)||0),[A,N]=oe.useState((e==null?void 0:e.allergyReaction)||""),[R,k]=oe.useState((e==null?void 0:e.date)||new Date().toISOString().split("T")[0]),[H,W]=oe.useState(e?e.moreThanOneBite?"yes":"no":""),[K,te]=oe.useState((e==null?void 0:e.notes)||""),[le,ee]=oe.useState((e==null?void 0:e.tryCount)||1),[de,Ee]=oe.useState(e==null?void 0:e.messyFaceImage),[me,U]=oe.useState((e==null?void 0:e.behavioralTags)||[]),[V,F]=oe.useState(!1),Q=oe.useRef(null),Y=A&&A!=="none",$=c==="TODDLER",z=ie=>{e&&(ie==="yes"&&H!=="yes"?ee(Me=>Me+1):ie==="no"&&H==="yes"&&ee(Me=>Math.max(1,Me-1))),W(ie)},_e=ie=>{U(Me=>Me.includes(ie)?Me.filter(ze=>ze!==ie):[...Me,ie])},he=async ie=>{var ze;const Me=(ze=ie.target.files)==null?void 0:ze[0];if(Me){F(!0);try{const ct=await Y6(Me,300);Ee(ct)}catch(ct){console.error(ct),alert("Failed to process image. Try a smaller file.")}finally{F(!1)}}},ne=ie=>{if(ie.preventDefault(),!f||!w||!A||!H){alert("Please fill out all required fields.");return}t(n.name,{meal:f,reaction:w,allergyReaction:A,date:R,moreThanOneBite:H==="yes",notes:K,tryCount:le,messyFaceImage:de,behavioralTags:me})};return h.jsxs("form",{onSubmit:ne,className:"modal-scroll-content p-6 space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"1. Meal"}),h.jsx("div",{className:"grid grid-cols-4 gap-2",children:aM.map(ie=>h.jsx("button",{type:"button",onClick:()=>y(ie),className:`text-sm p-2 border border-gray-300 rounded-lg text-gray-600 hover:border-gray-400 ${f===ie?`bg-${o}-50 border-${o}-500 text-${o}-600`:""}`,children:ie.charAt(0).toUpperCase()+ie.slice(1)},ie))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"2. How did baby react?"}),h.jsx("div",{className:"grid grid-cols-4 gap-2",children:rM.map(ie=>h.jsxs("button",{type:"button",onClick:()=>x(ie.value),className:`text-lg p-2 border border-gray-300 rounded-lg flex flex-col items-center text-gray-600 hover:border-gray-400 ${w===ie.value?`bg-${o}-50 border-${o}-500 text-${o}-600`:""}`,children:[h.jsx("span",{children:ie.emoji}),h.jsx("span",{className:"text-xs mt-1",children:ie.text})]},ie.value))})]}),h.jsxs("div",{className:`rounded-lg transition-all duration-300 ${Y?"p-3 bg-red-50 border border-red-200 -mx-3":""}`,children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("label",{className:`block text-sm font-medium ${Y?"text-red-800":"text-gray-700"}`,children:"3. Any sign of reaction?"}),Y&&h.jsxs("div",{className:"flex items-center text-red-600 text-xs font-bold animate-pulse",children:[h.jsx(ue,{name:"alert-triangle",className:"w-4 h-4 mr-1"}),h.jsx("span",{children:"Attention Needed"})]})]}),h.jsx("div",{className:"grid grid-cols-3 gap-2",children:oM.map(ie=>{const Me=A===ie;let ze="capitalize text-sm p-2 border border-gray-300 rounded-lg text-gray-600 hover:border-gray-400 transition-colors";return Me&&(ie!=="none"?ze="capitalize text-sm p-2 border border-red-500 bg-red-100 text-red-800 font-medium rounded-lg shadow-sm":ze=`capitalize text-sm p-2 border rounded-lg bg-${o}-50 border-${o}-500 text-${o}-600`),h.jsx("button",{type:"button",onClick:()=>N(ie),className:ze,children:ie==="gas"?"Gas/Fussy":ie},ie)})})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"feeding-date",className:"block text-sm font-medium text-gray-700",children:"4. Date of feeding:"}),h.jsx("input",{type:"date",id:"feeding-date",value:R,onChange:ie=>k(ie.target.value),className:`mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-${o}-500 focus:ring-${o}-500 sm:text-sm`,required:!0,disabled:!!e})]}),h.jsxs("div",{children:[h.jsx("legend",{className:"text-sm font-medium text-gray-700",children:"5. How much did baby eat?"}),h.jsx("div",{className:"mt-2 grid grid-cols-2 gap-3",children:lM.map(ie=>h.jsxs("button",{type:"button",onClick:()=>z(ie.value),className:`p-3 border border-gray-300 rounded-lg flex items-center justify-center gap-2 text-gray-600 hover:border-gray-400 ${H===ie.value?`bg-${o}-50 border-${o}-500 text-${o}-600`:""}`,children:[h.jsx(ue,{name:ie.icon,className:"w-5 h-5"}),h.jsx("span",{className:"text-sm font-medium",children:ie.text})]},ie.value))})]}),$&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"6. Behavior (Toddler Challenges)"}),h.jsx("div",{className:"grid grid-cols-2 gap-2",children:cM.map(ie=>{const Me=me.includes(ie);return h.jsxs("button",{type:"button",onClick:()=>_e(ie),className:`text-xs p-2 rounded-lg border text-left transition-colors flex items-center gap-2 ${Me?"bg-orange-50 border-orange-300 text-orange-800":"bg-white border-gray-200 text-gray-600"}`,children:[h.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${Me?"bg-orange-500 border-orange-500":"bg-white border-gray-300"}`,children:Me&&h.jsx(ue,{name:"check",className:"w-3 h-3 text-white"})}),ie]},ie)})})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[h.jsx(ue,{name:"camera",className:`w-4 h-4 text-${o}-600`}),' "Messy Face" Photo (Optional)']}),h.jsxs("div",{className:"flex items-center gap-4",children:[de?h.jsxs("div",{className:"relative w-20 h-20 rounded-md overflow-hidden border border-gray-300",children:[h.jsx("img",{src:de,alt:"Messy face",className:"w-full h-full object-cover"}),h.jsx("button",{type:"button",onClick:()=>Ee(void 0),className:"absolute top-0 right-0 bg-red-500 text-white p-0.5 rounded-bl-md",children:h.jsx(ue,{name:"x",className:"w-3 h-3"})})]}):h.jsx("button",{type:"button",onClick:()=>{var ie;return(ie=Q.current)==null?void 0:ie.click()},disabled:V,className:"w-20 h-20 bg-gray-50 border border-dashed border-gray-300 rounded-md flex items-center justify-center text-gray-400 hover:bg-gray-100 transition-colors",children:V?h.jsx("div",{className:"spinner w-4 h-4"}):h.jsx(ue,{name:"plus"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("input",{type:"file",ref:Q,accept:"image/*",capture:"user",onChange:he,className:"hidden"}),h.jsx("p",{className:"text-xs text-gray-500",children:"Capture that funny first reaction! stored locally on this device."})]})]})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"notes-input",className:"block text-sm font-medium text-gray-700",children:$?"8. Notes (Optional):":"Notes (Optional):"}),h.jsx("textarea",{id:"notes-input",value:K,onChange:ie=>te(ie.target.value),rows:3,className:`mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-${o}-500 focus:ring-${o}-500 sm:text-sm`,placeholder:"e.g., Gagged a lot at first..."})]}),e&&h.jsxs("div",{className:"bg-gray-50 p-3 rounded-md border border-gray-200",children:[h.jsx("label",{htmlFor:"try-count-input",className:"block text-sm font-medium text-gray-700",children:"Total Times Tried"}),h.jsxs("div",{className:"mt-2 flex items-center",children:[h.jsx("button",{type:"button",onClick:()=>ee(Math.max(1,le-1)),className:"p-2 border border-gray-300 rounded-l-md bg-white text-gray-600 hover:bg-gray-50",children:h.jsx(ue,{name:"minus",className:"h-4 w-4"})}),h.jsx("input",{type:"number",id:"try-count-input",value:le,onChange:ie=>ee(Math.max(1,parseInt(ie.target.value)||1)),className:`w-20 text-center border-t border-b border-gray-300 py-1.5 text-sm focus:ring-${o}-500 focus:border-${o}-500`}),h.jsx("button",{type:"button",onClick:()=>ee(le+1),className:"p-2 border border-gray-300 rounded-r-md bg-white text-gray-600 hover:bg-gray-50",children:h.jsx(ue,{name:"plus",className:"h-4 w-4"})})]}),h.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Correct the count if you missed logging some tries."})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t sticky bottom-0 bg-white py-4",children:[h.jsx("button",{type:"button",onClick:i,className:"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),h.jsx("button",{type:"submit",className:`inline-flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-${o}-600 hover:bg-${o}-700`,children:"Save"})]})]})},hM=({existingLog:n,onIncrement:e,onEdit:t,baseColor:i})=>{const o=uM(n.reaction);return h.jsxs("div",{className:"p-6 space-y-4",children:[h.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[h.jsxs("p",{className:"text-sm text-gray-600",children:["First tried on: ",h.jsx("span",{className:"font-medium text-gray-800",children:n.date})]}),h.jsxs("p",{className:"text-sm text-gray-600",children:["Reaction: ",h.jsxs("span",{className:"font-medium text-gray-800",children:[o.emoji," ",o.text]})]}),n.behavioralTags&&n.behavioralTags.length>0&&h.jsx("div",{className:"mt-3 flex flex-wrap gap-1",children:n.behavioralTags.map(c=>h.jsx("span",{className:"text-xs bg-orange-100 text-orange-800 px-2 py-0.5 rounded-full border border-orange-200",children:c},c))}),n.notes&&h.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Notes: ",h.jsxs("span",{className:"italic",children:['"',n.notes,'"']})]})]}),n.messyFaceImage&&h.jsx("div",{className:"flex justify-center",children:h.jsx("img",{src:n.messyFaceImage,alt:"Messy Face",className:"h-32 rounded-lg border border-gray-200 shadow-sm"})}),h.jsx("div",{className:"text-center",children:h.jsxs("p",{className:"text-lg font-medium text-gray-700",children:["Total Times Tried: ",h.jsx("span",{className:`font-bold text-${i}-600`,children:n.tryCount||1})]})}),h.jsxs("button",{onClick:e,className:`w-full inline-flex justify-center items-center gap-2 py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-${i}-600 hover:bg-${i}-700`,children:[h.jsx(ue,{name:"plus",className:"w-5 h-5"})," +1 Mark as Tried Again"]}),h.jsx("div",{className:"text-center",children:h.jsx("button",{onClick:t,className:"text-sm text-gray-500 hover:underline",children:"Edit Initial Log"})})]})},fM=({food:n,existingLog:e,onClose:t,onSave:i,onShowGuide:o,onIncrementTry:c,baseColor:f="teal",appMode:y})=>{const[w,x]=oe.useState(!e),A=Jl[n.name]||[],N=()=>{c(n.name),t()};return h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-50",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4",children:[h.jsxs("div",{className:"flex flex-col",children:[h.jsxs("h2",{className:"text-xl font-semibold",children:["Log Food: ",h.jsxs("span",{className:`text-${f}-600`,children:[n.emoji," ",n.name]})]}),A.length>0&&h.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1.5",children:A.map(R=>{const k=Yh[R]||{bg:"bg-gray-100",text:"text-gray-800",border:"border-gray-200",label:R};return h.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-bold border ${k.bg} ${k.text} ${k.border}`,children:k.label},R)})})]}),h.jsxs("div",{children:[h.jsxs("button",{onClick:()=>o(n),type:"button",className:`text-sm text-${f}-600 font-medium inline-flex items-center gap-1 hover:text-${f}-700`,children:[h.jsx(ue,{name:"help-circle",className:"w-4 h-4"})," How to Serve"]}),h.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 ml-3",children:h.jsx(ue,{name:"x"})})]})]}),w||!e?h.jsx(dM,{food:n,existingLog:e,onSave:i,onClose:t,baseColor:f,appMode:y}):h.jsx(hM,{existingLog:e,onIncrement:N,onEdit:()=>x(!0),baseColor:f})]})})},mM=({food:n,onClose:e})=>{const t=JA[n.name],i=Jl[n.name]||[],[o,c]=oe.useState("6-8"),f=n.isCustom?n.details:null,y=t||{allergyRisk:Eh[n.name]?`High (${Eh[n.name].join(", ")})`:"Low",chokingRisk:"Medium (depends on prep)",serve6to8:"<h4 class='font-semibold'>General Advice (6-8m):</h4><p>Ensure food is cooked until soft enough to smash with gentle pressure between your thumb and forefinger. Serve in large pieces baby can hold (palmar grasp).</p>",serve9to12:"<h4 class='font-semibold mt-4'>General Advice (9-12m):</h4><p>Cut into small, bite-sized pieces (about the size of a chickpea) to practice pincer grasp. Ensure round foods (like grapes/tomatoes) are quartered lengthwise.</p>"},w=x=>{if(!x)return{bg:"bg-gray-50",border:"border-gray-200",text:"text-gray-800",icon:"info"};const A=x.toLowerCase();return A.includes("high")||A.includes("avoid")?{bg:"bg-red-50",border:"border-red-200",text:"text-red-800",icon:"alert-octagon"}:A.includes("medium")||A.includes("caution")?{bg:"bg-yellow-50",border:"border-yellow-200",text:"text-yellow-800",icon:"alert-triangle"}:{bg:"bg-green-50",border:"border-green-200",text:"text-green-800",icon:"shield-check"}};return h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[501]",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md mx-auto flex flex-col max-h-[90vh] overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-start p-5 pb-0 bg-white",children:[h.jsxs("div",{children:[h.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[h.jsx("span",{className:"text-3xl",children:n.emoji})," ",n.name,f&&h.jsx("span",{className:"text-xs font-normal bg-violet-100 text-violet-700 px-2 py-0.5 rounded-full",children:"Custom"})]}),i.length>0&&h.jsx("div",{className:"flex flex-wrap gap-1.5 mt-3",children:i.map(x=>{const A=Yh[x]||{bg:"bg-gray-100",text:"text-gray-800",border:"border-gray-200",icon:"star",label:x};return h.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded-md text-[10px] font-bold border ${A.bg} ${A.text} ${A.border}`,children:[h.jsx(ue,{name:A.icon,className:"w-3 h-3 mr-1"})," ",A.label]},x)})})]}),h.jsx("button",{onClick:e,className:"p-2 bg-gray-50 rounded-full text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors",children:h.jsx(ue,{name:"x",className:"w-5 h-5"})})]}),h.jsx("div",{className:"p-0 modal-scroll-content bg-white flex-1 overflow-y-auto",children:f?h.jsxs("div",{className:"p-5 space-y-6 animate-fadeIn",children:[h.jsxs("div",{className:`p-4 rounded-xl border ${w(f.safety_rating).bg} ${w(f.safety_rating).border} text-center`,children:[h.jsx("p",{className:"text-xs font-bold uppercase tracking-wide opacity-70",children:"Safety Rating"}),h.jsx("p",{className:`text-lg font-bold ${w(f.safety_rating).text}`,children:f.safety_rating})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 flex items-center gap-1",children:[h.jsx(ue,{name:"alert-circle",className:"w-3.5 h-3.5"})," Allergen Info"]}),h.jsx("p",{className:"text-sm text-gray-800 bg-gray-50 p-3 rounded-lg border border-gray-100",children:f.allergen_info})]}),h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 flex items-center gap-1",children:[h.jsx(ue,{name:"chef-hat",className:"w-3.5 h-3.5"})," Serving Recommendation"]}),h.jsx("p",{className:"text-sm text-gray-800 bg-gray-50 p-3 rounded-lg border border-gray-100",children:f.texture_recommendation})]}),h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 flex items-center gap-1",children:[h.jsx(ue,{name:"heart",className:"w-3.5 h-3.5"})," Nutrition Highlight"]}),h.jsx("p",{className:"text-sm text-gray-800 bg-gray-50 p-3 rounded-lg border border-gray-100",children:f.nutrition_highlight})]})]}),h.jsx("div",{className:"bg-yellow-50 p-3 rounded-md border border-yellow-100 text-xs text-yellow-800",children:h.jsxs("p",{children:[h.jsx("strong",{children:"Note:"})," This is a custom food entry generated by AI. Consult your pediatrician for specific advice."]})})]}):h.jsxs("div",{className:"p-5 space-y-6",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-1",children:[h.jsx(ue,{name:"shield",className:"w-3 h-3"})," Safety Profile"]}),h.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{label:"Allergy",val:y.allergyRisk},{label:"Choking",val:y.chokingRisk}].map((x,A)=>{const N=w(x.val);return h.jsxs("div",{className:`p-3 rounded-xl border ${N.bg} ${N.border}`,children:[h.jsxs("div",{className:`flex items-center gap-1.5 mb-1 ${N.text}`,children:[h.jsx(ue,{name:N.icon,className:"w-3.5 h-3.5"}),h.jsx("span",{className:"text-[10px] font-bold uppercase",children:x.label})]}),h.jsx("p",{className:`text-sm font-bold leading-tight ${N.text}`,children:x.val})]},A)})})]}),h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-1",children:[h.jsx(ue,{name:"chef-hat",className:"w-3 h-3"})," Preparation Guide"]}),h.jsxs("div",{className:"flex p-1 bg-gray-100 rounded-xl mb-4",children:[h.jsx("button",{onClick:()=>c("6-8"),className:`flex-1 py-2 text-sm font-semibold rounded-lg transition-all duration-200 ${o==="6-8"?"bg-white text-teal-700 shadow-sm ring-1 ring-black/5":"text-gray-500 hover:text-gray-700"}`,children:"6-8 Months"}),h.jsx("button",{onClick:()=>c("9-12"),className:`flex-1 py-2 text-sm font-semibold rounded-lg transition-all duration-200 ${o==="9-12"?"bg-white text-teal-700 shadow-sm ring-1 ring-black/5":"text-gray-500 hover:text-gray-700"}`,children:"9-12 Months"})]}),h.jsxs("div",{className:"prose-static bg-teal-50/60 p-5 rounded-xl border border-teal-100/60 text-gray-700 text-sm leading-relaxed",children:[h.jsx("style",{children:`
                            .prose-static h4 { display: none; }
                         `}),h.jsx("div",{dangerouslySetInnerHTML:{__html:o==="6-8"?y.serve6to8:y.serve9to12}})]})]})]})}),h.jsx("div",{className:"p-4 bg-gray-50 border-t border-gray-100 text-center",children:h.jsx("p",{className:"text-[10px] text-gray-400",children:"Always consult your pediatrician. Ensure food is soft & safe."})})]})})},gM=["breakfast","lunch","dinner","snack"],pM=({onClose:n,onSave:e,initialData:t})=>{const[i,o]=oe.useState(""),[c,f]=oe.useState(new Set),[y,w]=oe.useState(""),[x,A]=oe.useState(""),[N,R]=oe.useState("");oe.useEffect(()=>{t&&(o(t.title||""),f(new Set(t.mealTypes||[])),w(Array.isArray(t.ingredients)?t.ingredients.join(`
`):t.ingredients||""),A(Array.isArray(t.instructions)?t.instructions.join(`
`):t.instructions||""),R((t.tags||[]).join(", ")))},[t]);const k=W=>{const K=new Set(c);K.has(W)?K.delete(W):K.add(W),f(K)},H=W=>{if(W.preventDefault(),!i){alert("Recipe title is required.");return}e({title:i,ingredients:y,instructions:x,tags:N.split(",").map(K=>K.trim()).filter(Boolean),mealTypes:Array.from(c)})};return h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[500]",children:h.jsxs("form",{onSubmit:H,className:"bg-white rounded-lg shadow-xl w-full max-w-lg mx-auto",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4",children:[h.jsx("h2",{className:"text-xl font-semibold",children:"Add New Recipe"}),h.jsx("button",{type:"button",onClick:n,className:"text-gray-400 hover:text-gray-600",children:"X"})]}),h.jsxs("div",{className:"p-6 modal-scroll-content space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"recipe-title",className:"block text-sm font-medium text-gray-700",children:"Recipe Title"}),h.jsx("input",{type:"text",id:"recipe-title",value:i,onChange:W=>o(W.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm",required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Meal Type (Optional)"}),h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 mt-1",children:gM.map(W=>h.jsx("button",{type:"button",onClick:()=>k(W),className:`capitalize p-2 border border-gray-300 rounded-lg text-sm text-gray-600 hover:border-gray-400 ${c.has(W)?"modal-btn-selected":""}`,children:W},W))})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"recipe-ingredients",className:"block text-sm font-medium text-gray-700",children:"Ingredients"}),h.jsx("textarea",{id:"recipe-ingredients",value:y,onChange:W=>w(W.target.value),rows:5,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm",placeholder:`e.g.,
- 1 cup oats
- 1/2 banana, mashed`})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"recipe-instructions",className:"block text-sm font-medium text-gray-700",children:"Instructions"}),h.jsx("textarea",{id:"recipe-instructions",value:x,onChange:W=>A(W.target.value),rows:7,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm",placeholder:`e.g.,
1. Mix all ingredients.`})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"recipe-tags",className:"block text-sm font-medium text-gray-700",children:"Custom Tags (comma separated)"}),h.jsx("input",{type:"text",id:"recipe-tags",value:N,onChange:W=>R(W.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm",placeholder:"e.g., muffin, 6m+, egg-free"})]})]}),h.jsxs("div",{className:"flex justify-end space-x-3 p-4 border-t bg-gray-50 rounded-b-lg",children:[h.jsx("button",{type:"button",onClick:n,className:"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),h.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700",children:"Save Recipe"})]})]})})},vw=n=>{const e=typeof n=="string"?n.split(`
`):[];return e.length===0?null:e.map((t,i)=>(t=t.trim(),t.startsWith("-")||t.startsWith("*")?h.jsx("li",{className:"ml-4",children:t.substring(1).trim()},i):/^\d+\./.test(t)?h.jsx("li",{className:"ml-4",children:t.replace(/^\d+\./,"").trim()},i):t?h.jsx("p",{children:t},i):null)).filter(Boolean)},xM=({recipe:n,onClose:e,onDelete:t,onUpdateRating:i})=>{const o=[...n.mealTypes||[],...n.tags||[]],c=()=>{window.confirm("Are you sure you want to delete this recipe? This cannot be undone.")&&t(n.id)};return h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[500]",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg mx-auto flex flex-col max-h-[90vh]",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4",children:[h.jsx("h2",{className:"text-xl font-semibold text-teal-600",children:n.title}),h.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-600",children:h.jsx(ue,{name:"x"})})]}),h.jsxs("div",{className:"p-6 modal-scroll-content prose-static",children:[h.jsx("div",{className:"mb-4 flex flex-wrap gap-2",children:o.length>0?o.map(f=>h.jsx("span",{className:`text-xs ${["breakfast","lunch","dinner","snack"].includes(f)?"bg-blue-100 text-blue-700":"bg-teal-100 text-teal-700"} px-2 py-0.5 rounded-full`,children:f},f)):h.jsx("span",{className:"text-xs text-gray-500",children:"No tags"})}),h.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Ingredients"}),h.jsx("div",{className:"mb-4 list-disc list-inside",children:vw(n.ingredients)||h.jsx("p",{children:"No ingredients listed."})}),h.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Instructions"}),h.jsx("div",{className:"list-decimal list-inside",children:vw(n.instructions)||h.jsx("p",{children:"No instructions provided."})}),h.jsxs("div",{className:"mt-6 border-t pt-4",children:[h.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Rate this Recipe"}),h.jsx("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(f=>h.jsx("button",{onClick:()=>i(n.id,f===n.rating?0:f),className:"focus:outline-none transition-transform hover:scale-110","aria-label":`Rate ${f} star${f>1?"s":""}`,children:h.jsx(ue,{name:"star",className:`w-8 h-8 ${f<=(n.rating||0)?"text-yellow-400 fill-yellow-400":"text-gray-300"}`})},f))})]})]}),h.jsx("div",{className:"flex justify-end space-x-3 p-4 border-t bg-gray-50 rounded-b-lg mt-auto",children:h.jsx("button",{type:"button",onClick:c,className:"inline-flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700",children:"Delete Recipe"})})]})})},yM=({onClose:n,onRecipeParsed:e})=>{const[t,i]=oe.useState(null),[o,c]=oe.useState(null),[f,y]=oe.useState(!1),[w,x]=oe.useState(null),A=R=>{var H;const k=(H=R.target.files)==null?void 0:H[0];k&&(i(k),c(URL.createObjectURL(k)),x(null))},N=async()=>{if(t){y(!0),x(null);try{const R=await u6(t);e(R)}catch(R){x(R.message||"Failed to parse recipe.")}finally{y(!1)}}};return h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[500]",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4",children:[h.jsx("h2",{className:"text-xl font-semibold text-blue-600",children:"Import Recipe from Image"}),h.jsx("button",{type:"button",onClick:n,className:"text-gray-400 hover:text-gray-600",children:h.jsx(ue,{name:"x"})})]}),h.jsxs("div",{className:"p-6 space-y-4",children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Upload a photo of a recipe (from a cookbook or screenshot) and AI will try to extract the details."}),h.jsx("input",{type:"file",onChange:A,accept:"image/*",className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),o&&h.jsx("img",{src:o,alt:"Image preview",className:"w-full h-auto max-h-48 object-contain rounded-md border"}),w&&h.jsx("p",{className:"text-sm text-red-600",children:w}),h.jsx("button",{onClick:N,disabled:!t||f,className:"w-full inline-flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:f?h.jsx("div",{className:"spinner h-5 w-5 border-2"}):"Upload and Analyze"})]})]})})},vM=[{value:"none",label:"None (Normal Recipe)"},{value:"Vegetables",label:"Vegetables"},{value:"Fruits",label:"Fruits"},{value:"Protein",label:"Protein / Meat"},{value:"Grains",label:"Carbs / Grains"},{value:"Dairy",label:"Dairy"}],wM=({onClose:n,onRecipeParsed:e,userProfile:t})=>{const[i,o]=oe.useState(""),[c,f]=oe.useState("none"),[y,w]=oe.useState(!1),[x,A]=oe.useState(null),N=r2(t),R=async()=>{if(i.trim()){w(!0),A(null);try{const k=ku(t==null?void 0:t.birthDate);let H=i;c!=="none"&&(H=`Create a recipe that hides ${c} using these ingredients: ${i}. The child is picky and dislikes ${c}, so mask the flavor/texture completely.`);const W=await c6(H,k);e(W)}catch(k){A(k.message||"Failed to generate recipe.")}finally{w(!1)}}};return h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[500]",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4",children:[h.jsxs("h2",{className:"text-xl font-semibold text-violet-600 flex items-center gap-2",children:[h.jsx(ue,{name:"refrigerator",className:"w-5 h-5"}),"What's in the Fridge?"]}),h.jsx("button",{type:"button",onClick:n,className:"text-gray-400 hover:text-gray-600",children:h.jsx(ue,{name:"x"})})]}),h.jsxs("div",{className:"p-6 space-y-4",children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Enter a few ingredients you have on hand, and we'll create a baby-safe recipe for you!"}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wide mb-1",children:"Your Ingredients"}),h.jsx("textarea",{value:i,onChange:k=>o(k.target.value),placeholder:"e.g., Spinach, Greek Yogurt, and Sweet Potato...",rows:3,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-violet-500 focus:ring-violet-500 sm:text-sm"})]}),N==="TODDLER"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wide mb-1",children:"Picky Eater Mode"}),h.jsxs("div",{className:"bg-violet-50 p-3 rounded-lg border border-violet-100",children:[h.jsx("p",{className:"text-xs text-violet-800 mb-2",children:"Need to hide a specific food group?"}),h.jsx("select",{value:c,onChange:k=>f(k.target.value),className:"block w-full rounded-md border-violet-300 text-sm focus:border-violet-500 focus:ring-violet-500",children:vM.map(k=>h.jsx("option",{value:k.value,children:k.label},k.value))})]})]}),x&&h.jsx("p",{className:"text-sm text-red-600",children:x}),h.jsx("button",{onClick:R,disabled:y,className:"w-full inline-flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-violet-600 hover:bg-violet-700 disabled:opacity-50",children:y?h.jsx("div",{className:"spinner h-5 w-5 border-2"}):"Generate Recipe Idea"}),h.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:h.jsxs("p",{className:"text-xs text-gray-500 text-center",children:[h.jsx("strong",{children:"Disclaimer:"})," AI recipes may not be perfect. Always ensure textures are age-appropriate and safe for your baby."]})})]})]})})},ww=n=>typeof n!="string"?[]:n.split(`
`).map(e=>e.trim().replace(/^[\*\-\s]|^(\d+\.\s)/,"")).filter(e=>e.length>0),bM=()=>h.jsxs("svg",{viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M20,25 L28,70 H72 L80,25 Z"}),h.jsx("circle",{cx:"35",cy:"80",r:"5"}),h.jsx("circle",{cx:"65",cy:"80",r:"5"}),h.jsx("line",{x1:"20",y1:"25",x2:"80",y2:"25"}),h.jsx("line",{x1:"45",y1:"25",x2:"55",y2:"10"})]}),EM=({recipes:n,mealPlan:e,triedFoods:t,manualItems:i,checkedItems:o,onAddManualItem:c,onToggleItem:f,onClearChecked:y,onClose:w})=>{const[x,A]=oe.useState({}),[N,R]=oe.useState([]),[k,H]=oe.useState(!0),[W,K]=oe.useState(null),[te,le]=oe.useState(""),[ee,de]=oe.useState(!1),Ee=oe.useMemo(()=>{const Y={};return t.forEach($=>{$.reaction>=5&&(Y[$.id]=(Y[$.id]||0)+1)}),Object.entries(Y).sort(([,$],[,z])=>z-$).slice(0,5).map(([$])=>$)},[t]),me=()=>{te.trim()&&(c(te.trim()),le(""))},U=Y=>{ww(Y.ingredients).forEach(z=>c(z)),de(!1)},V=oe.useMemo(()=>{const Y=i.map($=>$.name);return Array.from(new Set([...N,...Y]))},[N,i]);oe.useEffect(()=>{const Y=new Set,$=new Date;$.setDate($.getDate()-$.getDay()+($.getDay()===0?-6:1));for(let z=0;z<7;z++){const _e=new Date($);_e.setDate($.getDate()+z);const he=_e.toISOString().split("T")[0],ne=e[he];if(ne){for(const ie of Object.values(ne))if(ie&&typeof ie=="object"&&"id"in ie&&typeof ie.id=="string"){const Me=n.find(ze=>ze.id===ie.id);Me&&Me.ingredients&&ww(Me.ingredients).forEach(ze=>Y.add(ze))}}}R(Array.from(Y))},[n,e]),oe.useEffect(()=>{(async()=>{if(V.length===0){A({}),H(!1);return}H(!0),K(null);try{const $=await y6(V),z={};let _e=!0;if(typeof $=="object"&&$!==null&&!Array.isArray($))for(const[he,ne]of Object.entries($))if(Array.isArray(ne)&&ne.every(ie=>typeof ie=="string"))z[he]=ne;else{_e=!1;break}else _e=!1;if(_e&&Object.keys(z).length>0)A(z);else throw new Error("AI response was not in the expected format.")}catch($){console.error($),A({Items:V})}finally{H(!1)}})()},[V]);const F=V.length===0,Q=Object.keys(o).length>0;return h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[500]",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto flex flex-col max-h-[90vh]",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Shopping List"}),h.jsxs("div",{className:"flex items-center gap-2",children:[Q&&h.jsx("button",{onClick:y,className:"text-xs font-bold text-red-600 hover:bg-red-50 px-2 py-1 rounded transition-colors",children:"Clear Checked"}),h.jsx("button",{type:"button",onClick:w,className:"text-gray-400 hover:text-gray-600 p-1",children:h.jsx(ue,{name:"x"})})]})]}),h.jsxs("div",{className:"p-4 bg-gray-50 border-b space-y-3",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{type:"text",value:te,onChange:Y=>le(Y.target.value),onKeyPress:Y=>Y.key==="Enter"&&me(),placeholder:"Add item (e.g. Diapers)...",className:"flex-1 rounded-lg border-gray-300 shadow-sm focus:ring-teal-500 focus:border-teal-500 text-sm"}),h.jsx("button",{onClick:me,className:"bg-teal-600 text-white px-3 rounded-lg hover:bg-teal-700",children:h.jsx(ue,{name:"plus",className:"w-5 h-5"})})]}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{onClick:()=>de(!ee),className:"text-xs font-bold text-teal-700 flex items-center gap-1 hover:underline",children:[h.jsx(ue,{name:"plus-circle",className:"w-3 h-3"})," Add from Saved Plate"]}),ee&&h.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-gray-200 rounded-xl shadow-lg z-20 max-h-60 overflow-y-auto p-2",children:[h.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-2 px-2",children:"Select a Plate"}),n.length>0?n.map(Y=>h.jsxs("button",{onClick:()=>U(Y),className:"w-full text-left px-3 py-2 hover:bg-teal-50 rounded-lg text-sm text-gray-700 flex justify-between items-center",children:[h.jsx("span",{className:"truncate",children:Y.title}),h.jsx(ue,{name:"plus",className:"w-3 h-3 text-teal-500"})]},Y.id)):h.jsx("p",{className:"text-xs text-gray-400 px-2 pb-2",children:"No saved recipes."})]})]})]}),h.jsx("div",{className:"p-6 modal-scroll-content overflow-y-auto",children:k?h.jsxs("div",{className:"text-center p-6",children:[h.jsx("div",{className:"spinner mx-auto"}),h.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Organizing your list..."})]}):F?h.jsx(Ou,{illustration:h.jsx(bM,{}),title:"List is Empty",message:"Add items manually or plan some meals to auto-generate a list.",children:Ee.length>0&&h.jsxs("div",{className:"mt-6 text-left w-full",children:[h.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wide mb-3 text-center",children:"Quick Add Favorites"}),h.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Ee.map(Y=>{const $=Ns.flatMap(_e=>_e.items).find(_e=>_e.name===Y),z=($==null?void 0:$.emoji)||"";return h.jsxs("button",{onClick:()=>c(Y),className:"text-xs px-3 py-1.5 rounded-full border bg-white text-gray-700 border-gray-200 hover:border-teal-400 hover:bg-teal-50 transition-all flex items-center gap-1.5",children:[h.jsx("span",{children:z})," ",Y]},Y)})})]})}):h.jsxs("div",{className:"space-y-6",children:[W&&h.jsx("p",{className:"text-sm text-red-600 mb-4 bg-red-50 p-2 rounded",children:W}),Object.entries(x).map(([Y,$])=>{const z=$;return h.jsxs("div",{children:[h.jsx("h4",{className:"text-sm font-bold text-teal-800 uppercase tracking-wider border-b border-teal-100 pb-1 mb-2",children:Y}),h.jsx("ul",{className:"space-y-2",children:z.map((_e,he)=>{const ne=!!o[_e],ie=o[_e];return h.jsx("li",{className:`flex items-start justify-between group p-2 rounded-lg transition-colors ${ne?"bg-gray-50":"hover:bg-gray-50"}`,children:h.jsxs("div",{className:"flex items-start gap-3 flex-1 cursor-pointer",onClick:()=>f(_e,!ne),children:[h.jsx("div",{className:`mt-0.5 w-5 h-5 rounded border flex items-center justify-center transition-colors ${ne?"bg-teal-500 border-teal-500":"bg-white border-gray-300"}`,children:ne&&h.jsx(ue,{name:"check",className:"w-3.5 h-3.5 text-white"})}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:`text-sm leading-snug ${ne?"text-gray-400 line-through":"text-gray-800"}`,children:_e}),ne&&ie&&h.jsxs("span",{className:"text-[10px] text-teal-600 font-medium",children:["Added to cart on ",new Date(ie).toLocaleDateString(void 0,{month:"short",day:"numeric"})]})]})]})},`${Y}-${he}`)})})]},Y)})]})})]})})},_M=({recipes:n,meal:e,onClose:t,onSelect:i})=>{const o=n.filter(f=>!f.mealTypes||f.mealTypes.length===0?!0:f.mealTypes.includes(e)),c=f=>f?f.replace(/\n/g,", "):"";return h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[500]",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4",children:[h.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Select a Recipe for ",e]}),h.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-600",children:h.jsx(ue,{name:"x"})})]}),h.jsx("div",{className:"p-2 modal-scroll-content",children:o.length>0?o.map(f=>h.jsxs("button",{onClick:()=>i(f),className:"block w-full text-left p-3 rounded-md transition-colors hover:bg-teal-50",children:[h.jsx("h4",{className:"font-medium text-teal-600",children:f.title}),h.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:c(f.ingredients)})]},f.id)):h.jsxs("p",{className:"p-4 text-center text-gray-500",children:['No recipes found for "',e,'". You can add recipes from the "My Recipes" tab.']})})]})})},TM=({food:n,userProfile:e,onClose:t,onSelectSubstitute:i})=>{const[o,c]=oe.useState([]),[f,y]=oe.useState(!0),[w,x]=oe.useState(null),A=Ns.flatMap(H=>H.items),N=ku(e==null?void 0:e.birthDate),R=N>=12;oe.useEffect(()=>{(async()=>{if(!(e!=null&&e.birthDate)){x("Baby's birth date is not set."),y(!1);return}try{const W=await v6(n.name,N);c(W)}catch{x("Could not fetch substitutes. Please try again later.")}finally{y(!1)}})()},[n.name,e==null?void 0:e.birthDate,N]);const k=H=>{const W=H.toUpperCase(),K=A.find(te=>W.includes(te.name));K?i(K):alert(`"${H}" is a great suggestion, but it's not in the app's 100 foods list yet!`)};return h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[501]",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4",children:[h.jsxs("h2",{className:"text-xl font-semibold",children:[R?"Texture Bridges for ":"Substitutes for ",h.jsx("span",{className:"text-teal-600",children:n.name})]}),h.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:h.jsx(ue,{name:"x"})})]}),h.jsxs("div",{className:"p-6 modal-scroll-content",children:[f&&h.jsxs("div",{className:"text-center p-6",children:[h.jsx("div",{className:"spinner mx-auto"}),h.jsx("p",{className:"mt-4 text-sm text-gray-600",children:R?"Finding similar textures (Food Bridges)...":"Finding safe & yummy substitutes..."})]}),w&&h.jsx("p",{className:"text-center text-red-600 p-6",children:w}),!f&&!w&&h.jsx("div",{className:"space-y-4",children:o.length>0?o.map((H,W)=>h.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border",children:[h.jsx("h4",{className:"font-semibold text-gray-800",children:H.name}),h.jsx("p",{className:"text-sm text-gray-600 mt-1",children:H.reason}),h.jsx("button",{onClick:()=>k(H.name),className:"text-sm text-teal-600 font-medium mt-2 hover:underline",children:"Log this food"})]},W)):h.jsx("p",{className:"text-center text-gray-500 p-6",children:"No specific substitutes found. Try exploring other foods in the same category!"})}),h.jsxs("p",{className:"mt-6 text-xs text-gray-500 border-t pt-4",children:[h.jsx("strong",{children:"Disclaimer:"})," ",R?"AI-generated bridging ideas based on texture/color.":"AI-generated suggestions."," Always ensure food is soft-cooked and served in a safe, age-appropriate manner. Check for allergens."]})]})]})})},AM=({userProfile:n,triedFoods:e,onClose:t})=>{const[i,o]=oe.useState("30");oe.useRef(null);const c=new Date;i==="30"&&c.setDate(c.getDate()-30),i==="90"&&c.setDate(c.getDate()-90);const f=e.filter(k=>i==="all"?!0:new Date(k.date)>=c).sort((k,H)=>new Date(H.date).getTime()-new Date(k.date).getTime()),y=f.filter(k=>k.allergyReaction&&k.allergyReaction!=="none"),w=new Set(f.map(k=>k.id)).size,x=()=>{window.print()},A=()=>{const k=["Date","Food","Reaction","Allergy Flag","Notes"],H=f.map(le=>[le.date,le.id,`${le.reaction}/7`,le.allergyReaction||"None",`"${(le.notes||"").replace(/"/g,'""')}"`]);let W="data:text/csv;charset=utf-8,"+k.join(",")+`\r
`+H.join(`\r
`);const K=encodeURI(W),te=document.createElement("a");te.setAttribute("href",K),te.setAttribute("download",`Report_${(n==null?void 0:n.babyName)||"Baby"}_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(te),te.click(),document.body.removeChild(te)},N=k=>{const H=Ns.flatMap(W=>W.items).find(W=>W.name===k);return(H==null?void 0:H.emoji)||""},R=Array.isArray(n==null?void 0:n.knownAllergies)?n==null?void 0:n.knownAllergies:[];return h.jsxs("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[500]",children:[h.jsx("style",{children:`
            @media print {
                @page {
                    margin: 0.5in;
                    size: auto;
                }
                body {
                    background-color: white;
                }
                body * {
                    visibility: hidden;
                }
                #doctor-report-container, #doctor-report-container * {
                    visibility: visible;
                }
                #doctor-report-container {
                    position: absolute;
                    left: 0;
                    top: 0;
                    width: 100%;
                    max-width: 100% !important;
                    margin: 0;
                    padding: 0;
                    background: white;
                    overflow: visible;
                    box-shadow: none !important;
                }
                .no-print {
                    display: none !important;
                }
                /* Force background colors to print (important for allergy flags) */
                * {
                    -webkit-print-color-adjust: exact !important;
                    print-color-adjust: exact !important;
                }
                /* Prevent page breaks inside summary cards or table rows */
                .avoid-break {
                    break-inside: avoid;
                    page-break-inside: avoid;
                }
                thead {
                    display: table-header-group; 
                }
            }
        `}),h.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl h-[90vh] flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4 bg-gray-50 no-print flex-shrink-0",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Generate Doctor Report"}),h.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:h.jsx(ue,{name:"x"})})]}),h.jsxs("div",{className:"p-4 border-b bg-white no-print flex flex-col sm:flex-row justify-between items-center gap-4 flex-shrink-0",children:[h.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Time Period:"}),h.jsxs("select",{value:i,onChange:k=>o(k.target.value),className:"block w-full sm:w-40 pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm rounded-md",children:[h.jsx("option",{value:"30",children:"Last 30 Days"}),h.jsx("option",{value:"90",children:"Last 3 Months"}),h.jsx("option",{value:"all",children:"All Time"})]})]}),h.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[h.jsxs("button",{onClick:A,className:"flex-1 sm:flex-none inline-flex items-center justify-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[h.jsx(ue,{name:"download",className:"w-4 h-4 mr-2"})," CSV"]}),h.jsxs("button",{onClick:x,className:"flex-1 sm:flex-none inline-flex items-center justify-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-teal-600 hover:bg-teal-700",children:[h.jsx(ue,{name:"printer",className:"w-4 h-4 mr-2"})," Print / Save PDF"]})]})]}),h.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 sm:p-8",children:h.jsxs("div",{id:"doctor-report-container",className:"bg-white max-w-3xl mx-auto p-8 shadow-sm min-h-full print:shadow-none text-gray-900",children:[h.jsxs("div",{className:"border-b-2 border-gray-800 pb-6 mb-6 flex justify-between items-start",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Food Introduction Report"}),h.jsxs("p",{className:"text-sm text-gray-500",children:["Generated on ",new Date().toLocaleDateString()]})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("h2",{className:"text-2xl font-bold text-teal-700",children:(n==null?void 0:n.babyName)||"Baby"}),(n==null?void 0:n.birthDate)&&h.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["DOB: ",n.birthDate]})]})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[h.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200 avoid-break",children:[h.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide font-semibold",children:"Period"}),h.jsx("p",{className:"text-lg font-bold text-gray-800 mt-1",children:i==="all"?"All Time":`Last ${i} Days`})]}),h.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200 avoid-break",children:[h.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide font-semibold",children:"New Foods Tried"}),h.jsx("p",{className:"text-lg font-bold text-teal-600 mt-1",children:w})]}),h.jsxs("div",{className:`p-4 rounded-lg border avoid-break ${y.length>0?"bg-red-50 border-red-200":"bg-green-50 border-green-200"}`,children:[h.jsx("p",{className:`text-xs uppercase tracking-wide font-semibold ${y.length>0?"text-red-600":"text-green-600"}`,children:"Reactions Flagged"}),h.jsx("p",{className:`text-lg font-bold mt-1 ${y.length>0?"text-red-700":"text-green-700"}`,children:y.length})]})]}),R.length>0&&h.jsxs("div",{className:"mb-8 avoid-break",children:[h.jsx("h3",{className:"text-sm font-bold text-gray-900 uppercase border-b border-gray-200 pb-2 mb-3",children:"Known Allergies & Conditions"}),h.jsx("div",{className:"flex flex-wrap gap-2",children:R.map(k=>h.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-bold bg-red-100 text-red-800 border border-red-200",children:k},k))})]}),y.length>0&&h.jsxs("div",{className:"mb-8",children:[h.jsxs("h3",{className:"text-sm font-bold text-red-700 uppercase border-b border-red-200 pb-2 mb-3 flex items-center",children:[h.jsx(ue,{name:"alert-triangle",className:"w-4 h-4 mr-2"})," Adverse Reactions Reported"]}),h.jsx("div",{className:"space-y-3",children:y.map((k,H)=>h.jsxs("div",{className:"bg-red-50 border border-red-200 p-4 rounded-md avoid-break",children:[h.jsxs("div",{className:"flex justify-between font-bold text-red-900 mb-2 border-b border-red-200 pb-2",children:[h.jsxs("span",{className:"flex items-center gap-2 text-lg",children:[N(k.id)," ",k.id]}),h.jsx("span",{children:k.date})]}),h.jsxs("div",{className:"text-sm text-red-800 mb-1",children:[h.jsx("span",{className:"font-bold uppercase text-xs mr-2",children:"Reaction Type:"}),h.jsx("span",{className:"font-semibold text-base",children:k.allergyReaction})]}),k.notes&&h.jsxs("div",{className:"text-sm text-red-800 mt-2 p-2 bg-white/50 rounded border border-red-100 italic",children:['"',k.notes,'"']})]},H))})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-sm font-bold text-gray-900 uppercase border-b border-gray-200 pb-2 mb-4",children:"Detailed Food Log"}),f.length>0?h.jsxs("table",{className:"min-w-full text-left text-sm border-collapse",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"border-b-2 border-gray-300",children:[h.jsx("th",{className:"py-3 font-bold text-gray-700 w-[15%]",children:"Date"}),h.jsx("th",{className:"py-3 font-bold text-gray-700 w-[25%]",children:"Food"}),h.jsx("th",{className:"py-3 font-bold text-gray-700 w-[15%]",children:"Reaction"}),h.jsx("th",{className:"py-3 font-bold text-gray-700 w-[45%]",children:"Notes"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100",children:f.map((k,H)=>h.jsxs("tr",{className:"avoid-break hover:bg-gray-50",children:[h.jsx("td",{className:"py-3 pr-2 text-gray-600 align-top whitespace-nowrap",children:k.date}),h.jsxs("td",{className:"py-3 pr-2 font-semibold text-gray-900 align-top",children:[h.jsx("span",{className:"mr-1.5 inline-block",children:N(k.id)}),k.id]}),h.jsxs("td",{className:"py-3 pr-2 align-top",children:[h.jsxs("div",{className:"text-gray-700 font-medium",children:[k.reaction,"/7"]}),k.allergyReaction&&k.allergyReaction!=="none"&&h.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 rounded text-[10px] font-bold bg-red-100 text-red-700 border border-red-200 uppercase tracking-wider",children:k.allergyReaction})]}),h.jsx("td",{className:"py-3 text-gray-600 align-top leading-relaxed",children:k.notes?k.notes:h.jsx("span",{className:"text-gray-300 text-xs",children:"-"})})]},H))})]}):h.jsx("p",{className:"text-gray-500 italic text-center py-8 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:"No logs found for this period."})]}),h.jsx("div",{className:"mt-12 pt-4 border-t border-gray-200 text-center",children:h.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-widest",children:"Generated by Tiny Tastes Tracker"})})]})})]})]})},SM=({triedFoods:n,onClose:e})=>{const[t,i]=oe.useState([]),[o,c]=oe.useState(!0),[f,y]=oe.useState(null);return oe.useEffect(()=>{(async()=>{c(!0),y(null);try{const x=n.filter(N=>N.reaction>=4).map(N=>N.id),A=await h6(x);A&&A.pairings?i(A.pairings):y("Couldn't generate pairings right now.")}catch{y("Failed to connect to Sage. Please try again later.")}finally{c(!1)}})()},[n]),h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[500]",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto h-[80vh] flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"p-1.5 bg-violet-100 rounded-full",children:h.jsx(ue,{name:"sparkles",className:"w-5 h-5 text-violet-600"})}),h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Sage's Flavor Pairings"})]}),h.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-600",children:h.jsx(ue,{name:"x"})})]}),h.jsxs("div",{className:"p-6 overflow-y-auto flex-1 bg-gray-50",children:[o&&h.jsxs("div",{className:"text-center p-8",children:[h.jsx("div",{className:"spinner mx-auto mb-4"}),h.jsx("p",{className:"text-gray-600 font-medium",children:"Sage is brainstorming delicious combinations..."}),h.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Checking your tried foods list"})]}),f&&h.jsxs("div",{className:"text-center p-8 bg-white rounded-lg border border-red-100",children:[h.jsx(ue,{name:"frown",className:"w-10 h-10 text-red-300 mx-auto mb-3"}),h.jsx("p",{className:"text-red-600",children:f})]}),!o&&!f&&t.length===0&&h.jsx("div",{className:"text-center p-8",children:h.jsx("p",{className:"text-gray-500",children:"Log a few more foods (that baby likes!) to get better suggestions."})}),!o&&!f&&t.map((w,x)=>h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-5 mb-4 transition-transform hover:scale-[1.01]",children:[h.jsx("h3",{className:"text-lg font-bold text-teal-700 mb-2",children:w.title}),h.jsxs("p",{className:"text-sm text-gray-600 italic mb-4",children:['"',w.description,'"']}),h.jsxs("div",{className:"bg-teal-50 rounded-lg p-3",children:[h.jsx("p",{className:"text-xs font-bold text-teal-800 uppercase tracking-wider mb-2",children:"Ingredients"}),h.jsx("div",{className:"flex flex-wrap gap-2",children:w.ingredients.map((A,N)=>h.jsx("span",{className:"px-2.5 py-1 bg-white border border-teal-200 rounded-full text-xs font-medium text-teal-700 shadow-sm",children:A},N))})]})]},x))]}),h.jsx("div",{className:"p-4 border-t bg-white text-center text-xs text-gray-400",children:"AI suggestions. Always ensure texture is age-appropriate."})]})})},CM=({foodName:n,allergens:e,onClose:t})=>h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-80 flex items-center justify-center p-4 z-[999]",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-sm mx-auto overflow-hidden animate-fadeIn",children:[h.jsxs("div",{className:"bg-orange-50 border-b border-orange-100 p-6 flex flex-col items-center text-center",children:[h.jsx("div",{className:"bg-orange-100 p-3 rounded-full mb-3",children:h.jsx(ue,{name:"alert-triangle",className:"w-8 h-8 text-orange-600"})}),h.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Allergen Alert"}),h.jsxs("p",{className:"text-sm text-orange-800 font-medium mt-1",children:["You just logged ",n," for the first time."]})]}),h.jsxs("div",{className:"p-6",children:[h.jsxs("p",{className:"text-gray-600 text-sm mb-4 leading-relaxed",children:["This food contains ",h.jsx("strong",{children:e.join(", ")}),", which ",e.length>1?"are common allergens":"is a common allergen","."]}),h.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4 mb-6",children:[h.jsxs("h4",{className:"flex items-center gap-2 text-sm font-bold text-blue-800 mb-2",children:[h.jsx(ue,{name:"eye",className:"w-4 h-4"})," Watch for 2 Hours:"]}),h.jsxs("ul",{className:"text-xs text-blue-800 space-y-1 ml-6 list-disc",children:[h.jsx("li",{children:"Hives or rash (especially around the mouth)"}),h.jsx("li",{children:"Vomiting"}),h.jsx("li",{children:"Swelling of lips or face"}),h.jsx("li",{children:"Wheezing or difficulty breathing"})]})]}),h.jsx("button",{onClick:t,className:"w-full inline-flex justify-center items-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-bold text-white bg-teal-600 hover:bg-teal-700 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500",children:"Got it, I'll keep watch"})]})]})}),NM=({badge:n,onClose:e})=>h.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-90 flex items-center justify-center p-4 z-[999] animate-fadeIn",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-sm mx-auto overflow-hidden text-center p-8 relative transform transition-all scale-100",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-yellow-50 to-white -z-10"}),h.jsx("div",{className:"mb-6 flex justify-center",children:h.jsx("div",{className:"p-6 rounded-full bg-yellow-100 ring-8 ring-yellow-50 animate-bounce",children:h.jsx(ue,{name:n.icon,className:"w-16 h-16 text-yellow-600"})})}),h.jsx("h2",{className:"text-2xl font-black text-gray-800 uppercase tracking-wide mb-2",children:"New Badge!"}),h.jsx("h3",{className:"text-xl font-bold text-teal-600 mb-4",children:n.title}),h.jsx("p",{className:"text-gray-500 mb-8",children:n.description}),h.jsx("button",{onClick:e,className:"w-full py-3 px-4 border border-transparent rounded-full shadow-lg text-sm font-bold text-white bg-teal-600 hover:bg-teal-700 transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-teal-200",children:"Awesome!"})]})}),IM=({babyName:n,date:e,onClose:t})=>{const i=()=>{window.print()};return h.jsxs("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-80 flex items-center justify-center p-4 z-[1000]",children:[h.jsx("style",{children:`
            @media print {
                @page { margin: 0; size: landscape; }
                body * { visibility: hidden; }
                #certificate-container, #certificate-container * { visibility: visible; }
                #certificate-container {
                    position: fixed;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    margin: 0;
                    padding: 0;
                    background: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 9999;
                }
                .no-print { display: none !important; }
                * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            }
        `}),h.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4 bg-gray-50 no-print",children:[h.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Your Certificate"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("button",{onClick:i,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700",children:[h.jsx(ue,{name:"printer",className:"w-4 h-4 mr-2"})," Print"]}),h.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 p-2",children:h.jsx(ue,{name:"x",className:"w-5 h-5"})})]})]}),h.jsx("div",{className:"flex-1 bg-gray-200 p-4 sm:p-8 flex items-center justify-center",children:h.jsx("div",{id:"certificate-container",className:"bg-white p-2 w-full max-w-[800px] aspect-[1.4/1] shadow-2xl relative border-8 border-teal-600 box-border",children:h.jsxs("div",{className:"w-full h-full border-4 border-dashed border-teal-200 flex flex-col items-center justify-center text-center p-8 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-yellow-50 via-white to-white relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-4 left-4 text-teal-100",children:h.jsx(ue,{name:"carrot",className:"w-24 h-24 rotate-45"})}),h.jsx("div",{className:"absolute bottom-4 right-4 text-orange-100",children:h.jsx(ue,{name:"apple",className:"w-24 h-24 -rotate-12"})}),h.jsxs("div",{className:"relative z-10",children:[h.jsx("div",{className:"flex justify-center mb-6",children:h.jsx(ue,{name:"trophy",className:"w-20 h-20 text-yellow-500 drop-shadow-sm"})}),h.jsx("h1",{className:"text-4xl sm:text-5xl font-serif font-bold text-teal-800 mb-2 tracking-wide",children:"Certificate of Achievement"}),h.jsx("p",{className:"text-lg text-teal-600 font-medium uppercase tracking-widest mb-8",children:"The 100 Foods Challenge"}),h.jsx("p",{className:"text-xl text-gray-600 italic mb-4",children:"This certifies that"}),h.jsx("div",{className:"text-4xl sm:text-6xl font-cursive font-bold text-gray-900 mb-8 border-b-2 border-gray-300 pb-2 px-12 inline-block min-w-[300px]",children:n||"Super Baby"}),h.jsx("p",{className:"text-xl text-gray-600 italic mb-2",children:"Has successfully tasted 100 new foods!"}),h.jsxs("p",{className:"text-sm text-gray-500",children:["Awarded on ",e]}),h.jsxs("div",{className:"mt-12 flex justify-between w-full px-12",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"w-40 border-t border-gray-400 mb-2"}),h.jsx("p",{className:"text-xs text-gray-400 uppercase",children:"Tiny Tastes Tracker"})]}),h.jsx("div",{className:"text-center",children:h.jsx(ue,{name:"award",className:"w-12 h-12 text-teal-600 mx-auto opacity-80"})})]})]})]})})})]})]})},RM=async(n,e)=>{const t={food_name:n,searched_term:e,timestamp:new Date().toISOString(),user_id:localStorage.getItem("tiny_tastes_anon_id")||"anonymous_user"};try{console.groupCollapsed(" Telemetry: Missing Food Logged"),console.log("Sending to cloud (simulated):",t),console.log("Purpose: Crowdsourcing database improvements."),console.groupEnd()}catch(i){console.warn("Failed to log missing food telemetry",i)}},MM=["Vegetables","Fruits","Grains","Protein","Dairy","Snacks"],DM=({initialName:n="",scannedData:e,onClose:t,onSave:i})=>{const[o,c]=oe.useState(n),[f,y]=oe.useState(!1),[w,x]=oe.useState(null),[A,N]=oe.useState(""),[R,k]=oe.useState(""),[H,W]=oe.useState(null);oe.useEffect(()=>{if(e){const de=e.brand?`${e.brand} ${e.name}`:e.name;c(de),K(de,e.ingredientsText)}},[e]);const K=async(de,Ee)=>{y(!0),W(null);try{const me=await w6(de,Ee);x(me),N(me.emoji),k(me.category||"Snacks")}catch{W("Could not analyze this product. Please check your internet connection.")}finally{y(!1)}},te=async()=>{if(o.trim()){y(!0),W(null);try{const de=await m6(o);x(de),N(de.emoji),k(de.category||"Snacks")}catch{W("Could not analyze food. Please try again or check your internet.")}finally{y(!1)}}},le=()=>{if(!w||!o.trim())return;const de={name:o.trim().toUpperCase(),emoji:A||w.emoji,isCustom:!0,details:{safety_rating:w.safety_rating,allergen_info:w.allergen_info,texture_recommendation:w.texture_recommendation,nutrition_highlight:w.nutrition_highlight},image:e==null?void 0:e.image,category:R};RM(de.name,o.trim()),i(de)},ee=de=>{switch(de){case"Safe":return"bg-green-100 text-green-800 border-green-200";case"Use Caution":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"Avoid":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800"}};return h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-90 flex items-center justify-center p-4 z-[502]",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md mx-auto overflow-hidden flex flex-col max-h-[90vh]",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4 bg-gradient-to-r from-teal-50 to-white",children:[h.jsxs("h2",{className:"text-xl font-bold text-teal-900 flex items-center gap-2",children:[e?h.jsx(ue,{name:"scan-barcode",className:"w-6 h-6 text-teal-600"}):h.jsx(ue,{name:"plus-circle",className:"w-6 h-6 text-teal-600"}),e?"Add Scanned Food":"Add Custom Food"]}),h.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:h.jsx(ue,{name:"x"})})]}),h.jsxs("div",{className:"p-6 overflow-y-auto",children:[(e==null?void 0:e.image)&&!w&&h.jsx("div",{className:"flex justify-center mb-6",children:h.jsx("div",{className:"w-32 h-32 rounded-lg border border-gray-200 overflow-hidden shadow-sm",children:h.jsx("img",{src:e.image,alt:"Scanned product",className:"w-full h-full object-contain"})})}),w?h.jsxs("div",{className:"space-y-5 animate-fadeIn",children:[h.jsxs("div",{className:"flex flex-col items-center",children:[e!=null&&e.image?h.jsxs("div",{className:"relative mb-4",children:[h.jsx("img",{src:e.image,alt:o,className:"w-24 h-24 object-contain rounded-md border border-gray-200"}),h.jsx("div",{className:"absolute -bottom-2 -right-2 bg-white rounded-full border shadow-sm p-1 text-xl",children:A})]}):h.jsxs("div",{className:"relative group",children:[h.jsx("input",{type:"text",value:A,onChange:de=>N(de.target.value),className:"text-6xl text-center border-none focus:ring-0 bg-transparent w-32 p-0 cursor-pointer hover:scale-110 transition-transform bg-gray-50 rounded-xl",maxLength:5}),h.jsx("div",{className:"absolute -bottom-5 left-0 right-0 text-center",children:h.jsx("span",{className:"text-[10px] text-gray-400 uppercase tracking-wider font-bold bg-white px-2",children:"Tap to Edit"})})]}),h.jsx("h3",{className:"text-xl font-bold text-gray-900 mt-2 text-center leading-tight",children:o})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wide mb-1",children:"Category"}),h.jsx("select",{value:R,onChange:de=>k(de.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 text-sm py-2",children:MM.map(de=>h.jsx("option",{value:de,children:de},de))})]}),h.jsxs("div",{className:`p-4 rounded-lg border text-center ${ee(w.safety_rating)}`,children:[h.jsx("p",{className:"text-xs uppercase tracking-wider font-bold mb-1",children:"Safety Rating"}),h.jsx("p",{className:"text-xl font-black",children:w.safety_rating})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex gap-3 items-start p-3 bg-gray-50 rounded-lg border border-gray-100",children:[h.jsx(ue,{name:"alert-circle",className:"w-5 h-5 text-orange-500 mt-0.5 flex-shrink-0"}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"Allergen Info"}),h.jsx("p",{className:"text-sm text-gray-800",children:w.allergen_info})]})]}),h.jsxs("div",{className:"flex gap-3 items-start p-3 bg-gray-50 rounded-lg border border-gray-100",children:[h.jsx(ue,{name:"utensils",className:"w-5 h-5 text-blue-500 mt-0.5 flex-shrink-0"}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"How to Serve"}),h.jsx("p",{className:"text-sm text-gray-800",children:w.texture_recommendation})]})]}),h.jsxs("div",{className:"flex gap-3 items-start p-3 bg-gray-50 rounded-lg border border-gray-100",children:[h.jsx(ue,{name:"heart",className:"w-5 h-5 text-rose-500 mt-0.5 flex-shrink-0"}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"Nutrition Highlight"}),h.jsx("p",{className:"text-sm text-gray-800",children:w.nutrition_highlight})]})]})]}),h.jsxs("div",{className:"bg-yellow-50 p-3 rounded-md border border-yellow-100 text-xs text-yellow-800 flex gap-2",children:[h.jsx(ue,{name:"info",className:"w-4 h-4 flex-shrink-0"}),h.jsxs("p",{children:[h.jsx("strong",{children:"Disclaimer:"})," This info is generated by AI based on the product ingredients. Always verify with your pediatrician."]})]}),h.jsxs("div",{className:"flex gap-3 pt-2",children:[h.jsx("button",{onClick:()=>x(null),className:"flex-1 py-2 px-4 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Back"}),h.jsx("button",{onClick:le,className:"flex-1 py-2 px-4 bg-teal-600 text-white rounded-md hover:bg-teal-700 font-bold shadow-sm",children:"Save & Add"})]})]}):h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Food Name"}),h.jsx("div",{className:"flex gap-2",children:h.jsx("input",{type:"text",value:o,onChange:de=>c(de.target.value),onKeyPress:de=>de.key==="Enter"&&te(),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500",placeholder:"e.g., Dragonfruit",autoFocus:!e})}),h.jsx("p",{className:"text-xs text-gray-500 mt-2",children:e?"Review the product name. AI is analyzing safety & nutrition based on ingredients...":"We'll use AI to analyze safety and nutrition for this food."})]}),f&&h.jsxs("div",{className:"flex flex-col items-center py-6 text-gray-500 gap-3",children:[h.jsx("div",{className:"spinner w-8 h-8 border-teal-500"}),h.jsx("span",{className:"text-sm font-medium animate-pulse",children:"Analyzing ingredients..."})]}),H&&h.jsx("p",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-md",children:H}),!f&&!e&&h.jsxs("button",{onClick:te,disabled:!o.trim(),className:"w-full flex justify-center items-center gap-2 py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-bold text-white bg-teal-600 hover:bg-teal-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[h.jsx(ue,{name:"wand-2",className:"w-4 h-4"})," Analyze with AI"]})]})]})]})})},OM=["organic","puree","concentrate","juice","vitamin","acid","citric","ascorbic","water","of","and","extract","flavor","flavour","natural","sauce","paste","dried","powder","syrup","starch","gum","lecithin"],a2=async n=>{try{const t=await(await fetch(`https://world.openfoodfacts.org/api/v2/product/${n}.json`)).json();if(t.status!==1||!t.product)return null;const{product:i}=t,o=new Set;return i.ingredients_tags&&i.ingredients_tags.length>0&&i.ingredients_tags.forEach(c=>{const f=c.replace("en:","").replace(/-/g," "),y=bw(f);y&&o.add(y)}),o.size===0&&i.ingredients_text&&i.ingredients_text.split(/[,()]/).forEach(f=>{const y=kM(f),w=bw(y);w&&o.add(w)}),{productName:i.product_name||"Unknown Snack",brand:i.brands,ingredientsText:i.ingredients_text||"",matchedFoods:Array.from(o),imageUrl:i.image_url}}catch(e){return console.error("Error fetching product:",e),null}},kM=n=>{let e=n.toLowerCase();return OM.forEach(t=>{const i=new RegExp(`\\b${t}\\b`,"gi");e=e.replace(i,"")}),e.trim()},bw=n=>{const e=n.toLowerCase().trim();if(!e)return null;for(const t of ac){const i=t.toLowerCase();if(i===e||i+"s"===e||i===e+"s"||e.includes(i))return t}return null};var tt;(function(n){n[n.QR_CODE=0]="QR_CODE",n[n.AZTEC=1]="AZTEC",n[n.CODABAR=2]="CODABAR",n[n.CODE_39=3]="CODE_39",n[n.CODE_93=4]="CODE_93",n[n.CODE_128=5]="CODE_128",n[n.DATA_MATRIX=6]="DATA_MATRIX",n[n.MAXICODE=7]="MAXICODE",n[n.ITF=8]="ITF",n[n.EAN_13=9]="EAN_13",n[n.EAN_8=10]="EAN_8",n[n.PDF_417=11]="PDF_417",n[n.RSS_14=12]="RSS_14",n[n.RSS_EXPANDED=13]="RSS_EXPANDED",n[n.UPC_A=14]="UPC_A",n[n.UPC_E=15]="UPC_E",n[n.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(tt||(tt={}));var Ew=new Map([[tt.QR_CODE,"QR_CODE"],[tt.AZTEC,"AZTEC"],[tt.CODABAR,"CODABAR"],[tt.CODE_39,"CODE_39"],[tt.CODE_93,"CODE_93"],[tt.CODE_128,"CODE_128"],[tt.DATA_MATRIX,"DATA_MATRIX"],[tt.MAXICODE,"MAXICODE"],[tt.ITF,"ITF"],[tt.EAN_13,"EAN_13"],[tt.EAN_8,"EAN_8"],[tt.PDF_417,"PDF_417"],[tt.RSS_14,"RSS_14"],[tt.RSS_EXPANDED,"RSS_EXPANDED"],[tt.UPC_A,"UPC_A"],[tt.UPC_E,"UPC_E"],[tt.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),_w;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.URL=1]="URL"})(_w||(_w={}));function PM(n){return Object.values(tt).includes(n)}var Nh;(function(n){n[n.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",n[n.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Nh||(Nh={}));var LM=(function(){function n(){}return n.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",n.SCAN_DEFAULT_FPS=2,n.DEFAULT_DISABLE_FLIP=!1,n.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,n.DEFAULT_SUPPORTED_SCAN_TYPE=[Nh.SCAN_TYPE_CAMERA,Nh.SCAN_TYPE_FILE],n})(),l2=(function(){function n(e,t){this.format=e,this.formatName=t}return n.prototype.toString=function(){return this.formatName},n.create=function(e){if(!Ew.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new n(e,Ew.get(e))},n})(),Tw=(function(){function n(){}return n.createFromText=function(e){var t={text:e};return{decodedText:e,result:t}},n.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},n})(),qm;(function(n){n[n.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",n[n.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",n[n.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(qm||(qm={}));var UM=(function(){function n(){}return n.createFrom=function(e){return{errorMessage:e,type:qm.UNKWOWN_ERROR}},n})(),BM=(function(){function n(e){this.verbose=e}return n.prototype.log=function(e){this.verbose&&console.log(e)},n.prototype.warn=function(e){this.verbose&&console.warn(e)},n.prototype.logError=function(e,t){(this.verbose||t===!0)&&console.error(e)},n.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},n})();function vo(n){return typeof n>"u"||n===null}var $l=(function(){function n(){}return n.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},n.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},n.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},n.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},n.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},n.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},n.scannerPaused=function(){return"Scanner paused"},n})(),c2=(function(){function n(){}return n.isMediaStreamConstraintsValid=function(e,t){if(typeof e!="object"){var i=typeof e;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(i,"."),!0),!1}for(var o=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],c=new Set(o),f=Object.keys(e),y=0,w=f;y<w.length;y++){var x=w[y];if(c.has(x))return t.logError("".concat(x," is not supported videoConstaints."),!0),!1}return!0},n})(),du={exports:{}},FM=du.exports,Aw;function jM(){return Aw||(Aw=1,(function(n,e){(function(t,i){i(e)})(FM,(function(t){function i(B){return B==null}var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,r){B.__proto__=r}||function(B,r){for(var l in r)r.hasOwnProperty(l)&&(B[l]=r[l])};function c(B,r){o(B,r);function l(){this.constructor=B}B.prototype=r===null?Object.create(r):(l.prototype=r.prototype,new l)}function f(B,r){var l=Object.setPrototypeOf;l?l(B,r):B.__proto__=r}function y(B,r){r===void 0&&(r=B.constructor);var l=Error.captureStackTrace;l&&l(B,r)}var w=(function(B){c(r,B);function r(l){var u=this.constructor,m=B.call(this,l)||this;return Object.defineProperty(m,"name",{value:u.name,enumerable:!1}),f(m,u.prototype),y(m),m}return r})(Error);class x extends w{constructor(r=void 0){super(r),this.message=r}getKind(){return this.constructor.kind}}x.kind="Exception";class A extends x{}A.kind="ArgumentException";class N extends x{}N.kind="IllegalArgumentException";class R{constructor(r){if(this.binarizer=r,r===null)throw new N("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(r,l){return this.binarizer.getBlackRow(r,l)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(r,l,u,m){const g=this.binarizer.getLuminanceSource().crop(r,l,u,m);return new R(this.binarizer.createBinarizer(g))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new R(this.binarizer.createBinarizer(r))}rotateCounterClockwise45(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new R(this.binarizer.createBinarizer(r))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class k extends x{static getChecksumInstance(){return new k}}k.kind="ChecksumException";class H{constructor(r){this.source=r}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class W{static arraycopy(r,l,u,m,g){for(;g--;)u[m++]=r[l++]}static currentTimeMillis(){return Date.now()}}class K extends x{}K.kind="IndexOutOfBoundsException";class te extends K{constructor(r=void 0,l=void 0){super(l),this.index=r,this.message=l}}te.kind="ArrayIndexOutOfBoundsException";class le{static fill(r,l){for(let u=0,m=r.length;u<m;u++)r[u]=l}static fillWithin(r,l,u,m){le.rangeCheck(r.length,l,u);for(let g=l;g<u;g++)r[g]=m}static rangeCheck(r,l,u){if(l>u)throw new N("fromIndex("+l+") > toIndex("+u+")");if(l<0)throw new te(l);if(u>r)throw new te(u)}static asList(...r){return r}static create(r,l,u){return Array.from({length:r}).map(g=>Array.from({length:l}).fill(u))}static createInt32Array(r,l,u){return Array.from({length:r}).map(g=>Int32Array.from({length:l}).fill(u))}static equals(r,l){if(!r||!l||!r.length||!l.length||r.length!==l.length)return!1;for(let u=0,m=r.length;u<m;u++)if(r[u]!==l[u])return!1;return!0}static hashCode(r){if(r===null)return 0;let l=1;for(const u of r)l=31*l+u;return l}static fillUint8Array(r,l){for(let u=0;u!==r.length;u++)r[u]=l}static copyOf(r,l){return r.slice(0,l)}static copyOfUint8Array(r,l){if(r.length<=l){const u=new Uint8Array(l);return u.set(r),u}return r.slice(0,l)}static copyOfRange(r,l,u){const m=u-l,g=new Int32Array(m);return W.arraycopy(r,l,g,0,m),g}static binarySearch(r,l,u){u===void 0&&(u=le.numberComparator);let m=0,g=r.length-1;for(;m<=g;){const v=g+m>>1,_=u(l,r[v]);if(_>0)m=v+1;else if(_<0)g=v-1;else return v}return-m-1}static numberComparator(r,l){return r-l}}class ee{static numberOfTrailingZeros(r){let l;if(r===0)return 32;let u=31;return l=r<<16,l!==0&&(u-=16,r=l),l=r<<8,l!==0&&(u-=8,r=l),l=r<<4,l!==0&&(u-=4,r=l),l=r<<2,l!==0&&(u-=2,r=l),u-(r<<1>>>31)}static numberOfLeadingZeros(r){if(r===0)return 32;let l=1;return r>>>16||(l+=16,r<<=16),r>>>24||(l+=8,r<<=8),r>>>28||(l+=4,r<<=4),r>>>30||(l+=2,r<<=2),l-=r>>>31,l}static toHexString(r){return r.toString(16)}static toBinaryString(r){return String(parseInt(String(r),2))}static bitCount(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),r=r+(r>>>4)&252645135,r=r+(r>>>8),r=r+(r>>>16),r&63}static truncDivision(r,l){return Math.trunc(r/l)}static parseInt(r,l=void 0){return parseInt(r,l)}}ee.MIN_VALUE_32_BITS=-2147483648,ee.MAX_VALUE=Number.MAX_SAFE_INTEGER;class de{constructor(r,l){r===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=r,l==null?this.bits=de.makeArray(r):this.bits=l)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(r){if(r>this.bits.length*32){const l=de.makeArray(r);W.arraycopy(this.bits,0,l,0,this.bits.length),this.bits=l}}get(r){return(this.bits[Math.floor(r/32)]&1<<(r&31))!==0}set(r){this.bits[Math.floor(r/32)]|=1<<(r&31)}flip(r){this.bits[Math.floor(r/32)]^=1<<(r&31)}getNextSet(r){const l=this.size;if(r>=l)return l;const u=this.bits;let m=Math.floor(r/32),g=u[m];g&=~((1<<(r&31))-1);const v=u.length;for(;g===0;){if(++m===v)return l;g=u[m]}const _=m*32+ee.numberOfTrailingZeros(g);return _>l?l:_}getNextUnset(r){const l=this.size;if(r>=l)return l;const u=this.bits;let m=Math.floor(r/32),g=~u[m];g&=~((1<<(r&31))-1);const v=u.length;for(;g===0;){if(++m===v)return l;g=~u[m]}const _=m*32+ee.numberOfTrailingZeros(g);return _>l?l:_}setBulk(r,l){this.bits[Math.floor(r/32)]=l}setRange(r,l){if(l<r||r<0||l>this.size)throw new N;if(l===r)return;l--;const u=Math.floor(r/32),m=Math.floor(l/32),g=this.bits;for(let v=u;v<=m;v++){const _=v>u?0:r&31,M=(2<<(v<m?31:l&31))-(1<<_);g[v]|=M}}clear(){const r=this.bits.length,l=this.bits;for(let u=0;u<r;u++)l[u]=0}isRange(r,l,u){if(l<r||r<0||l>this.size)throw new N;if(l===r)return!0;l--;const m=Math.floor(r/32),g=Math.floor(l/32),v=this.bits;for(let _=m;_<=g;_++){const C=_>m?0:r&31,O=(2<<(_<g?31:l&31))-(1<<C)&4294967295;if((v[_]&O)!==(u?O:0))return!1}return!0}appendBit(r){this.ensureCapacity(this.size+1),r&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(r,l){if(l<0||l>32)throw new N("Num bits must be between 0 and 32");this.ensureCapacity(this.size+l);for(let u=l;u>0;u--)this.appendBit((r>>u-1&1)===1)}appendBitArray(r){const l=r.size;this.ensureCapacity(this.size+l);for(let u=0;u<l;u++)this.appendBit(r.get(u))}xor(r){if(this.size!==r.size)throw new N("Sizes don't match");const l=this.bits;for(let u=0,m=l.length;u<m;u++)l[u]^=r.bits[u]}toBytes(r,l,u,m){for(let g=0;g<m;g++){let v=0;for(let _=0;_<8;_++)this.get(r)&&(v|=1<<7-_),r++;l[u+g]=v}}getBitArray(){return this.bits}reverse(){const r=new Int32Array(this.bits.length),l=Math.floor((this.size-1)/32),u=l+1,m=this.bits;for(let g=0;g<u;g++){let v=m[g];v=v>>1&1431655765|(v&1431655765)<<1,v=v>>2&858993459|(v&858993459)<<2,v=v>>4&252645135|(v&252645135)<<4,v=v>>8&16711935|(v&16711935)<<8,v=v>>16&65535|(v&65535)<<16,r[l-g]=v}if(this.size!==u*32){const g=u*32-this.size;let v=r[0]>>>g;for(let _=1;_<u;_++){const C=r[_];v|=C<<32-g,r[_-1]=v,v=C>>>g}r[u-1]=v}this.bits=r}static makeArray(r){return new Int32Array(Math.floor((r+31)/32))}equals(r){if(!(r instanceof de))return!1;const l=r;return this.size===l.size&&le.equals(this.bits,l.bits)}hashCode(){return 31*this.size+le.hashCode(this.bits)}toString(){let r="";for(let l=0,u=this.size;l<u;l++)(l&7)===0&&(r+=" "),r+=this.get(l)?"X":".";return r}clone(){return new de(this.size,this.bits.slice())}}var Ee;(function(B){B[B.OTHER=0]="OTHER",B[B.PURE_BARCODE=1]="PURE_BARCODE",B[B.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",B[B.TRY_HARDER=3]="TRY_HARDER",B[B.CHARACTER_SET=4]="CHARACTER_SET",B[B.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",B[B.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",B[B.ASSUME_GS1=7]="ASSUME_GS1",B[B.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",B[B.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",B[B.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(Ee||(Ee={}));var me=Ee;class U extends x{static getFormatInstance(){return new U}}U.kind="FormatException";var V;(function(B){B[B.Cp437=0]="Cp437",B[B.ISO8859_1=1]="ISO8859_1",B[B.ISO8859_2=2]="ISO8859_2",B[B.ISO8859_3=3]="ISO8859_3",B[B.ISO8859_4=4]="ISO8859_4",B[B.ISO8859_5=5]="ISO8859_5",B[B.ISO8859_6=6]="ISO8859_6",B[B.ISO8859_7=7]="ISO8859_7",B[B.ISO8859_8=8]="ISO8859_8",B[B.ISO8859_9=9]="ISO8859_9",B[B.ISO8859_10=10]="ISO8859_10",B[B.ISO8859_11=11]="ISO8859_11",B[B.ISO8859_13=12]="ISO8859_13",B[B.ISO8859_14=13]="ISO8859_14",B[B.ISO8859_15=14]="ISO8859_15",B[B.ISO8859_16=15]="ISO8859_16",B[B.SJIS=16]="SJIS",B[B.Cp1250=17]="Cp1250",B[B.Cp1251=18]="Cp1251",B[B.Cp1252=19]="Cp1252",B[B.Cp1256=20]="Cp1256",B[B.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",B[B.UTF8=22]="UTF8",B[B.ASCII=23]="ASCII",B[B.Big5=24]="Big5",B[B.GB18030=25]="GB18030",B[B.EUC_KR=26]="EUC_KR"})(V||(V={}));class F{constructor(r,l,u,...m){this.valueIdentifier=r,this.name=u,typeof l=="number"?this.values=Int32Array.from([l]):this.values=l,this.otherEncodingNames=m,F.VALUE_IDENTIFIER_TO_ECI.set(r,this),F.NAME_TO_ECI.set(u,this);const g=this.values;for(let v=0,_=g.length;v!==_;v++){const C=g[v];F.VALUES_TO_ECI.set(C,this)}for(const v of m)F.NAME_TO_ECI.set(v,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(r){if(r<0||r>=900)throw new U("incorect value");const l=F.VALUES_TO_ECI.get(r);if(l===void 0)throw new U("incorect value");return l}static getCharacterSetECIByName(r){const l=F.NAME_TO_ECI.get(r);if(l===void 0)throw new U("incorect value");return l}equals(r){if(!(r instanceof F))return!1;const l=r;return this.getName()===l.getName()}}F.VALUE_IDENTIFIER_TO_ECI=new Map,F.VALUES_TO_ECI=new Map,F.NAME_TO_ECI=new Map,F.Cp437=new F(V.Cp437,Int32Array.from([0,2]),"Cp437"),F.ISO8859_1=new F(V.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),F.ISO8859_2=new F(V.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),F.ISO8859_3=new F(V.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),F.ISO8859_4=new F(V.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),F.ISO8859_5=new F(V.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),F.ISO8859_6=new F(V.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),F.ISO8859_7=new F(V.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),F.ISO8859_8=new F(V.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),F.ISO8859_9=new F(V.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),F.ISO8859_10=new F(V.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),F.ISO8859_11=new F(V.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),F.ISO8859_13=new F(V.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),F.ISO8859_14=new F(V.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),F.ISO8859_15=new F(V.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),F.ISO8859_16=new F(V.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),F.SJIS=new F(V.SJIS,20,"SJIS","Shift_JIS"),F.Cp1250=new F(V.Cp1250,21,"Cp1250","windows-1250"),F.Cp1251=new F(V.Cp1251,22,"Cp1251","windows-1251"),F.Cp1252=new F(V.Cp1252,23,"Cp1252","windows-1252"),F.Cp1256=new F(V.Cp1256,24,"Cp1256","windows-1256"),F.UnicodeBigUnmarked=new F(V.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),F.UTF8=new F(V.UTF8,26,"UTF8","UTF-8"),F.ASCII=new F(V.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),F.Big5=new F(V.Big5,28,"Big5"),F.GB18030=new F(V.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),F.EUC_KR=new F(V.EUC_KR,30,"EUC_KR","EUC-KR");class Q extends x{}Q.kind="UnsupportedOperationException";class Y{static decode(r,l){const u=this.encodingName(l);return this.customDecoder?this.customDecoder(r,u):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(u)?this.decodeFallback(r,u):new TextDecoder(u).decode(r)}static shouldDecodeOnFallback(r){return!Y.isBrowser()&&r==="ISO-8859-1"}static encode(r,l){const u=this.encodingName(l);return this.customEncoder?this.customEncoder(r,u):typeof TextEncoder>"u"?this.encodeFallback(r):new TextEncoder().encode(r)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(r){return typeof r=="string"?r:r.getName()}static encodingCharacterSet(r){return r instanceof F?r:F.getCharacterSetECIByName(r)}static decodeFallback(r,l){const u=this.encodingCharacterSet(l);if(Y.isDecodeFallbackSupported(u)){let m="";for(let g=0,v=r.length;g<v;g++){let _=r[g].toString(16);_.length<2&&(_="0"+_),m+="%"+_}return decodeURIComponent(m)}if(u.equals(F.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(r.buffer));throw new Q(`Encoding ${this.encodingName(l)} not supported by fallback.`)}static isDecodeFallbackSupported(r){return r.equals(F.UTF8)||r.equals(F.ISO8859_1)||r.equals(F.ASCII)}static encodeFallback(r){const u=btoa(unescape(encodeURIComponent(r))).split(""),m=[];for(let g=0;g<u.length;g++)m.push(u[g].charCodeAt(0));return new Uint8Array(m)}}class ${static castAsNonUtf8Char(r,l=null){const u=l?l.getName():this.ISO88591;return Y.decode(new Uint8Array([r]),u)}static guessEncoding(r,l){if(l!=null&&l.get(me.CHARACTER_SET)!==void 0)return l.get(me.CHARACTER_SET).toString();const u=r.length;let m=!0,g=!0,v=!0,_=0,C=0,M=0,O=0,j=0,G=0,Z=0,re=0,ce=0,ye=0,Ce=0;const qe=r.length>3&&r[0]===239&&r[1]===187&&r[2]===191;for(let He=0;He<u&&(m||g||v);He++){const Fe=r[He]&255;v&&(_>0?(Fe&128)===0?v=!1:_--:(Fe&128)!==0&&((Fe&64)===0?v=!1:(_++,(Fe&32)===0?C++:(_++,(Fe&16)===0?M++:(_++,(Fe&8)===0?O++:v=!1))))),m&&(Fe>127&&Fe<160?m=!1:Fe>159&&(Fe<192||Fe===215||Fe===247)&&Ce++),g&&(j>0?Fe<64||Fe===127||Fe>252?g=!1:j--:Fe===128||Fe===160||Fe>239?g=!1:Fe>160&&Fe<224?(G++,re=0,Z++,Z>ce&&(ce=Z)):Fe>127?(j++,Z=0,re++,re>ye&&(ye=re)):(Z=0,re=0))}return v&&_>0&&(v=!1),g&&j>0&&(g=!1),v&&(qe||C+M+O>0)?$.UTF8:g&&($.ASSUME_SHIFT_JIS||ce>=3||ye>=3)?$.SHIFT_JIS:m&&g?ce===2&&G===2||Ce*10>=u?$.SHIFT_JIS:$.ISO88591:m?$.ISO88591:g?$.SHIFT_JIS:v?$.UTF8:$.PLATFORM_DEFAULT_ENCODING}static format(r,...l){let u=-1;function m(v,_,C,M,O,j){if(v==="%%")return"%";if(l[++u]===void 0)return;v=M?parseInt(M.substr(1)):void 0;let G=O?parseInt(O.substr(1)):void 0,Z;switch(j){case"s":Z=l[u];break;case"c":Z=l[u][0];break;case"f":Z=parseFloat(l[u]).toFixed(v);break;case"p":Z=parseFloat(l[u]).toPrecision(v);break;case"e":Z=parseFloat(l[u]).toExponential(v);break;case"x":Z=parseInt(l[u]).toString(G||16);break;case"d":Z=parseFloat(parseInt(l[u],G||10).toPrecision(v)).toFixed(0);break}Z=typeof Z=="object"?JSON.stringify(Z):(+Z).toString(G);let re=parseInt(C),ce=C&&C[0]+""=="0"?"0":" ";for(;Z.length<re;)Z=_!==void 0?Z+ce:ce+Z;return Z}let g=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(g,m)}static getBytes(r,l){return Y.encode(r,l)}static getCharCode(r,l=0){return r.charCodeAt(l)}static getCharAt(r){return String.fromCharCode(r)}}$.SHIFT_JIS=F.SJIS.getName(),$.GB2312="GB2312",$.ISO88591=F.ISO8859_1.getName(),$.EUC_JP="EUC_JP",$.UTF8=F.UTF8.getName(),$.PLATFORM_DEFAULT_ENCODING=$.UTF8,$.ASSUME_SHIFT_JIS=!1;class z{constructor(r=""){this.value=r}enableDecoding(r){return this.encoding=r,this}append(r){return typeof r=="string"?this.value+=r.toString():this.encoding?this.value+=$.castAsNonUtf8Char(r,this.encoding):this.value+=String.fromCharCode(r),this}appendChars(r,l,u){for(let m=l;l<l+u;m++)this.append(r[m]);return this}length(){return this.value.length}charAt(r){return this.value.charAt(r)}deleteCharAt(r){this.value=this.value.substr(0,r)+this.value.substring(r+1)}setCharAt(r,l){this.value=this.value.substr(0,r)+l+this.value.substr(r+1)}substring(r,l){return this.value.substring(r,l)}setLengthToZero(){this.value=""}toString(){return this.value}insert(r,l){this.value=this.value.substr(0,r)+l+this.value.substr(r+l.length)}}class _e{constructor(r,l,u,m){if(this.width=r,this.height=l,this.rowSize=u,this.bits=m,l==null&&(l=r),this.height=l,r<1||l<1)throw new N("Both dimensions must be greater than 0");u==null&&(u=Math.floor((r+31)/32)),this.rowSize=u,m==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(r){const l=r.length,u=r[0].length,m=new _e(u,l);for(let g=0;g<l;g++){const v=r[g];for(let _=0;_<u;_++)v[_]&&m.set(_,g)}return m}static parseFromString(r,l,u){if(r===null)throw new N("stringRepresentation cannot be null");const m=new Array(r.length);let g=0,v=0,_=-1,C=0,M=0;for(;M<r.length;)if(r.charAt(M)===`
`||r.charAt(M)==="\r"){if(g>v){if(_===-1)_=g-v;else if(g-v!==_)throw new N("row lengths do not match");v=g,C++}M++}else if(r.substring(M,M+l.length)===l)M+=l.length,m[g]=!0,g++;else if(r.substring(M,M+u.length)===u)M+=u.length,m[g]=!1,g++;else throw new N("illegal character encountered: "+r.substring(M));if(g>v){if(_===-1)_=g-v;else if(g-v!==_)throw new N("row lengths do not match");C++}const O=new _e(_,C);for(let j=0;j<g;j++)m[j]&&O.set(Math.floor(j%_),Math.floor(j/_));return O}get(r,l){const u=l*this.rowSize+Math.floor(r/32);return(this.bits[u]>>>(r&31)&1)!==0}set(r,l){const u=l*this.rowSize+Math.floor(r/32);this.bits[u]|=1<<(r&31)&4294967295}unset(r,l){const u=l*this.rowSize+Math.floor(r/32);this.bits[u]&=~(1<<(r&31)&4294967295)}flip(r,l){const u=l*this.rowSize+Math.floor(r/32);this.bits[u]^=1<<(r&31)&4294967295}xor(r){if(this.width!==r.getWidth()||this.height!==r.getHeight()||this.rowSize!==r.getRowSize())throw new N("input matrix dimensions do not match");const l=new de(Math.floor(this.width/32)+1),u=this.rowSize,m=this.bits;for(let g=0,v=this.height;g<v;g++){const _=g*u,C=r.getRow(g,l).getBitArray();for(let M=0;M<u;M++)m[_+M]^=C[M]}}clear(){const r=this.bits,l=r.length;for(let u=0;u<l;u++)r[u]=0}setRegion(r,l,u,m){if(l<0||r<0)throw new N("Left and top must be nonnegative");if(m<1||u<1)throw new N("Height and width must be at least 1");const g=r+u,v=l+m;if(v>this.height||g>this.width)throw new N("The region must fit inside the matrix");const _=this.rowSize,C=this.bits;for(let M=l;M<v;M++){const O=M*_;for(let j=r;j<g;j++)C[O+Math.floor(j/32)]|=1<<(j&31)&4294967295}}getRow(r,l){l==null||l.getSize()<this.width?l=new de(this.width):l.clear();const u=this.rowSize,m=this.bits,g=r*u;for(let v=0;v<u;v++)l.setBulk(v*32,m[g+v]);return l}setRow(r,l){W.arraycopy(l.getBitArray(),0,this.bits,r*this.rowSize,this.rowSize)}rotate180(){const r=this.getWidth(),l=this.getHeight();let u=new de(r),m=new de(r);for(let g=0,v=Math.floor((l+1)/2);g<v;g++)u=this.getRow(g,u),m=this.getRow(l-1-g,m),u.reverse(),m.reverse(),this.setRow(g,m),this.setRow(l-1-g,u)}getEnclosingRectangle(){const r=this.width,l=this.height,u=this.rowSize,m=this.bits;let g=r,v=l,_=-1,C=-1;for(let M=0;M<l;M++)for(let O=0;O<u;O++){const j=m[M*u+O];if(j!==0){if(M<v&&(v=M),M>C&&(C=M),O*32<g){let G=0;for(;(j<<31-G&4294967295)===0;)G++;O*32+G<g&&(g=O*32+G)}if(O*32+31>_){let G=31;for(;!(j>>>G);)G--;O*32+G>_&&(_=O*32+G)}}}return _<g||C<v?null:Int32Array.from([g,v,_-g+1,C-v+1])}getTopLeftOnBit(){const r=this.rowSize,l=this.bits;let u=0;for(;u<l.length&&l[u]===0;)u++;if(u===l.length)return null;const m=u/r;let g=u%r*32;const v=l[u];let _=0;for(;(v<<31-_&4294967295)===0;)_++;return g+=_,Int32Array.from([g,m])}getBottomRightOnBit(){const r=this.rowSize,l=this.bits;let u=l.length-1;for(;u>=0&&l[u]===0;)u--;if(u<0)return null;const m=Math.floor(u/r);let g=Math.floor(u%r)*32;const v=l[u];let _=31;for(;!(v>>>_);)_--;return g+=_,Int32Array.from([g,m])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(r){if(!(r instanceof _e))return!1;const l=r;return this.width===l.width&&this.height===l.height&&this.rowSize===l.rowSize&&le.equals(this.bits,l.bits)}hashCode(){let r=this.width;return r=31*r+this.width,r=31*r+this.height,r=31*r+this.rowSize,r=31*r+le.hashCode(this.bits),r}toString(r="X ",l="  ",u=`
`){return this.buildToString(r,l,u)}buildToString(r,l,u){let m=new z;for(let g=0,v=this.height;g<v;g++){for(let _=0,C=this.width;_<C;_++)m.append(this.get(_,g)?r:l);m.append(u)}return m.toString()}clone(){return new _e(this.width,this.height,this.rowSize,this.bits.slice())}}class he extends x{static getNotFoundInstance(){return new he}}he.kind="NotFoundException";class ne extends H{constructor(r){super(r),this.luminances=ne.EMPTY,this.buckets=new Int32Array(ne.LUMINANCE_BUCKETS)}getBlackRow(r,l){const u=this.getLuminanceSource(),m=u.getWidth();l==null||l.getSize()<m?l=new de(m):l.clear(),this.initArrays(m);const g=u.getRow(r,this.luminances),v=this.buckets;for(let C=0;C<m;C++)v[(g[C]&255)>>ne.LUMINANCE_SHIFT]++;const _=ne.estimateBlackPoint(v);if(m<3)for(let C=0;C<m;C++)(g[C]&255)<_&&l.set(C);else{let C=g[0]&255,M=g[1]&255;for(let O=1;O<m-1;O++){const j=g[O+1]&255;(M*4-C-j)/2<_&&l.set(O),C=M,M=j}}return l}getBlackMatrix(){const r=this.getLuminanceSource(),l=r.getWidth(),u=r.getHeight(),m=new _e(l,u);this.initArrays(l);const g=this.buckets;for(let C=1;C<5;C++){const M=Math.floor(u*C/5),O=r.getRow(M,this.luminances),j=Math.floor(l*4/5);for(let G=Math.floor(l/5);G<j;G++){const Z=O[G]&255;g[Z>>ne.LUMINANCE_SHIFT]++}}const v=ne.estimateBlackPoint(g),_=r.getMatrix();for(let C=0;C<u;C++){const M=C*l;for(let O=0;O<l;O++)(_[M+O]&255)<v&&m.set(O,C)}return m}createBinarizer(r){return new ne(r)}initArrays(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));const l=this.buckets;for(let u=0;u<ne.LUMINANCE_BUCKETS;u++)l[u]=0}static estimateBlackPoint(r){const l=r.length;let u=0,m=0,g=0;for(let O=0;O<l;O++)r[O]>g&&(m=O,g=r[O]),r[O]>u&&(u=r[O]);let v=0,_=0;for(let O=0;O<l;O++){const j=O-m,G=r[O]*j*j;G>_&&(v=O,_=G)}if(m>v){const O=m;m=v,v=O}if(v-m<=l/16)throw new he;let C=v-1,M=-1;for(let O=v-1;O>m;O--){const j=O-m,G=j*j*(v-O)*(u-r[O]);G>M&&(C=O,M=G)}return C<<ne.LUMINANCE_SHIFT}}ne.LUMINANCE_BITS=5,ne.LUMINANCE_SHIFT=8-ne.LUMINANCE_BITS,ne.LUMINANCE_BUCKETS=1<<ne.LUMINANCE_BITS,ne.EMPTY=Uint8ClampedArray.from([0]);class ie extends ne{constructor(r){super(r),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const r=this.getLuminanceSource(),l=r.getWidth(),u=r.getHeight();if(l>=ie.MINIMUM_DIMENSION&&u>=ie.MINIMUM_DIMENSION){const m=r.getMatrix();let g=l>>ie.BLOCK_SIZE_POWER;(l&ie.BLOCK_SIZE_MASK)!==0&&g++;let v=u>>ie.BLOCK_SIZE_POWER;(u&ie.BLOCK_SIZE_MASK)!==0&&v++;const _=ie.calculateBlackPoints(m,g,v,l,u),C=new _e(l,u);ie.calculateThresholdForBlock(m,g,v,l,u,_,C),this.matrix=C}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(r){return new ie(r)}static calculateThresholdForBlock(r,l,u,m,g,v,_){const C=g-ie.BLOCK_SIZE,M=m-ie.BLOCK_SIZE;for(let O=0;O<u;O++){let j=O<<ie.BLOCK_SIZE_POWER;j>C&&(j=C);const G=ie.cap(O,2,u-3);for(let Z=0;Z<l;Z++){let re=Z<<ie.BLOCK_SIZE_POWER;re>M&&(re=M);const ce=ie.cap(Z,2,l-3);let ye=0;for(let qe=-2;qe<=2;qe++){const He=v[G+qe];ye+=He[ce-2]+He[ce-1]+He[ce]+He[ce+1]+He[ce+2]}const Ce=ye/25;ie.thresholdBlock(r,re,j,Ce,m,_)}}}static cap(r,l,u){return r<l?l:r>u?u:r}static thresholdBlock(r,l,u,m,g,v){for(let _=0,C=u*g+l;_<ie.BLOCK_SIZE;_++,C+=g)for(let M=0;M<ie.BLOCK_SIZE;M++)(r[C+M]&255)<=m&&v.set(l+M,u+_)}static calculateBlackPoints(r,l,u,m,g){const v=g-ie.BLOCK_SIZE,_=m-ie.BLOCK_SIZE,C=new Array(u);for(let M=0;M<u;M++){C[M]=new Int32Array(l);let O=M<<ie.BLOCK_SIZE_POWER;O>v&&(O=v);for(let j=0;j<l;j++){let G=j<<ie.BLOCK_SIZE_POWER;G>_&&(G=_);let Z=0,re=255,ce=0;for(let Ce=0,qe=O*m+G;Ce<ie.BLOCK_SIZE;Ce++,qe+=m){for(let He=0;He<ie.BLOCK_SIZE;He++){const Fe=r[qe+He]&255;Z+=Fe,Fe<re&&(re=Fe),Fe>ce&&(ce=Fe)}if(ce-re>ie.MIN_DYNAMIC_RANGE)for(Ce++,qe+=m;Ce<ie.BLOCK_SIZE;Ce++,qe+=m)for(let He=0;He<ie.BLOCK_SIZE;He++)Z+=r[qe+He]&255}let ye=Z>>ie.BLOCK_SIZE_POWER*2;if(ce-re<=ie.MIN_DYNAMIC_RANGE&&(ye=re/2,M>0&&j>0)){const Ce=(C[M-1][j]+2*C[M][j-1]+C[M-1][j-1])/4;re<Ce&&(ye=Ce)}C[M][j]=ye}}return C}}ie.BLOCK_SIZE_POWER=3,ie.BLOCK_SIZE=1<<ie.BLOCK_SIZE_POWER,ie.BLOCK_SIZE_MASK=ie.BLOCK_SIZE-1,ie.MINIMUM_DIMENSION=ie.BLOCK_SIZE*5,ie.MIN_DYNAMIC_RANGE=24;class Me{constructor(r,l){this.width=r,this.height=l}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(r,l,u,m){throw new Q("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Q("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Q("This luminance source does not support rotation by 45 degrees.")}toString(){const r=new Uint8ClampedArray(this.width);let l=new z;for(let u=0;u<this.height;u++){const m=this.getRow(u,r);for(let g=0;g<this.width;g++){const v=m[g]&255;let _;v<64?_="#":v<128?_="+":v<192?_=".":_=" ",l.append(_)}l.append(`
`)}return l.toString()}}class ze extends Me{constructor(r){super(r.getWidth(),r.getHeight()),this.delegate=r}getRow(r,l){const u=this.delegate.getRow(r,l),m=this.getWidth();for(let g=0;g<m;g++)u[g]=255-(u[g]&255);return u}getMatrix(){const r=this.delegate.getMatrix(),l=this.getWidth()*this.getHeight(),u=new Uint8ClampedArray(l);for(let m=0;m<l;m++)u[m]=255-(r[m]&255);return u}isCropSupported(){return this.delegate.isCropSupported()}crop(r,l,u,m){return new ze(this.delegate.crop(r,l,u,m))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new ze(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new ze(this.delegate.rotateCounterClockwise45())}}class ct extends Me{constructor(r){super(r.width,r.height),this.canvas=r,this.tempCanvasElement=null,this.buffer=ct.makeBufferFromCanvasImageData(r)}static makeBufferFromCanvasImageData(r){const l=r.getContext("2d").getImageData(0,0,r.width,r.height);return ct.toGrayscaleBuffer(l.data,r.width,r.height)}static toGrayscaleBuffer(r,l,u){const m=new Uint8ClampedArray(l*u);for(let g=0,v=0,_=r.length;g<_;g+=4,v++){let C;if(r[g+3]===0)C=255;else{const O=r[g],j=r[g+1],G=r[g+2];C=306*O+601*j+117*G+512>>10}m[v]=C}return m}getRow(r,l){if(r<0||r>=this.getHeight())throw new N("Requested row is outside the image: "+r);const u=this.getWidth(),m=r*u;return l===null?l=this.buffer.slice(m,m+u):(l.length<u&&(l=new Uint8ClampedArray(u)),l.set(this.buffer.slice(m,m+u))),l}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(r,l,u,m){return super.crop(r,l,u,m),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement}rotate(r){const l=this.getTempCanvasElement(),u=l.getContext("2d"),m=r*ct.DEGREE_TO_RADIANS,g=this.canvas.width,v=this.canvas.height,_=Math.ceil(Math.abs(Math.cos(m))*g+Math.abs(Math.sin(m))*v),C=Math.ceil(Math.abs(Math.sin(m))*g+Math.abs(Math.cos(m))*v);return l.width=_,l.height=C,u.translate(_/2,C/2),u.rotate(m),u.drawImage(this.canvas,g/-2,v/-2),this.buffer=ct.makeBufferFromCanvasImageData(l),this}invert(){return new ze(this)}}ct.DEGREE_TO_RADIANS=Math.PI/180;class ae{constructor(r,l,u){this.deviceId=r,this.label=l,this.kind="videoinput",this.groupId=u||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Ie=(globalThis||$d||self||window||void 0)&&(globalThis||$d||self||window||void 0).__awaiter||function(B,r,l,u){function m(g){return g instanceof l?g:new l(function(v){v(g)})}return new(l||(l=Promise))(function(g,v){function _(O){try{M(u.next(O))}catch(j){v(j)}}function C(O){try{M(u.throw(O))}catch(j){v(j)}}function M(O){O.done?g(O.value):m(O.value).then(_,C)}M((u=u.apply(B,r||[])).next())})};class Ae{constructor(r,l=500,u){this.reader=r,this.timeBetweenScansMillis=l,this._hints=u,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(r){this._timeBetweenDecodingAttempts=r<0?0:r}set hints(r){this._hints=r||null}get hints(){return this._hints}listVideoInputDevices(){return Ie(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const r=yield navigator.mediaDevices.enumerateDevices(),l=[];for(const u of r){const m=u.kind==="video"?"videoinput":u.kind;if(m!=="videoinput")continue;const g=u.deviceId||u.id,v=u.label||`Video device ${l.length+1}`,_=u.groupId,C={deviceId:g,label:v,kind:m,groupId:_};l.push(C)}return l})}getVideoInputDevices(){return Ie(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(l=>new ae(l.deviceId,l.label))})}findDeviceById(r){return Ie(this,void 0,void 0,function*(){const l=yield this.listVideoInputDevices();return l?l.find(u=>u.deviceId===r):null})}decodeFromInputVideoDevice(r,l){return Ie(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(r,l)})}decodeOnceFromVideoDevice(r,l){return Ie(this,void 0,void 0,function*(){this.reset();let u;r?u={deviceId:{exact:r}}:u={facingMode:"environment"};const m={video:u};return yield this.decodeOnceFromConstraints(m,l)})}decodeOnceFromConstraints(r,l){return Ie(this,void 0,void 0,function*(){const u=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeOnceFromStream(u,l)})}decodeOnceFromStream(r,l){return Ie(this,void 0,void 0,function*(){this.reset();const u=yield this.attachStreamToVideo(r,l);return yield this.decodeOnce(u)})}decodeFromInputVideoDeviceContinuously(r,l,u){return Ie(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(r,l,u)})}decodeFromVideoDevice(r,l,u){return Ie(this,void 0,void 0,function*(){let m;r?m={deviceId:{exact:r}}:m={facingMode:"environment"};const g={video:m};return yield this.decodeFromConstraints(g,l,u)})}decodeFromConstraints(r,l,u){return Ie(this,void 0,void 0,function*(){const m=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeFromStream(m,l,u)})}decodeFromStream(r,l,u){return Ie(this,void 0,void 0,function*(){this.reset();const m=yield this.attachStreamToVideo(r,l);return yield this.decodeContinuously(m,u)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(r,l){return Ie(this,void 0,void 0,function*(){const u=this.prepareVideoElement(l);return this.addVideoSource(u,r),this.videoElement=u,this.stream=r,yield this.playVideoOnLoadAsync(u),u})}playVideoOnLoadAsync(r){return new Promise((l,u)=>this.playVideoOnLoad(r,()=>l()))}playVideoOnLoad(r,l){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(r),r.addEventListener("ended",this.videoEndedListener),r.addEventListener("canplay",this.videoCanPlayListener),r.addEventListener("playing",l),this.tryPlayVideo(r)}isVideoPlaying(r){return r.currentTime>0&&!r.paused&&!r.ended&&r.readyState>2}tryPlayVideo(r){return Ie(this,void 0,void 0,function*(){if(this.isVideoPlaying(r)){console.warn("Trying to play video that is already playing.");return}try{yield r.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(r,l){const u=document.getElementById(r);if(!u)throw new A(`element with id '${r}' not found`);if(u.nodeName.toLowerCase()!==l.toLowerCase())throw new A(`element with id '${r}' must be an ${l} element`);return u}decodeFromImage(r,l){if(!r&&!l)throw new A("either imageElement with a src set or an url must be provided");return l&&!r?this.decodeFromImageUrl(l):this.decodeFromImageElement(r)}decodeFromVideo(r,l){if(!r&&!l)throw new A("Either an element with a src set or an URL must be provided");return l&&!r?this.decodeFromVideoUrl(l):this.decodeFromVideoElement(r)}decodeFromVideoContinuously(r,l,u){if(r===void 0&&l===void 0)throw new A("Either an element with a src set or an URL must be provided");return l&&!r?this.decodeFromVideoUrlContinuously(l,u):this.decodeFromVideoElementContinuously(r,u)}decodeFromImageElement(r){if(!r)throw new A("An image element must be provided.");this.reset();const l=this.prepareImageElement(r);this.imageElement=l;let u;return this.isImageLoaded(l)?u=this.decodeOnce(l,!1,!0):u=this._decodeOnLoadImage(l),u}decodeFromVideoElement(r){const l=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideo(l)}decodeFromVideoElementContinuously(r,l){const u=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideoContinuously(u,l)}_decodeFromVideoElementSetup(r){if(!r)throw new A("A video element must be provided.");this.reset();const l=this.prepareVideoElement(r);return this.videoElement=l,l}decodeFromImageUrl(r){if(!r)throw new A("An URL must be provided.");this.reset();const l=this.prepareImageElement();this.imageElement=l;const u=this._decodeOnLoadImage(l);return l.src=r,u}decodeFromVideoUrl(r){if(!r)throw new A("An URL must be provided.");this.reset();const l=this.prepareVideoElement(),u=this.decodeFromVideoElement(l);return l.src=r,u}decodeFromVideoUrlContinuously(r,l){if(!r)throw new A("An URL must be provided.");this.reset();const u=this.prepareVideoElement(),m=this.decodeFromVideoElementContinuously(u,l);return u.src=r,m}_decodeOnLoadImage(r){return new Promise((l,u)=>{this.imageLoadedListener=()=>this.decodeOnce(r,!1,!0).then(l,u),r.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(r){return Ie(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(r),yield this.decodeOnce(r)})}_decodeOnLoadVideoContinuously(r,l){return Ie(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(r),this.decodeContinuously(r,l)})}isImageLoaded(r){return!(!r.complete||r.naturalWidth===0)}prepareImageElement(r){let l;return typeof r>"u"&&(l=document.createElement("img"),l.width=200,l.height=200),typeof r=="string"&&(l=this.getMediaElement(r,"img")),r instanceof HTMLImageElement&&(l=r),l}prepareVideoElement(r){let l;return!r&&typeof document<"u"&&(l=document.createElement("video"),l.width=200,l.height=200),typeof r=="string"&&(l=this.getMediaElement(r,"video")),r instanceof HTMLVideoElement&&(l=r),l.setAttribute("autoplay","true"),l.setAttribute("muted","true"),l.setAttribute("playsinline","true"),l}decodeOnce(r,l=!0,u=!0){this._stopAsyncDecode=!1;const m=(g,v)=>{if(this._stopAsyncDecode){v(new he("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const _=this.decode(r);g(_)}catch(_){const C=l&&_ instanceof he,O=(_ instanceof k||_ instanceof U)&&u;if(C||O)return setTimeout(m,this._timeBetweenDecodingAttempts,g,v);v(_)}};return new Promise((g,v)=>m(g,v))}decodeContinuously(r,l){this._stopContinuousDecode=!1;const u=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const m=this.decode(r);l(m,null),setTimeout(u,this.timeBetweenScansMillis)}catch(m){l(null,m);const g=m instanceof k||m instanceof U,v=m instanceof he;(g||v)&&setTimeout(u,this._timeBetweenDecodingAttempts)}};u()}decode(r){const l=this.createBinaryBitmap(r);return this.decodeBitmap(l)}_isHTMLVideoElement(r){return r.videoWidth!==0}drawFrameOnCanvas(r,l,u){l||(l={sx:0,sy:0,sWidth:r.videoWidth,sHeight:r.videoHeight,dx:0,dy:0,dWidth:r.videoWidth,dHeight:r.videoHeight}),u||(u=this.captureCanvasContext),u.drawImage(r,l.sx,l.sy,l.sWidth,l.sHeight,l.dx,l.dy,l.dWidth,l.dHeight)}drawImageOnCanvas(r,l,u=this.captureCanvasContext){l||(l={sx:0,sy:0,sWidth:r.naturalWidth,sHeight:r.naturalHeight,dx:0,dy:0,dWidth:r.naturalWidth,dHeight:r.naturalHeight}),u||(u=this.captureCanvasContext),u.drawImage(r,l.sx,l.sy,l.sWidth,l.sHeight,l.dx,l.dy,l.dWidth,l.dHeight)}createBinaryBitmap(r){this.getCaptureCanvasContext(r),this._isHTMLVideoElement(r)?this.drawFrameOnCanvas(r):this.drawImageOnCanvas(r);const l=this.getCaptureCanvas(r),u=new ct(l),m=new ie(u);return new R(m)}getCaptureCanvasContext(r){if(!this.captureCanvasContext){const u=this.getCaptureCanvas(r).getContext("2d");this.captureCanvasContext=u}return this.captureCanvasContext}getCaptureCanvas(r){if(!this.captureCanvas){const l=this.createCaptureCanvas(r);this.captureCanvas=l}return this.captureCanvas}decodeBitmap(r){return this.reader.decode(r,this._hints)}createCaptureCanvas(r){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const l=document.createElement("canvas");let u,m;return typeof r<"u"&&(r instanceof HTMLVideoElement?(u=r.videoWidth,m=r.videoHeight):r instanceof HTMLImageElement&&(u=r.naturalWidth||r.width,m=r.naturalHeight||r.height)),l.style.width=u+"px",l.style.height=m+"px",l.width=u,l.height=m,l}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(r=>r.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(r,l){try{r.srcObject=l}catch{r.src=URL.createObjectURL(l)}}cleanVideoSource(r){try{r.srcObject=null}catch{r.src=""}this.videoElement.removeAttribute("src")}}class je{constructor(r,l,u=l==null?0:8*l.length,m,g,v=W.currentTimeMillis()){this.text=r,this.rawBytes=l,this.numBits=u,this.resultPoints=m,this.format=g,this.timestamp=v,this.text=r,this.rawBytes=l,u==null?this.numBits=l==null?0:8*l.length:this.numBits=u,this.resultPoints=m,this.format=g,this.resultMetadata=null,v==null?this.timestamp=W.currentTimeMillis():this.timestamp=v}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(r,l){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(r,l)}putAllMetadata(r){r!==null&&(this.resultMetadata===null?this.resultMetadata=r:this.resultMetadata=new Map(r))}addResultPoints(r){const l=this.resultPoints;if(l===null)this.resultPoints=r;else if(r!==null&&r.length>0){const u=new Array(l.length+r.length);W.arraycopy(l,0,u,0,l.length),W.arraycopy(r,0,u,l.length,r.length),this.resultPoints=u}}getTimestamp(){return this.timestamp}toString(){return this.text}}var rt;(function(B){B[B.AZTEC=0]="AZTEC",B[B.CODABAR=1]="CODABAR",B[B.CODE_39=2]="CODE_39",B[B.CODE_93=3]="CODE_93",B[B.CODE_128=4]="CODE_128",B[B.DATA_MATRIX=5]="DATA_MATRIX",B[B.EAN_8=6]="EAN_8",B[B.EAN_13=7]="EAN_13",B[B.ITF=8]="ITF",B[B.MAXICODE=9]="MAXICODE",B[B.PDF_417=10]="PDF_417",B[B.QR_CODE=11]="QR_CODE",B[B.RSS_14=12]="RSS_14",B[B.RSS_EXPANDED=13]="RSS_EXPANDED",B[B.UPC_A=14]="UPC_A",B[B.UPC_E=15]="UPC_E",B[B.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(rt||(rt={}));var pe=rt,Ve;(function(B){B[B.OTHER=0]="OTHER",B[B.ORIENTATION=1]="ORIENTATION",B[B.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",B[B.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",B[B.ISSUE_NUMBER=4]="ISSUE_NUMBER",B[B.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",B[B.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",B[B.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",B[B.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",B[B.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",B[B.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Ve||(Ve={}));var Ke=Ve;class it{constructor(r,l,u,m,g=-1,v=-1){this.rawBytes=r,this.text=l,this.byteSegments=u,this.ecLevel=m,this.structuredAppendSequenceNumber=g,this.structuredAppendParity=v,this.numBits=r==null?0:8*r.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(r){this.numBits=r}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(r){this.errorsCorrected=r}getErasures(){return this.erasures}setErasures(r){this.erasures=r}getOther(){return this.other}setOther(r){this.other=r}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Mn{exp(r){return this.expTable[r]}log(r){if(r===0)throw new N;return this.logTable[r]}static addOrSubtract(r,l){return r^l}}class kt{constructor(r,l){if(l.length===0)throw new N;this.field=r;const u=l.length;if(u>1&&l[0]===0){let m=1;for(;m<u&&l[m]===0;)m++;m===u?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(u-m),W.arraycopy(l,m,this.coefficients,0,this.coefficients.length))}else this.coefficients=l}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);const l=this.coefficients;let u;if(r===1){u=0;for(let v=0,_=l.length;v!==_;v++){const C=l[v];u=Mn.addOrSubtract(u,C)}return u}u=l[0];const m=l.length,g=this.field;for(let v=1;v<m;v++)u=Mn.addOrSubtract(g.multiply(r,u),l[v]);return u}addOrSubtract(r){if(!this.field.equals(r.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero())return r;if(r.isZero())return this;let l=this.coefficients,u=r.coefficients;if(l.length>u.length){const v=l;l=u,u=v}let m=new Int32Array(u.length);const g=u.length-l.length;W.arraycopy(u,0,m,0,g);for(let v=g;v<u.length;v++)m[v]=Mn.addOrSubtract(l[v-g],u[v]);return new kt(this.field,m)}multiply(r){if(!this.field.equals(r.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero()||r.isZero())return this.field.getZero();const l=this.coefficients,u=l.length,m=r.coefficients,g=m.length,v=new Int32Array(u+g-1),_=this.field;for(let C=0;C<u;C++){const M=l[C];for(let O=0;O<g;O++)v[C+O]=Mn.addOrSubtract(v[C+O],_.multiply(M,m[O]))}return new kt(_,v)}multiplyScalar(r){if(r===0)return this.field.getZero();if(r===1)return this;const l=this.coefficients.length,u=this.field,m=new Int32Array(l),g=this.coefficients;for(let v=0;v<l;v++)m[v]=u.multiply(g[v],r);return new kt(u,m)}multiplyByMonomial(r,l){if(r<0)throw new N;if(l===0)return this.field.getZero();const u=this.coefficients,m=u.length,g=new Int32Array(m+r),v=this.field;for(let _=0;_<m;_++)g[_]=v.multiply(u[_],l);return new kt(v,g)}divide(r){if(!this.field.equals(r.field))throw new N("GenericGFPolys do not have same GenericGF field");if(r.isZero())throw new N("Divide by 0");const l=this.field;let u=l.getZero(),m=this;const g=r.getCoefficient(r.getDegree()),v=l.inverse(g);for(;m.getDegree()>=r.getDegree()&&!m.isZero();){const _=m.getDegree()-r.getDegree(),C=l.multiply(m.getCoefficient(m.getDegree()),v),M=r.multiplyByMonomial(_,C),O=l.buildMonomial(_,C);u=u.addOrSubtract(O),m=m.addOrSubtract(M)}return[u,m]}toString(){let r="";for(let l=this.getDegree();l>=0;l--){let u=this.getCoefficient(l);if(u!==0){if(u<0?(r+=" - ",u=-u):r.length>0&&(r+=" + "),l===0||u!==1){const m=this.field.log(u);m===0?r+="1":m===1?r+="a":(r+="a^",r+=m)}l!==0&&(l===1?r+="x":(r+="x^",r+=l))}}return r}}class Dn extends x{}Dn.kind="ArithmeticException";class St extends Mn{constructor(r,l,u){super(),this.primitive=r,this.size=l,this.generatorBase=u;const m=new Int32Array(l);let g=1;for(let _=0;_<l;_++)m[_]=g,g*=2,g>=l&&(g^=r,g&=l-1);this.expTable=m;const v=new Int32Array(l);for(let _=0;_<l-1;_++)v[m[_]]=_;this.logTable=v,this.zero=new kt(this,Int32Array.from([0])),this.one=new kt(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,l){if(r<0)throw new N;if(l===0)return this.zero;const u=new Int32Array(r+1);return u[0]=l,new kt(this,u)}inverse(r){if(r===0)throw new Dn;return this.expTable[this.size-this.logTable[r]-1]}multiply(r,l){return r===0||l===0?0:this.expTable[(this.logTable[r]+this.logTable[l])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+ee.toHexString(this.primitive)+","+this.size+")"}equals(r){return r===this}}St.AZTEC_DATA_12=new St(4201,4096,1),St.AZTEC_DATA_10=new St(1033,1024,1),St.AZTEC_DATA_6=new St(67,64,1),St.AZTEC_PARAM=new St(19,16,1),St.QR_CODE_FIELD_256=new St(285,256,0),St.DATA_MATRIX_FIELD_256=new St(301,256,1),St.AZTEC_DATA_8=St.DATA_MATRIX_FIELD_256,St.MAXICODE_FIELD_64=St.AZTEC_DATA_6;class Pn extends x{}Pn.kind="ReedSolomonException";class De extends x{}De.kind="IllegalStateException";class ot{constructor(r){this.field=r}decode(r,l){const u=this.field,m=new kt(u,r),g=new Int32Array(l);let v=!0;for(let Z=0;Z<l;Z++){const re=m.evaluateAt(u.exp(Z+u.getGeneratorBase()));g[g.length-1-Z]=re,re!==0&&(v=!1)}if(v)return;const _=new kt(u,g),C=this.runEuclideanAlgorithm(u.buildMonomial(l,1),_,l),M=C[0],O=C[1],j=this.findErrorLocations(M),G=this.findErrorMagnitudes(O,j);for(let Z=0;Z<j.length;Z++){const re=r.length-1-u.log(j[Z]);if(re<0)throw new Pn("Bad error location");r[re]=St.addOrSubtract(r[re],G[Z])}}runEuclideanAlgorithm(r,l,u){if(r.getDegree()<l.getDegree()){const Z=r;r=l,l=Z}const m=this.field;let g=r,v=l,_=m.getZero(),C=m.getOne();for(;v.getDegree()>=(u/2|0);){let Z=g,re=_;if(g=v,_=C,g.isZero())throw new Pn("r_{i-1} was zero");v=Z;let ce=m.getZero();const ye=g.getCoefficient(g.getDegree()),Ce=m.inverse(ye);for(;v.getDegree()>=g.getDegree()&&!v.isZero();){const qe=v.getDegree()-g.getDegree(),He=m.multiply(v.getCoefficient(v.getDegree()),Ce);ce=ce.addOrSubtract(m.buildMonomial(qe,He)),v=v.addOrSubtract(g.multiplyByMonomial(qe,He))}if(C=ce.multiply(_).addOrSubtract(re),v.getDegree()>=g.getDegree())throw new De("Division algorithm failed to reduce polynomial?")}const M=C.getCoefficient(0);if(M===0)throw new Pn("sigmaTilde(0) was zero");const O=m.inverse(M),j=C.multiplyScalar(O),G=v.multiplyScalar(O);return[j,G]}findErrorLocations(r){const l=r.getDegree();if(l===1)return Int32Array.from([r.getCoefficient(1)]);const u=new Int32Array(l);let m=0;const g=this.field;for(let v=1;v<g.getSize()&&m<l;v++)r.evaluateAt(v)===0&&(u[m]=g.inverse(v),m++);if(m!==l)throw new Pn("Error locator degree does not match number of roots");return u}findErrorMagnitudes(r,l){const u=l.length,m=new Int32Array(u),g=this.field;for(let v=0;v<u;v++){const _=g.inverse(l[v]);let C=1;for(let M=0;M<u;M++)if(v!==M){const O=g.multiply(l[M],_),j=(O&1)===0?O|1:O&-2;C=g.multiply(C,j)}m[v]=g.multiply(r.evaluateAt(_),g.inverse(C)),g.getGeneratorBase()!==0&&(m[v]=g.multiply(m[v],_))}return m}}var ht;(function(B){B[B.UPPER=0]="UPPER",B[B.LOWER=1]="LOWER",B[B.MIXED=2]="MIXED",B[B.DIGIT=3]="DIGIT",B[B.PUNCT=4]="PUNCT",B[B.BINARY=5]="BINARY"})(ht||(ht={}));class Qe{decode(r){this.ddata=r;let l=r.getBits(),u=this.extractBits(l),m=this.correctBits(u),g=Qe.convertBoolArrayToByteArray(m),v=Qe.getEncodedData(m),_=new it(g,v,null,null);return _.setNumBits(m.length),_}static highLevelDecode(r){return this.getEncodedData(r)}static getEncodedData(r){let l=r.length,u=ht.UPPER,m=ht.UPPER,g="",v=0;for(;v<l;)if(m===ht.BINARY){if(l-v<5)break;let _=Qe.readCode(r,v,5);if(v+=5,_===0){if(l-v<11)break;_=Qe.readCode(r,v,11)+31,v+=11}for(let C=0;C<_;C++){if(l-v<8){v=l;break}const M=Qe.readCode(r,v,8);g+=$.castAsNonUtf8Char(M),v+=8}m=u}else{let _=m===ht.DIGIT?4:5;if(l-v<_)break;let C=Qe.readCode(r,v,_);v+=_;let M=Qe.getCharacter(m,C);M.startsWith("CTRL_")?(u=m,m=Qe.getTable(M.charAt(5)),M.charAt(6)==="L"&&(u=m)):(g+=M,m=u)}return g}static getTable(r){switch(r){case"L":return ht.LOWER;case"P":return ht.PUNCT;case"M":return ht.MIXED;case"D":return ht.DIGIT;case"B":return ht.BINARY;case"U":default:return ht.UPPER}}static getCharacter(r,l){switch(r){case ht.UPPER:return Qe.UPPER_TABLE[l];case ht.LOWER:return Qe.LOWER_TABLE[l];case ht.MIXED:return Qe.MIXED_TABLE[l];case ht.PUNCT:return Qe.PUNCT_TABLE[l];case ht.DIGIT:return Qe.DIGIT_TABLE[l];default:throw new De("Bad table")}}correctBits(r){let l,u;this.ddata.getNbLayers()<=2?(u=6,l=St.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(u=8,l=St.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(u=10,l=St.AZTEC_DATA_10):(u=12,l=St.AZTEC_DATA_12);let m=this.ddata.getNbDatablocks(),g=r.length/u;if(g<m)throw new U;let v=r.length%u,_=new Int32Array(g);for(let G=0;G<g;G++,v+=u)_[G]=Qe.readCode(r,v,u);try{new ot(l).decode(_,g-m)}catch(G){throw new U(G)}let C=(1<<u)-1,M=0;for(let G=0;G<m;G++){let Z=_[G];if(Z===0||Z===C)throw new U;(Z===1||Z===C-1)&&M++}let O=new Array(m*u-M),j=0;for(let G=0;G<m;G++){let Z=_[G];if(Z===1||Z===C-1)O.fill(Z>1,j,j+u-1),j+=u-1;else for(let re=u-1;re>=0;--re)O[j++]=(Z&1<<re)!==0}return O}extractBits(r){let l=this.ddata.isCompact(),u=this.ddata.getNbLayers(),m=(l?11:14)+u*4,g=new Int32Array(m),v=new Array(this.totalBitsInLayer(u,l));if(l)for(let _=0;_<g.length;_++)g[_]=_;else{let _=m+1+2*ee.truncDivision(ee.truncDivision(m,2)-1,15),C=m/2,M=ee.truncDivision(_,2);for(let O=0;O<C;O++){let j=O+ee.truncDivision(O,15);g[C-O-1]=M-j-1,g[C+O]=M+j+1}}for(let _=0,C=0;_<u;_++){let M=(u-_)*4+(l?9:12),O=_*2,j=m-1-O;for(let G=0;G<M;G++){let Z=G*2;for(let re=0;re<2;re++)v[C+Z+re]=r.get(g[O+re],g[O+G]),v[C+2*M+Z+re]=r.get(g[O+G],g[j-re]),v[C+4*M+Z+re]=r.get(g[j-re],g[j-G]),v[C+6*M+Z+re]=r.get(g[j-G],g[O+re])}C+=M*8}return v}static readCode(r,l,u){let m=0;for(let g=l;g<l+u;g++)m<<=1,r[g]&&(m|=1);return m}static readByte(r,l){let u=r.length-l;return u>=8?Qe.readCode(r,l,8):Qe.readCode(r,l,u)<<8-u}static convertBoolArrayToByteArray(r){let l=new Uint8Array((r.length+7)/8);for(let u=0;u<l.length;u++)l[u]=Qe.readByte(r,8*u);return l}totalBitsInLayer(r,l){return((l?88:112)+16*r)*r}}Qe.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Qe.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Qe.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Qe.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Qe.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class nt{constructor(){}static round(r){return r===NaN?0:r<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:r>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:r+(r<0?-.5:.5)|0}static distance(r,l,u,m){const g=r-u,v=l-m;return Math.sqrt(g*g+v*v)}static sum(r){let l=0;for(let u=0,m=r.length;u!==m;u++){const g=r[u];l+=g}return l}}class xn{static floatToIntBits(r){return r}}xn.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Ze{constructor(r,l){this.x=r,this.y=l}getX(){return this.x}getY(){return this.y}equals(r){if(r instanceof Ze){const l=r;return this.x===l.x&&this.y===l.y}return!1}hashCode(){return 31*xn.floatToIntBits(this.x)+xn.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(r){const l=this.distance(r[0],r[1]),u=this.distance(r[1],r[2]),m=this.distance(r[0],r[2]);let g,v,_;if(u>=l&&u>=m?(v=r[0],g=r[1],_=r[2]):m>=u&&m>=l?(v=r[1],g=r[0],_=r[2]):(v=r[2],g=r[0],_=r[1]),this.crossProductZ(g,v,_)<0){const C=g;g=_,_=C}r[0]=g,r[1]=v,r[2]=_}static distance(r,l){return nt.distance(r.x,r.y,l.x,l.y)}static crossProductZ(r,l,u){const m=l.x,g=l.y;return(u.x-m)*(r.y-g)-(u.y-g)*(r.x-m)}}class Gr{constructor(r,l){this.bits=r,this.points=l}getBits(){return this.bits}getPoints(){return this.points}}class Mo extends Gr{constructor(r,l,u,m,g){super(r,l),this.compact=u,this.nbDatablocks=m,this.nbLayers=g}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class On{constructor(r,l,u,m){this.image=r,this.height=r.getHeight(),this.width=r.getWidth(),l==null&&(l=On.INIT_SIZE),u==null&&(u=r.getWidth()/2|0),m==null&&(m=r.getHeight()/2|0);const g=l/2|0;if(this.leftInit=u-g,this.rightInit=u+g,this.upInit=m-g,this.downInit=m+g,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new he}detect(){let r=this.leftInit,l=this.rightInit,u=this.upInit,m=this.downInit,g=!1,v=!0,_=!1,C=!1,M=!1,O=!1,j=!1;const G=this.width,Z=this.height;for(;v;){v=!1;let re=!0;for(;(re||!C)&&l<G;)re=this.containsBlackPoint(u,m,l,!1),re?(l++,v=!0,C=!0):C||l++;if(l>=G){g=!0;break}let ce=!0;for(;(ce||!M)&&m<Z;)ce=this.containsBlackPoint(r,l,m,!0),ce?(m++,v=!0,M=!0):M||m++;if(m>=Z){g=!0;break}let ye=!0;for(;(ye||!O)&&r>=0;)ye=this.containsBlackPoint(u,m,r,!1),ye?(r--,v=!0,O=!0):O||r--;if(r<0){g=!0;break}let Ce=!0;for(;(Ce||!j)&&u>=0;)Ce=this.containsBlackPoint(r,l,u,!0),Ce?(u--,v=!0,j=!0):j||u--;if(u<0){g=!0;break}v&&(_=!0)}if(!g&&_){const re=l-r;let ce=null;for(let He=1;ce===null&&He<re;He++)ce=this.getBlackPointOnSegment(r,m-He,r+He,m);if(ce==null)throw new he;let ye=null;for(let He=1;ye===null&&He<re;He++)ye=this.getBlackPointOnSegment(r,u+He,r+He,u);if(ye==null)throw new he;let Ce=null;for(let He=1;Ce===null&&He<re;He++)Ce=this.getBlackPointOnSegment(l,u+He,l-He,u);if(Ce==null)throw new he;let qe=null;for(let He=1;qe===null&&He<re;He++)qe=this.getBlackPointOnSegment(l,m-He,l-He,m);if(qe==null)throw new he;return this.centerEdges(qe,ce,Ce,ye)}else throw new he}getBlackPointOnSegment(r,l,u,m){const g=nt.round(nt.distance(r,l,u,m)),v=(u-r)/g,_=(m-l)/g,C=this.image;for(let M=0;M<g;M++){const O=nt.round(r+M*v),j=nt.round(l+M*_);if(C.get(O,j))return new Ze(O,j)}return null}centerEdges(r,l,u,m){const g=r.getX(),v=r.getY(),_=l.getX(),C=l.getY(),M=u.getX(),O=u.getY(),j=m.getX(),G=m.getY(),Z=On.CORR;return g<this.width/2?[new Ze(j-Z,G+Z),new Ze(_+Z,C+Z),new Ze(M-Z,O-Z),new Ze(g+Z,v-Z)]:[new Ze(j+Z,G+Z),new Ze(_+Z,C-Z),new Ze(M-Z,O+Z),new Ze(g-Z,v-Z)]}containsBlackPoint(r,l,u,m){const g=this.image;if(m){for(let v=r;v<=l;v++)if(g.get(v,u))return!0}else for(let v=r;v<=l;v++)if(g.get(u,v))return!0;return!1}}On.INIT_SIZE=10,On.CORR=1;class qs{static checkAndNudgePoints(r,l){const u=r.getWidth(),m=r.getHeight();let g=!0;for(let v=0;v<l.length&&g;v+=2){const _=Math.floor(l[v]),C=Math.floor(l[v+1]);if(_<-1||_>u||C<-1||C>m)throw new he;g=!1,_===-1?(l[v]=0,g=!0):_===u&&(l[v]=u-1,g=!0),C===-1?(l[v+1]=0,g=!0):C===m&&(l[v+1]=m-1,g=!0)}g=!0;for(let v=l.length-2;v>=0&&g;v-=2){const _=Math.floor(l[v]),C=Math.floor(l[v+1]);if(_<-1||_>u||C<-1||C>m)throw new he;g=!1,_===-1?(l[v]=0,g=!0):_===u&&(l[v]=u-1,g=!0),C===-1?(l[v+1]=0,g=!0):C===m&&(l[v+1]=m-1,g=!0)}}}class Ei{constructor(r,l,u,m,g,v,_,C,M){this.a11=r,this.a21=l,this.a31=u,this.a12=m,this.a22=g,this.a32=v,this.a13=_,this.a23=C,this.a33=M}static quadrilateralToQuadrilateral(r,l,u,m,g,v,_,C,M,O,j,G,Z,re,ce,ye){const Ce=Ei.quadrilateralToSquare(r,l,u,m,g,v,_,C);return Ei.squareToQuadrilateral(M,O,j,G,Z,re,ce,ye).times(Ce)}transformPoints(r){const l=r.length,u=this.a11,m=this.a12,g=this.a13,v=this.a21,_=this.a22,C=this.a23,M=this.a31,O=this.a32,j=this.a33;for(let G=0;G<l;G+=2){const Z=r[G],re=r[G+1],ce=g*Z+C*re+j;r[G]=(u*Z+v*re+M)/ce,r[G+1]=(m*Z+_*re+O)/ce}}transformPointsWithValues(r,l){const u=this.a11,m=this.a12,g=this.a13,v=this.a21,_=this.a22,C=this.a23,M=this.a31,O=this.a32,j=this.a33,G=r.length;for(let Z=0;Z<G;Z++){const re=r[Z],ce=l[Z],ye=g*re+C*ce+j;r[Z]=(u*re+v*ce+M)/ye,l[Z]=(m*re+_*ce+O)/ye}}static squareToQuadrilateral(r,l,u,m,g,v,_,C){const M=r-u+g-_,O=l-m+v-C;if(M===0&&O===0)return new Ei(u-r,g-u,r,m-l,v-m,l,0,0,1);{const j=u-g,G=_-g,Z=m-v,re=C-v,ce=j*re-G*Z,ye=(M*re-G*O)/ce,Ce=(j*O-M*Z)/ce;return new Ei(u-r+ye*u,_-r+Ce*_,r,m-l+ye*m,C-l+Ce*C,l,ye,Ce,1)}}static quadrilateralToSquare(r,l,u,m,g,v,_,C){return Ei.squareToQuadrilateral(r,l,u,m,g,v,_,C).buildAdjoint()}buildAdjoint(){return new Ei(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(r){return new Ei(this.a11*r.a11+this.a21*r.a12+this.a31*r.a13,this.a11*r.a21+this.a21*r.a22+this.a31*r.a23,this.a11*r.a31+this.a21*r.a32+this.a31*r.a33,this.a12*r.a11+this.a22*r.a12+this.a32*r.a13,this.a12*r.a21+this.a22*r.a22+this.a32*r.a23,this.a12*r.a31+this.a22*r.a32+this.a32*r.a33,this.a13*r.a11+this.a23*r.a12+this.a33*r.a13,this.a13*r.a21+this.a23*r.a22+this.a33*r.a23,this.a13*r.a31+this.a23*r.a32+this.a33*r.a33)}}class Hr extends qs{sampleGrid(r,l,u,m,g,v,_,C,M,O,j,G,Z,re,ce,ye,Ce,qe,He){const Fe=Ei.quadrilateralToQuadrilateral(m,g,v,_,C,M,O,j,G,Z,re,ce,ye,Ce,qe,He);return this.sampleGridWithTransform(r,l,u,Fe)}sampleGridWithTransform(r,l,u,m){if(l<=0||u<=0)throw new he;const g=new _e(l,u),v=new Float32Array(2*l);for(let _=0;_<u;_++){const C=v.length,M=_+.5;for(let O=0;O<C;O+=2)v[O]=O/2+.5,v[O+1]=M;m.transformPoints(v),qs.checkAndNudgePoints(r,v);try{for(let O=0;O<C;O+=2)r.get(Math.floor(v[O]),Math.floor(v[O+1]))&&g.set(O/2,_)}catch{throw new he}}return g}}class _i{static setGridSampler(r){_i.gridSampler=r}static getInstance(){return _i.gridSampler}}_i.gridSampler=new Hr;class ci{constructor(r,l){this.x=r,this.y=l}toResultPoint(){return new Ze(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Do{constructor(r){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=r}detect(){return this.detectMirror(!1)}detectMirror(r){let l=this.getMatrixCenter(),u=this.getBullsEyeCorners(l);if(r){let v=u[0];u[0]=u[2],u[2]=v}this.extractParameters(u);let m=this.sampleGrid(this.image,u[this.shift%4],u[(this.shift+1)%4],u[(this.shift+2)%4],u[(this.shift+3)%4]),g=this.getMatrixCornerPoints(u);return new Mo(m,g,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(r){if(!this.isValidPoint(r[0])||!this.isValidPoint(r[1])||!this.isValidPoint(r[2])||!this.isValidPoint(r[3]))throw new he;let l=2*this.nbCenterLayers,u=new Int32Array([this.sampleLine(r[0],r[1],l),this.sampleLine(r[1],r[2],l),this.sampleLine(r[2],r[3],l),this.sampleLine(r[3],r[0],l)]);this.shift=this.getRotation(u,l);let m=0;for(let v=0;v<4;v++){let _=u[(this.shift+v)%4];this.compact?(m<<=7,m+=_>>1&127):(m<<=10,m+=(_>>2&992)+(_>>1&31))}let g=this.getCorrectedParameterData(m,this.compact);this.compact?(this.nbLayers=(g>>6)+1,this.nbDataBlocks=(g&63)+1):(this.nbLayers=(g>>11)+1,this.nbDataBlocks=(g&2047)+1)}getRotation(r,l){let u=0;r.forEach((m,g,v)=>{let _=(m>>l-2<<1)+(m&1);u=(u<<3)+_}),u=((u&1)<<11)+(u>>1);for(let m=0;m<4;m++)if(ee.bitCount(u^this.EXPECTED_CORNER_BITS[m])<=2)return m;throw new he}getCorrectedParameterData(r,l){let u,m;l?(u=7,m=2):(u=10,m=4);let g=u-m,v=new Int32Array(u);for(let C=u-1;C>=0;--C)v[C]=r&15,r>>=4;try{new ot(St.AZTEC_PARAM).decode(v,g)}catch{throw new he}let _=0;for(let C=0;C<m;C++)_=(_<<4)+v[C];return _}getBullsEyeCorners(r){let l=r,u=r,m=r,g=r,v=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let j=this.getFirstDifferent(l,v,1,-1),G=this.getFirstDifferent(u,v,1,1),Z=this.getFirstDifferent(m,v,-1,1),re=this.getFirstDifferent(g,v,-1,-1);if(this.nbCenterLayers>2){let ce=this.distancePoint(re,j)*this.nbCenterLayers/(this.distancePoint(g,l)*(this.nbCenterLayers+2));if(ce<.75||ce>1.25||!this.isWhiteOrBlackRectangle(j,G,Z,re))break}l=j,u=G,m=Z,g=re,v=!v}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new he;this.compact=this.nbCenterLayers===5;let _=new Ze(l.getX()+.5,l.getY()-.5),C=new Ze(u.getX()+.5,u.getY()+.5),M=new Ze(m.getX()-.5,m.getY()+.5),O=new Ze(g.getX()-.5,g.getY()-.5);return this.expandSquare([_,C,M,O],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let r,l,u,m;try{let _=new On(this.image).detect();r=_[0],l=_[1],u=_[2],m=_[3]}catch{let C=this.image.getWidth()/2,M=this.image.getHeight()/2;r=this.getFirstDifferent(new ci(C+7,M-7),!1,1,-1).toResultPoint(),l=this.getFirstDifferent(new ci(C+7,M+7),!1,1,1).toResultPoint(),u=this.getFirstDifferent(new ci(C-7,M+7),!1,-1,1).toResultPoint(),m=this.getFirstDifferent(new ci(C-7,M-7),!1,-1,-1).toResultPoint()}let g=nt.round((r.getX()+m.getX()+l.getX()+u.getX())/4),v=nt.round((r.getY()+m.getY()+l.getY()+u.getY())/4);try{let _=new On(this.image,15,g,v).detect();r=_[0],l=_[1],u=_[2],m=_[3]}catch{r=this.getFirstDifferent(new ci(g+7,v-7),!1,1,-1).toResultPoint(),l=this.getFirstDifferent(new ci(g+7,v+7),!1,1,1).toResultPoint(),u=this.getFirstDifferent(new ci(g-7,v+7),!1,-1,1).toResultPoint(),m=this.getFirstDifferent(new ci(g-7,v-7),!1,-1,-1).toResultPoint()}return g=nt.round((r.getX()+m.getX()+l.getX()+u.getX())/4),v=nt.round((r.getY()+m.getY()+l.getY()+u.getY())/4),new ci(g,v)}getMatrixCornerPoints(r){return this.expandSquare(r,2*this.nbCenterLayers,this.getDimension())}sampleGrid(r,l,u,m,g){let v=_i.getInstance(),_=this.getDimension(),C=_/2-this.nbCenterLayers,M=_/2+this.nbCenterLayers;return v.sampleGrid(r,_,_,C,C,M,C,M,M,C,M,l.getX(),l.getY(),u.getX(),u.getY(),m.getX(),m.getY(),g.getX(),g.getY())}sampleLine(r,l,u){let m=0,g=this.distanceResultPoint(r,l),v=g/u,_=r.getX(),C=r.getY(),M=v*(l.getX()-r.getX())/g,O=v*(l.getY()-r.getY())/g;for(let j=0;j<u;j++)this.image.get(nt.round(_+j*M),nt.round(C+j*O))&&(m|=1<<u-j-1);return m}isWhiteOrBlackRectangle(r,l,u,m){let g=3;r=new ci(r.getX()-g,r.getY()+g),l=new ci(l.getX()-g,l.getY()-g),u=new ci(u.getX()+g,u.getY()-g),m=new ci(m.getX()+g,m.getY()+g);let v=this.getColor(m,r);if(v===0)return!1;let _=this.getColor(r,l);return _!==v||(_=this.getColor(l,u),_!==v)?!1:(_=this.getColor(u,m),_===v)}getColor(r,l){let u=this.distancePoint(r,l),m=(l.getX()-r.getX())/u,g=(l.getY()-r.getY())/u,v=0,_=r.getX(),C=r.getY(),M=this.image.get(r.getX(),r.getY()),O=Math.ceil(u);for(let G=0;G<O;G++)_+=m,C+=g,this.image.get(nt.round(_),nt.round(C))!==M&&v++;let j=v/u;return j>.1&&j<.9?0:j<=.1===M?1:-1}getFirstDifferent(r,l,u,m){let g=r.getX()+u,v=r.getY()+m;for(;this.isValid(g,v)&&this.image.get(g,v)===l;)g+=u,v+=m;for(g-=u,v-=m;this.isValid(g,v)&&this.image.get(g,v)===l;)g+=u;for(g-=u;this.isValid(g,v)&&this.image.get(g,v)===l;)v+=m;return v-=m,new ci(g,v)}expandSquare(r,l,u){let m=u/(2*l),g=r[0].getX()-r[2].getX(),v=r[0].getY()-r[2].getY(),_=(r[0].getX()+r[2].getX())/2,C=(r[0].getY()+r[2].getY())/2,M=new Ze(_+m*g,C+m*v),O=new Ze(_-m*g,C-m*v);g=r[1].getX()-r[3].getX(),v=r[1].getY()-r[3].getY(),_=(r[1].getX()+r[3].getX())/2,C=(r[1].getY()+r[3].getY())/2;let j=new Ze(_+m*g,C+m*v),G=new Ze(_-m*g,C-m*v);return[M,j,O,G]}isValid(r,l){return r>=0&&r<this.image.getWidth()&&l>0&&l<this.image.getHeight()}isValidPoint(r){let l=nt.round(r.getX()),u=nt.round(r.getY());return this.isValid(l,u)}distancePoint(r,l){return nt.distance(r.getX(),r.getY(),l.getX(),l.getY())}distanceResultPoint(r,l){return nt.distance(r.getX(),r.getY(),l.getX(),l.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(ee.truncDivision(this.nbLayers-4,8)+1)+15}}class Tr{decode(r,l=null){let u=null,m=new Do(r.getBlackMatrix()),g=null,v=null;try{let O=m.detectMirror(!1);g=O.getPoints(),this.reportFoundResultPoints(l,g),v=new Qe().decode(O)}catch(O){u=O}if(v==null)try{let O=m.detectMirror(!0);g=O.getPoints(),this.reportFoundResultPoints(l,g),v=new Qe().decode(O)}catch(O){throw u??O}let _=new je(v.getText(),v.getRawBytes(),v.getNumBits(),g,pe.AZTEC,W.currentTimeMillis()),C=v.getByteSegments();C!=null&&_.putMetadata(Ke.BYTE_SEGMENTS,C);let M=v.getECLevel();return M!=null&&_.putMetadata(Ke.ERROR_CORRECTION_LEVEL,M),_}reportFoundResultPoints(r,l){if(r!=null){let u=r.get(me.NEED_RESULT_POINT_CALLBACK);u!=null&&l.forEach((m,g,v)=>{u.foundPossibleResultPoint(m)})}}reset(){}}class Ma extends Ae{constructor(r=500){super(new Tr,r)}}class an{decode(r,l){try{return this.doDecode(r,l)}catch{if(l&&l.get(me.TRY_HARDER)===!0&&r.isRotateSupported()){const g=r.rotateCounterClockwise(),v=this.doDecode(g,l),_=v.getResultMetadata();let C=270;_!==null&&_.get(Ke.ORIENTATION)===!0&&(C=C+_.get(Ke.ORIENTATION)%360),v.putMetadata(Ke.ORIENTATION,C);const M=v.getResultPoints();if(M!==null){const O=g.getHeight();for(let j=0;j<M.length;j++)M[j]=new Ze(O-M[j].getY()-1,M[j].getX())}return v}else throw new he}}reset(){}doDecode(r,l){const u=r.getWidth(),m=r.getHeight();let g=new de(u);const v=l&&l.get(me.TRY_HARDER)===!0,_=Math.max(1,m>>(v?8:5));let C;v?C=m:C=15;const M=Math.trunc(m/2);for(let O=0;O<C;O++){const j=Math.trunc((O+1)/2),G=(O&1)===0,Z=M+_*(G?j:-j);if(Z<0||Z>=m)break;try{g=r.getBlackRow(Z,g)}catch{continue}for(let re=0;re<2;re++){if(re===1&&(g.reverse(),l&&l.get(me.NEED_RESULT_POINT_CALLBACK)===!0)){const ce=new Map;l.forEach((ye,Ce)=>ce.set(Ce,ye)),ce.delete(me.NEED_RESULT_POINT_CALLBACK),l=ce}try{const ce=this.decodeRow(Z,g,l);if(re===1){ce.putMetadata(Ke.ORIENTATION,180);const ye=ce.getResultPoints();ye!==null&&(ye[0]=new Ze(u-ye[0].getX()-1,ye[0].getY()),ye[1]=new Ze(u-ye[1].getX()-1,ye[1].getY()))}return ce}catch{}}}throw new he}static recordPattern(r,l,u){const m=u.length;for(let M=0;M<m;M++)u[M]=0;const g=r.getSize();if(l>=g)throw new he;let v=!r.get(l),_=0,C=l;for(;C<g;){if(r.get(C)!==v)u[_]++;else{if(++_===m)break;u[_]=1,v=!v}C++}if(!(_===m||_===m-1&&C===g))throw new he}static recordPatternInReverse(r,l,u){let m=u.length,g=r.get(l);for(;l>0&&m>=0;)r.get(--l)!==g&&(m--,g=!g);if(m>=0)throw new he;an.recordPattern(r,l+1,u)}static patternMatchVariance(r,l,u){const m=r.length;let g=0,v=0;for(let M=0;M<m;M++)g+=r[M],v+=l[M];if(g<v)return Number.POSITIVE_INFINITY;const _=g/v;u*=_;let C=0;for(let M=0;M<m;M++){const O=r[M],j=l[M]*_,G=O>j?O-j:j-O;if(G>u)return Number.POSITIVE_INFINITY;C+=G}return C/g}}class Ge extends an{static findStartPattern(r){const l=r.getSize(),u=r.getNextSet(0);let m=0,g=Int32Array.from([0,0,0,0,0,0]),v=u,_=!1;const C=6;for(let M=u;M<l;M++)if(r.get(M)!==_)g[m]++;else{if(m===C-1){let O=Ge.MAX_AVG_VARIANCE,j=-1;for(let G=Ge.CODE_START_A;G<=Ge.CODE_START_C;G++){const Z=an.patternMatchVariance(g,Ge.CODE_PATTERNS[G],Ge.MAX_INDIVIDUAL_VARIANCE);Z<O&&(O=Z,j=G)}if(j>=0&&r.isRange(Math.max(0,v-(M-v)/2),v,!1))return Int32Array.from([v,M,j]);v+=g[0]+g[1],g=g.slice(2,g.length-1),g[m-1]=0,g[m]=0,m--}else m++;g[m]=1,_=!_}throw new he}static decodeCode(r,l,u){an.recordPattern(r,u,l);let m=Ge.MAX_AVG_VARIANCE,g=-1;for(let v=0;v<Ge.CODE_PATTERNS.length;v++){const _=Ge.CODE_PATTERNS[v],C=this.patternMatchVariance(l,_,Ge.MAX_INDIVIDUAL_VARIANCE);C<m&&(m=C,g=v)}if(g>=0)return g;throw new he}decodeRow(r,l,u){const m=u&&u.get(me.ASSUME_GS1)===!0,g=Ge.findStartPattern(l),v=g[2];let _=0;const C=new Uint8Array(20);C[_++]=v;let M;switch(v){case Ge.CODE_START_A:M=Ge.CODE_CODE_A;break;case Ge.CODE_START_B:M=Ge.CODE_CODE_B;break;case Ge.CODE_START_C:M=Ge.CODE_CODE_C;break;default:throw new U}let O=!1,j=!1,G="",Z=g[0],re=g[1];const ce=Int32Array.from([0,0,0,0,0,0]);let ye=0,Ce=0,qe=v,He=0,Fe=!0,jt=!1,Nt=!1;for(;!O;){const no=j;switch(j=!1,ye=Ce,Ce=Ge.decodeCode(l,ce,re),C[_++]=Ce,Ce!==Ge.CODE_STOP&&(Fe=!0),Ce!==Ge.CODE_STOP&&(He++,qe+=He*Ce),Z=re,re+=ce.reduce((Wu,Cc)=>Wu+Cc,0),Ce){case Ge.CODE_START_A:case Ge.CODE_START_B:case Ge.CODE_START_C:throw new U}switch(M){case Ge.CODE_CODE_A:if(Ce<64)Nt===jt?G+=String.fromCharCode(32+Ce):G+=String.fromCharCode(32+Ce+128),Nt=!1;else if(Ce<96)Nt===jt?G+=String.fromCharCode(Ce-64):G+=String.fromCharCode(Ce+64),Nt=!1;else switch(Ce!==Ge.CODE_STOP&&(Fe=!1),Ce){case Ge.CODE_FNC_1:m&&(G.length===0?G+="]C1":G+="");break;case Ge.CODE_FNC_2:case Ge.CODE_FNC_3:break;case Ge.CODE_FNC_4_A:!jt&&Nt?(jt=!0,Nt=!1):jt&&Nt?(jt=!1,Nt=!1):Nt=!0;break;case Ge.CODE_SHIFT:j=!0,M=Ge.CODE_CODE_B;break;case Ge.CODE_CODE_B:M=Ge.CODE_CODE_B;break;case Ge.CODE_CODE_C:M=Ge.CODE_CODE_C;break;case Ge.CODE_STOP:O=!0;break}break;case Ge.CODE_CODE_B:if(Ce<96)Nt===jt?G+=String.fromCharCode(32+Ce):G+=String.fromCharCode(32+Ce+128),Nt=!1;else switch(Ce!==Ge.CODE_STOP&&(Fe=!1),Ce){case Ge.CODE_FNC_1:m&&(G.length===0?G+="]C1":G+="");break;case Ge.CODE_FNC_2:case Ge.CODE_FNC_3:break;case Ge.CODE_FNC_4_B:!jt&&Nt?(jt=!0,Nt=!1):jt&&Nt?(jt=!1,Nt=!1):Nt=!0;break;case Ge.CODE_SHIFT:j=!0,M=Ge.CODE_CODE_A;break;case Ge.CODE_CODE_A:M=Ge.CODE_CODE_A;break;case Ge.CODE_CODE_C:M=Ge.CODE_CODE_C;break;case Ge.CODE_STOP:O=!0;break}break;case Ge.CODE_CODE_C:if(Ce<100)Ce<10&&(G+="0"),G+=Ce;else switch(Ce!==Ge.CODE_STOP&&(Fe=!1),Ce){case Ge.CODE_FNC_1:m&&(G.length===0?G+="]C1":G+="");break;case Ge.CODE_CODE_A:M=Ge.CODE_CODE_A;break;case Ge.CODE_CODE_B:M=Ge.CODE_CODE_B;break;case Ge.CODE_STOP:O=!0;break}break}no&&(M=M===Ge.CODE_CODE_A?Ge.CODE_CODE_B:Ge.CODE_CODE_A)}const Zn=re-Z;if(re=l.getNextUnset(re),!l.isRange(re,Math.min(l.getSize(),re+(re-Z)/2),!1))throw new he;if(qe-=He*ye,qe%103!==ye)throw new k;const bs=G.length;if(bs===0)throw new he;bs>0&&Fe&&(M===Ge.CODE_CODE_C?G=G.substring(0,bs-2):G=G.substring(0,bs-1));const Ui=(g[1]+g[0])/2,bn=Z+Zn/2,yi=C.length,cs=new Uint8Array(yi);for(let no=0;no<yi;no++)cs[no]=C[no];const jo=[new Ze(Ui,r),new Ze(bn,r)];return new je(G,cs,0,jo,pe.CODE_128,new Date().getTime())}}Ge.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Ge.MAX_AVG_VARIANCE=.25,Ge.MAX_INDIVIDUAL_VARIANCE=.7,Ge.CODE_SHIFT=98,Ge.CODE_CODE_C=99,Ge.CODE_CODE_B=100,Ge.CODE_CODE_A=101,Ge.CODE_FNC_1=102,Ge.CODE_FNC_2=97,Ge.CODE_FNC_3=96,Ge.CODE_FNC_4_A=101,Ge.CODE_FNC_4_B=100,Ge.CODE_START_A=103,Ge.CODE_START_B=104,Ge.CODE_START_C=105,Ge.CODE_STOP=106;class ln extends an{constructor(r=!1,l=!1){super(),this.usingCheckDigit=r,this.extendedMode=l,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(r,l,u){let m=this.counters;m.fill(0),this.decodeRowResult="";let g=ln.findAsteriskPattern(l,m),v=l.getNextSet(g[1]),_=l.getSize(),C,M;do{ln.recordPattern(l,v,m);let ce=ln.toNarrowWidePattern(m);if(ce<0)throw new he;C=ln.patternToChar(ce),this.decodeRowResult+=C,M=v;for(let ye of m)v+=ye;v=l.getNextSet(v)}while(C!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let O=0;for(let ce of m)O+=ce;let j=v-M-O;if(v!==_&&j*2<O)throw new he;if(this.usingCheckDigit){let ce=this.decodeRowResult.length-1,ye=0;for(let Ce=0;Ce<ce;Ce++)ye+=ln.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(Ce));if(this.decodeRowResult.charAt(ce)!==ln.ALPHABET_STRING.charAt(ye%43))throw new k;this.decodeRowResult=this.decodeRowResult.substring(0,ce)}if(this.decodeRowResult.length===0)throw new he;let G;this.extendedMode?G=ln.decodeExtended(this.decodeRowResult):G=this.decodeRowResult;let Z=(g[1]+g[0])/2,re=M+O/2;return new je(G,null,0,[new Ze(Z,r),new Ze(re,r)],pe.CODE_39,new Date().getTime())}static findAsteriskPattern(r,l){let u=r.getSize(),m=r.getNextSet(0),g=0,v=m,_=!1,C=l.length;for(let M=m;M<u;M++)if(r.get(M)!==_)l[g]++;else{if(g===C-1){if(this.toNarrowWidePattern(l)===ln.ASTERISK_ENCODING&&r.isRange(Math.max(0,v-Math.floor((M-v)/2)),v,!1))return[v,M];v+=l[0]+l[1],l.copyWithin(0,2,2+g-1),l[g-1]=0,l[g]=0,g--}else g++;l[g]=1,_=!_}throw new he}static toNarrowWidePattern(r){let l=r.length,u=0,m;do{let g=2147483647;for(let C of r)C<g&&C>u&&(g=C);u=g,m=0;let v=0,_=0;for(let C=0;C<l;C++){let M=r[C];M>u&&(_|=1<<l-1-C,m++,v+=M)}if(m===3){for(let C=0;C<l&&m>0;C++){let M=r[C];if(M>u&&(m--,M*2>=v))return-1}return _}}while(m>3);return-1}static patternToChar(r){for(let l=0;l<ln.CHARACTER_ENCODINGS.length;l++)if(ln.CHARACTER_ENCODINGS[l]===r)return ln.ALPHABET_STRING.charAt(l);if(r===ln.ASTERISK_ENCODING)return"*";throw new he}static decodeExtended(r){let l=r.length,u="";for(let m=0;m<l;m++){let g=r.charAt(m);if(g==="+"||g==="$"||g==="%"||g==="/"){let v=r.charAt(m+1),_="\0";switch(g){case"+":if(v>="A"&&v<="Z")_=String.fromCharCode(v.charCodeAt(0)+32);else throw new U;break;case"$":if(v>="A"&&v<="Z")_=String.fromCharCode(v.charCodeAt(0)-64);else throw new U;break;case"%":if(v>="A"&&v<="E")_=String.fromCharCode(v.charCodeAt(0)-38);else if(v>="F"&&v<="J")_=String.fromCharCode(v.charCodeAt(0)-11);else if(v>="K"&&v<="O")_=String.fromCharCode(v.charCodeAt(0)+16);else if(v>="P"&&v<="T")_=String.fromCharCode(v.charCodeAt(0)+43);else if(v==="U")_="\0";else if(v==="V")_="@";else if(v==="W")_="`";else if(v==="X"||v==="Y"||v==="Z")_="";else throw new U;break;case"/":if(v>="A"&&v<="O")_=String.fromCharCode(v.charCodeAt(0)-32);else if(v==="Z")_=":";else throw new U;break}u+=_,m++}else u+=g}return u}}ln.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",ln.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],ln.ASTERISK_ENCODING=148;class _t extends an{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(r,l,u){let m=this.decodeStart(l),g=this.decodeEnd(l),v=new z;_t.decodeMiddle(l,m[1],g[0],v);let _=v.toString(),C=null;u!=null&&(C=u.get(me.ALLOWED_LENGTHS)),C==null&&(C=_t.DEFAULT_ALLOWED_LENGTHS);let M=_.length,O=!1,j=0;for(let re of C){if(M===re){O=!0;break}re>j&&(j=re)}if(!O&&M>j&&(O=!0),!O)throw new U;const G=[new Ze(m[1],r),new Ze(g[0],r)];return new je(_,null,0,G,pe.ITF,new Date().getTime())}static decodeMiddle(r,l,u,m){let g=new Int32Array(10),v=new Int32Array(5),_=new Int32Array(5);for(g.fill(0),v.fill(0),_.fill(0);l<u;){an.recordPattern(r,l,g);for(let M=0;M<5;M++){let O=2*M;v[M]=g[O],_[M]=g[O+1]}let C=_t.decodeDigit(v);m.append(C.toString()),C=this.decodeDigit(_),m.append(C.toString()),g.forEach(function(M){l+=M})}}decodeStart(r){let l=_t.skipWhiteSpace(r),u=_t.findGuardPattern(r,l,_t.START_PATTERN);return this.narrowLineWidth=(u[1]-u[0])/4,this.validateQuietZone(r,u[0]),u}validateQuietZone(r,l){let u=this.narrowLineWidth*10;u=u<l?u:l;for(let m=l-1;u>0&&m>=0&&!r.get(m);m--)u--;if(u!==0)throw new he}static skipWhiteSpace(r){const l=r.getSize(),u=r.getNextSet(0);if(u===l)throw new he;return u}decodeEnd(r){r.reverse();try{let l=_t.skipWhiteSpace(r),u;try{u=_t.findGuardPattern(r,l,_t.END_PATTERN_REVERSED[0])}catch(g){g instanceof he&&(u=_t.findGuardPattern(r,l,_t.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,u[0]);let m=u[0];return u[0]=r.getSize()-u[1],u[1]=r.getSize()-m,u}finally{r.reverse()}}static findGuardPattern(r,l,u){let m=u.length,g=new Int32Array(m),v=r.getSize(),_=!1,C=0,M=l;g.fill(0);for(let O=l;O<v;O++)if(r.get(O)!==_)g[C]++;else{if(C===m-1){if(an.patternMatchVariance(g,u,_t.MAX_INDIVIDUAL_VARIANCE)<_t.MAX_AVG_VARIANCE)return[M,O];M+=g[0]+g[1],W.arraycopy(g,2,g,0,C-1),g[C-1]=0,g[C]=0,C--}else C++;g[C]=1,_=!_}throw new he}static decodeDigit(r){let l=_t.MAX_AVG_VARIANCE,u=-1,m=_t.PATTERNS.length;for(let g=0;g<m;g++){let v=_t.PATTERNS[g],_=an.patternMatchVariance(r,v,_t.MAX_INDIVIDUAL_VARIANCE);_<l?(l=_,u=g):_===l&&(u=-1)}if(u>=0)return u%10;throw new he}}_t.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],_t.MAX_AVG_VARIANCE=.38,_t.MAX_INDIVIDUAL_VARIANCE=.5,_t.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],_t.START_PATTERN=Int32Array.from([1,1,1,1]),_t.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Ue extends an{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(r){let l=!1,u,m=0,g=Int32Array.from([0,0,0]);for(;!l;){g=Int32Array.from([0,0,0]),u=Ue.findGuardPattern(r,m,!1,this.START_END_PATTERN,g);let v=u[0];m=u[1];let _=v-(m-v);_>=0&&(l=r.isRange(_,v,!1))}return u}static checkChecksum(r){return Ue.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let l=r.length;if(l===0)return!1;let u=parseInt(r.charAt(l-1),10);return Ue.getStandardUPCEANChecksum(r.substring(0,l-1))===u}static getStandardUPCEANChecksum(r){let l=r.length,u=0;for(let m=l-1;m>=0;m-=2){let g=r.charAt(m).charCodeAt(0)-48;if(g<0||g>9)throw new U;u+=g}u*=3;for(let m=l-2;m>=0;m-=2){let g=r.charAt(m).charCodeAt(0)-48;if(g<0||g>9)throw new U;u+=g}return(1e3-u)%10}static decodeEnd(r,l){return Ue.findGuardPattern(r,l,!1,Ue.START_END_PATTERN,new Int32Array(Ue.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(r,l,u,m){return this.findGuardPattern(r,l,u,m,new Int32Array(m.length))}static findGuardPattern(r,l,u,m,g){let v=r.getSize();l=u?r.getNextUnset(l):r.getNextSet(l);let _=0,C=l,M=m.length,O=u;for(let j=l;j<v;j++)if(r.get(j)!==O)g[_]++;else{if(_===M-1){if(an.patternMatchVariance(g,m,Ue.MAX_INDIVIDUAL_VARIANCE)<Ue.MAX_AVG_VARIANCE)return Int32Array.from([C,j]);C+=g[0]+g[1];let G=g.slice(2,g.length-1);for(let Z=0;Z<_-1;Z++)g[Z]=G[Z];g[_-1]=0,g[_]=0,_--}else _++;g[_]=1,O=!O}throw new he}static decodeDigit(r,l,u,m){this.recordPattern(r,u,l);let g=this.MAX_AVG_VARIANCE,v=-1,_=m.length;for(let C=0;C<_;C++){let M=m[C],O=an.patternMatchVariance(l,M,Ue.MAX_INDIVIDUAL_VARIANCE);O<g&&(g=O,v=C)}if(v>=0)return v;throw new he}}Ue.MAX_AVG_VARIANCE=.48,Ue.MAX_INDIVIDUAL_VARIANCE=.7,Ue.START_END_PATTERN=Int32Array.from([1,1,1]),Ue.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Ue.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ue.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Xe{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,l,u){let m=this.decodeRowStringBuffer,g=this.decodeMiddle(l,u,m),v=m.toString(),_=Xe.parseExtensionString(v),C=[new Ze((u[0]+u[1])/2,r),new Ze(g,r)],M=new je(v,null,0,C,pe.UPC_EAN_EXTENSION,new Date().getTime());return _!=null&&M.putAllMetadata(_),M}decodeMiddle(r,l,u){let m=this.decodeMiddleCounters;m[0]=0,m[1]=0,m[2]=0,m[3]=0;let g=r.getSize(),v=l[1],_=0;for(let M=0;M<5&&v<g;M++){let O=Ue.decodeDigit(r,m,v,Ue.L_AND_G_PATTERNS);u+=String.fromCharCode(48+O%10);for(let j of m)v+=j;O>=10&&(_|=1<<4-M),M!==4&&(v=r.getNextSet(v),v=r.getNextUnset(v))}if(u.length!==5)throw new he;let C=this.determineCheckDigit(_);if(Xe.extensionChecksum(u.toString())!==C)throw new he;return v}static extensionChecksum(r){let l=r.length,u=0;for(let m=l-2;m>=0;m-=2)u+=r.charAt(m).charCodeAt(0)-48;u*=3;for(let m=l-1;m>=0;m-=2)u+=r.charAt(m).charCodeAt(0)-48;return u*=3,u%10}determineCheckDigit(r){for(let l=0;l<10;l++)if(r===this.CHECK_DIGIT_ENCODINGS[l])return l;throw new he}static parseExtensionString(r){if(r.length!==5)return null;let l=Xe.parseExtension5String(r);return l==null?null:new Map([[Ke.SUGGESTED_PRICE,l]])}static parseExtension5String(r){let l;switch(r.charAt(0)){case"0":l="";break;case"5":l="$";break;case"9":switch(r){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}l="";break;default:l="";break}let u=parseInt(r.substring(1)),m=(u/100).toString(),g=u%100,v=g<10?"0"+g:g.toString();return l+m+"."+v}}class xt{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,l,u){let m=this.decodeRowStringBuffer,g=this.decodeMiddle(l,u,m),v=m.toString(),_=xt.parseExtensionString(v),C=[new Ze((u[0]+u[1])/2,r),new Ze(g,r)],M=new je(v,null,0,C,pe.UPC_EAN_EXTENSION,new Date().getTime());return _!=null&&M.putAllMetadata(_),M}decodeMiddle(r,l,u){let m=this.decodeMiddleCounters;m[0]=0,m[1]=0,m[2]=0,m[3]=0;let g=r.getSize(),v=l[1],_=0;for(let C=0;C<2&&v<g;C++){let M=Ue.decodeDigit(r,m,v,Ue.L_AND_G_PATTERNS);u+=String.fromCharCode(48+M%10);for(let O of m)v+=O;M>=10&&(_|=1<<1-C),C!==1&&(v=r.getNextSet(v),v=r.getNextUnset(v))}if(u.length!==2)throw new he;if(parseInt(u.toString())%4!==_)throw new he;return v}static parseExtensionString(r){return r.length!==2?null:new Map([[Ke.ISSUE_NUMBER,parseInt(r)]])}}class yt{static decodeRow(r,l,u){let m=Ue.findGuardPattern(l,u,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Xe().decodeRow(r,l,m)}catch{return new xt().decodeRow(r,l,m)}}}yt.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class ut extends Ue{constructor(){super(),this.decodeRowStringBuffer="",ut.L_AND_G_PATTERNS=ut.L_PATTERNS.map(r=>Int32Array.from(r));for(let r=10;r<20;r++){let l=ut.L_PATTERNS[r-10],u=new Int32Array(l.length);for(let m=0;m<l.length;m++)u[m]=l[l.length-m-1];ut.L_AND_G_PATTERNS[r]=u}}decodeRow(r,l,u){let m=ut.findStartGuardPattern(l),g=u==null?null:u.get(me.NEED_RESULT_POINT_CALLBACK);if(g!=null){const Fe=new Ze((m[0]+m[1])/2,r);g.foundPossibleResultPoint(Fe)}let v=this.decodeMiddle(l,m,this.decodeRowStringBuffer),_=v.rowOffset,C=v.resultString;if(g!=null){const Fe=new Ze(_,r);g.foundPossibleResultPoint(Fe)}let M=this.decodeEnd(l,_);if(g!=null){const Fe=new Ze((M[0]+M[1])/2,r);g.foundPossibleResultPoint(Fe)}let O=M[1],j=O+(O-M[0]);if(j>=l.getSize()||!l.isRange(O,j,!1))throw new he;let G=C.toString();if(G.length<8)throw new U;if(!ut.checkChecksum(G))throw new k;let Z=(m[1]+m[0])/2,re=(M[1]+M[0])/2,ce=this.getBarcodeFormat(),ye=[new Ze(Z,r),new Ze(re,r)],Ce=new je(G,null,0,ye,ce,new Date().getTime()),qe=0;try{let Fe=yt.decodeRow(r,l,M[1]);Ce.putMetadata(Ke.UPC_EAN_EXTENSION,Fe.getText()),Ce.putAllMetadata(Fe.getResultMetadata()),Ce.addResultPoints(Fe.getResultPoints()),qe=Fe.getText().length}catch{}let He=u==null?null:u.get(me.ALLOWED_EAN_EXTENSIONS);if(He!=null){let Fe=!1;for(let jt in He)if(qe.toString()===jt){Fe=!0;break}if(!Fe)throw new he}return Ce}decodeEnd(r,l){return ut.findGuardPattern(r,l,!1,ut.START_END_PATTERN,new Int32Array(ut.START_END_PATTERN.length).fill(0))}static checkChecksum(r){return ut.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let l=r.length;if(l===0)return!1;let u=parseInt(r.charAt(l-1),10);return ut.getStandardUPCEANChecksum(r.substring(0,l-1))===u}static getStandardUPCEANChecksum(r){let l=r.length,u=0;for(let m=l-1;m>=0;m-=2){let g=r.charAt(m).charCodeAt(0)-48;if(g<0||g>9)throw new U;u+=g}u*=3;for(let m=l-2;m>=0;m-=2){let g=r.charAt(m).charCodeAt(0)-48;if(g<0||g>9)throw new U;u+=g}return(1e3-u)%10}}class At extends ut{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,l,u){let m=this.decodeMiddleCounters;m[0]=0,m[1]=0,m[2]=0,m[3]=0;let g=r.getSize(),v=l[1],_=0;for(let M=0;M<6&&v<g;M++){let O=ut.decodeDigit(r,m,v,ut.L_AND_G_PATTERNS);u+=String.fromCharCode(48+O%10);for(let j of m)v+=j;O>=10&&(_|=1<<5-M)}u=At.determineFirstDigit(u,_),v=ut.findGuardPattern(r,v,!0,ut.MIDDLE_PATTERN,new Int32Array(ut.MIDDLE_PATTERN.length).fill(0))[1];for(let M=0;M<6&&v<g;M++){let O=ut.decodeDigit(r,m,v,ut.L_PATTERNS);u+=String.fromCharCode(48+O);for(let j of m)v+=j}return{rowOffset:v,resultString:u}}getBarcodeFormat(){return pe.EAN_13}static determineFirstDigit(r,l){for(let u=0;u<10;u++)if(l===this.FIRST_DIGIT_ENCODINGS[u])return r=String.fromCharCode(48+u)+r,r;throw new he}}At.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Tn extends ut{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,l,u){const m=this.decodeMiddleCounters;m[0]=0,m[1]=0,m[2]=0,m[3]=0;let g=r.getSize(),v=l[1];for(let C=0;C<4&&v<g;C++){let M=ut.decodeDigit(r,m,v,ut.L_PATTERNS);u+=String.fromCharCode(48+M);for(let O of m)v+=O}v=ut.findGuardPattern(r,v,!0,ut.MIDDLE_PATTERN,new Int32Array(ut.MIDDLE_PATTERN.length).fill(0))[1];for(let C=0;C<4&&v<g;C++){let M=ut.decodeDigit(r,m,v,ut.L_PATTERNS);u+=String.fromCharCode(48+M);for(let O of m)v+=O}return{rowOffset:v,resultString:u}}getBarcodeFormat(){return pe.EAN_8}}class yn extends ut{constructor(){super(...arguments),this.ean13Reader=new At}getBarcodeFormat(){return pe.UPC_A}decode(r,l){return this.maybeReturnResult(this.ean13Reader.decode(r))}decodeRow(r,l,u){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,l,u))}decodeMiddle(r,l,u){return this.ean13Reader.decodeMiddle(r,l,u)}maybeReturnResult(r){let l=r.getText();if(l.charAt(0)==="0"){let u=new je(l.substring(1),null,null,r.getResultPoints(),pe.UPC_A);return r.getResultMetadata()!=null&&u.putAllMetadata(r.getResultMetadata()),u}else throw new he}reset(){this.ean13Reader.reset()}}class Pt extends ut{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(r,l,u){const m=this.decodeMiddleCounters.map(M=>M);m[0]=0,m[1]=0,m[2]=0,m[3]=0;const g=r.getSize();let v=l[1],_=0;for(let M=0;M<6&&v<g;M++){const O=Pt.decodeDigit(r,m,v,Pt.L_AND_G_PATTERNS);u+=String.fromCharCode(48+O%10);for(let j of m)v+=j;O>=10&&(_|=1<<5-M)}let C=Pt.determineNumSysAndCheckDigit(u,_);return{rowOffset:v,resultString:C}}decodeEnd(r,l){return Pt.findGuardPatternWithoutCounters(r,l,!0,Pt.MIDDLE_END_PATTERN)}checkChecksum(r){return ut.checkChecksum(Pt.convertUPCEtoUPCA(r))}static determineNumSysAndCheckDigit(r,l){for(let u=0;u<=1;u++)for(let m=0;m<10;m++)if(l===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[u][m]){let g=String.fromCharCode(48+u),v=String.fromCharCode(48+m);return g+r+v}throw he.getNotFoundInstance()}getBarcodeFormat(){return pe.UPC_E}static convertUPCEtoUPCA(r){const l=r.slice(1,7).split("").map(g=>g.charCodeAt(0)),u=new z;u.append(r.charAt(0));let m=l[5];switch(m){case 0:case 1:case 2:u.appendChars(l,0,2),u.append(m),u.append("0000"),u.appendChars(l,2,3);break;case 3:u.appendChars(l,0,3),u.append("00000"),u.appendChars(l,3,2);break;case 4:u.appendChars(l,0,4),u.append("00000"),u.append(l[4]);break;default:u.appendChars(l,0,5),u.append("0000"),u.append(m);break}return r.length>=8&&u.append(r.charAt(7)),u.toString()}}Pt.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Pt.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class is extends an{constructor(r){super();let l=r==null?null:r.get(me.POSSIBLE_FORMATS),u=[];i(l)?(u.push(new At),u.push(new yn),u.push(new Tn),u.push(new Pt)):(l.indexOf(pe.EAN_13)>-1&&u.push(new At),l.indexOf(pe.UPC_A)>-1&&u.push(new yn),l.indexOf(pe.EAN_8)>-1&&u.push(new Tn),l.indexOf(pe.UPC_E)>-1&&u.push(new Pt)),this.readers=u}decodeRow(r,l,u){for(let m of this.readers)try{const g=m.decodeRow(r,l,u),v=g.getBarcodeFormat()===pe.EAN_13&&g.getText().charAt(0)==="0",_=u==null?null:u.get(me.POSSIBLE_FORMATS),C=_==null||_.includes(pe.UPC_A);if(v&&C){const M=g.getRawBytes(),O=new je(g.getText().substring(1),M,M?M.length:null,g.getResultPoints(),pe.UPC_A);return O.putAllMetadata(g.getResultMetadata()),O}return g}catch{}throw new he}reset(){for(let r of this.readers)r.reset()}}class Vt extends an{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(r,l){for(let u=0;u<l.length;u++)if(an.patternMatchVariance(r,l[u],Vt.MAX_INDIVIDUAL_VARIANCE)<Vt.MAX_AVG_VARIANCE)return u;throw new he}static count(r){return nt.sum(new Int32Array(r))}static increment(r,l){let u=0,m=l[0];for(let g=1;g<r.length;g++)l[g]>m&&(m=l[g],u=g);r[u]++}static decrement(r,l){let u=0,m=l[0];for(let g=1;g<r.length;g++)l[g]<m&&(m=l[g],u=g);r[u]--}static isFinderPattern(r){let l=r[0]+r[1],u=l+r[2]+r[3],m=l/u;if(m>=Vt.MIN_FINDER_PATTERN_RATIO&&m<=Vt.MAX_FINDER_PATTERN_RATIO){let g=Number.MAX_SAFE_INTEGER,v=Number.MIN_SAFE_INTEGER;for(let _ of r)_>v&&(v=_),_<g&&(g=_);return v<10*g}return!1}}Vt.MAX_AVG_VARIANCE=.2,Vt.MAX_INDIVIDUAL_VARIANCE=.45,Vt.MIN_FINDER_PATTERN_RATIO=9.5/12,Vt.MAX_FINDER_PATTERN_RATIO=12.5/14;class ii{constructor(r,l){this.value=r,this.checksumPortion=l}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(r){if(!(r instanceof ii))return!1;const l=r;return this.value===l.value&&this.checksumPortion===l.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class zi{constructor(r,l,u,m,g){this.value=r,this.startEnd=l,this.value=r,this.startEnd=l,this.resultPoints=new Array,this.resultPoints.push(new Ze(u,g)),this.resultPoints.push(new Ze(m,g))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(r){if(!(r instanceof zi))return!1;const l=r;return this.value===l.value}hashCode(){return this.value}}class ps{constructor(){}static getRSSvalue(r,l,u){let m=0;for(let C of r)m+=C;let g=0,v=0,_=r.length;for(let C=0;C<_-1;C++){let M;for(M=1,v|=1<<C;M<r[C];M++,v&=~(1<<C)){let O=ps.combins(m-M-1,_-C-2);if(u&&v===0&&m-M-(_-C-1)>=_-C-1&&(O-=ps.combins(m-M-(_-C),_-C-2)),_-C-1>1){let j=0;for(let G=m-M-(_-C-2);G>l;G--)j+=ps.combins(m-M-G-1,_-C-3);O-=j*(_-1-C)}else m-M>l&&O--;g+=O}m-=M}return g}static combins(r,l){let u,m;r-l>l?(m=l,u=r-l):(m=r-l,u=l);let g=1,v=1;for(let _=r;_>u;_--)g*=_,v<=m&&(g/=v,v++);for(;v<=m;)g/=v,v++;return g}}class zr{static buildBitArray(r){let l=r.length*2-1;r[r.length-1].getRightChar()==null&&(l-=1);let u=12*l,m=new de(u),g=0,_=r[0].getRightChar().getValue();for(let C=11;C>=0;--C)(_&1<<C)!=0&&m.set(g),g++;for(let C=1;C<r.length;++C){let M=r[C],O=M.getLeftChar().getValue();for(let j=11;j>=0;--j)(O&1<<j)!=0&&m.set(g),g++;if(M.getRightChar()!=null){let j=M.getRightChar().getValue();for(let G=11;G>=0;--G)(j&1<<G)!=0&&m.set(g),g++}}return m}}class Is{constructor(r,l){l?this.decodedInformation=null:(this.finished=r,this.decodedInformation=l)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class qr{constructor(r){this.newPosition=r}getNewPosition(){return this.newPosition}}class Qn extends qr{constructor(r,l){super(r),this.value=l}getValue(){return this.value}isFNC1(){return this.value===Qn.FNC1}}Qn.FNC1="$";class Ri extends qr{constructor(r,l,u){super(r),u?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=l}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Mi extends qr{constructor(r,l,u){if(super(r),l<0||l>10||u<0||u>10)throw new U;this.firstDigit=l,this.secondDigit=u}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Mi.FNC1}isSecondDigitFNC1(){return this.secondDigit===Mi.FNC1}isAnyFNC1(){return this.firstDigit===Mi.FNC1||this.secondDigit===Mi.FNC1}}Mi.FNC1=10;class Je{constructor(){}static parseFieldsInGeneralPurpose(r){if(!r)return null;if(r.length<2)throw new he;let l=r.substring(0,2);for(let g of Je.TWO_DIGIT_DATA_LENGTH)if(g[0]===l)return g[1]===Je.VARIABLE_LENGTH?Je.processVariableAI(2,g[2],r):Je.processFixedAI(2,g[1],r);if(r.length<3)throw new he;let u=r.substring(0,3);for(let g of Je.THREE_DIGIT_DATA_LENGTH)if(g[0]===u)return g[1]===Je.VARIABLE_LENGTH?Je.processVariableAI(3,g[2],r):Je.processFixedAI(3,g[1],r);for(let g of Je.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(g[0]===u)return g[1]===Je.VARIABLE_LENGTH?Je.processVariableAI(4,g[2],r):Je.processFixedAI(4,g[1],r);if(r.length<4)throw new he;let m=r.substring(0,4);for(let g of Je.FOUR_DIGIT_DATA_LENGTH)if(g[0]===m)return g[1]===Je.VARIABLE_LENGTH?Je.processVariableAI(4,g[2],r):Je.processFixedAI(4,g[1],r);throw new he}static processFixedAI(r,l,u){if(u.length<r)throw new he;let m=u.substring(0,r);if(u.length<r+l)throw new he;let g=u.substring(r,r+l),v=u.substring(r+l),_="("+m+")"+g,C=Je.parseFieldsInGeneralPurpose(v);return C==null?_:_+C}static processVariableAI(r,l,u){let m=u.substring(0,r),g;u.length<r+l?g=u.length:g=r+l;let v=u.substring(r,g),_=u.substring(g),C="("+m+")"+v,M=Je.parseFieldsInGeneralPurpose(_);return M==null?C:C+M}}Je.VARIABLE_LENGTH=[],Je.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",Je.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",Je.VARIABLE_LENGTH,20],["22",Je.VARIABLE_LENGTH,29],["30",Je.VARIABLE_LENGTH,8],["37",Je.VARIABLE_LENGTH,8],["90",Je.VARIABLE_LENGTH,30],["91",Je.VARIABLE_LENGTH,30],["92",Je.VARIABLE_LENGTH,30],["93",Je.VARIABLE_LENGTH,30],["94",Je.VARIABLE_LENGTH,30],["95",Je.VARIABLE_LENGTH,30],["96",Je.VARIABLE_LENGTH,30],["97",Je.VARIABLE_LENGTH,3],["98",Je.VARIABLE_LENGTH,30],["99",Je.VARIABLE_LENGTH,30]],Je.THREE_DIGIT_DATA_LENGTH=[["240",Je.VARIABLE_LENGTH,30],["241",Je.VARIABLE_LENGTH,30],["242",Je.VARIABLE_LENGTH,6],["250",Je.VARIABLE_LENGTH,30],["251",Je.VARIABLE_LENGTH,30],["253",Je.VARIABLE_LENGTH,17],["254",Je.VARIABLE_LENGTH,20],["400",Je.VARIABLE_LENGTH,30],["401",Je.VARIABLE_LENGTH,30],["402",17],["403",Je.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",Je.VARIABLE_LENGTH,20],["421",Je.VARIABLE_LENGTH,15],["422",3],["423",Je.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],Je.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",Je.VARIABLE_LENGTH,15],["391",Je.VARIABLE_LENGTH,18],["392",Je.VARIABLE_LENGTH,15],["393",Je.VARIABLE_LENGTH,18],["703",Je.VARIABLE_LENGTH,30]],Je.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",Je.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",Je.VARIABLE_LENGTH,20],["8003",Je.VARIABLE_LENGTH,30],["8004",Je.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",Je.VARIABLE_LENGTH,30],["8008",Je.VARIABLE_LENGTH,12],["8018",18],["8020",Je.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",Je.VARIABLE_LENGTH,70],["8200",Je.VARIABLE_LENGTH,70]];class Ti{constructor(r){this.buffer=new z,this.information=r}decodeAllCodes(r,l){let u=l,m=null;do{let g=this.decodeGeneralPurposeField(u,m),v=Je.parseFieldsInGeneralPurpose(g.getNewString());if(v!=null&&r.append(v),g.isRemaining()?m=""+g.getRemainingValue():m=null,u===g.getNewPosition())break;u=g.getNewPosition()}while(!0);return r.toString()}isStillNumeric(r){if(r+7>this.information.getSize())return r+4<=this.information.getSize();for(let l=r;l<r+3;++l)if(this.information.get(l))return!0;return this.information.get(r+3)}decodeNumeric(r){if(r+7>this.information.getSize()){let g=this.extractNumericValueFromBitArray(r,4);return g===0?new Mi(this.information.getSize(),Mi.FNC1,Mi.FNC1):new Mi(this.information.getSize(),g-1,Mi.FNC1)}let l=this.extractNumericValueFromBitArray(r,7),u=(l-8)/11,m=(l-8)%11;return new Mi(r+7,u,m)}extractNumericValueFromBitArray(r,l){return Ti.extractNumericValueFromBitArray(this.information,r,l)}static extractNumericValueFromBitArray(r,l,u){let m=0;for(let g=0;g<u;++g)r.get(l+g)&&(m|=1<<u-g-1);return m}decodeGeneralPurposeField(r,l){this.buffer.setLengthToZero(),l!=null&&this.buffer.append(l),this.current.setPosition(r);let u=this.parseBlocks();return u!=null&&u.isRemaining()?new Ri(this.current.getPosition(),this.buffer.toString(),u.getRemainingValue()):new Ri(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let r,l;do{let u=this.current.getPosition();if(this.current.isAlpha()?(l=this.parseAlphaBlock(),r=l.isFinished()):this.current.isIsoIec646()?(l=this.parseIsoIec646Block(),r=l.isFinished()):(l=this.parseNumericBlock(),r=l.isFinished()),!(u!==this.current.getPosition())&&!r)break}while(!r);return l.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let r=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFirstDigitFNC1()){let l;return r.isSecondDigitFNC1()?l=new Ri(this.current.getPosition(),this.buffer.toString()):l=new Ri(this.current.getPosition(),this.buffer.toString(),r.getSecondDigit()),new Is(!0,l)}if(this.buffer.append(r.getFirstDigit()),r.isSecondDigitFNC1()){let l=new Ri(this.current.getPosition(),this.buffer.toString());return new Is(!0,l)}this.buffer.append(r.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Is(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let r=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let l=new Ri(this.current.getPosition(),this.buffer.toString());return new Is(!0,l)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Is(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let r=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let l=new Ri(this.current.getPosition(),this.buffer.toString());return new Is(!0,l)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Is(!1)}isStillIsoIec646(r){if(r+5>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(r,5);if(l>=5&&l<16)return!0;if(r+7>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(r,7);if(u>=64&&u<116)return!0;if(r+8>this.information.getSize())return!1;let m=this.extractNumericValueFromBitArray(r,8);return m>=232&&m<253}decodeIsoIec646(r){let l=this.extractNumericValueFromBitArray(r,5);if(l===15)return new Qn(r+5,Qn.FNC1);if(l>=5&&l<15)return new Qn(r+5,"0"+(l-5));let u=this.extractNumericValueFromBitArray(r,7);if(u>=64&&u<90)return new Qn(r+7,""+(u+1));if(u>=90&&u<116)return new Qn(r+7,""+(u+7));let m=this.extractNumericValueFromBitArray(r,8),g;switch(m){case 232:g="!";break;case 233:g='"';break;case 234:g="%";break;case 235:g="&";break;case 236:g="'";break;case 237:g="(";break;case 238:g=")";break;case 239:g="*";break;case 240:g="+";break;case 241:g=",";break;case 242:g="-";break;case 243:g=".";break;case 244:g="/";break;case 245:g=":";break;case 246:g=";";break;case 247:g="<";break;case 248:g="=";break;case 249:g=">";break;case 250:g="?";break;case 251:g="_";break;case 252:g=" ";break;default:throw new U}return new Qn(r+8,g)}isStillAlpha(r){if(r+5>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(r,5);if(l>=5&&l<16)return!0;if(r+6>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(r,6);return u>=16&&u<63}decodeAlphanumeric(r){let l=this.extractNumericValueFromBitArray(r,5);if(l===15)return new Qn(r+5,Qn.FNC1);if(l>=5&&l<15)return new Qn(r+5,"0"+(l-5));let u=this.extractNumericValueFromBitArray(r,6);if(u>=32&&u<58)return new Qn(r+6,""+(u+33));let m;switch(u){case 58:m="*";break;case 59:m=",";break;case 60:m="-";break;case 61:m=".";break;case 62:m="/";break;default:throw new De("Decoding invalid alphanumeric value: "+u)}return new Qn(r+6,m)}isAlphaTo646ToAlphaLatch(r){if(r+1>this.information.getSize())return!1;for(let l=0;l<5&&l+r<this.information.getSize();++l)if(l===2){if(!this.information.get(r+2))return!1}else if(this.information.get(r+l))return!1;return!0}isAlphaOr646ToNumericLatch(r){if(r+3>this.information.getSize())return!1;for(let l=r;l<r+3;++l)if(this.information.get(l))return!1;return!0}isNumericToAlphaNumericLatch(r){if(r+1>this.information.getSize())return!1;for(let l=0;l<4&&l+r<this.information.getSize();++l)if(this.information.get(r+l))return!1;return!0}}class jn{constructor(r){this.information=r,this.generalDecoder=new Ti(r)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class cn extends jn{constructor(r){super(r)}encodeCompressedGtin(r,l){r.append("(01)");let u=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,l,u)}encodeCompressedGtinWithoutAI(r,l,u){for(let m=0;m<4;++m){let g=this.getGeneralDecoder().extractNumericValueFromBitArray(l+10*m,10);g/100===0&&r.append("0"),g/10===0&&r.append("0"),r.append(g)}cn.appendCheckDigit(r,u)}static appendCheckDigit(r,l){let u=0;for(let m=0;m<13;m++){let g=r.charAt(m+l).charCodeAt(0)-48;u+=(m&1)===0?3*g:g}u=10-u%10,u===10&&(u=0),r.append(u)}}cn.GTIN_SIZE=40;class Di extends cn{constructor(r){super(r)}parseInformation(){let r=new z;r.append("(01)");let l=r.length(),u=this.getGeneralDecoder().extractNumericValueFromBitArray(Di.HEADER_SIZE,4);return r.append(u),this.encodeCompressedGtinWithoutAI(r,Di.HEADER_SIZE+4,l),this.getGeneralDecoder().decodeAllCodes(r,Di.HEADER_SIZE+44)}}Di.HEADER_SIZE=4;class dr extends jn{constructor(r){super(r)}parseInformation(){let r=new z;return this.getGeneralDecoder().decodeAllCodes(r,dr.HEADER_SIZE)}}dr.HEADER_SIZE=5;class Oo extends cn{constructor(r){super(r)}encodeCompressedWeight(r,l,u){let m=this.getGeneralDecoder().extractNumericValueFromBitArray(l,u);this.addWeightCode(r,m);let g=this.checkWeight(m),v=1e5;for(let _=0;_<5;++_)g/v===0&&r.append("0"),v/=10;r.append(g)}}class ss extends Oo{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()!=ss.HEADER_SIZE+Oo.GTIN_SIZE+ss.WEIGHT_SIZE)throw new he;let r=new z;return this.encodeCompressedGtin(r,ss.HEADER_SIZE),this.encodeCompressedWeight(r,ss.HEADER_SIZE+Oo.GTIN_SIZE,ss.WEIGHT_SIZE),r.toString()}}ss.HEADER_SIZE=5,ss.WEIGHT_SIZE=15;class fl extends ss{constructor(r){super(r)}addWeightCode(r,l){r.append("(3103)")}checkWeight(r){return r}}class Ys extends ss{constructor(r){super(r)}addWeightCode(r,l){l<1e4?r.append("(3202)"):r.append("(3203)")}checkWeight(r){return r<1e4?r:r-1e4}}class Oi extends cn{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<Oi.HEADER_SIZE+cn.GTIN_SIZE)throw new he;let r=new z;this.encodeCompressedGtin(r,Oi.HEADER_SIZE);let l=this.getGeneralDecoder().extractNumericValueFromBitArray(Oi.HEADER_SIZE+cn.GTIN_SIZE,Oi.LAST_DIGIT_SIZE);r.append("(392"),r.append(l),r.append(")");let u=this.getGeneralDecoder().decodeGeneralPurposeField(Oi.HEADER_SIZE+cn.GTIN_SIZE+Oi.LAST_DIGIT_SIZE,null);return r.append(u.getNewString()),r.toString()}}Oi.HEADER_SIZE=8,Oi.LAST_DIGIT_SIZE=2;class kn extends cn{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<kn.HEADER_SIZE+cn.GTIN_SIZE)throw new he;let r=new z;this.encodeCompressedGtin(r,kn.HEADER_SIZE);let l=this.getGeneralDecoder().extractNumericValueFromBitArray(kn.HEADER_SIZE+cn.GTIN_SIZE,kn.LAST_DIGIT_SIZE);r.append("(393"),r.append(l),r.append(")");let u=this.getGeneralDecoder().extractNumericValueFromBitArray(kn.HEADER_SIZE+cn.GTIN_SIZE+kn.LAST_DIGIT_SIZE,kn.FIRST_THREE_DIGITS_SIZE);u/100==0&&r.append("0"),u/10==0&&r.append("0"),r.append(u);let m=this.getGeneralDecoder().decodeGeneralPurposeField(kn.HEADER_SIZE+cn.GTIN_SIZE+kn.LAST_DIGIT_SIZE+kn.FIRST_THREE_DIGITS_SIZE,null);return r.append(m.getNewString()),r.toString()}}kn.HEADER_SIZE=8,kn.LAST_DIGIT_SIZE=2,kn.FIRST_THREE_DIGITS_SIZE=10;class zt extends Oo{constructor(r,l,u){super(r),this.dateCode=u,this.firstAIdigits=l}parseInformation(){if(this.getInformation().getSize()!=zt.HEADER_SIZE+zt.GTIN_SIZE+zt.WEIGHT_SIZE+zt.DATE_SIZE)throw new he;let r=new z;return this.encodeCompressedGtin(r,zt.HEADER_SIZE),this.encodeCompressedWeight(r,zt.HEADER_SIZE+zt.GTIN_SIZE,zt.WEIGHT_SIZE),this.encodeCompressedDate(r,zt.HEADER_SIZE+zt.GTIN_SIZE+zt.WEIGHT_SIZE),r.toString()}encodeCompressedDate(r,l){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(l,zt.DATE_SIZE);if(u==38400)return;r.append("("),r.append(this.dateCode),r.append(")");let m=u%32;u/=32;let g=u%12+1;u/=12;let v=u;v/10==0&&r.append("0"),r.append(v),g/10==0&&r.append("0"),r.append(g),m/10==0&&r.append("0"),r.append(m)}addWeightCode(r,l){r.append("("),r.append(this.firstAIdigits),r.append(l/1e5),r.append(")")}checkWeight(r){return r%1e5}}zt.HEADER_SIZE=8,zt.WEIGHT_SIZE=20,zt.DATE_SIZE=16;function qi(B){try{if(B.get(1))return new Di(B);if(!B.get(2))return new dr(B);switch(Ti.extractNumericValueFromBitArray(B,1,4)){case 4:return new fl(B);case 5:return new Ys(B)}switch(Ti.extractNumericValueFromBitArray(B,1,5)){case 12:return new Oi(B);case 13:return new kn(B)}switch(Ti.extractNumericValueFromBitArray(B,1,7)){case 56:return new zt(B,"310","11");case 57:return new zt(B,"320","11");case 58:return new zt(B,"310","13");case 59:return new zt(B,"320","13");case 60:return new zt(B,"310","15");case 61:return new zt(B,"320","15");case 62:return new zt(B,"310","17");case 63:return new zt(B,"320","17")}}catch(r){throw console.log(r),new De("unknown decoder: "+B)}}class xi{constructor(r,l,u,m){this.leftchar=r,this.rightchar=l,this.finderpattern=u,this.maybeLast=m}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(r,l){return r instanceof xi?xi.equalsOrNull(r.leftchar,l.leftchar)&&xi.equalsOrNull(r.rightchar,l.rightchar)&&xi.equalsOrNull(r.finderpattern,l.finderpattern):!1}static equalsOrNull(r,l){return r===null?l===null:xi.equals(r,l)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Vn{constructor(r,l,u){this.pairs=r,this.rowNumber=l,this.wasReversed=u}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(r){return this.checkEqualitity(this,r)}toString(){return"{ "+this.pairs+" }"}equals(r,l){return r instanceof Vn?this.checkEqualitity(r,l)&&r.wasReversed===l.wasReversed:!1}checkEqualitity(r,l){if(!r||!l)return;let u;return r.forEach((m,g)=>{l.forEach(v=>{m.getLeftChar().getValue()===v.getLeftChar().getValue()&&m.getRightChar().getValue()===v.getRightChar().getValue()&&m.getFinderPatter().getValue()===v.getFinderPatter().getValue()&&(u=!0)})}),u}}class Le extends Vt{constructor(r){super(...arguments),this.pairs=new Array(Le.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=r===!0}decodeRow(r,l,u){this.pairs.length=0,this.startFromEven=!1;try{return Le.constructResult(this.decodeRow2pairs(r,l))}catch(m){this.verbose&&console.log(m)}return this.pairs.length=0,this.startFromEven=!0,Le.constructResult(this.decodeRow2pairs(r,l))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(r,l){let u=!1;for(;!u;)try{this.pairs.push(this.retrieveNextPair(l,this.pairs,r))}catch(g){if(g instanceof he){if(!this.pairs.length)throw new he;u=!0}}if(this.checkChecksum())return this.pairs;let m;if(this.rows.length?m=!0:m=!1,this.storeRow(r,!1),m){let g=this.checkRowsBoolean(!1);if(g!=null||(g=this.checkRowsBoolean(!0),g!=null))return g}throw new he}checkRowsBoolean(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());let l=null;try{l=this.checkRows(new Array,0)}catch(u){this.verbose&&console.log(u)}return r&&(this.rows=this.rows.reverse()),l}checkRows(r,l){for(let u=l;u<this.rows.length;u++){let m=this.rows[u];this.pairs.length=0;for(let v of r)this.pairs.push(v.getPairs());if(this.pairs.push(m.getPairs()),!Le.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let g=new Array(r);g.push(m);try{return this.checkRows(g,u+1)}catch(v){this.verbose&&console.log(v)}}throw new he}static isValidSequence(r){for(let l of Le.FINDER_PATTERN_SEQUENCES){if(r.length>l.length)continue;let u=!0;for(let m=0;m<r.length;m++)if(r[m].getFinderPattern().getValue()!=l[m]){u=!1;break}if(u)return!0}return!1}storeRow(r,l){let u=0,m=!1,g=!1;for(;u<this.rows.length;){let v=this.rows[u];if(v.getRowNumber()>r){g=v.isEquivalent(this.pairs);break}m=v.isEquivalent(this.pairs),u++}g||m||Le.isPartialRow(this.pairs,this.rows)||(this.rows.push(u,new Vn(this.pairs,r,l)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(r,l){for(let u of l)if(u.getPairs().length!==r.length){for(let m of u.getPairs())for(let g of r)if(xi.equals(m,g))break}}static isPartialRow(r,l){for(let u of l){let m=!0;for(let g of r){let v=!1;for(let _ of u.getPairs())if(g.equals(_)){v=!0;break}if(!v){m=!1;break}}if(m)return!0}return!1}getRows(){return this.rows}static constructResult(r){let l=zr.buildBitArray(r),m=qi(l).parseInformation(),g=r[0].getFinderPattern().getResultPoints(),v=r[r.length-1].getFinderPattern().getResultPoints(),_=[g[0],g[1],v[0],v[1]];return new je(m,null,null,_,pe.RSS_EXPANDED,null)}checkChecksum(){let r=this.pairs.get(0),l=r.getLeftChar(),u=r.getRightChar();if(u==null)return!1;let m=u.getChecksumPortion(),g=2;for(let _=1;_<this.pairs.size();++_){let C=this.pairs.get(_);m+=C.getLeftChar().getChecksumPortion(),g++;let M=C.getRightChar();M!=null&&(m+=M.getChecksumPortion(),g++)}return m%=211,211*(g-4)+m==l.getValue()}static getNextSecondBar(r,l){let u;return r.get(l)?(u=r.getNextUnset(l),u=r.getNextSet(u)):(u=r.getNextSet(l),u=r.getNextUnset(u)),u}retrieveNextPair(r,l,u){let m=l.length%2==0;this.startFromEven&&(m=!m);let g,v=!0,_=-1;do this.findNextPair(r,l,_),g=this.parseFoundFinderPattern(r,u,m),g==null?_=Le.getNextSecondBar(r,this.startEnd[0]):v=!1;while(v);let C=this.decodeDataCharacter(r,g,m,!0);if(!this.isEmptyPair(l)&&l[l.length-1].mustBeLast())throw new he;let M;try{M=this.decodeDataCharacter(r,g,m,!1)}catch(O){M=null,this.verbose&&console.log(O)}return new xi(C,M,g,!0)}isEmptyPair(r){return r.length===0}findNextPair(r,l,u){let m=this.getDecodeFinderCounters();m[0]=0,m[1]=0,m[2]=0,m[3]=0;let g=r.getSize(),v;u>=0?v=u:this.isEmptyPair(l)?v=0:v=l[l.length-1].getFinderPattern().getStartEnd()[1];let _=l.length%2!=0;this.startFromEven&&(_=!_);let C=!1;for(;v<g&&(C=!r.get(v),!!C);)v++;let M=0,O=v;for(let j=v;j<g;j++)if(r.get(j)!=C)m[M]++;else{if(M==3){if(_&&Le.reverseCounters(m),Le.isFinderPattern(m)){this.startEnd[0]=O,this.startEnd[1]=j;return}_&&Le.reverseCounters(m),O+=m[0]+m[1],m[0]=m[2],m[1]=m[3],m[2]=0,m[3]=0,M--}else M++;m[M]=1,C=!C}throw new he}static reverseCounters(r){let l=r.length;for(let u=0;u<l/2;++u){let m=r[u];r[u]=r[l-u-1],r[l-u-1]=m}}parseFoundFinderPattern(r,l,u){let m,g,v;if(u){let M=this.startEnd[0]-1;for(;M>=0&&!r.get(M);)M--;M++,m=this.startEnd[0]-M,g=M,v=this.startEnd[1]}else g=this.startEnd[0],v=r.getNextUnset(this.startEnd[1]+1),m=v-this.startEnd[1];let _=this.getDecodeFinderCounters();W.arraycopy(_,0,_,1,_.length-1),_[0]=m;let C;try{C=this.parseFinderValue(_,Le.FINDER_PATTERNS)}catch{return null}return new zi(C,[g,v],g,v,l)}decodeDataCharacter(r,l,u,m){let g=this.getDataCharacterCounters();for(let bn=0;bn<g.length;bn++)g[bn]=0;if(m)Le.recordPatternInReverse(r,l.getStartEnd()[0],g);else{Le.recordPattern(r,l.getStartEnd()[1],g);for(let bn=0,yi=g.length-1;bn<yi;bn++,yi--){let cs=g[bn];g[bn]=g[yi],g[yi]=cs}}let v=17,_=nt.sum(new Int32Array(g))/v,C=(l.getStartEnd()[1]-l.getStartEnd()[0])/15;if(Math.abs(_-C)/C>.3)throw new he;let M=this.getOddCounts(),O=this.getEvenCounts(),j=this.getOddRoundingErrors(),G=this.getEvenRoundingErrors();for(let bn=0;bn<g.length;bn++){let yi=1*g[bn]/_,cs=yi+.5;if(cs<1){if(yi<.3)throw new he;cs=1}else if(cs>8){if(yi>8.7)throw new he;cs=8}let jo=bn/2;(bn&1)==0?(M[jo]=cs,j[jo]=yi-cs):(O[jo]=cs,G[jo]=yi-cs)}this.adjustOddEvenCounts(v);let Z=4*l.getValue()+(u?0:2)+(m?0:1)-1,re=0,ce=0;for(let bn=M.length-1;bn>=0;bn--){if(Le.isNotA1left(l,u,m)){let yi=Le.WEIGHTS[Z][2*bn];ce+=M[bn]*yi}re+=M[bn]}let ye=0;for(let bn=O.length-1;bn>=0;bn--)if(Le.isNotA1left(l,u,m)){let yi=Le.WEIGHTS[Z][2*bn+1];ye+=O[bn]*yi}let Ce=ce+ye;if((re&1)!=0||re>13||re<4)throw new he;let qe=(13-re)/2,He=Le.SYMBOL_WIDEST[qe],Fe=9-He,jt=ps.getRSSvalue(M,He,!0),Nt=ps.getRSSvalue(O,Fe,!1),Zn=Le.EVEN_TOTAL_SUBSET[qe],bs=Le.GSUM[qe],Ui=jt*Zn+Nt+bs;return new ii(Ui,Ce)}static isNotA1left(r,l,u){return!(r.getValue()==0&&l&&u)}adjustOddEvenCounts(r){let l=nt.sum(new Int32Array(this.getOddCounts())),u=nt.sum(new Int32Array(this.getEvenCounts())),m=!1,g=!1;l>13?g=!0:l<4&&(m=!0);let v=!1,_=!1;u>13?_=!0:u<4&&(v=!0);let C=l+u-r,M=(l&1)==1,O=(u&1)==0;if(C==1)if(M){if(O)throw new he;g=!0}else{if(!O)throw new he;_=!0}else if(C==-1)if(M){if(O)throw new he;m=!0}else{if(!O)throw new he;v=!0}else if(C==0){if(M){if(!O)throw new he;l<u?(m=!0,_=!0):(g=!0,v=!0)}else if(O)throw new he}else throw new he;if(m){if(g)throw new he;Le.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(g&&Le.decrement(this.getOddCounts(),this.getOddRoundingErrors()),v){if(_)throw new he;Le.increment(this.getEvenCounts(),this.getOddRoundingErrors())}_&&Le.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Le.SYMBOL_WIDEST=[7,5,4,3,1],Le.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Le.GSUM=[0,348,1388,2948,3988],Le.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Le.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Le.FINDER_PAT_A=0,Le.FINDER_PAT_B=1,Le.FINDER_PAT_C=2,Le.FINDER_PAT_D=3,Le.FINDER_PAT_E=4,Le.FINDER_PAT_F=5,Le.FINDER_PATTERN_SEQUENCES=[[Le.FINDER_PAT_A,Le.FINDER_PAT_A],[Le.FINDER_PAT_A,Le.FINDER_PAT_B,Le.FINDER_PAT_B],[Le.FINDER_PAT_A,Le.FINDER_PAT_C,Le.FINDER_PAT_B,Le.FINDER_PAT_D],[Le.FINDER_PAT_A,Le.FINDER_PAT_E,Le.FINDER_PAT_B,Le.FINDER_PAT_D,Le.FINDER_PAT_C],[Le.FINDER_PAT_A,Le.FINDER_PAT_E,Le.FINDER_PAT_B,Le.FINDER_PAT_D,Le.FINDER_PAT_D,Le.FINDER_PAT_F],[Le.FINDER_PAT_A,Le.FINDER_PAT_E,Le.FINDER_PAT_B,Le.FINDER_PAT_D,Le.FINDER_PAT_E,Le.FINDER_PAT_F,Le.FINDER_PAT_F],[Le.FINDER_PAT_A,Le.FINDER_PAT_A,Le.FINDER_PAT_B,Le.FINDER_PAT_B,Le.FINDER_PAT_C,Le.FINDER_PAT_C,Le.FINDER_PAT_D,Le.FINDER_PAT_D],[Le.FINDER_PAT_A,Le.FINDER_PAT_A,Le.FINDER_PAT_B,Le.FINDER_PAT_B,Le.FINDER_PAT_C,Le.FINDER_PAT_C,Le.FINDER_PAT_D,Le.FINDER_PAT_E,Le.FINDER_PAT_E],[Le.FINDER_PAT_A,Le.FINDER_PAT_A,Le.FINDER_PAT_B,Le.FINDER_PAT_B,Le.FINDER_PAT_C,Le.FINDER_PAT_C,Le.FINDER_PAT_D,Le.FINDER_PAT_E,Le.FINDER_PAT_F,Le.FINDER_PAT_F],[Le.FINDER_PAT_A,Le.FINDER_PAT_A,Le.FINDER_PAT_B,Le.FINDER_PAT_B,Le.FINDER_PAT_C,Le.FINDER_PAT_D,Le.FINDER_PAT_D,Le.FINDER_PAT_E,Le.FINDER_PAT_E,Le.FINDER_PAT_F,Le.FINDER_PAT_F]],Le.MAX_PAIRS=11;class Da extends ii{constructor(r,l,u){super(r,l),this.count=0,this.finderPattern=u}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class un extends Vt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(r,l,u){const m=this.decodePair(l,!1,r,u);un.addOrTally(this.possibleLeftPairs,m),l.reverse();let g=this.decodePair(l,!0,r,u);un.addOrTally(this.possibleRightPairs,g),l.reverse();for(let v of this.possibleLeftPairs)if(v.getCount()>1){for(let _ of this.possibleRightPairs)if(_.getCount()>1&&un.checkChecksum(v,_))return un.constructResult(v,_)}throw new he}static addOrTally(r,l){if(l==null)return;let u=!1;for(let m of r)if(m.getValue()===l.getValue()){m.incrementCount(),u=!0;break}u||r.push(l)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(r,l){let u=4537077*r.getValue()+l.getValue(),m=new String(u).toString(),g=new z;for(let M=13-m.length;M>0;M--)g.append("0");g.append(m);let v=0;for(let M=0;M<13;M++){let O=g.charAt(M).charCodeAt(0)-48;v+=(M&1)===0?3*O:O}v=10-v%10,v===10&&(v=0),g.append(v.toString());let _=r.getFinderPattern().getResultPoints(),C=l.getFinderPattern().getResultPoints();return new je(g.toString(),null,0,[_[0],_[1],C[0],C[1]],pe.RSS_14,new Date().getTime())}static checkChecksum(r,l){let u=(r.getChecksumPortion()+16*l.getChecksumPortion())%79,m=9*r.getFinderPattern().getValue()+l.getFinderPattern().getValue();return m>72&&m--,m>8&&m--,u===m}decodePair(r,l,u,m){try{let g=this.findFinderPattern(r,l),v=this.parseFoundFinderPattern(r,u,l,g),_=m==null?null:m.get(me.NEED_RESULT_POINT_CALLBACK);if(_!=null){let O=(g[0]+g[1])/2;l&&(O=r.getSize()-1-O),_.foundPossibleResultPoint(new Ze(O,u))}let C=this.decodeDataCharacter(r,v,!0),M=this.decodeDataCharacter(r,v,!1);return new Da(1597*C.getValue()+M.getValue(),C.getChecksumPortion()+4*M.getChecksumPortion(),v)}catch{return null}}decodeDataCharacter(r,l,u){let m=this.getDataCharacterCounters();for(let ye=0;ye<m.length;ye++)m[ye]=0;if(u)an.recordPatternInReverse(r,l.getStartEnd()[0],m);else{an.recordPattern(r,l.getStartEnd()[1]+1,m);for(let ye=0,Ce=m.length-1;ye<Ce;ye++,Ce--){let qe=m[ye];m[ye]=m[Ce],m[Ce]=qe}}let g=u?16:15,v=nt.sum(new Int32Array(m))/g,_=this.getOddCounts(),C=this.getEvenCounts(),M=this.getOddRoundingErrors(),O=this.getEvenRoundingErrors();for(let ye=0;ye<m.length;ye++){let Ce=m[ye]/v,qe=Math.floor(Ce+.5);qe<1?qe=1:qe>8&&(qe=8);let He=Math.floor(ye/2);(ye&1)===0?(_[He]=qe,M[He]=Ce-qe):(C[He]=qe,O[He]=Ce-qe)}this.adjustOddEvenCounts(u,g);let j=0,G=0;for(let ye=_.length-1;ye>=0;ye--)G*=9,G+=_[ye],j+=_[ye];let Z=0,re=0;for(let ye=C.length-1;ye>=0;ye--)Z*=9,Z+=C[ye],re+=C[ye];let ce=G+3*Z;if(u){if((j&1)!==0||j>12||j<4)throw new he;let ye=(12-j)/2,Ce=un.OUTSIDE_ODD_WIDEST[ye],qe=9-Ce,He=ps.getRSSvalue(_,Ce,!1),Fe=ps.getRSSvalue(C,qe,!0),jt=un.OUTSIDE_EVEN_TOTAL_SUBSET[ye],Nt=un.OUTSIDE_GSUM[ye];return new ii(He*jt+Fe+Nt,ce)}else{if((re&1)!==0||re>10||re<4)throw new he;let ye=(10-re)/2,Ce=un.INSIDE_ODD_WIDEST[ye],qe=9-Ce,He=ps.getRSSvalue(_,Ce,!0),Fe=ps.getRSSvalue(C,qe,!1),jt=un.INSIDE_ODD_TOTAL_SUBSET[ye],Nt=un.INSIDE_GSUM[ye];return new ii(Fe*jt+He+Nt,ce)}}findFinderPattern(r,l){let u=this.getDecodeFinderCounters();u[0]=0,u[1]=0,u[2]=0,u[3]=0;let m=r.getSize(),g=!1,v=0;for(;v<m&&(g=!r.get(v),l!==g);)v++;let _=0,C=v;for(let M=v;M<m;M++)if(r.get(M)!==g)u[_]++;else{if(_===3){if(Vt.isFinderPattern(u))return[C,M];C+=u[0]+u[1],u[0]=u[2],u[1]=u[3],u[2]=0,u[3]=0,_--}else _++;u[_]=1,g=!g}throw new he}parseFoundFinderPattern(r,l,u,m){let g=r.get(m[0]),v=m[0]-1;for(;v>=0&&g!==r.get(v);)v--;v++;const _=m[0]-v,C=this.getDecodeFinderCounters(),M=new Int32Array(C.length);W.arraycopy(C,0,M,1,C.length-1),M[0]=_;const O=this.parseFinderValue(M,un.FINDER_PATTERNS);let j=v,G=m[1];return u&&(j=r.getSize()-1-j,G=r.getSize()-1-G),new zi(O,[v,m[1]],j,G,l)}adjustOddEvenCounts(r,l){let u=nt.sum(new Int32Array(this.getOddCounts())),m=nt.sum(new Int32Array(this.getEvenCounts())),g=!1,v=!1,_=!1,C=!1;r?(u>12?v=!0:u<4&&(g=!0),m>12?C=!0:m<4&&(_=!0)):(u>11?v=!0:u<5&&(g=!0),m>10?C=!0:m<4&&(_=!0));let M=u+m-l,O=(u&1)===(r?1:0),j=(m&1)===1;if(M===1)if(O){if(j)throw new he;v=!0}else{if(!j)throw new he;C=!0}else if(M===-1)if(O){if(j)throw new he;g=!0}else{if(!j)throw new he;_=!0}else if(M===0){if(O){if(!j)throw new he;u<m?(g=!0,C=!0):(v=!0,_=!0)}else if(j)throw new he}else throw new he;if(g){if(v)throw new he;Vt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(v&&Vt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),_){if(C)throw new he;Vt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}C&&Vt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}un.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],un.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],un.OUTSIDE_GSUM=[0,161,961,2015,2715],un.INSIDE_GSUM=[0,336,1036,1516],un.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],un.INSIDE_ODD_WIDEST=[2,4,6,8],un.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class ki extends an{constructor(r,l){super(),this.readers=[],this.verbose=l===!0;const u=r?r.get(me.POSSIBLE_FORMATS):null,m=r&&r.get(me.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;u?((u.includes(pe.EAN_13)||u.includes(pe.UPC_A)||u.includes(pe.EAN_8)||u.includes(pe.UPC_E))&&this.readers.push(new is(r)),u.includes(pe.CODE_39)&&this.readers.push(new ln(m)),u.includes(pe.CODE_128)&&this.readers.push(new Ge),u.includes(pe.ITF)&&this.readers.push(new _t),u.includes(pe.RSS_14)&&this.readers.push(new un),u.includes(pe.RSS_EXPANDED)&&this.readers.push(new Le(this.verbose))):(this.readers.push(new is(r)),this.readers.push(new ln),this.readers.push(new is(r)),this.readers.push(new Ge),this.readers.push(new _t),this.readers.push(new un),this.readers.push(new Le(this.verbose)))}decodeRow(r,l,u){for(let m=0;m<this.readers.length;m++)try{return this.readers[m].decodeRow(r,l,u)}catch{}throw new he}reset(){this.readers.forEach(r=>r.reset())}}class Oa extends Ae{constructor(r=500,l){super(new ki(l),r,l)}}class Kt{constructor(r,l,u){this.ecCodewords=r,this.ecBlocks=[l],u&&this.ecBlocks.push(u)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class qt{constructor(r,l){this.count=r,this.dataCodewords=l}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ft{constructor(r,l,u,m,g,v){this.versionNumber=r,this.symbolSizeRows=l,this.symbolSizeColumns=u,this.dataRegionSizeRows=m,this.dataRegionSizeColumns=g,this.ecBlocks=v;let _=0;const C=v.getECCodewords(),M=v.getECBlocks();for(let O of M)_+=O.getCount()*(O.getDataCodewords()+C);this.totalCodewords=_}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(r,l){if((r&1)!==0||(l&1)!==0)throw new U;for(let u of Ft.VERSIONS)if(u.symbolSizeRows===r&&u.symbolSizeColumns===l)return u;throw new U}toString(){return""+this.versionNumber}static buildVersions(){return[new Ft(1,10,10,8,8,new Kt(5,new qt(1,3))),new Ft(2,12,12,10,10,new Kt(7,new qt(1,5))),new Ft(3,14,14,12,12,new Kt(10,new qt(1,8))),new Ft(4,16,16,14,14,new Kt(12,new qt(1,12))),new Ft(5,18,18,16,16,new Kt(14,new qt(1,18))),new Ft(6,20,20,18,18,new Kt(18,new qt(1,22))),new Ft(7,22,22,20,20,new Kt(20,new qt(1,30))),new Ft(8,24,24,22,22,new Kt(24,new qt(1,36))),new Ft(9,26,26,24,24,new Kt(28,new qt(1,44))),new Ft(10,32,32,14,14,new Kt(36,new qt(1,62))),new Ft(11,36,36,16,16,new Kt(42,new qt(1,86))),new Ft(12,40,40,18,18,new Kt(48,new qt(1,114))),new Ft(13,44,44,20,20,new Kt(56,new qt(1,144))),new Ft(14,48,48,22,22,new Kt(68,new qt(1,174))),new Ft(15,52,52,24,24,new Kt(42,new qt(2,102))),new Ft(16,64,64,14,14,new Kt(56,new qt(2,140))),new Ft(17,72,72,16,16,new Kt(36,new qt(4,92))),new Ft(18,80,80,18,18,new Kt(48,new qt(4,114))),new Ft(19,88,88,20,20,new Kt(56,new qt(4,144))),new Ft(20,96,96,22,22,new Kt(68,new qt(4,174))),new Ft(21,104,104,24,24,new Kt(56,new qt(6,136))),new Ft(22,120,120,18,18,new Kt(68,new qt(6,175))),new Ft(23,132,132,20,20,new Kt(62,new qt(8,163))),new Ft(24,144,144,22,22,new Kt(62,new qt(8,156),new qt(2,155))),new Ft(25,8,18,6,16,new Kt(7,new qt(1,5))),new Ft(26,8,32,6,14,new Kt(11,new qt(1,10))),new Ft(27,12,26,10,24,new Kt(14,new qt(1,16))),new Ft(28,12,36,10,16,new Kt(18,new qt(1,22))),new Ft(29,16,36,14,16,new Kt(24,new qt(1,32))),new Ft(30,16,48,14,22,new Kt(28,new qt(1,49)))]}}Ft.VERSIONS=Ft.buildVersions();class Ar{constructor(r){const l=r.getHeight();if(l<8||l>144||(l&1)!==0)throw new U;this.version=Ar.readVersion(r),this.mappingBitMatrix=this.extractDataRegion(r),this.readMappingMatrix=new _e(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(r){const l=r.getHeight(),u=r.getWidth();return Ft.getVersionForDimensions(l,u)}readCodewords(){const r=new Int8Array(this.version.getTotalCodewords());let l=0,u=4,m=0;const g=this.mappingBitMatrix.getHeight(),v=this.mappingBitMatrix.getWidth();let _=!1,C=!1,M=!1,O=!1;do if(u===g&&m===0&&!_)r[l++]=this.readCorner1(g,v)&255,u-=2,m+=2,_=!0;else if(u===g-2&&m===0&&(v&3)!==0&&!C)r[l++]=this.readCorner2(g,v)&255,u-=2,m+=2,C=!0;else if(u===g+4&&m===2&&(v&7)===0&&!M)r[l++]=this.readCorner3(g,v)&255,u-=2,m+=2,M=!0;else if(u===g-2&&m===0&&(v&7)===4&&!O)r[l++]=this.readCorner4(g,v)&255,u-=2,m+=2,O=!0;else{do u<g&&m>=0&&!this.readMappingMatrix.get(m,u)&&(r[l++]=this.readUtah(u,m,g,v)&255),u-=2,m+=2;while(u>=0&&m<v);u+=1,m+=3;do u>=0&&m<v&&!this.readMappingMatrix.get(m,u)&&(r[l++]=this.readUtah(u,m,g,v)&255),u+=2,m-=2;while(u<g&&m>=0);u+=3,m+=1}while(u<g||m<v);if(l!==this.version.getTotalCodewords())throw new U;return r}readModule(r,l,u,m){return r<0&&(r+=u,l+=4-(u+4&7)),l<0&&(l+=m,r+=4-(m+4&7)),this.readMappingMatrix.set(l,r),this.mappingBitMatrix.get(l,r)}readUtah(r,l,u,m){let g=0;return this.readModule(r-2,l-2,u,m)&&(g|=1),g<<=1,this.readModule(r-2,l-1,u,m)&&(g|=1),g<<=1,this.readModule(r-1,l-2,u,m)&&(g|=1),g<<=1,this.readModule(r-1,l-1,u,m)&&(g|=1),g<<=1,this.readModule(r-1,l,u,m)&&(g|=1),g<<=1,this.readModule(r,l-2,u,m)&&(g|=1),g<<=1,this.readModule(r,l-1,u,m)&&(g|=1),g<<=1,this.readModule(r,l,u,m)&&(g|=1),g}readCorner1(r,l){let u=0;return this.readModule(r-1,0,r,l)&&(u|=1),u<<=1,this.readModule(r-1,1,r,l)&&(u|=1),u<<=1,this.readModule(r-1,2,r,l)&&(u|=1),u<<=1,this.readModule(0,l-2,r,l)&&(u|=1),u<<=1,this.readModule(0,l-1,r,l)&&(u|=1),u<<=1,this.readModule(1,l-1,r,l)&&(u|=1),u<<=1,this.readModule(2,l-1,r,l)&&(u|=1),u<<=1,this.readModule(3,l-1,r,l)&&(u|=1),u}readCorner2(r,l){let u=0;return this.readModule(r-3,0,r,l)&&(u|=1),u<<=1,this.readModule(r-2,0,r,l)&&(u|=1),u<<=1,this.readModule(r-1,0,r,l)&&(u|=1),u<<=1,this.readModule(0,l-4,r,l)&&(u|=1),u<<=1,this.readModule(0,l-3,r,l)&&(u|=1),u<<=1,this.readModule(0,l-2,r,l)&&(u|=1),u<<=1,this.readModule(0,l-1,r,l)&&(u|=1),u<<=1,this.readModule(1,l-1,r,l)&&(u|=1),u}readCorner3(r,l){let u=0;return this.readModule(r-1,0,r,l)&&(u|=1),u<<=1,this.readModule(r-1,l-1,r,l)&&(u|=1),u<<=1,this.readModule(0,l-3,r,l)&&(u|=1),u<<=1,this.readModule(0,l-2,r,l)&&(u|=1),u<<=1,this.readModule(0,l-1,r,l)&&(u|=1),u<<=1,this.readModule(1,l-3,r,l)&&(u|=1),u<<=1,this.readModule(1,l-2,r,l)&&(u|=1),u<<=1,this.readModule(1,l-1,r,l)&&(u|=1),u}readCorner4(r,l){let u=0;return this.readModule(r-3,0,r,l)&&(u|=1),u<<=1,this.readModule(r-2,0,r,l)&&(u|=1),u<<=1,this.readModule(r-1,0,r,l)&&(u|=1),u<<=1,this.readModule(0,l-2,r,l)&&(u|=1),u<<=1,this.readModule(0,l-1,r,l)&&(u|=1),u<<=1,this.readModule(1,l-1,r,l)&&(u|=1),u<<=1,this.readModule(2,l-1,r,l)&&(u|=1),u<<=1,this.readModule(3,l-1,r,l)&&(u|=1),u}extractDataRegion(r){const l=this.version.getSymbolSizeRows(),u=this.version.getSymbolSizeColumns();if(r.getHeight()!==l)throw new N("Dimension of bitMatrix must match the version size");const m=this.version.getDataRegionSizeRows(),g=this.version.getDataRegionSizeColumns(),v=l/m|0,_=u/g|0,C=v*m,M=_*g,O=new _e(M,C);for(let j=0;j<v;++j){const G=j*m;for(let Z=0;Z<_;++Z){const re=Z*g;for(let ce=0;ce<m;++ce){const ye=j*(m+2)+1+ce,Ce=G+ce;for(let qe=0;qe<g;++qe){const He=Z*(g+2)+1+qe;if(r.get(He,ye)){const Fe=re+qe;O.set(Fe,Ce)}}}}}return O}}class Pi{constructor(r,l){this.numDataCodewords=r,this.codewords=l}static getDataBlocks(r,l){const u=l.getECBlocks();let m=0;const g=u.getECBlocks();for(let ce of g)m+=ce.getCount();const v=new Array(m);let _=0;for(let ce of g)for(let ye=0;ye<ce.getCount();ye++){const Ce=ce.getDataCodewords(),qe=u.getECCodewords()+Ce;v[_++]=new Pi(Ce,new Uint8Array(qe))}const M=v[0].codewords.length-u.getECCodewords(),O=M-1;let j=0;for(let ce=0;ce<O;ce++)for(let ye=0;ye<_;ye++)v[ye].codewords[ce]=r[j++];const G=l.getVersionNumber()===24,Z=G?8:_;for(let ce=0;ce<Z;ce++)v[ce].codewords[M-1]=r[j++];const re=v[0].codewords.length;for(let ce=M;ce<re;ce++)for(let ye=0;ye<_;ye++){const Ce=G?(ye+8)%_:ye,qe=G&&Ce>7?ce-1:ce;v[Ce].codewords[qe]=r[j++]}if(j!==r.length)throw new N;return v}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Gn{constructor(r){this.bytes=r,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(r){if(r<1||r>32||r>this.available())throw new N(""+r);let l=0,u=this.bitOffset,m=this.byteOffset;const g=this.bytes;if(u>0){const v=8-u,_=r<v?r:v,C=v-_,M=255>>8-_<<C;l=(g[m]&M)>>C,r-=_,u+=_,u===8&&(u=0,m++)}if(r>0){for(;r>=8;)l=l<<8|g[m]&255,m++,r-=8;if(r>0){const v=8-r,_=255>>v<<v;l=l<<r|(g[m]&_)>>v,u+=r}}return this.bitOffset=u,this.byteOffset=m,l}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Gt;(function(B){B[B.PAD_ENCODE=0]="PAD_ENCODE",B[B.ASCII_ENCODE=1]="ASCII_ENCODE",B[B.C40_ENCODE=2]="C40_ENCODE",B[B.TEXT_ENCODE=3]="TEXT_ENCODE",B[B.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",B[B.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",B[B.BASE256_ENCODE=6]="BASE256_ENCODE"})(Gt||(Gt={}));class Li{static decode(r){const l=new Gn(r),u=new z,m=new z,g=new Array;let v=Gt.ASCII_ENCODE;do if(v===Gt.ASCII_ENCODE)v=this.decodeAsciiSegment(l,u,m);else{switch(v){case Gt.C40_ENCODE:this.decodeC40Segment(l,u);break;case Gt.TEXT_ENCODE:this.decodeTextSegment(l,u);break;case Gt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(l,u);break;case Gt.EDIFACT_ENCODE:this.decodeEdifactSegment(l,u);break;case Gt.BASE256_ENCODE:this.decodeBase256Segment(l,u,g);break;default:throw new U}v=Gt.ASCII_ENCODE}while(v!==Gt.PAD_ENCODE&&l.available()>0);return m.length()>0&&u.append(m.toString()),new it(r,u.toString(),g.length===0?null:g,null)}static decodeAsciiSegment(r,l,u){let m=!1;do{let g=r.readBits(8);if(g===0)throw new U;if(g<=128)return m&&(g+=128),l.append(String.fromCharCode(g-1)),Gt.ASCII_ENCODE;if(g===129)return Gt.PAD_ENCODE;if(g<=229){const v=g-130;v<10&&l.append("0"),l.append(""+v)}else switch(g){case 230:return Gt.C40_ENCODE;case 231:return Gt.BASE256_ENCODE;case 232:l.append("");break;case 233:case 234:break;case 235:m=!0;break;case 236:l.append("[)>05"),u.insert(0,"");break;case 237:l.append("[)>06"),u.insert(0,"");break;case 238:return Gt.ANSIX12_ENCODE;case 239:return Gt.TEXT_ENCODE;case 240:return Gt.EDIFACT_ENCODE;case 241:break;default:if(g!==254||r.available()!==0)throw new U;break}}while(r.available()>0);return Gt.ASCII_ENCODE}static decodeC40Segment(r,l){let u=!1;const m=[];let g=0;do{if(r.available()===8)return;const v=r.readBits(8);if(v===254)return;this.parseTwoBytes(v,r.readBits(8),m);for(let _=0;_<3;_++){const C=m[_];switch(g){case 0:if(C<3)g=C+1;else if(C<this.C40_BASIC_SET_CHARS.length){const M=this.C40_BASIC_SET_CHARS[C];u?(l.append(String.fromCharCode(M.charCodeAt(0)+128)),u=!1):l.append(M)}else throw new U;break;case 1:u?(l.append(String.fromCharCode(C+128)),u=!1):l.append(String.fromCharCode(C)),g=0;break;case 2:if(C<this.C40_SHIFT2_SET_CHARS.length){const M=this.C40_SHIFT2_SET_CHARS[C];u?(l.append(String.fromCharCode(M.charCodeAt(0)+128)),u=!1):l.append(M)}else switch(C){case 27:l.append("");break;case 30:u=!0;break;default:throw new U}g=0;break;case 3:u?(l.append(String.fromCharCode(C+224)),u=!1):l.append(String.fromCharCode(C+96)),g=0;break;default:throw new U}}}while(r.available()>0)}static decodeTextSegment(r,l){let u=!1,m=[],g=0;do{if(r.available()===8)return;const v=r.readBits(8);if(v===254)return;this.parseTwoBytes(v,r.readBits(8),m);for(let _=0;_<3;_++){const C=m[_];switch(g){case 0:if(C<3)g=C+1;else if(C<this.TEXT_BASIC_SET_CHARS.length){const M=this.TEXT_BASIC_SET_CHARS[C];u?(l.append(String.fromCharCode(M.charCodeAt(0)+128)),u=!1):l.append(M)}else throw new U;break;case 1:u?(l.append(String.fromCharCode(C+128)),u=!1):l.append(String.fromCharCode(C)),g=0;break;case 2:if(C<this.TEXT_SHIFT2_SET_CHARS.length){const M=this.TEXT_SHIFT2_SET_CHARS[C];u?(l.append(String.fromCharCode(M.charCodeAt(0)+128)),u=!1):l.append(M)}else switch(C){case 27:l.append("");break;case 30:u=!0;break;default:throw new U}g=0;break;case 3:if(C<this.TEXT_SHIFT3_SET_CHARS.length){const M=this.TEXT_SHIFT3_SET_CHARS[C];u?(l.append(String.fromCharCode(M.charCodeAt(0)+128)),u=!1):l.append(M),g=0}else throw new U;break;default:throw new U}}}while(r.available()>0)}static decodeAnsiX12Segment(r,l){const u=[];do{if(r.available()===8)return;const m=r.readBits(8);if(m===254)return;this.parseTwoBytes(m,r.readBits(8),u);for(let g=0;g<3;g++){const v=u[g];switch(v){case 0:l.append("\r");break;case 1:l.append("*");break;case 2:l.append(">");break;case 3:l.append(" ");break;default:if(v<14)l.append(String.fromCharCode(v+44));else if(v<40)l.append(String.fromCharCode(v+51));else throw new U;break}}}while(r.available()>0)}static parseTwoBytes(r,l,u){let m=(r<<8)+l-1,g=Math.floor(m/1600);u[0]=g,m-=g*1600,g=Math.floor(m/40),u[1]=g,u[2]=m-g*40}static decodeEdifactSegment(r,l){do{if(r.available()<=16)return;for(let u=0;u<4;u++){let m=r.readBits(6);if(m===31){const g=8-r.getBitOffset();g!==8&&r.readBits(g);return}(m&32)===0&&(m|=64),l.append(String.fromCharCode(m))}}while(r.available()>0)}static decodeBase256Segment(r,l,u){let m=1+r.getByteOffset();const g=this.unrandomize255State(r.readBits(8),m++);let v;if(g===0?v=r.available()/8|0:g<250?v=g:v=250*(g-249)+this.unrandomize255State(r.readBits(8),m++),v<0)throw new U;const _=new Uint8Array(v);for(let C=0;C<v;C++){if(r.available()<8)throw new U;_[C]=this.unrandomize255State(r.readBits(8),m++)}u.push(_);try{l.append(Y.decode(_,$.ISO88591))}catch(C){throw new De("Platform does not support required encoding: "+C.message)}}static unrandomize255State(r,l){const u=149*l%255+1,m=r-u;return m>=0?m:m+256}}Li.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Li.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Li.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Li.TEXT_SHIFT2_SET_CHARS=Li.C40_SHIFT2_SET_CHARS,Li.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class ka{constructor(){this.rsDecoder=new ot(St.DATA_MATRIX_FIELD_256)}decode(r){const l=new Ar(r),u=l.getVersion(),m=l.readCodewords(),g=Pi.getDataBlocks(m,u);let v=0;for(let M of g)v+=M.getNumDataCodewords();const _=new Uint8Array(v),C=g.length;for(let M=0;M<C;M++){const O=g[M],j=O.getCodewords(),G=O.getNumDataCodewords();this.correctErrors(j,G);for(let Z=0;Z<G;Z++)_[Z*C+M]=j[Z]}return Li.decode(_)}correctErrors(r,l){const u=new Int32Array(r);try{this.rsDecoder.decode(u,r.length-l)}catch{throw new k}for(let m=0;m<l;m++)r[m]=u[m]}}class wt{constructor(r){this.image=r,this.rectangleDetector=new On(this.image)}detect(){const r=this.rectangleDetector.detect();let l=this.detectSolid1(r);if(l=this.detectSolid2(l),l[3]=this.correctTopRight(l),!l[3])throw new he;l=this.shiftToModuleCenter(l);const u=l[0],m=l[1],g=l[2],v=l[3];let _=this.transitionsBetween(u,v)+1,C=this.transitionsBetween(g,v)+1;(_&1)===1&&(_+=1),(C&1)===1&&(C+=1),4*_<7*C&&4*C<7*_&&(_=C=Math.max(_,C));let M=wt.sampleGrid(this.image,u,m,g,v,_,C);return new Gr(M,[u,m,g,v])}static shiftPoint(r,l,u){let m=(l.getX()-r.getX())/(u+1),g=(l.getY()-r.getY())/(u+1);return new Ze(r.getX()+m,r.getY()+g)}static moveAway(r,l,u){let m=r.getX(),g=r.getY();return m<l?m-=1:m+=1,g<u?g-=1:g+=1,new Ze(m,g)}detectSolid1(r){let l=r[0],u=r[1],m=r[3],g=r[2],v=this.transitionsBetween(l,u),_=this.transitionsBetween(u,m),C=this.transitionsBetween(m,g),M=this.transitionsBetween(g,l),O=v,j=[g,l,u,m];return O>_&&(O=_,j[0]=l,j[1]=u,j[2]=m,j[3]=g),O>C&&(O=C,j[0]=u,j[1]=m,j[2]=g,j[3]=l),O>M&&(j[0]=m,j[1]=g,j[2]=l,j[3]=u),j}detectSolid2(r){let l=r[0],u=r[1],m=r[2],g=r[3],v=this.transitionsBetween(l,g),_=wt.shiftPoint(u,m,(v+1)*4),C=wt.shiftPoint(m,u,(v+1)*4),M=this.transitionsBetween(_,l),O=this.transitionsBetween(C,g);return M<O?(r[0]=l,r[1]=u,r[2]=m,r[3]=g):(r[0]=u,r[1]=m,r[2]=g,r[3]=l),r}correctTopRight(r){let l=r[0],u=r[1],m=r[2],g=r[3],v=this.transitionsBetween(l,g),_=this.transitionsBetween(u,g),C=wt.shiftPoint(l,u,(_+1)*4),M=wt.shiftPoint(m,u,(v+1)*4);v=this.transitionsBetween(C,g),_=this.transitionsBetween(M,g);let O=new Ze(g.getX()+(m.getX()-u.getX())/(v+1),g.getY()+(m.getY()-u.getY())/(v+1)),j=new Ze(g.getX()+(l.getX()-u.getX())/(_+1),g.getY()+(l.getY()-u.getY())/(_+1));if(!this.isValid(O))return this.isValid(j)?j:null;if(!this.isValid(j))return O;let G=this.transitionsBetween(C,O)+this.transitionsBetween(M,O),Z=this.transitionsBetween(C,j)+this.transitionsBetween(M,j);return G>Z?O:j}shiftToModuleCenter(r){let l=r[0],u=r[1],m=r[2],g=r[3],v=this.transitionsBetween(l,g)+1,_=this.transitionsBetween(m,g)+1,C=wt.shiftPoint(l,u,_*4),M=wt.shiftPoint(m,u,v*4);v=this.transitionsBetween(C,g)+1,_=this.transitionsBetween(M,g)+1,(v&1)===1&&(v+=1),(_&1)===1&&(_+=1);let O=(l.getX()+u.getX()+m.getX()+g.getX())/4,j=(l.getY()+u.getY()+m.getY()+g.getY())/4;l=wt.moveAway(l,O,j),u=wt.moveAway(u,O,j),m=wt.moveAway(m,O,j),g=wt.moveAway(g,O,j);let G,Z;return C=wt.shiftPoint(l,u,_*4),C=wt.shiftPoint(C,g,v*4),G=wt.shiftPoint(u,l,_*4),G=wt.shiftPoint(G,m,v*4),M=wt.shiftPoint(m,g,_*4),M=wt.shiftPoint(M,u,v*4),Z=wt.shiftPoint(g,m,_*4),Z=wt.shiftPoint(Z,l,v*4),[C,G,M,Z]}isValid(r){return r.getX()>=0&&r.getX()<this.image.getWidth()&&r.getY()>0&&r.getY()<this.image.getHeight()}static sampleGrid(r,l,u,m,g,v,_){return _i.getInstance().sampleGrid(r,v,_,.5,.5,v-.5,.5,v-.5,_-.5,.5,_-.5,l.getX(),l.getY(),g.getX(),g.getY(),m.getX(),m.getY(),u.getX(),u.getY())}transitionsBetween(r,l){let u=Math.trunc(r.getX()),m=Math.trunc(r.getY()),g=Math.trunc(l.getX()),v=Math.trunc(l.getY()),_=Math.abs(v-m)>Math.abs(g-u);if(_){let ce=u;u=m,m=ce,ce=g,g=v,v=ce}let C=Math.abs(g-u),M=Math.abs(v-m),O=-C/2,j=m<v?1:-1,G=u<g?1:-1,Z=0,re=this.image.get(_?m:u,_?u:m);for(let ce=u,ye=m;ce!==g;ce+=G){let Ce=this.image.get(_?ye:ce,_?ce:ye);if(Ce!==re&&(Z++,re=Ce),O+=M,O>0){if(ye===v)break;ye+=j,O-=C}}return Z}}class Yi{constructor(){this.decoder=new ka}decode(r,l=null){let u,m;if(l!=null&&l.has(me.PURE_BARCODE)){const M=Yi.extractPureBits(r.getBlackMatrix());u=this.decoder.decode(M),m=Yi.NO_POINTS}else{const M=new wt(r.getBlackMatrix()).detect();u=this.decoder.decode(M.getBits()),m=M.getPoints()}const g=u.getRawBytes(),v=new je(u.getText(),g,8*g.length,m,pe.DATA_MATRIX,W.currentTimeMillis()),_=u.getByteSegments();_!=null&&v.putMetadata(Ke.BYTE_SEGMENTS,_);const C=u.getECLevel();return C!=null&&v.putMetadata(Ke.ERROR_CORRECTION_LEVEL,C),v}reset(){}static extractPureBits(r){const l=r.getTopLeftOnBit(),u=r.getBottomRightOnBit();if(l==null||u==null)throw new he;const m=this.moduleSize(l,r);let g=l[1];const v=u[1];let _=l[0];const M=(u[0]-_+1)/m,O=(v-g+1)/m;if(M<=0||O<=0)throw new he;const j=m/2;g+=j,_+=j;const G=new _e(M,O);for(let Z=0;Z<O;Z++){const re=g+Z*m;for(let ce=0;ce<M;ce++)r.get(_+ce*m,re)&&G.set(ce,Z)}return G}static moduleSize(r,l){const u=l.getWidth();let m=r[0];const g=r[1];for(;m<u&&l.get(m,g);)m++;if(m===u)throw new he;const v=m-r[0];if(v===0)throw new he;return v}}Yi.NO_POINTS=[];class Ws extends Ae{constructor(r=500){super(new Yi,r)}}var xs;(function(B){B[B.L=0]="L",B[B.M=1]="M",B[B.Q=2]="Q",B[B.H=3]="H"})(xs||(xs={}));class Ut{constructor(r,l,u){this.value=r,this.stringValue=l,this.bits=u,Ut.FOR_BITS.set(u,this),Ut.FOR_VALUE.set(r,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(r){switch(r){case"L":return Ut.L;case"M":return Ut.M;case"Q":return Ut.Q;case"H":return Ut.H;default:throw new A(r+"not available")}}toString(){return this.stringValue}equals(r){if(!(r instanceof Ut))return!1;const l=r;return this.value===l.value}static forBits(r){if(r<0||r>=Ut.FOR_BITS.size)throw new N;return Ut.FOR_BITS.get(r)}}Ut.FOR_BITS=new Map,Ut.FOR_VALUE=new Map,Ut.L=new Ut(xs.L,"L",1),Ut.M=new Ut(xs.M,"M",0),Ut.Q=new Ut(xs.Q,"Q",3),Ut.H=new Ut(xs.H,"H",2);class Wn{constructor(r){this.errorCorrectionLevel=Ut.forBits(r>>3&3),this.dataMask=r&7}static numBitsDiffering(r,l){return ee.bitCount(r^l)}static decodeFormatInformation(r,l){const u=Wn.doDecodeFormatInformation(r,l);return u!==null?u:Wn.doDecodeFormatInformation(r^Wn.FORMAT_INFO_MASK_QR,l^Wn.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(r,l){let u=Number.MAX_SAFE_INTEGER,m=0;for(const g of Wn.FORMAT_INFO_DECODE_LOOKUP){const v=g[0];if(v===r||v===l)return new Wn(g[1]);let _=Wn.numBitsDiffering(r,v);_<u&&(m=g[1],u=_),r!==l&&(_=Wn.numBitsDiffering(l,v),_<u&&(m=g[1],u=_))}return u<=3?new Wn(m):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(r){if(!(r instanceof Wn))return!1;const l=r;return this.errorCorrectionLevel===l.errorCorrectionLevel&&this.dataMask===l.dataMask}}Wn.FORMAT_INFO_MASK_QR=21522,Wn.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class ve{constructor(r,...l){this.ecCodewordsPerBlock=r,this.ecBlocks=l}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let r=0;const l=this.ecBlocks;for(const u of l)r+=u.getCount();return r}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class J{constructor(r,l){this.count=r,this.dataCodewords=l}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class at{constructor(r,l,...u){this.versionNumber=r,this.alignmentPatternCenters=l,this.ecBlocks=u;let m=0;const g=u[0].getECCodewordsPerBlock(),v=u[0].getECBlocks();for(const _ of v)m+=_.getCount()*(_.getDataCodewords()+g);this.totalCodewords=m}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(r){return this.ecBlocks[r.getValue()]}static getProvisionalVersionForDimension(r){if(r%4!==1)throw new U;try{return this.getVersionForNumber((r-17)/4)}catch{throw new U}}static getVersionForNumber(r){if(r<1||r>40)throw new N;return at.VERSIONS[r-1]}static decodeVersionInformation(r){let l=Number.MAX_SAFE_INTEGER,u=0;for(let m=0;m<at.VERSION_DECODE_INFO.length;m++){const g=at.VERSION_DECODE_INFO[m];if(g===r)return at.getVersionForNumber(m+7);const v=Wn.numBitsDiffering(r,g);v<l&&(u=m+7,l=v)}return l<=3?at.getVersionForNumber(u):null}buildFunctionPattern(){const r=this.getDimensionForVersion(),l=new _e(r);l.setRegion(0,0,9,9),l.setRegion(r-8,0,8,9),l.setRegion(0,r-8,9,8);const u=this.alignmentPatternCenters.length;for(let m=0;m<u;m++){const g=this.alignmentPatternCenters[m]-2;for(let v=0;v<u;v++)m===0&&(v===0||v===u-1)||m===u-1&&v===0||l.setRegion(this.alignmentPatternCenters[v]-2,g,5,5)}return l.setRegion(6,9,1,r-17),l.setRegion(9,6,r-17,1),this.versionNumber>6&&(l.setRegion(r-11,0,3,6),l.setRegion(0,r-11,6,3)),l}toString(){return""+this.versionNumber}}at.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),at.VERSIONS=[new at(1,new Int32Array(0),new ve(7,new J(1,19)),new ve(10,new J(1,16)),new ve(13,new J(1,13)),new ve(17,new J(1,9))),new at(2,Int32Array.from([6,18]),new ve(10,new J(1,34)),new ve(16,new J(1,28)),new ve(22,new J(1,22)),new ve(28,new J(1,16))),new at(3,Int32Array.from([6,22]),new ve(15,new J(1,55)),new ve(26,new J(1,44)),new ve(18,new J(2,17)),new ve(22,new J(2,13))),new at(4,Int32Array.from([6,26]),new ve(20,new J(1,80)),new ve(18,new J(2,32)),new ve(26,new J(2,24)),new ve(16,new J(4,9))),new at(5,Int32Array.from([6,30]),new ve(26,new J(1,108)),new ve(24,new J(2,43)),new ve(18,new J(2,15),new J(2,16)),new ve(22,new J(2,11),new J(2,12))),new at(6,Int32Array.from([6,34]),new ve(18,new J(2,68)),new ve(16,new J(4,27)),new ve(24,new J(4,19)),new ve(28,new J(4,15))),new at(7,Int32Array.from([6,22,38]),new ve(20,new J(2,78)),new ve(18,new J(4,31)),new ve(18,new J(2,14),new J(4,15)),new ve(26,new J(4,13),new J(1,14))),new at(8,Int32Array.from([6,24,42]),new ve(24,new J(2,97)),new ve(22,new J(2,38),new J(2,39)),new ve(22,new J(4,18),new J(2,19)),new ve(26,new J(4,14),new J(2,15))),new at(9,Int32Array.from([6,26,46]),new ve(30,new J(2,116)),new ve(22,new J(3,36),new J(2,37)),new ve(20,new J(4,16),new J(4,17)),new ve(24,new J(4,12),new J(4,13))),new at(10,Int32Array.from([6,28,50]),new ve(18,new J(2,68),new J(2,69)),new ve(26,new J(4,43),new J(1,44)),new ve(24,new J(6,19),new J(2,20)),new ve(28,new J(6,15),new J(2,16))),new at(11,Int32Array.from([6,30,54]),new ve(20,new J(4,81)),new ve(30,new J(1,50),new J(4,51)),new ve(28,new J(4,22),new J(4,23)),new ve(24,new J(3,12),new J(8,13))),new at(12,Int32Array.from([6,32,58]),new ve(24,new J(2,92),new J(2,93)),new ve(22,new J(6,36),new J(2,37)),new ve(26,new J(4,20),new J(6,21)),new ve(28,new J(7,14),new J(4,15))),new at(13,Int32Array.from([6,34,62]),new ve(26,new J(4,107)),new ve(22,new J(8,37),new J(1,38)),new ve(24,new J(8,20),new J(4,21)),new ve(22,new J(12,11),new J(4,12))),new at(14,Int32Array.from([6,26,46,66]),new ve(30,new J(3,115),new J(1,116)),new ve(24,new J(4,40),new J(5,41)),new ve(20,new J(11,16),new J(5,17)),new ve(24,new J(11,12),new J(5,13))),new at(15,Int32Array.from([6,26,48,70]),new ve(22,new J(5,87),new J(1,88)),new ve(24,new J(5,41),new J(5,42)),new ve(30,new J(5,24),new J(7,25)),new ve(24,new J(11,12),new J(7,13))),new at(16,Int32Array.from([6,26,50,74]),new ve(24,new J(5,98),new J(1,99)),new ve(28,new J(7,45),new J(3,46)),new ve(24,new J(15,19),new J(2,20)),new ve(30,new J(3,15),new J(13,16))),new at(17,Int32Array.from([6,30,54,78]),new ve(28,new J(1,107),new J(5,108)),new ve(28,new J(10,46),new J(1,47)),new ve(28,new J(1,22),new J(15,23)),new ve(28,new J(2,14),new J(17,15))),new at(18,Int32Array.from([6,30,56,82]),new ve(30,new J(5,120),new J(1,121)),new ve(26,new J(9,43),new J(4,44)),new ve(28,new J(17,22),new J(1,23)),new ve(28,new J(2,14),new J(19,15))),new at(19,Int32Array.from([6,30,58,86]),new ve(28,new J(3,113),new J(4,114)),new ve(26,new J(3,44),new J(11,45)),new ve(26,new J(17,21),new J(4,22)),new ve(26,new J(9,13),new J(16,14))),new at(20,Int32Array.from([6,34,62,90]),new ve(28,new J(3,107),new J(5,108)),new ve(26,new J(3,41),new J(13,42)),new ve(30,new J(15,24),new J(5,25)),new ve(28,new J(15,15),new J(10,16))),new at(21,Int32Array.from([6,28,50,72,94]),new ve(28,new J(4,116),new J(4,117)),new ve(26,new J(17,42)),new ve(28,new J(17,22),new J(6,23)),new ve(30,new J(19,16),new J(6,17))),new at(22,Int32Array.from([6,26,50,74,98]),new ve(28,new J(2,111),new J(7,112)),new ve(28,new J(17,46)),new ve(30,new J(7,24),new J(16,25)),new ve(24,new J(34,13))),new at(23,Int32Array.from([6,30,54,78,102]),new ve(30,new J(4,121),new J(5,122)),new ve(28,new J(4,47),new J(14,48)),new ve(30,new J(11,24),new J(14,25)),new ve(30,new J(16,15),new J(14,16))),new at(24,Int32Array.from([6,28,54,80,106]),new ve(30,new J(6,117),new J(4,118)),new ve(28,new J(6,45),new J(14,46)),new ve(30,new J(11,24),new J(16,25)),new ve(30,new J(30,16),new J(2,17))),new at(25,Int32Array.from([6,32,58,84,110]),new ve(26,new J(8,106),new J(4,107)),new ve(28,new J(8,47),new J(13,48)),new ve(30,new J(7,24),new J(22,25)),new ve(30,new J(22,15),new J(13,16))),new at(26,Int32Array.from([6,30,58,86,114]),new ve(28,new J(10,114),new J(2,115)),new ve(28,new J(19,46),new J(4,47)),new ve(28,new J(28,22),new J(6,23)),new ve(30,new J(33,16),new J(4,17))),new at(27,Int32Array.from([6,34,62,90,118]),new ve(30,new J(8,122),new J(4,123)),new ve(28,new J(22,45),new J(3,46)),new ve(30,new J(8,23),new J(26,24)),new ve(30,new J(12,15),new J(28,16))),new at(28,Int32Array.from([6,26,50,74,98,122]),new ve(30,new J(3,117),new J(10,118)),new ve(28,new J(3,45),new J(23,46)),new ve(30,new J(4,24),new J(31,25)),new ve(30,new J(11,15),new J(31,16))),new at(29,Int32Array.from([6,30,54,78,102,126]),new ve(30,new J(7,116),new J(7,117)),new ve(28,new J(21,45),new J(7,46)),new ve(30,new J(1,23),new J(37,24)),new ve(30,new J(19,15),new J(26,16))),new at(30,Int32Array.from([6,26,52,78,104,130]),new ve(30,new J(5,115),new J(10,116)),new ve(28,new J(19,47),new J(10,48)),new ve(30,new J(15,24),new J(25,25)),new ve(30,new J(23,15),new J(25,16))),new at(31,Int32Array.from([6,30,56,82,108,134]),new ve(30,new J(13,115),new J(3,116)),new ve(28,new J(2,46),new J(29,47)),new ve(30,new J(42,24),new J(1,25)),new ve(30,new J(23,15),new J(28,16))),new at(32,Int32Array.from([6,34,60,86,112,138]),new ve(30,new J(17,115)),new ve(28,new J(10,46),new J(23,47)),new ve(30,new J(10,24),new J(35,25)),new ve(30,new J(19,15),new J(35,16))),new at(33,Int32Array.from([6,30,58,86,114,142]),new ve(30,new J(17,115),new J(1,116)),new ve(28,new J(14,46),new J(21,47)),new ve(30,new J(29,24),new J(19,25)),new ve(30,new J(11,15),new J(46,16))),new at(34,Int32Array.from([6,34,62,90,118,146]),new ve(30,new J(13,115),new J(6,116)),new ve(28,new J(14,46),new J(23,47)),new ve(30,new J(44,24),new J(7,25)),new ve(30,new J(59,16),new J(1,17))),new at(35,Int32Array.from([6,30,54,78,102,126,150]),new ve(30,new J(12,121),new J(7,122)),new ve(28,new J(12,47),new J(26,48)),new ve(30,new J(39,24),new J(14,25)),new ve(30,new J(22,15),new J(41,16))),new at(36,Int32Array.from([6,24,50,76,102,128,154]),new ve(30,new J(6,121),new J(14,122)),new ve(28,new J(6,47),new J(34,48)),new ve(30,new J(46,24),new J(10,25)),new ve(30,new J(2,15),new J(64,16))),new at(37,Int32Array.from([6,28,54,80,106,132,158]),new ve(30,new J(17,122),new J(4,123)),new ve(28,new J(29,46),new J(14,47)),new ve(30,new J(49,24),new J(10,25)),new ve(30,new J(24,15),new J(46,16))),new at(38,Int32Array.from([6,32,58,84,110,136,162]),new ve(30,new J(4,122),new J(18,123)),new ve(28,new J(13,46),new J(32,47)),new ve(30,new J(48,24),new J(14,25)),new ve(30,new J(42,15),new J(32,16))),new at(39,Int32Array.from([6,26,54,82,110,138,166]),new ve(30,new J(20,117),new J(4,118)),new ve(28,new J(40,47),new J(7,48)),new ve(30,new J(43,24),new J(22,25)),new ve(30,new J(10,15),new J(67,16))),new at(40,Int32Array.from([6,30,58,86,114,142,170]),new ve(30,new J(19,118),new J(6,119)),new ve(28,new J(18,47),new J(31,48)),new ve(30,new J(34,24),new J(34,25)),new ve(30,new J(20,15),new J(61,16)))];var Xn;(function(B){B[B.DATA_MASK_000=0]="DATA_MASK_000",B[B.DATA_MASK_001=1]="DATA_MASK_001",B[B.DATA_MASK_010=2]="DATA_MASK_010",B[B.DATA_MASK_011=3]="DATA_MASK_011",B[B.DATA_MASK_100=4]="DATA_MASK_100",B[B.DATA_MASK_101=5]="DATA_MASK_101",B[B.DATA_MASK_110=6]="DATA_MASK_110",B[B.DATA_MASK_111=7]="DATA_MASK_111"})(Xn||(Xn={}));class si{constructor(r,l){this.value=r,this.isMasked=l}unmaskBitMatrix(r,l){for(let u=0;u<l;u++)for(let m=0;m<l;m++)this.isMasked(u,m)&&r.flip(m,u)}}si.values=new Map([[Xn.DATA_MASK_000,new si(Xn.DATA_MASK_000,(B,r)=>(B+r&1)===0)],[Xn.DATA_MASK_001,new si(Xn.DATA_MASK_001,(B,r)=>(B&1)===0)],[Xn.DATA_MASK_010,new si(Xn.DATA_MASK_010,(B,r)=>r%3===0)],[Xn.DATA_MASK_011,new si(Xn.DATA_MASK_011,(B,r)=>(B+r)%3===0)],[Xn.DATA_MASK_100,new si(Xn.DATA_MASK_100,(B,r)=>(Math.floor(B/2)+Math.floor(r/3)&1)===0)],[Xn.DATA_MASK_101,new si(Xn.DATA_MASK_101,(B,r)=>B*r%6===0)],[Xn.DATA_MASK_110,new si(Xn.DATA_MASK_110,(B,r)=>B*r%6<3)],[Xn.DATA_MASK_111,new si(Xn.DATA_MASK_111,(B,r)=>(B+r+B*r%3&1)===0)]]);class Wi{constructor(r){const l=r.getHeight();if(l<21||(l&3)!==1)throw new U;this.bitMatrix=r}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let r=0;for(let g=0;g<6;g++)r=this.copyBit(g,8,r);r=this.copyBit(7,8,r),r=this.copyBit(8,8,r),r=this.copyBit(8,7,r);for(let g=5;g>=0;g--)r=this.copyBit(8,g,r);const l=this.bitMatrix.getHeight();let u=0;const m=l-7;for(let g=l-1;g>=m;g--)u=this.copyBit(8,g,u);for(let g=l-8;g<l;g++)u=this.copyBit(g,8,u);if(this.parsedFormatInfo=Wn.decodeFormatInformation(r,u),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new U}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const r=this.bitMatrix.getHeight(),l=Math.floor((r-17)/4);if(l<=6)return at.getVersionForNumber(l);let u=0;const m=r-11;for(let v=5;v>=0;v--)for(let _=r-9;_>=m;_--)u=this.copyBit(_,v,u);let g=at.decodeVersionInformation(u);if(g!==null&&g.getDimensionForVersion()===r)return this.parsedVersion=g,g;u=0;for(let v=5;v>=0;v--)for(let _=r-9;_>=m;_--)u=this.copyBit(v,_,u);if(g=at.decodeVersionInformation(u),g!==null&&g.getDimensionForVersion()===r)return this.parsedVersion=g,g;throw new U}copyBit(r,l,u){return(this.isMirror?this.bitMatrix.get(l,r):this.bitMatrix.get(r,l))?u<<1|1:u<<1}readCodewords(){const r=this.readFormatInformation(),l=this.readVersion(),u=si.values.get(r.getDataMask()),m=this.bitMatrix.getHeight();u.unmaskBitMatrix(this.bitMatrix,m);const g=l.buildFunctionPattern();let v=!0;const _=new Uint8Array(l.getTotalCodewords());let C=0,M=0,O=0;for(let j=m-1;j>0;j-=2){j===6&&j--;for(let G=0;G<m;G++){const Z=v?m-1-G:G;for(let re=0;re<2;re++)g.get(j-re,Z)||(O++,M<<=1,this.bitMatrix.get(j-re,Z)&&(M|=1),O===8&&(_[C++]=M,O=0,M=0))}v=!v}if(C!==l.getTotalCodewords())throw new U;return _}remask(){if(this.parsedFormatInfo===null)return;const r=si.values[this.parsedFormatInfo.getDataMask()],l=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,l)}setMirror(r){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=r}mirror(){const r=this.bitMatrix;for(let l=0,u=r.getWidth();l<u;l++)for(let m=l+1,g=r.getHeight();m<g;m++)r.get(l,m)!==r.get(m,l)&&(r.flip(m,l),r.flip(l,m))}}class ko{constructor(r,l){this.numDataCodewords=r,this.codewords=l}static getDataBlocks(r,l,u){if(r.length!==l.getTotalCodewords())throw new N;const m=l.getECBlocksForLevel(u);let g=0;const v=m.getECBlocks();for(const re of v)g+=re.getCount();const _=new Array(g);let C=0;for(const re of v)for(let ce=0;ce<re.getCount();ce++){const ye=re.getDataCodewords(),Ce=m.getECCodewordsPerBlock()+ye;_[C++]=new ko(ye,new Uint8Array(Ce))}const M=_[0].codewords.length;let O=_.length-1;for(;O>=0&&_[O].codewords.length!==M;)O--;O++;const j=M-m.getECCodewordsPerBlock();let G=0;for(let re=0;re<j;re++)for(let ce=0;ce<C;ce++)_[ce].codewords[re]=r[G++];for(let re=O;re<C;re++)_[re].codewords[j]=r[G++];const Z=_[0].codewords.length;for(let re=j;re<Z;re++)for(let ce=0;ce<C;ce++){const ye=ce<O?re:re+1;_[ce].codewords[ye]=r[G++]}return _}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Ai;(function(B){B[B.TERMINATOR=0]="TERMINATOR",B[B.NUMERIC=1]="NUMERIC",B[B.ALPHANUMERIC=2]="ALPHANUMERIC",B[B.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",B[B.BYTE=4]="BYTE",B[B.ECI=5]="ECI",B[B.KANJI=6]="KANJI",B[B.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",B[B.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",B[B.HANZI=9]="HANZI"})(Ai||(Ai={}));class ft{constructor(r,l,u,m){this.value=r,this.stringValue=l,this.characterCountBitsForVersions=u,this.bits=m,ft.FOR_BITS.set(m,this),ft.FOR_VALUE.set(r,this)}static forBits(r){const l=ft.FOR_BITS.get(r);if(l===void 0)throw new N;return l}getCharacterCountBits(r){const l=r.getVersionNumber();let u;return l<=9?u=0:l<=26?u=1:u=2,this.characterCountBitsForVersions[u]}getValue(){return this.value}getBits(){return this.bits}equals(r){if(!(r instanceof ft))return!1;const l=r;return this.value===l.value}toString(){return this.stringValue}}ft.FOR_BITS=new Map,ft.FOR_VALUE=new Map,ft.TERMINATOR=new ft(Ai.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),ft.NUMERIC=new ft(Ai.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),ft.ALPHANUMERIC=new ft(Ai.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),ft.STRUCTURED_APPEND=new ft(Ai.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),ft.BYTE=new ft(Ai.BYTE,"BYTE",Int32Array.from([8,16,16]),4),ft.ECI=new ft(Ai.ECI,"ECI",Int32Array.from([0,0,0]),7),ft.KANJI=new ft(Ai.KANJI,"KANJI",Int32Array.from([8,10,12]),8),ft.FNC1_FIRST_POSITION=new ft(Ai.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),ft.FNC1_SECOND_POSITION=new ft(Ai.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),ft.HANZI=new ft(Ai.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class vn{static decode(r,l,u,m){const g=new Gn(r);let v=new z;const _=new Array;let C=-1,M=-1;try{let O=null,j=!1,G;do{if(g.available()<4)G=ft.TERMINATOR;else{const Z=g.readBits(4);G=ft.forBits(Z)}switch(G){case ft.TERMINATOR:break;case ft.FNC1_FIRST_POSITION:case ft.FNC1_SECOND_POSITION:j=!0;break;case ft.STRUCTURED_APPEND:if(g.available()<16)throw new U;C=g.readBits(8),M=g.readBits(8);break;case ft.ECI:const Z=vn.parseECIValue(g);if(O=F.getCharacterSetECIByValue(Z),O===null)throw new U;break;case ft.HANZI:const re=g.readBits(4),ce=g.readBits(G.getCharacterCountBits(l));re===vn.GB2312_SUBSET&&vn.decodeHanziSegment(g,v,ce);break;default:const ye=g.readBits(G.getCharacterCountBits(l));switch(G){case ft.NUMERIC:vn.decodeNumericSegment(g,v,ye);break;case ft.ALPHANUMERIC:vn.decodeAlphanumericSegment(g,v,ye,j);break;case ft.BYTE:vn.decodeByteSegment(g,v,ye,O,_,m);break;case ft.KANJI:vn.decodeKanjiSegment(g,v,ye);break;default:throw new U}break}}while(G!==ft.TERMINATOR)}catch{throw new U}return new it(r,v.toString(),_.length===0?null:_,u===null?null:u.toString(),C,M)}static decodeHanziSegment(r,l,u){if(u*13>r.available())throw new U;const m=new Uint8Array(2*u);let g=0;for(;u>0;){const v=r.readBits(13);let _=v/96<<8&4294967295|v%96;_<959?_+=41377:_+=42657,m[g]=_>>8&255,m[g+1]=_&255,g+=2,u--}try{l.append(Y.decode(m,$.GB2312))}catch(v){throw new U(v)}}static decodeKanjiSegment(r,l,u){if(u*13>r.available())throw new U;const m=new Uint8Array(2*u);let g=0;for(;u>0;){const v=r.readBits(13);let _=v/192<<8&4294967295|v%192;_<7936?_+=33088:_+=49472,m[g]=_>>8,m[g+1]=_,g+=2,u--}try{l.append(Y.decode(m,$.SHIFT_JIS))}catch(v){throw new U(v)}}static decodeByteSegment(r,l,u,m,g,v){if(8*u>r.available())throw new U;const _=new Uint8Array(u);for(let M=0;M<u;M++)_[M]=r.readBits(8);let C;m===null?C=$.guessEncoding(_,v):C=m.getName();try{l.append(Y.decode(_,C))}catch(M){throw new U(M)}g.push(_)}static toAlphaNumericChar(r){if(r>=vn.ALPHANUMERIC_CHARS.length)throw new U;return vn.ALPHANUMERIC_CHARS[r]}static decodeAlphanumericSegment(r,l,u,m){const g=l.length();for(;u>1;){if(r.available()<11)throw new U;const v=r.readBits(11);l.append(vn.toAlphaNumericChar(Math.floor(v/45))),l.append(vn.toAlphaNumericChar(v%45)),u-=2}if(u===1){if(r.available()<6)throw new U;l.append(vn.toAlphaNumericChar(r.readBits(6)))}if(m)for(let v=g;v<l.length();v++)l.charAt(v)==="%"&&(v<l.length()-1&&l.charAt(v+1)==="%"?l.deleteCharAt(v+1):l.setCharAt(v,""))}static decodeNumericSegment(r,l,u){for(;u>=3;){if(r.available()<10)throw new U;const m=r.readBits(10);if(m>=1e3)throw new U;l.append(vn.toAlphaNumericChar(Math.floor(m/100))),l.append(vn.toAlphaNumericChar(Math.floor(m/10)%10)),l.append(vn.toAlphaNumericChar(m%10)),u-=3}if(u===2){if(r.available()<7)throw new U;const m=r.readBits(7);if(m>=100)throw new U;l.append(vn.toAlphaNumericChar(Math.floor(m/10))),l.append(vn.toAlphaNumericChar(m%10))}else if(u===1){if(r.available()<4)throw new U;const m=r.readBits(4);if(m>=10)throw new U;l.append(vn.toAlphaNumericChar(m))}}static parseECIValue(r){const l=r.readBits(8);if((l&128)===0)return l&127;if((l&192)===128){const u=r.readBits(8);return(l&63)<<8&4294967295|u}if((l&224)===192){const u=r.readBits(16);return(l&31)<<16&4294967295|u}throw new U}}vn.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",vn.GB2312_SUBSET=1;class Pa{constructor(r){this.mirrored=r}isMirrored(){return this.mirrored}applyMirroredCorrection(r){if(!this.mirrored||r===null||r.length<3)return;const l=r[0];r[0]=r[2],r[2]=l}}class Sr{constructor(){this.rsDecoder=new ot(St.QR_CODE_FIELD_256)}decodeBooleanArray(r,l){return this.decodeBitMatrix(_e.parseFromBooleanArray(r),l)}decodeBitMatrix(r,l){const u=new Wi(r);let m=null;try{return this.decodeBitMatrixParser(u,l)}catch(g){m=g}try{u.remask(),u.setMirror(!0),u.readVersion(),u.readFormatInformation(),u.mirror();const g=this.decodeBitMatrixParser(u,l);return g.setOther(new Pa(!0)),g}catch(g){throw m!==null?m:g}}decodeBitMatrixParser(r,l){const u=r.readVersion(),m=r.readFormatInformation().getErrorCorrectionLevel(),g=r.readCodewords(),v=ko.getDataBlocks(g,u,m);let _=0;for(const O of v)_+=O.getNumDataCodewords();const C=new Uint8Array(_);let M=0;for(const O of v){const j=O.getCodewords(),G=O.getNumDataCodewords();this.correctErrors(j,G);for(let Z=0;Z<G;Z++)C[M++]=j[Z]}return vn.decode(C,u,m,l)}correctErrors(r,l){const u=new Int32Array(r);try{this.rsDecoder.decode(u,r.length-l)}catch{throw new k}for(let m=0;m<l;m++)r[m]=u[m]}}class Cr extends Ze{constructor(r,l,u){super(r,l),this.estimatedModuleSize=u}aboutEquals(r,l,u){if(Math.abs(l-this.getY())<=r&&Math.abs(u-this.getX())<=r){const m=Math.abs(r-this.estimatedModuleSize);return m<=1||m<=this.estimatedModuleSize}return!1}combineEstimate(r,l,u){const m=(this.getX()+l)/2,g=(this.getY()+r)/2,v=(this.estimatedModuleSize+u)/2;return new Cr(m,g,v)}}class Xi{constructor(r,l,u,m,g,v,_){this.image=r,this.startX=l,this.startY=u,this.width=m,this.height=g,this.moduleSize=v,this.resultPointCallback=_,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const r=this.startX,l=this.height,u=this.width,m=r+u,g=this.startY+l/2,v=new Int32Array(3),_=this.image;for(let C=0;C<l;C++){const M=g+((C&1)===0?Math.floor((C+1)/2):-Math.floor((C+1)/2));v[0]=0,v[1]=0,v[2]=0;let O=r;for(;O<m&&!_.get(O,M);)O++;let j=0;for(;O<m;){if(_.get(O,M))if(j===1)v[1]++;else if(j===2){if(this.foundPatternCross(v)){const G=this.handlePossibleCenter(v,M,O);if(G!==null)return G}v[0]=v[2],v[1]=1,v[2]=0,j=1}else v[++j]++;else j===1&&j++,v[j]++;O++}if(this.foundPatternCross(v)){const G=this.handlePossibleCenter(v,M,m);if(G!==null)return G}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new he}static centerFromEnd(r,l){return l-r[2]-r[1]/2}foundPatternCross(r){const l=this.moduleSize,u=l/2;for(let m=0;m<3;m++)if(Math.abs(l-r[m])>=u)return!1;return!0}crossCheckVertical(r,l,u,m){const g=this.image,v=g.getHeight(),_=this.crossCheckStateCount;_[0]=0,_[1]=0,_[2]=0;let C=r;for(;C>=0&&g.get(l,C)&&_[1]<=u;)_[1]++,C--;if(C<0||_[1]>u)return NaN;for(;C>=0&&!g.get(l,C)&&_[0]<=u;)_[0]++,C--;if(_[0]>u)return NaN;for(C=r+1;C<v&&g.get(l,C)&&_[1]<=u;)_[1]++,C++;if(C===v||_[1]>u)return NaN;for(;C<v&&!g.get(l,C)&&_[2]<=u;)_[2]++,C++;if(_[2]>u)return NaN;const M=_[0]+_[1]+_[2];return 5*Math.abs(M-m)>=2*m?NaN:this.foundPatternCross(_)?Xi.centerFromEnd(_,C):NaN}handlePossibleCenter(r,l,u){const m=r[0]+r[1]+r[2],g=Xi.centerFromEnd(r,u),v=this.crossCheckVertical(l,g,2*r[1],m);if(!isNaN(v)){const _=(r[0]+r[1]+r[2])/3;for(const M of this.possibleCenters)if(M.aboutEquals(_,v,g))return M.combineEstimate(v,g,_);const C=new Cr(g,v,_);this.possibleCenters.push(C),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(C)}return null}}class Yr extends Ze{constructor(r,l,u,m){super(r,l),this.estimatedModuleSize=u,this.count=m,m===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(r,l,u){if(Math.abs(l-this.getY())<=r&&Math.abs(u-this.getX())<=r){const m=Math.abs(r-this.estimatedModuleSize);return m<=1||m<=this.estimatedModuleSize}return!1}combineEstimate(r,l,u){const m=this.count+1,g=(this.count*this.getX()+l)/m,v=(this.count*this.getY()+r)/m,_=(this.count*this.estimatedModuleSize+u)/m;return new Yr(g,v,_,m)}}class ys{constructor(r){this.bottomLeft=r[0],this.topLeft=r[1],this.topRight=r[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Nn{constructor(r,l){this.image=r,this.resultPointCallback=l,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=l}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(r){const l=r!=null&&r.get(me.TRY_HARDER)!==void 0,u=r!=null&&r.get(me.PURE_BARCODE)!==void 0,m=this.image,g=m.getHeight(),v=m.getWidth();let _=Math.floor(3*g/(4*Nn.MAX_MODULES));(_<Nn.MIN_SKIP||l)&&(_=Nn.MIN_SKIP);let C=!1;const M=new Int32Array(5);for(let j=_-1;j<g&&!C;j+=_){M[0]=0,M[1]=0,M[2]=0,M[3]=0,M[4]=0;let G=0;for(let Z=0;Z<v;Z++)if(m.get(Z,j))(G&1)===1&&G++,M[G]++;else if((G&1)===0)if(G===4)if(Nn.foundPatternCross(M)){if(this.handlePossibleCenter(M,j,Z,u)===!0)if(_=2,this.hasSkipped===!0)C=this.haveMultiplyConfirmedCenters();else{const ce=this.findRowSkip();ce>M[2]&&(j+=ce-M[2]-_,Z=v-1)}else{M[0]=M[2],M[1]=M[3],M[2]=M[4],M[3]=1,M[4]=0,G=3;continue}G=0,M[0]=0,M[1]=0,M[2]=0,M[3]=0,M[4]=0}else M[0]=M[2],M[1]=M[3],M[2]=M[4],M[3]=1,M[4]=0,G=3;else M[++G]++;else M[G]++;Nn.foundPatternCross(M)&&this.handlePossibleCenter(M,j,v,u)===!0&&(_=M[0],this.hasSkipped&&(C=this.haveMultiplyConfirmedCenters()))}const O=this.selectBestPatterns();return Ze.orderBestPatterns(O),new ys(O)}static centerFromEnd(r,l){return l-r[4]-r[3]-r[2]/2}static foundPatternCross(r){let l=0;for(let g=0;g<5;g++){const v=r[g];if(v===0)return!1;l+=v}if(l<7)return!1;const u=l/7,m=u/2;return Math.abs(u-r[0])<m&&Math.abs(u-r[1])<m&&Math.abs(3*u-r[2])<3*m&&Math.abs(u-r[3])<m&&Math.abs(u-r[4])<m}getCrossCheckStateCount(){const r=this.crossCheckStateCount;return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r}crossCheckDiagonal(r,l,u,m){const g=this.getCrossCheckStateCount();let v=0;const _=this.image;for(;r>=v&&l>=v&&_.get(l-v,r-v);)g[2]++,v++;if(r<v||l<v)return!1;for(;r>=v&&l>=v&&!_.get(l-v,r-v)&&g[1]<=u;)g[1]++,v++;if(r<v||l<v||g[1]>u)return!1;for(;r>=v&&l>=v&&_.get(l-v,r-v)&&g[0]<=u;)g[0]++,v++;if(g[0]>u)return!1;const C=_.getHeight(),M=_.getWidth();for(v=1;r+v<C&&l+v<M&&_.get(l+v,r+v);)g[2]++,v++;if(r+v>=C||l+v>=M)return!1;for(;r+v<C&&l+v<M&&!_.get(l+v,r+v)&&g[3]<u;)g[3]++,v++;if(r+v>=C||l+v>=M||g[3]>=u)return!1;for(;r+v<C&&l+v<M&&_.get(l+v,r+v)&&g[4]<u;)g[4]++,v++;if(g[4]>=u)return!1;const O=g[0]+g[1]+g[2]+g[3]+g[4];return Math.abs(O-m)<2*m&&Nn.foundPatternCross(g)}crossCheckVertical(r,l,u,m){const g=this.image,v=g.getHeight(),_=this.getCrossCheckStateCount();let C=r;for(;C>=0&&g.get(l,C);)_[2]++,C--;if(C<0)return NaN;for(;C>=0&&!g.get(l,C)&&_[1]<=u;)_[1]++,C--;if(C<0||_[1]>u)return NaN;for(;C>=0&&g.get(l,C)&&_[0]<=u;)_[0]++,C--;if(_[0]>u)return NaN;for(C=r+1;C<v&&g.get(l,C);)_[2]++,C++;if(C===v)return NaN;for(;C<v&&!g.get(l,C)&&_[3]<u;)_[3]++,C++;if(C===v||_[3]>=u)return NaN;for(;C<v&&g.get(l,C)&&_[4]<u;)_[4]++,C++;if(_[4]>=u)return NaN;const M=_[0]+_[1]+_[2]+_[3]+_[4];return 5*Math.abs(M-m)>=2*m?NaN:Nn.foundPatternCross(_)?Nn.centerFromEnd(_,C):NaN}crossCheckHorizontal(r,l,u,m){const g=this.image,v=g.getWidth(),_=this.getCrossCheckStateCount();let C=r;for(;C>=0&&g.get(C,l);)_[2]++,C--;if(C<0)return NaN;for(;C>=0&&!g.get(C,l)&&_[1]<=u;)_[1]++,C--;if(C<0||_[1]>u)return NaN;for(;C>=0&&g.get(C,l)&&_[0]<=u;)_[0]++,C--;if(_[0]>u)return NaN;for(C=r+1;C<v&&g.get(C,l);)_[2]++,C++;if(C===v)return NaN;for(;C<v&&!g.get(C,l)&&_[3]<u;)_[3]++,C++;if(C===v||_[3]>=u)return NaN;for(;C<v&&g.get(C,l)&&_[4]<u;)_[4]++,C++;if(_[4]>=u)return NaN;const M=_[0]+_[1]+_[2]+_[3]+_[4];return 5*Math.abs(M-m)>=m?NaN:Nn.foundPatternCross(_)?Nn.centerFromEnd(_,C):NaN}handlePossibleCenter(r,l,u,m){const g=r[0]+r[1]+r[2]+r[3]+r[4];let v=Nn.centerFromEnd(r,u),_=this.crossCheckVertical(l,Math.floor(v),r[2],g);if(!isNaN(_)&&(v=this.crossCheckHorizontal(Math.floor(v),Math.floor(_),r[2],g),!isNaN(v)&&(!m||this.crossCheckDiagonal(Math.floor(_),Math.floor(v),r[2],g)))){const C=g/7;let M=!1;const O=this.possibleCenters;for(let j=0,G=O.length;j<G;j++){const Z=O[j];if(Z.aboutEquals(C,_,v)){O[j]=Z.combineEstimate(_,v,C),M=!0;break}}if(!M){const j=new Yr(v,_,C);O.push(j),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(j)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let l=null;for(const u of this.possibleCenters)if(u.getCount()>=Nn.CENTER_QUORUM)if(l==null)l=u;else return this.hasSkipped=!0,Math.floor((Math.abs(l.getX()-u.getX())-Math.abs(l.getY()-u.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let r=0,l=0;const u=this.possibleCenters.length;for(const v of this.possibleCenters)v.getCount()>=Nn.CENTER_QUORUM&&(r++,l+=v.getEstimatedModuleSize());if(r<3)return!1;const m=l/u;let g=0;for(const v of this.possibleCenters)g+=Math.abs(v.getEstimatedModuleSize()-m);return g<=.05*l}selectBestPatterns(){const r=this.possibleCenters.length;if(r<3)throw new he;const l=this.possibleCenters;let u;if(r>3){let m=0,g=0;for(const C of this.possibleCenters){const M=C.getEstimatedModuleSize();m+=M,g+=M*M}u=m/r;let v=Math.sqrt(g/r-u*u);l.sort((C,M)=>{const O=Math.abs(M.getEstimatedModuleSize()-u),j=Math.abs(C.getEstimatedModuleSize()-u);return O<j?-1:O>j?1:0});const _=Math.max(.2*u,v);for(let C=0;C<l.length&&l.length>3;C++){const M=l[C];Math.abs(M.getEstimatedModuleSize()-u)>_&&(l.splice(C,1),C--)}}if(l.length>3){let m=0;for(const g of l)m+=g.getEstimatedModuleSize();u=m/l.length,l.sort((g,v)=>{if(v.getCount()===g.getCount()){const _=Math.abs(v.getEstimatedModuleSize()-u),C=Math.abs(g.getEstimatedModuleSize()-u);return _<C?1:_>C?-1:0}else return v.getCount()-g.getCount()}),l.splice(3)}return[l[0],l[1],l[2]]}}Nn.CENTER_QUORUM=2,Nn.MIN_SKIP=3,Nn.MAX_MODULES=57;class Ki{constructor(r){this.image=r}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(r){this.resultPointCallback=r==null?null:r.get(me.NEED_RESULT_POINT_CALLBACK);const u=new Nn(this.image,this.resultPointCallback).find(r);return this.processFinderPatternInfo(u)}processFinderPatternInfo(r){const l=r.getTopLeft(),u=r.getTopRight(),m=r.getBottomLeft(),g=this.calculateModuleSize(l,u,m);if(g<1)throw new he("No pattern found in proccess finder.");const v=Ki.computeDimension(l,u,m,g),_=at.getProvisionalVersionForDimension(v),C=_.getDimensionForVersion()-7;let M=null;if(_.getAlignmentPatternCenters().length>0){const Z=u.getX()-l.getX()+m.getX(),re=u.getY()-l.getY()+m.getY(),ce=1-3/C,ye=Math.floor(l.getX()+ce*(Z-l.getX())),Ce=Math.floor(l.getY()+ce*(re-l.getY()));for(let qe=4;qe<=16;qe<<=1)try{M=this.findAlignmentInRegion(g,ye,Ce,qe);break}catch(He){if(!(He instanceof he))throw He}}const O=Ki.createTransform(l,u,m,M,v),j=Ki.sampleGrid(this.image,O,v);let G;return M===null?G=[m,l,u]:G=[m,l,u,M],new Gr(j,G)}static createTransform(r,l,u,m,g){const v=g-3.5;let _,C,M,O;return m!==null?(_=m.getX(),C=m.getY(),M=v-3,O=M):(_=l.getX()-r.getX()+u.getX(),C=l.getY()-r.getY()+u.getY(),M=v,O=v),Ei.quadrilateralToQuadrilateral(3.5,3.5,v,3.5,M,O,3.5,v,r.getX(),r.getY(),l.getX(),l.getY(),_,C,u.getX(),u.getY())}static sampleGrid(r,l,u){return _i.getInstance().sampleGridWithTransform(r,u,u,l)}static computeDimension(r,l,u,m){const g=nt.round(Ze.distance(r,l)/m),v=nt.round(Ze.distance(r,u)/m);let _=Math.floor((g+v)/2)+7;switch(_&3){case 0:_++;break;case 2:_--;break;case 3:throw new he("Dimensions could be not found.")}return _}calculateModuleSize(r,l,u){return(this.calculateModuleSizeOneWay(r,l)+this.calculateModuleSizeOneWay(r,u))/2}calculateModuleSizeOneWay(r,l){const u=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(l.getX()),Math.floor(l.getY())),m=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(l.getX()),Math.floor(l.getY()),Math.floor(r.getX()),Math.floor(r.getY()));return isNaN(u)?m/7:isNaN(m)?u/7:(u+m)/14}sizeOfBlackWhiteBlackRunBothWays(r,l,u,m){let g=this.sizeOfBlackWhiteBlackRun(r,l,u,m),v=1,_=r-(u-r);_<0?(v=r/(r-_),_=0):_>=this.image.getWidth()&&(v=(this.image.getWidth()-1-r)/(_-r),_=this.image.getWidth()-1);let C=Math.floor(l-(m-l)*v);return v=1,C<0?(v=l/(l-C),C=0):C>=this.image.getHeight()&&(v=(this.image.getHeight()-1-l)/(C-l),C=this.image.getHeight()-1),_=Math.floor(r+(_-r)*v),g+=this.sizeOfBlackWhiteBlackRun(r,l,_,C),g-1}sizeOfBlackWhiteBlackRun(r,l,u,m){const g=Math.abs(m-l)>Math.abs(u-r);if(g){let Z=r;r=l,l=Z,Z=u,u=m,m=Z}const v=Math.abs(u-r),_=Math.abs(m-l);let C=-v/2;const M=r<u?1:-1,O=l<m?1:-1;let j=0;const G=u+M;for(let Z=r,re=l;Z!==G;Z+=M){const ce=g?re:Z,ye=g?Z:re;if(j===1===this.image.get(ce,ye)){if(j===2)return nt.distance(Z,re,r,l);j++}if(C+=_,C>0){if(re===m)break;re+=O,C-=v}}return j===2?nt.distance(u+M,m,r,l):NaN}findAlignmentInRegion(r,l,u,m){const g=Math.floor(m*r),v=Math.max(0,l-g),_=Math.min(this.image.getWidth()-1,l+g);if(_-v<r*3)throw new he("Alignment top exceeds estimated module size.");const C=Math.max(0,u-g),M=Math.min(this.image.getHeight()-1,u+g);if(M-C<r*3)throw new he("Alignment bottom exceeds estimated module size.");return new Xi(this.image,v,C,_-v,M-C,r,this.resultPointCallback).find()}}class $i{constructor(){this.decoder=new Sr}getDecoder(){return this.decoder}decode(r,l){let u,m;if(l!=null&&l.get(me.PURE_BARCODE)!==void 0){const C=$i.extractPureBits(r.getBlackMatrix());u=this.decoder.decodeBitMatrix(C,l),m=$i.NO_POINTS}else{const C=new Ki(r.getBlackMatrix()).detect(l);u=this.decoder.decodeBitMatrix(C.getBits(),l),m=C.getPoints()}u.getOther()instanceof Pa&&u.getOther().applyMirroredCorrection(m);const g=new je(u.getText(),u.getRawBytes(),void 0,m,pe.QR_CODE,void 0),v=u.getByteSegments();v!==null&&g.putMetadata(Ke.BYTE_SEGMENTS,v);const _=u.getECLevel();return _!==null&&g.putMetadata(Ke.ERROR_CORRECTION_LEVEL,_),u.hasStructuredAppend()&&(g.putMetadata(Ke.STRUCTURED_APPEND_SEQUENCE,u.getStructuredAppendSequenceNumber()),g.putMetadata(Ke.STRUCTURED_APPEND_PARITY,u.getStructuredAppendParity())),g}reset(){}static extractPureBits(r){const l=r.getTopLeftOnBit(),u=r.getBottomRightOnBit();if(l===null||u===null)throw new he;const m=this.moduleSize(l,r);let g=l[1],v=u[1],_=l[0],C=u[0];if(_>=C||g>=v)throw new he;if(v-g!==C-_&&(C=_+(v-g),C>=r.getWidth()))throw new he;const M=Math.round((C-_+1)/m),O=Math.round((v-g+1)/m);if(M<=0||O<=0)throw new he;if(O!==M)throw new he;const j=Math.floor(m/2);g+=j,_+=j;const G=_+Math.floor((M-1)*m)-C;if(G>0){if(G>j)throw new he;_-=G}const Z=g+Math.floor((O-1)*m)-v;if(Z>0){if(Z>j)throw new he;g-=Z}const re=new _e(M,O);for(let ce=0;ce<O;ce++){const ye=g+Math.floor(ce*m);for(let Ce=0;Ce<M;Ce++)r.get(_+Math.floor(Ce*m),ye)&&re.set(Ce,ce)}return re}static moduleSize(r,l){const u=l.getHeight(),m=l.getWidth();let g=r[0],v=r[1],_=!0,C=0;for(;g<m&&v<u;){if(_!==l.get(g,v)){if(++C===5)break;_=!_}g++,v++}if(g===m||v===u)throw new he;return(g-r[0])/7}}$i.NO_POINTS=new Array;class mt{PDF417Common(){}static getBitCountSum(r){return nt.sum(r)}static toIntArray(r){if(r==null||!r.length)return mt.EMPTY_INT_ARRAY;const l=new Int32Array(r.length);let u=0;for(const m of r)l[u++]=m;return l}static getCodeword(r){const l=le.binarySearch(mt.SYMBOL_TABLE,r&262143);return l<0?-1:(mt.CODEWORD_TABLE[l]-1)%mt.NUMBER_OF_CODEWORDS}}mt.NUMBER_OF_CODEWORDS=929,mt.MAX_CODEWORDS_IN_BARCODE=mt.NUMBER_OF_CODEWORDS-1,mt.MIN_ROWS_IN_BARCODE=3,mt.MAX_ROWS_IN_BARCODE=90,mt.MODULES_IN_CODEWORD=17,mt.MODULES_IN_STOP_PATTERN=18,mt.BARS_IN_MODULE=8,mt.EMPTY_INT_ARRAY=new Int32Array([]),mt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),mt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Nr{constructor(r,l){this.bits=r,this.points=l}getBits(){return this.bits}getPoints(){return this.points}}class vt{static detectMultiple(r,l,u){let m=r.getBlackMatrix(),g=vt.detect(u,m);return g.length||(m=m.clone(),m.rotate180(),g=vt.detect(u,m)),new Nr(m,g)}static detect(r,l){const u=new Array;let m=0,g=0,v=!1;for(;m<l.getHeight();){const _=vt.findVertices(l,m,g);if(_[0]==null&&_[3]==null){if(!v)break;v=!1,g=0;for(const C of u)C[1]!=null&&(m=Math.trunc(Math.max(m,C[1].getY()))),C[3]!=null&&(m=Math.max(m,Math.trunc(C[3].getY())));m+=vt.ROW_STEP;continue}if(v=!0,u.push(_),!r)break;_[2]!=null?(g=Math.trunc(_[2].getX()),m=Math.trunc(_[2].getY())):(g=Math.trunc(_[4].getX()),m=Math.trunc(_[4].getY()))}return u}static findVertices(r,l,u){const m=r.getHeight(),g=r.getWidth(),v=new Array(8);return vt.copyToResult(v,vt.findRowsWithPattern(r,m,g,l,u,vt.START_PATTERN),vt.INDEXES_START_PATTERN),v[4]!=null&&(u=Math.trunc(v[4].getX()),l=Math.trunc(v[4].getY())),vt.copyToResult(v,vt.findRowsWithPattern(r,m,g,l,u,vt.STOP_PATTERN),vt.INDEXES_STOP_PATTERN),v}static copyToResult(r,l,u){for(let m=0;m<u.length;m++)r[u[m]]=l[m]}static findRowsWithPattern(r,l,u,m,g,v){const _=new Array(4);let C=!1;const M=new Int32Array(v.length);for(;m<l;m+=vt.ROW_STEP){let j=vt.findGuardPattern(r,g,m,u,!1,v,M);if(j!=null){for(;m>0;){const G=vt.findGuardPattern(r,g,--m,u,!1,v,M);if(G!=null)j=G;else{m++;break}}_[0]=new Ze(j[0],m),_[1]=new Ze(j[1],m),C=!0;break}}let O=m+1;if(C){let j=0,G=Int32Array.from([Math.trunc(_[0].getX()),Math.trunc(_[1].getX())]);for(;O<l;O++){const Z=vt.findGuardPattern(r,G[0],O,u,!1,v,M);if(Z!=null&&Math.abs(G[0]-Z[0])<vt.MAX_PATTERN_DRIFT&&Math.abs(G[1]-Z[1])<vt.MAX_PATTERN_DRIFT)G=Z,j=0;else{if(j>vt.SKIPPED_ROW_COUNT_MAX)break;j++}}O-=j+1,_[2]=new Ze(G[0],O),_[3]=new Ze(G[1],O)}return O-m<vt.BARCODE_MIN_HEIGHT&&le.fill(_,null),_}static findGuardPattern(r,l,u,m,g,v,_){le.fillWithin(_,0,_.length,0);let C=l,M=0;for(;r.get(C,u)&&C>0&&M++<vt.MAX_PIXEL_DRIFT;)C--;let O=C,j=0,G=v.length;for(let Z=g;O<m;O++)if(r.get(O,u)!==Z)_[j]++;else{if(j===G-1){if(vt.patternMatchVariance(_,v,vt.MAX_INDIVIDUAL_VARIANCE)<vt.MAX_AVG_VARIANCE)return new Int32Array([C,O]);C+=_[0]+_[1],W.arraycopy(_,2,_,0,j-1),_[j-1]=0,_[j]=0,j--}else j++;_[j]=1,Z=!Z}return j===G-1&&vt.patternMatchVariance(_,v,vt.MAX_INDIVIDUAL_VARIANCE)<vt.MAX_AVG_VARIANCE?new Int32Array([C,O-1]):null}static patternMatchVariance(r,l,u){let m=r.length,g=0,v=0;for(let M=0;M<m;M++)g+=r[M],v+=l[M];if(g<v)return 1/0;let _=g/v;u*=_;let C=0;for(let M=0;M<m;M++){let O=r[M],j=l[M]*_,G=O>j?O-j:j-O;if(G>u)return 1/0;C+=G}return C/g}}vt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),vt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),vt.MAX_AVG_VARIANCE=.42,vt.MAX_INDIVIDUAL_VARIANCE=.8,vt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),vt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),vt.MAX_PIXEL_DRIFT=3,vt.MAX_PATTERN_DRIFT=5,vt.SKIPPED_ROW_COUNT_MAX=25,vt.ROW_STEP=5,vt.BARCODE_MIN_HEIGHT=10;class wn{constructor(r,l){if(l.length===0)throw new N;this.field=r;let u=l.length;if(u>1&&l[0]===0){let m=1;for(;m<u&&l[m]===0;)m++;m===u?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(u-m),W.arraycopy(l,m,this.coefficients,0,this.coefficients.length))}else this.coefficients=l}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);if(r===1){let m=0;for(let g of this.coefficients)m=this.field.add(m,g);return m}let l=this.coefficients[0],u=this.coefficients.length;for(let m=1;m<u;m++)l=this.field.add(this.field.multiply(r,l),this.coefficients[m]);return l}add(r){if(!this.field.equals(r.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero())return r;if(r.isZero())return this;let l=this.coefficients,u=r.coefficients;if(l.length>u.length){let v=l;l=u,u=v}let m=new Int32Array(u.length),g=u.length-l.length;W.arraycopy(u,0,m,0,g);for(let v=g;v<u.length;v++)m[v]=this.field.add(l[v-g],u[v]);return new wn(this.field,m)}subtract(r){if(!this.field.equals(r.field))throw new N("ModulusPolys do not have same ModulusGF field");return r.isZero()?this:this.add(r.negative())}multiply(r){return r instanceof wn?this.multiplyOther(r):this.multiplyScalar(r)}multiplyOther(r){if(!this.field.equals(r.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero()||r.isZero())return new wn(this.field,new Int32Array([0]));let l=this.coefficients,u=l.length,m=r.coefficients,g=m.length,v=new Int32Array(u+g-1);for(let _=0;_<u;_++){let C=l[_];for(let M=0;M<g;M++)v[_+M]=this.field.add(v[_+M],this.field.multiply(C,m[M]))}return new wn(this.field,v)}negative(){let r=this.coefficients.length,l=new Int32Array(r);for(let u=0;u<r;u++)l[u]=this.field.subtract(0,this.coefficients[u]);return new wn(this.field,l)}multiplyScalar(r){if(r===0)return new wn(this.field,new Int32Array([0]));if(r===1)return this;let l=this.coefficients.length,u=new Int32Array(l);for(let m=0;m<l;m++)u[m]=this.field.multiply(this.coefficients[m],r);return new wn(this.field,u)}multiplyByMonomial(r,l){if(r<0)throw new N;if(l===0)return new wn(this.field,new Int32Array([0]));let u=this.coefficients.length,m=new Int32Array(u+r);for(let g=0;g<u;g++)m[g]=this.field.multiply(this.coefficients[g],l);return new wn(this.field,m)}toString(){let r=new z;for(let l=this.getDegree();l>=0;l--){let u=this.getCoefficient(l);u!==0&&(u<0?(r.append(" - "),u=-u):r.length()>0&&r.append(" + "),(l===0||u!==1)&&r.append(u),l!==0&&(l===1?r.append("x"):(r.append("x^"),r.append(l))))}return r.toString()}}class Wr{add(r,l){return(r+l)%this.modulus}subtract(r,l){return(this.modulus+r-l)%this.modulus}exp(r){return this.expTable[r]}log(r){if(r===0)throw new N;return this.logTable[r]}inverse(r){if(r===0)throw new Dn;return this.expTable[this.modulus-this.logTable[r]-1]}multiply(r,l){return r===0||l===0?0:this.expTable[(this.logTable[r]+this.logTable[l])%(this.modulus-1)]}getSize(){return this.modulus}equals(r){return r===this}}class hn extends Wr{constructor(r,l){super(),this.modulus=r,this.expTable=new Int32Array(r),this.logTable=new Int32Array(r);let u=1;for(let m=0;m<r;m++)this.expTable[m]=u,u=u*l%r;for(let m=0;m<r-1;m++)this.logTable[this.expTable[m]]=m;this.zero=new wn(this,new Int32Array([0])),this.one=new wn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,l){if(r<0)throw new N;if(l===0)return this.zero;let u=new Int32Array(r+1);return u[0]=l,new wn(this,u)}}hn.PDF417_GF=new hn(mt.NUMBER_OF_CODEWORDS,3);class Rs{constructor(){this.field=hn.PDF417_GF}decode(r,l,u){let m=new wn(this.field,r),g=new Int32Array(l),v=!1;for(let re=l;re>0;re--){let ce=m.evaluateAt(this.field.exp(re));g[l-re]=ce,ce!==0&&(v=!0)}if(!v)return 0;let _=this.field.getOne();if(u!=null)for(const re of u){let ce=this.field.exp(r.length-1-re),ye=new wn(this.field,new Int32Array([this.field.subtract(0,ce),1]));_=_.multiply(ye)}let C=new wn(this.field,g),M=this.runEuclideanAlgorithm(this.field.buildMonomial(l,1),C,l),O=M[0],j=M[1],G=this.findErrorLocations(O),Z=this.findErrorMagnitudes(j,O,G);for(let re=0;re<G.length;re++){let ce=r.length-1-this.field.log(G[re]);if(ce<0)throw k.getChecksumInstance();r[ce]=this.field.subtract(r[ce],Z[re])}return G.length}runEuclideanAlgorithm(r,l,u){if(r.getDegree()<l.getDegree()){let G=r;r=l,l=G}let m=r,g=l,v=this.field.getZero(),_=this.field.getOne();for(;g.getDegree()>=Math.round(u/2);){let G=m,Z=v;if(m=g,v=_,m.isZero())throw k.getChecksumInstance();g=G;let re=this.field.getZero(),ce=m.getCoefficient(m.getDegree()),ye=this.field.inverse(ce);for(;g.getDegree()>=m.getDegree()&&!g.isZero();){let Ce=g.getDegree()-m.getDegree(),qe=this.field.multiply(g.getCoefficient(g.getDegree()),ye);re=re.add(this.field.buildMonomial(Ce,qe)),g=g.subtract(m.multiplyByMonomial(Ce,qe))}_=re.multiply(v).subtract(Z).negative()}let C=_.getCoefficient(0);if(C===0)throw k.getChecksumInstance();let M=this.field.inverse(C),O=_.multiply(M),j=g.multiply(M);return[O,j]}findErrorLocations(r){let l=r.getDegree(),u=new Int32Array(l),m=0;for(let g=1;g<this.field.getSize()&&m<l;g++)r.evaluateAt(g)===0&&(u[m]=this.field.inverse(g),m++);if(m!==l)throw k.getChecksumInstance();return u}findErrorMagnitudes(r,l,u){let m=l.getDegree(),g=new Int32Array(m);for(let M=1;M<=m;M++)g[m-M]=this.field.multiply(M,l.getCoefficient(M));let v=new wn(this.field,g),_=u.length,C=new Int32Array(_);for(let M=0;M<_;M++){let O=this.field.inverse(u[M]),j=this.field.subtract(0,r.evaluateAt(O)),G=this.field.inverse(v.evaluateAt(O));C[M]=this.field.multiply(j,G)}return C}}class Ms{constructor(r,l,u,m,g){r instanceof Ms?this.constructor_2(r):this.constructor_1(r,l,u,m,g)}constructor_1(r,l,u,m,g){const v=l==null||u==null,_=m==null||g==null;if(v&&_)throw new he;v?(l=new Ze(0,m.getY()),u=new Ze(0,g.getY())):_&&(m=new Ze(r.getWidth()-1,l.getY()),g=new Ze(r.getWidth()-1,u.getY())),this.image=r,this.topLeft=l,this.bottomLeft=u,this.topRight=m,this.bottomRight=g,this.minX=Math.trunc(Math.min(l.getX(),u.getX())),this.maxX=Math.trunc(Math.max(m.getX(),g.getX())),this.minY=Math.trunc(Math.min(l.getY(),m.getY())),this.maxY=Math.trunc(Math.max(u.getY(),g.getY()))}constructor_2(r){this.image=r.image,this.topLeft=r.getTopLeft(),this.bottomLeft=r.getBottomLeft(),this.topRight=r.getTopRight(),this.bottomRight=r.getBottomRight(),this.minX=r.getMinX(),this.maxX=r.getMaxX(),this.minY=r.getMinY(),this.maxY=r.getMaxY()}static merge(r,l){return r==null?l:l==null?r:new Ms(r.image,r.topLeft,r.bottomLeft,l.topRight,l.bottomRight)}addMissingRows(r,l,u){let m=this.topLeft,g=this.bottomLeft,v=this.topRight,_=this.bottomRight;if(r>0){let C=u?this.topLeft:this.topRight,M=Math.trunc(C.getY()-r);M<0&&(M=0);let O=new Ze(C.getX(),M);u?m=O:v=O}if(l>0){let C=u?this.bottomLeft:this.bottomRight,M=Math.trunc(C.getY()+l);M>=this.image.getHeight()&&(M=this.image.getHeight()-1);let O=new Ze(C.getX(),M);u?g=O:_=O}return new Ms(this.image,m,g,v,_)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Xr{constructor(r,l,u,m){this.columnCount=r,this.errorCorrectionLevel=m,this.rowCountUpperPart=l,this.rowCountLowerPart=u,this.rowCount=l+u}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class hr{constructor(){this.buffer=""}static form(r,l){let u=-1;function m(v,_,C,M,O,j){if(v==="%%")return"%";if(l[++u]===void 0)return;v=M?parseInt(M.substr(1)):void 0;let G=O?parseInt(O.substr(1)):void 0,Z;switch(j){case"s":Z=l[u];break;case"c":Z=l[u][0];break;case"f":Z=parseFloat(l[u]).toFixed(v);break;case"p":Z=parseFloat(l[u]).toPrecision(v);break;case"e":Z=parseFloat(l[u]).toExponential(v);break;case"x":Z=parseInt(l[u]).toString(G||16);break;case"d":Z=parseFloat(parseInt(l[u],G||10).toPrecision(v)).toFixed(0);break}Z=typeof Z=="object"?JSON.stringify(Z):(+Z).toString(G);let re=parseInt(C),ce=C&&C[0]+""=="0"?"0":" ";for(;Z.length<re;)Z=_!==void 0?Z+ce:ce+Z;return Z}let g=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(g,m)}format(r,...l){this.buffer+=hr.form(r,l)}toString(){return this.buffer}}class Ds{constructor(r){this.boundingBox=new Ms(r),this.codewords=new Array(r.getMaxY()-r.getMinY()+1)}getCodewordNearby(r){let l=this.getCodeword(r);if(l!=null)return l;for(let u=1;u<Ds.MAX_NEARBY_DISTANCE;u++){let m=this.imageRowToCodewordIndex(r)-u;if(m>=0&&(l=this.codewords[m],l!=null)||(m=this.imageRowToCodewordIndex(r)+u,m<this.codewords.length&&(l=this.codewords[m],l!=null)))return l}return null}imageRowToCodewordIndex(r){return r-this.boundingBox.getMinY()}setCodeword(r,l){this.codewords[this.imageRowToCodewordIndex(r)]=l}getCodeword(r){return this.codewords[this.imageRowToCodewordIndex(r)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const r=new hr;let l=0;for(const u of this.codewords){if(u==null){r.format("%3d:    |   %n",l++);continue}r.format("%3d: %3d|%3d%n",l++,u.getRowNumber(),u.getValue())}return r.toString()}}Ds.MAX_NEARBY_DISTANCE=5;class rs{constructor(){this.values=new Map}setValue(r){r=Math.trunc(r);let l=this.values.get(r);l==null&&(l=0),l++,this.values.set(r,l)}getValue(){let r=-1,l=new Array;for(const[u,m]of this.values.entries()){const g={getKey:()=>u,getValue:()=>m};g.getValue()>r?(r=g.getValue(),l=[],l.push(g.getKey())):g.getValue()===r&&l.push(g.getKey())}return mt.toIntArray(l)}getConfidence(r){return this.values.get(r)}}class vs extends Ds{constructor(r,l){super(r),this._isLeft=l}setRowNumbers(){for(let r of this.getCodewords())r!=null&&r.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(r){let l=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(l,r);let u=this.getBoundingBox(),m=this._isLeft?u.getTopLeft():u.getTopRight(),g=this._isLeft?u.getBottomLeft():u.getBottomRight(),v=this.imageRowToCodewordIndex(Math.trunc(m.getY())),_=this.imageRowToCodewordIndex(Math.trunc(g.getY())),C=-1,M=1,O=0;for(let j=v;j<_;j++){if(l[j]==null)continue;let G=l[j],Z=G.getRowNumber()-C;if(Z===0)O++;else if(Z===1)M=Math.max(M,O),O=1,C=G.getRowNumber();else if(Z<0||G.getRowNumber()>=r.getRowCount()||Z>j)l[j]=null;else{let re;M>2?re=(M-2)*Z:re=Z;let ce=re>=j;for(let ye=1;ye<=re&&!ce;ye++)ce=l[j-ye]!=null;ce?l[j]=null:(C=G.getRowNumber(),O=1)}}}getRowHeights(){let r=this.getBarcodeMetadata();if(r==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(r);let l=new Int32Array(r.getRowCount());for(let u of this.getCodewords())if(u!=null){let m=u.getRowNumber();if(m>=l.length)continue;l[m]++}return l}adjustIncompleteIndicatorColumnRowNumbers(r){let l=this.getBoundingBox(),u=this._isLeft?l.getTopLeft():l.getTopRight(),m=this._isLeft?l.getBottomLeft():l.getBottomRight(),g=this.imageRowToCodewordIndex(Math.trunc(u.getY())),v=this.imageRowToCodewordIndex(Math.trunc(m.getY())),_=this.getCodewords(),C=-1;for(let M=g;M<v;M++){if(_[M]==null)continue;let O=_[M];O.setRowNumberAsRowIndicatorColumn();let j=O.getRowNumber()-C;j===0||(j===1?C=O.getRowNumber():O.getRowNumber()>=r.getRowCount()?_[M]=null:C=O.getRowNumber())}}getBarcodeMetadata(){let r=this.getCodewords(),l=new rs,u=new rs,m=new rs,g=new rs;for(let _ of r){if(_==null)continue;_.setRowNumberAsRowIndicatorColumn();let C=_.getValue()%30,M=_.getRowNumber();switch(this._isLeft||(M+=2),M%3){case 0:u.setValue(C*3+1);break;case 1:g.setValue(C/3),m.setValue(C%3);break;case 2:l.setValue(C+1);break}}if(l.getValue().length===0||u.getValue().length===0||m.getValue().length===0||g.getValue().length===0||l.getValue()[0]<1||u.getValue()[0]+m.getValue()[0]<mt.MIN_ROWS_IN_BARCODE||u.getValue()[0]+m.getValue()[0]>mt.MAX_ROWS_IN_BARCODE)return null;let v=new Xr(l.getValue()[0],u.getValue()[0],m.getValue()[0],g.getValue()[0]);return this.removeIncorrectCodewords(r,v),v}removeIncorrectCodewords(r,l){for(let u=0;u<r.length;u++){let m=r[u];if(r[u]==null)continue;let g=m.getValue()%30,v=m.getRowNumber();if(v>l.getRowCount()){r[u]=null;continue}switch(this._isLeft||(v+=2),v%3){case 0:g*3+1!==l.getRowCountUpperPart()&&(r[u]=null);break;case 1:(Math.trunc(g/3)!==l.getErrorCorrectionLevel()||g%3!==l.getRowCountLowerPart())&&(r[u]=null);break;case 2:g+1!==l.getColumnCount()&&(r[u]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Kn{constructor(r,l){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=r,this.barcodeColumnCount=r.getColumnCount(),this.boundingBox=l,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let r=mt.MAX_CODEWORDS_IN_BARCODE,l;do l=r,r=this.adjustRowNumbersAndGetCount();while(r>0&&r<l);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(r){r!=null&&r.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let r=this.adjustRowNumbersByRow();if(r===0)return 0;for(let l=1;l<this.barcodeColumnCount+1;l++){let u=this.detectionResultColumns[l].getCodewords();for(let m=0;m<u.length;m++)u[m]!=null&&(u[m].hasValidRowNumber()||this.adjustRowNumbers(l,m,u))}return r}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let r=this.detectionResultColumns[0].getCodewords(),l=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let u=0;u<r.length;u++)if(r[u]!=null&&l[u]!=null&&r[u].getRowNumber()===l[u].getRowNumber())for(let m=1;m<=this.barcodeColumnCount;m++){let g=this.detectionResultColumns[m].getCodewords()[u];g!=null&&(g.setRowNumber(r[u].getRowNumber()),g.hasValidRowNumber()||(this.detectionResultColumns[m].getCodewords()[u]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let r=0,l=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let u=0;u<l.length;u++){if(l[u]==null)continue;let m=l[u].getRowNumber(),g=0;for(let v=this.barcodeColumnCount+1;v>0&&g<this.ADJUST_ROW_NUMBER_SKIP;v--){let _=this.detectionResultColumns[v].getCodewords()[u];_!=null&&(g=Kn.adjustRowNumberIfValid(m,g,_),_.hasValidRowNumber()||r++)}}return r}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let r=0,l=this.detectionResultColumns[0].getCodewords();for(let u=0;u<l.length;u++){if(l[u]==null)continue;let m=l[u].getRowNumber(),g=0;for(let v=1;v<this.barcodeColumnCount+1&&g<this.ADJUST_ROW_NUMBER_SKIP;v++){let _=this.detectionResultColumns[v].getCodewords()[u];_!=null&&(g=Kn.adjustRowNumberIfValid(m,g,_),_.hasValidRowNumber()||r++)}}return r}static adjustRowNumberIfValid(r,l,u){return u==null||u.hasValidRowNumber()||(u.isValidRowNumber(r)?(u.setRowNumber(r),l=0):++l),l}adjustRowNumbers(r,l,u){if(!this.detectionResultColumns[r-1])return;let m=u[l],g=this.detectionResultColumns[r-1].getCodewords(),v=g;this.detectionResultColumns[r+1]!=null&&(v=this.detectionResultColumns[r+1].getCodewords());let _=new Array(14);_[2]=g[l],_[3]=v[l],l>0&&(_[0]=u[l-1],_[4]=g[l-1],_[5]=v[l-1]),l>1&&(_[8]=u[l-2],_[10]=g[l-2],_[11]=v[l-2]),l<u.length-1&&(_[1]=u[l+1],_[6]=g[l+1],_[7]=v[l+1]),l<u.length-2&&(_[9]=u[l+2],_[12]=g[l+2],_[13]=v[l+2]);for(let C of _)if(Kn.adjustRowNumber(m,C))return}static adjustRowNumber(r,l){return l==null?!1:l.hasValidRowNumber()&&l.getBucket()===r.getBucket()?(r.setRowNumber(l.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(r){this.boundingBox=r}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(r,l){this.detectionResultColumns[r]=l}getDetectionResultColumn(r){return this.detectionResultColumns[r]}toString(){let r=this.detectionResultColumns[0];r==null&&(r=this.detectionResultColumns[this.barcodeColumnCount+1]);let l=new hr;for(let u=0;u<r.getCodewords().length;u++){l.format("CW %3d:",u);for(let m=0;m<this.barcodeColumnCount+2;m++){if(this.detectionResultColumns[m]==null){l.format("    |   ");continue}let g=this.detectionResultColumns[m].getCodewords()[u];if(g==null){l.format("    |   ");continue}l.format(" %3d|%3d",g.getRowNumber(),g.getValue())}l.format("%n")}return l.toString()}}class os{constructor(r,l,u,m){this.rowNumber=os.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(r),this.endX=Math.trunc(l),this.bucket=Math.trunc(u),this.value=Math.trunc(m)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(r){return r!==os.BARCODE_ROW_UNKNOWN&&this.bucket===r%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(r){this.rowNumber=r}toString(){return this.rowNumber+"|"+this.value}}os.BARCODE_ROW_UNKNOWN=-1;class Ln{static initialize(){for(let r=0;r<mt.SYMBOL_TABLE.length;r++){let l=mt.SYMBOL_TABLE[r],u=l&1;for(let m=0;m<mt.BARS_IN_MODULE;m++){let g=0;for(;(l&1)===u;)g+=1,l>>=1;u=l&1,Ln.RATIOS_TABLE[r]||(Ln.RATIOS_TABLE[r]=new Array(mt.BARS_IN_MODULE)),Ln.RATIOS_TABLE[r][mt.BARS_IN_MODULE-m-1]=Math.fround(g/mt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(r){let l=Ln.getDecodedCodewordValue(Ln.sampleBitCounts(r));return l!==-1?l:Ln.getClosestDecodedValue(r)}static sampleBitCounts(r){let l=nt.sum(r),u=new Int32Array(mt.BARS_IN_MODULE),m=0,g=0;for(let v=0;v<mt.MODULES_IN_CODEWORD;v++){let _=l/(2*mt.MODULES_IN_CODEWORD)+v*l/mt.MODULES_IN_CODEWORD;g+r[m]<=_&&(g+=r[m],m++),u[m]++}return u}static getDecodedCodewordValue(r){let l=Ln.getBitValue(r);return mt.getCodeword(l)===-1?-1:l}static getBitValue(r){let l=0;for(let u=0;u<r.length;u++)for(let m=0;m<r[u];m++)l=l<<1|(u%2===0?1:0);return Math.trunc(l)}static getClosestDecodedValue(r){let l=nt.sum(r),u=new Array(mt.BARS_IN_MODULE);if(l>1)for(let v=0;v<u.length;v++)u[v]=Math.fround(r[v]/l);let m=xn.MAX_VALUE,g=-1;this.bSymbolTableReady||Ln.initialize();for(let v=0;v<Ln.RATIOS_TABLE.length;v++){let _=0,C=Ln.RATIOS_TABLE[v];for(let M=0;M<mt.BARS_IN_MODULE;M++){let O=Math.fround(C[M]-u[M]);if(_+=Math.fround(O*O),_>=m)break}_<m&&(m=_,g=mt.SYMBOL_TABLE[v])}return g}}Ln.bSymbolTableReady=!1,Ln.RATIOS_TABLE=new Array(mt.SYMBOL_TABLE.length).map(B=>new Array(mt.BARS_IN_MODULE));class fr{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(r){this.segmentIndex=r}getFileId(){return this.fileId}setFileId(r){this.fileId=r}getOptionalData(){return this.optionalData}setOptionalData(r){this.optionalData=r}isLastSegment(){return this.lastSegment}setLastSegment(r){this.lastSegment=r}getSegmentCount(){return this.segmentCount}setSegmentCount(r){this.segmentCount=r}getSender(){return this.sender||null}setSender(r){this.sender=r}getAddressee(){return this.addressee||null}setAddressee(r){this.addressee=r}getFileName(){return this.fileName}setFileName(r){this.fileName=r}getFileSize(){return this.fileSize}setFileSize(r){this.fileSize=r}getChecksum(){return this.checksum}setChecksum(r){this.checksum=r}getTimestamp(){return this.timestamp}setTimestamp(r){this.timestamp=r}}class Po{static parseLong(r,l=void 0){return parseInt(r,l)}}class mr extends x{}mr.kind="NullPointerException";class Lo{writeBytes(r){this.writeBytesOffset(r,0,r.length)}writeBytesOffset(r,l,u){if(r==null)throw new mr;if(l<0||l>r.length||u<0||l+u>r.length||l+u<0)throw new K;if(u===0)return;for(let m=0;m<u;m++)this.write(r[l+m])}flush(){}close(){}}class Xs extends x{}class Uo extends Lo{constructor(r=32){if(super(),this.count=0,r<0)throw new N("Negative initial size: "+r);this.buf=new Uint8Array(r)}ensureCapacity(r){r-this.buf.length>0&&this.grow(r)}grow(r){let u=this.buf.length<<1;if(u-r<0&&(u=r),u<0){if(r<0)throw new Xs;u=ee.MAX_VALUE}this.buf=le.copyOfUint8Array(this.buf,u)}write(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1}writeBytesOffset(r,l,u){if(l<0||l>r.length||u<0||l+u-r.length>0)throw new K;this.ensureCapacity(this.count+u),W.arraycopy(r,l,this.buf,this.count,u),this.count+=u}writeTo(r){r.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return le.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(r){return new String(this.buf).toString()}toString_number(r){return new String(this.buf).toString()}close(){}}var sn;(function(B){B[B.ALPHA=0]="ALPHA",B[B.LOWER=1]="LOWER",B[B.MIXED=2]="MIXED",B[B.PUNCT=3]="PUNCT",B[B.ALPHA_SHIFT=4]="ALPHA_SHIFT",B[B.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(sn||(sn={}));function Ir(){if(typeof window<"u")return window.BigInt||null;if(typeof $d<"u")return $d.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Kr;function Os(B){if(typeof Kr>"u"&&(Kr=Ir()),Kr===null)throw new Error("BigInt is not supported!");return Kr(B)}function $r(){let B=[];B[0]=Os(1);let r=Os(900);B[1]=r;for(let l=2;l<16;l++)B[l]=B[l-1]*r;return B}class Se{static decode(r,l){let u=new z(""),m=F.ISO8859_1;u.enableDecoding(m);let g=1,v=r[g++],_=new fr;for(;g<r[0];){switch(v){case Se.TEXT_COMPACTION_MODE_LATCH:g=Se.textCompaction(r,g,u);break;case Se.BYTE_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH_6:g=Se.byteCompaction(v,r,m,g,u);break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(r[g++]);break;case Se.NUMERIC_COMPACTION_MODE_LATCH:g=Se.numericCompaction(r,g,u);break;case Se.ECI_CHARSET:F.getCharacterSetECIByValue(r[g++]);break;case Se.ECI_GENERAL_PURPOSE:g+=2;break;case Se.ECI_USER_DEFINED:g++;break;case Se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:g=Se.decodeMacroBlock(r,g,_);break;case Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Se.MACRO_PDF417_TERMINATOR:throw new U;default:g--,g=Se.textCompaction(r,g,u);break}if(g<r.length)v=r[g++];else throw U.getFormatInstance()}if(u.length()===0)throw U.getFormatInstance();let C=new it(null,u.toString(),null,l);return C.setOther(_),C}static decodeMacroBlock(r,l,u){if(l+Se.NUMBER_OF_SEQUENCE_CODEWORDS>r[0])throw U.getFormatInstance();let m=new Int32Array(Se.NUMBER_OF_SEQUENCE_CODEWORDS);for(let _=0;_<Se.NUMBER_OF_SEQUENCE_CODEWORDS;_++,l++)m[_]=r[l];u.setSegmentIndex(ee.parseInt(Se.decodeBase900toBase10(m,Se.NUMBER_OF_SEQUENCE_CODEWORDS)));let g=new z;l=Se.textCompaction(r,l,g),u.setFileId(g.toString());let v=-1;for(r[l]===Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(v=l+1);l<r[0];)switch(r[l]){case Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(l++,r[l]){case Se.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let _=new z;l=Se.textCompaction(r,l+1,_),u.setFileName(_.toString());break;case Se.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let C=new z;l=Se.textCompaction(r,l+1,C),u.setSender(C.toString());break;case Se.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let M=new z;l=Se.textCompaction(r,l+1,M),u.setAddressee(M.toString());break;case Se.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let O=new z;l=Se.numericCompaction(r,l+1,O),u.setSegmentCount(ee.parseInt(O.toString()));break;case Se.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let j=new z;l=Se.numericCompaction(r,l+1,j),u.setTimestamp(Po.parseLong(j.toString()));break;case Se.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let G=new z;l=Se.numericCompaction(r,l+1,G),u.setChecksum(ee.parseInt(G.toString()));break;case Se.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let Z=new z;l=Se.numericCompaction(r,l+1,Z),u.setFileSize(Po.parseLong(Z.toString()));break;default:throw U.getFormatInstance()}break;case Se.MACRO_PDF417_TERMINATOR:l++,u.setLastSegment(!0);break;default:throw U.getFormatInstance()}if(v!==-1){let _=l-v;u.isLastSegment()&&_--,u.setOptionalData(le.copyOfRange(r,v,v+_))}return l}static textCompaction(r,l,u){let m=new Int32Array((r[0]-l)*2),g=new Int32Array((r[0]-l)*2),v=0,_=!1;for(;l<r[0]&&!_;){let C=r[l++];if(C<Se.TEXT_COMPACTION_MODE_LATCH)m[v]=C/30,m[v+1]=C%30,v+=2;else switch(C){case Se.TEXT_COMPACTION_MODE_LATCH:m[v++]=Se.TEXT_COMPACTION_MODE_LATCH;break;case Se.BYTE_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH_6:case Se.NUMERIC_COMPACTION_MODE_LATCH:case Se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Se.MACRO_PDF417_TERMINATOR:l--,_=!0;break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m[v]=Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,C=r[l++],g[v]=C,v++;break}}return Se.decodeTextCompaction(m,g,v,u),l}static decodeTextCompaction(r,l,u,m){let g=sn.ALPHA,v=sn.ALPHA,_=0;for(;_<u;){let C=r[_],M="";switch(g){case sn.ALPHA:if(C<26)M=String.fromCharCode(65+C);else switch(C){case 26:M=" ";break;case Se.LL:g=sn.LOWER;break;case Se.ML:g=sn.MIXED;break;case Se.PS:v=g,g=sn.PUNCT_SHIFT;break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m.append(l[_]);break;case Se.TEXT_COMPACTION_MODE_LATCH:g=sn.ALPHA;break}break;case sn.LOWER:if(C<26)M=String.fromCharCode(97+C);else switch(C){case 26:M=" ";break;case Se.AS:v=g,g=sn.ALPHA_SHIFT;break;case Se.ML:g=sn.MIXED;break;case Se.PS:v=g,g=sn.PUNCT_SHIFT;break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m.append(l[_]);break;case Se.TEXT_COMPACTION_MODE_LATCH:g=sn.ALPHA;break}break;case sn.MIXED:if(C<Se.PL)M=Se.MIXED_CHARS[C];else switch(C){case Se.PL:g=sn.PUNCT;break;case 26:M=" ";break;case Se.LL:g=sn.LOWER;break;case Se.AL:g=sn.ALPHA;break;case Se.PS:v=g,g=sn.PUNCT_SHIFT;break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m.append(l[_]);break;case Se.TEXT_COMPACTION_MODE_LATCH:g=sn.ALPHA;break}break;case sn.PUNCT:if(C<Se.PAL)M=Se.PUNCT_CHARS[C];else switch(C){case Se.PAL:g=sn.ALPHA;break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m.append(l[_]);break;case Se.TEXT_COMPACTION_MODE_LATCH:g=sn.ALPHA;break}break;case sn.ALPHA_SHIFT:if(g=v,C<26)M=String.fromCharCode(65+C);else switch(C){case 26:M=" ";break;case Se.TEXT_COMPACTION_MODE_LATCH:g=sn.ALPHA;break}break;case sn.PUNCT_SHIFT:if(g=v,C<Se.PAL)M=Se.PUNCT_CHARS[C];else switch(C){case Se.PAL:g=sn.ALPHA;break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m.append(l[_]);break;case Se.TEXT_COMPACTION_MODE_LATCH:g=sn.ALPHA;break}break}M!==""&&m.append(M),_++}}static byteCompaction(r,l,u,m,g){let v=new Uo,_=0,C=0,M=!1;switch(r){case Se.BYTE_COMPACTION_MODE_LATCH:let O=new Int32Array(6),j=l[m++];for(;m<l[0]&&!M;)switch(O[_++]=j,C=900*C+j,j=l[m++],j){case Se.TEXT_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH:case Se.NUMERIC_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH_6:case Se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Se.MACRO_PDF417_TERMINATOR:m--,M=!0;break;default:if(_%5===0&&_>0){for(let G=0;G<6;++G)v.write(Number(Os(C)>>Os(8*(5-G))));C=0,_=0}break}m===l[0]&&j<Se.TEXT_COMPACTION_MODE_LATCH&&(O[_++]=j);for(let G=0;G<_;G++)v.write(O[G]);break;case Se.BYTE_COMPACTION_MODE_LATCH_6:for(;m<l[0]&&!M;){let G=l[m++];if(G<Se.TEXT_COMPACTION_MODE_LATCH)_++,C=900*C+G;else switch(G){case Se.TEXT_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH:case Se.NUMERIC_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH_6:case Se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Se.MACRO_PDF417_TERMINATOR:m--,M=!0;break}if(_%5===0&&_>0){for(let Z=0;Z<6;++Z)v.write(Number(Os(C)>>Os(8*(5-Z))));C=0,_=0}}break}return g.append(Y.decode(v.toByteArray(),u)),m}static numericCompaction(r,l,u){let m=0,g=!1,v=new Int32Array(Se.MAX_NUMERIC_CODEWORDS);for(;l<r[0]&&!g;){let _=r[l++];if(l===r[0]&&(g=!0),_<Se.TEXT_COMPACTION_MODE_LATCH)v[m]=_,m++;else switch(_){case Se.TEXT_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH_6:case Se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Se.MACRO_PDF417_TERMINATOR:l--,g=!0;break}(m%Se.MAX_NUMERIC_CODEWORDS===0||_===Se.NUMERIC_COMPACTION_MODE_LATCH||g)&&m>0&&(u.append(Se.decodeBase900toBase10(v,m)),m=0)}return l}static decodeBase900toBase10(r,l){let u=Os(0);for(let g=0;g<l;g++)u+=Se.EXP900[l-g-1]*Os(r[g]);let m=u.toString();if(m.charAt(0)!=="1")throw new U;return m.substring(1)}}Se.TEXT_COMPACTION_MODE_LATCH=900,Se.BYTE_COMPACTION_MODE_LATCH=901,Se.NUMERIC_COMPACTION_MODE_LATCH=902,Se.BYTE_COMPACTION_MODE_LATCH_6=924,Se.ECI_USER_DEFINED=925,Se.ECI_GENERAL_PURPOSE=926,Se.ECI_CHARSET=927,Se.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Se.MACRO_PDF417_TERMINATOR=922,Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Se.MAX_NUMERIC_CODEWORDS=15,Se.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Se.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Se.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Se.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Se.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Se.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Se.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Se.PL=25,Se.LL=27,Se.AS=27,Se.ML=28,Se.AL=28,Se.PS=29,Se.PAL=29,Se.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,Se.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",Se.EXP900=Ir()?$r():[],Se.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Rt{constructor(){}static decode(r,l,u,m,g,v,_){let C=new Ms(r,l,u,m,g),M=null,O=null,j;for(let re=!0;;re=!1){if(l!=null&&(M=Rt.getRowIndicatorColumn(r,C,l,!0,v,_)),m!=null&&(O=Rt.getRowIndicatorColumn(r,C,m,!1,v,_)),j=Rt.merge(M,O),j==null)throw he.getNotFoundInstance();let ce=j.getBoundingBox();if(re&&ce!=null&&(ce.getMinY()<C.getMinY()||ce.getMaxY()>C.getMaxY()))C=ce;else break}j.setBoundingBox(C);let G=j.getBarcodeColumnCount()+1;j.setDetectionResultColumn(0,M),j.setDetectionResultColumn(G,O);let Z=M!=null;for(let re=1;re<=G;re++){let ce=Z?re:G-re;if(j.getDetectionResultColumn(ce)!==void 0)continue;let ye;ce===0||ce===G?ye=new vs(C,ce===0):ye=new Ds(C),j.setDetectionResultColumn(ce,ye);let Ce=-1,qe=Ce;for(let He=C.getMinY();He<=C.getMaxY();He++){if(Ce=Rt.getStartColumn(j,ce,He,Z),Ce<0||Ce>C.getMaxX()){if(qe===-1)continue;Ce=qe}let Fe=Rt.detectCodeword(r,C.getMinX(),C.getMaxX(),Z,Ce,He,v,_);Fe!=null&&(ye.setCodeword(He,Fe),qe=Ce,v=Math.min(v,Fe.getWidth()),_=Math.max(_,Fe.getWidth()))}}return Rt.createDecoderResult(j)}static merge(r,l){if(r==null&&l==null)return null;let u=Rt.getBarcodeMetadata(r,l);if(u==null)return null;let m=Ms.merge(Rt.adjustBoundingBox(r),Rt.adjustBoundingBox(l));return new Kn(u,m)}static adjustBoundingBox(r){if(r==null)return null;let l=r.getRowHeights();if(l==null)return null;let u=Rt.getMax(l),m=0;for(let _ of l)if(m+=u-_,_>0)break;let g=r.getCodewords();for(let _=0;m>0&&g[_]==null;_++)m--;let v=0;for(let _=l.length-1;_>=0&&(v+=u-l[_],!(l[_]>0));_--);for(let _=g.length-1;v>0&&g[_]==null;_--)v--;return r.getBoundingBox().addMissingRows(m,v,r.isLeft())}static getMax(r){let l=-1;for(let u of r)l=Math.max(l,u);return l}static getBarcodeMetadata(r,l){let u;if(r==null||(u=r.getBarcodeMetadata())==null)return l==null?null:l.getBarcodeMetadata();let m;return l==null||(m=l.getBarcodeMetadata())==null?u:u.getColumnCount()!==m.getColumnCount()&&u.getErrorCorrectionLevel()!==m.getErrorCorrectionLevel()&&u.getRowCount()!==m.getRowCount()?null:u}static getRowIndicatorColumn(r,l,u,m,g,v){let _=new vs(l,m);for(let C=0;C<2;C++){let M=C===0?1:-1,O=Math.trunc(Math.trunc(u.getX()));for(let j=Math.trunc(Math.trunc(u.getY()));j<=l.getMaxY()&&j>=l.getMinY();j+=M){let G=Rt.detectCodeword(r,0,r.getWidth(),m,O,j,g,v);G!=null&&(_.setCodeword(j,G),m?O=G.getStartX():O=G.getEndX())}}return _}static adjustCodewordCount(r,l){let u=l[0][1],m=u.getValue(),g=r.getBarcodeColumnCount()*r.getBarcodeRowCount()-Rt.getNumberOfECCodeWords(r.getBarcodeECLevel());if(m.length===0){if(g<1||g>mt.MAX_CODEWORDS_IN_BARCODE)throw he.getNotFoundInstance();u.setValue(g)}else m[0]!==g&&u.setValue(g)}static createDecoderResult(r){let l=Rt.createBarcodeMatrix(r);Rt.adjustCodewordCount(r,l);let u=new Array,m=new Int32Array(r.getBarcodeRowCount()*r.getBarcodeColumnCount()),g=[],v=new Array;for(let C=0;C<r.getBarcodeRowCount();C++)for(let M=0;M<r.getBarcodeColumnCount();M++){let O=l[C][M+1].getValue(),j=C*r.getBarcodeColumnCount()+M;O.length===0?u.push(j):O.length===1?m[j]=O[0]:(v.push(j),g.push(O))}let _=new Array(g.length);for(let C=0;C<_.length;C++)_[C]=g[C];return Rt.createDecoderResultFromAmbiguousValues(r.getBarcodeECLevel(),m,mt.toIntArray(u),mt.toIntArray(v),_)}static createDecoderResultFromAmbiguousValues(r,l,u,m,g){let v=new Int32Array(m.length),_=100;for(;_-- >0;){for(let C=0;C<v.length;C++)l[m[C]]=g[C][v[C]];try{return Rt.decodeCodewords(l,r,u)}catch(C){if(!(C instanceof k))throw C}if(v.length===0)throw k.getChecksumInstance();for(let C=0;C<v.length;C++)if(v[C]<g[C].length-1){v[C]++;break}else if(v[C]=0,C===v.length-1)throw k.getChecksumInstance()}throw k.getChecksumInstance()}static createBarcodeMatrix(r){let l=Array.from({length:r.getBarcodeRowCount()},()=>new Array(r.getBarcodeColumnCount()+2));for(let m=0;m<l.length;m++)for(let g=0;g<l[m].length;g++)l[m][g]=new rs;let u=0;for(let m of r.getDetectionResultColumns()){if(m!=null){for(let g of m.getCodewords())if(g!=null){let v=g.getRowNumber();if(v>=0){if(v>=l.length)continue;l[v][u].setValue(g.getValue())}}}u++}return l}static isValidBarcodeColumn(r,l){return l>=0&&l<=r.getBarcodeColumnCount()+1}static getStartColumn(r,l,u,m){let g=m?1:-1,v=null;if(Rt.isValidBarcodeColumn(r,l-g)&&(v=r.getDetectionResultColumn(l-g).getCodeword(u)),v!=null)return m?v.getEndX():v.getStartX();if(v=r.getDetectionResultColumn(l).getCodewordNearby(u),v!=null)return m?v.getStartX():v.getEndX();if(Rt.isValidBarcodeColumn(r,l-g)&&(v=r.getDetectionResultColumn(l-g).getCodewordNearby(u)),v!=null)return m?v.getEndX():v.getStartX();let _=0;for(;Rt.isValidBarcodeColumn(r,l-g);){l-=g;for(let C of r.getDetectionResultColumn(l).getCodewords())if(C!=null)return(m?C.getEndX():C.getStartX())+g*_*(C.getEndX()-C.getStartX());_++}return m?r.getBoundingBox().getMinX():r.getBoundingBox().getMaxX()}static detectCodeword(r,l,u,m,g,v,_,C){g=Rt.adjustCodewordStartColumn(r,l,u,m,g,v);let M=Rt.getModuleBitCount(r,l,u,m,g,v);if(M==null)return null;let O,j=nt.sum(M);if(m)O=g+j;else{for(let re=0;re<M.length/2;re++){let ce=M[re];M[re]=M[M.length-1-re],M[M.length-1-re]=ce}O=g,g=O-j}if(!Rt.checkCodewordSkew(j,_,C))return null;let G=Ln.getDecodedValue(M),Z=mt.getCodeword(G);return Z===-1?null:new os(g,O,Rt.getCodewordBucketNumber(G),Z)}static getModuleBitCount(r,l,u,m,g,v){let _=g,C=new Int32Array(8),M=0,O=m?1:-1,j=m;for(;(m?_<u:_>=l)&&M<C.length;)r.get(_,v)===j?(C[M]++,_+=O):(M++,j=!j);return M===C.length||_===(m?u:l)&&M===C.length-1?C:null}static getNumberOfECCodeWords(r){return 2<<r}static adjustCodewordStartColumn(r,l,u,m,g,v){let _=g,C=m?-1:1;for(let M=0;M<2;M++){for(;(m?_>=l:_<u)&&m===r.get(_,v);){if(Math.abs(g-_)>Rt.CODEWORD_SKEW_SIZE)return g;_+=C}C=-C,m=!m}return _}static checkCodewordSkew(r,l,u){return l-Rt.CODEWORD_SKEW_SIZE<=r&&r<=u+Rt.CODEWORD_SKEW_SIZE}static decodeCodewords(r,l,u){if(r.length===0)throw U.getFormatInstance();let m=1<<l+1,g=Rt.correctErrors(r,u,m);Rt.verifyCodewordCount(r,m);let v=Se.decode(r,""+l);return v.setErrorsCorrected(g),v.setErasures(u.length),v}static correctErrors(r,l,u){if(l!=null&&l.length>u/2+Rt.MAX_ERRORS||u<0||u>Rt.MAX_EC_CODEWORDS)throw k.getChecksumInstance();return Rt.errorCorrection.decode(r,u,l)}static verifyCodewordCount(r,l){if(r.length<4)throw U.getFormatInstance();let u=r[0];if(u>r.length)throw U.getFormatInstance();if(u===0)if(l<r.length)r[0]=r.length-l;else throw U.getFormatInstance()}static getBitCountForCodeword(r){let l=new Int32Array(8),u=0,m=l.length-1;for(;!((r&1)!==u&&(u=r&1,m--,m<0));)l[m]++,r>>=1;return l}static getCodewordBucketNumber(r){return r instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(r):this.getCodewordBucketNumber_number(r)}static getCodewordBucketNumber_number(r){return Rt.getCodewordBucketNumber(Rt.getBitCountForCodeword(r))}static getCodewordBucketNumber_Int32Array(r){return(r[0]-r[2]+r[4]-r[6]+9)%9}static toString(r){let l=new hr;for(let u=0;u<r.length;u++){l.format("Row %2d: ",u);for(let m=0;m<r[u].length;m++){let g=r[u][m];g.getValue().length===0?l.format("        ",null):l.format("%4d(%2d)",g.getValue()[0],g.getConfidence(g.getValue()[0]))}l.format("%n")}return l.toString()}}Rt.CODEWORD_SKEW_SIZE=2,Rt.MAX_ERRORS=3,Rt.MAX_EC_CODEWORDS=512,Rt.errorCorrection=new Rs;class Hn{decode(r,l=null){let u=Hn.decode(r,l,!1);if(u==null||u.length===0||u[0]==null)throw he.getNotFoundInstance();return u[0]}decodeMultiple(r,l=null){try{return Hn.decode(r,l,!0)}catch(u){throw u instanceof U||u instanceof k?he.getNotFoundInstance():u}}static decode(r,l,u){const m=new Array,g=vt.detectMultiple(r,l,u);for(const v of g.getPoints()){const _=Rt.decode(g.getBits(),v[4],v[5],v[6],v[7],Hn.getMinCodewordWidth(v),Hn.getMaxCodewordWidth(v)),C=new je(_.getText(),_.getRawBytes(),void 0,v,pe.PDF_417);C.putMetadata(Ke.ERROR_CORRECTION_LEVEL,_.getECLevel());const M=_.getOther();M!=null&&C.putMetadata(Ke.PDF417_EXTRA_METADATA,M),m.push(C)}return m.map(v=>v)}static getMaxWidth(r,l){return r==null||l==null?0:Math.trunc(Math.abs(r.getX()-l.getX()))}static getMinWidth(r,l){return r==null||l==null?ee.MAX_VALUE:Math.trunc(Math.abs(r.getX()-l.getX()))}static getMaxCodewordWidth(r){return Math.floor(Math.max(Math.max(Hn.getMaxWidth(r[0],r[4]),Hn.getMaxWidth(r[6],r[2])*mt.MODULES_IN_CODEWORD/mt.MODULES_IN_STOP_PATTERN),Math.max(Hn.getMaxWidth(r[1],r[5]),Hn.getMaxWidth(r[7],r[3])*mt.MODULES_IN_CODEWORD/mt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(r){return Math.floor(Math.min(Math.min(Hn.getMinWidth(r[0],r[4]),Hn.getMinWidth(r[6],r[2])*mt.MODULES_IN_CODEWORD/mt.MODULES_IN_STOP_PATTERN),Math.min(Hn.getMinWidth(r[1],r[5]),Hn.getMinWidth(r[7],r[3])*mt.MODULES_IN_CODEWORD/mt.MODULES_IN_STOP_PATTERN)))}reset(){}}class Jr extends x{}Jr.kind="ReaderException";class La{constructor(r,l){this.verbose=r===!0,l&&this.setHints(l)}decode(r,l){return l&&this.setHints(l),this.decodeInternal(r)}decodeWithState(r){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(r)}setHints(r){this.hints=r;const l=!i(r)&&r.get(me.TRY_HARDER)===!0,u=i(r)?null:r.get(me.POSSIBLE_FORMATS),m=new Array;if(!i(u)){const g=u.some(v=>v===pe.UPC_A||v===pe.UPC_E||v===pe.EAN_13||v===pe.EAN_8||v===pe.CODABAR||v===pe.CODE_39||v===pe.CODE_93||v===pe.CODE_128||v===pe.ITF||v===pe.RSS_14||v===pe.RSS_EXPANDED);g&&!l&&m.push(new ki(r,this.verbose)),u.includes(pe.QR_CODE)&&m.push(new $i),u.includes(pe.DATA_MATRIX)&&m.push(new Yi),u.includes(pe.AZTEC)&&m.push(new Tr),u.includes(pe.PDF_417)&&m.push(new Hn),g&&l&&m.push(new ki(r,this.verbose))}m.length===0&&(l||m.push(new ki(r,this.verbose)),m.push(new $i),m.push(new Yi),m.push(new Tr),m.push(new Hn),l&&m.push(new ki(r,this.verbose))),this.readers=m}reset(){if(this.readers!==null)for(const r of this.readers)r.reset()}decodeInternal(r){if(this.readers===null)throw new Jr("No readers where selected, nothing can be read.");for(const l of this.readers)try{return l.decode(r,this.hints)}catch(u){if(u instanceof Jr)continue}throw new he("No MultiFormat Readers were able to detect the code.")}}class Ks extends Ae{constructor(r=null,l=500){const u=new La;u.setHints(r),super(u,l)}decodeBitmap(r){return this.reader.decodeWithState(r)}}class ml extends Ae{constructor(r=500){super(new Hn,r)}}class gl extends Ae{constructor(r=500){super(new $i,r)}}var Bo;(function(B){B[B.ERROR_CORRECTION=0]="ERROR_CORRECTION",B[B.CHARACTER_SET=1]="CHARACTER_SET",B[B.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",B[B.MIN_SIZE=3]="MIN_SIZE",B[B.MAX_SIZE=4]="MAX_SIZE",B[B.MARGIN=5]="MARGIN",B[B.PDF417_COMPACT=6]="PDF417_COMPACT",B[B.PDF417_COMPACTION=7]="PDF417_COMPACTION",B[B.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",B[B.AZTEC_LAYERS=9]="AZTEC_LAYERS",B[B.QR_VERSION=10]="QR_VERSION"})(Bo||(Bo={}));var zn=Bo;class $s{constructor(r){this.field=r,this.cachedGenerators=[],this.cachedGenerators.push(new kt(r,Int32Array.from([1])))}buildGenerator(r){const l=this.cachedGenerators;if(r>=l.length){let u=l[l.length-1];const m=this.field;for(let g=l.length;g<=r;g++){const v=u.multiply(new kt(m,Int32Array.from([1,m.exp(g-1+m.getGeneratorBase())])));l.push(v),u=v}}return l[r]}encode(r,l){if(l===0)throw new N("No error correction bytes");const u=r.length-l;if(u<=0)throw new N("No data bytes provided");const m=this.buildGenerator(l),g=new Int32Array(u);W.arraycopy(r,0,g,0,u);let v=new kt(this.field,g);v=v.multiplyByMonomial(l,1);const C=v.divide(m)[1].getCoefficients(),M=l-C.length;for(let O=0;O<M;O++)r[u+O]=0;W.arraycopy(C,0,r,u+M,C.length)}}class Ht{constructor(){}static applyMaskPenaltyRule1(r){return Ht.applyMaskPenaltyRule1Internal(r,!0)+Ht.applyMaskPenaltyRule1Internal(r,!1)}static applyMaskPenaltyRule2(r){let l=0;const u=r.getArray(),m=r.getWidth(),g=r.getHeight();for(let v=0;v<g-1;v++){const _=u[v];for(let C=0;C<m-1;C++){const M=_[C];M===_[C+1]&&M===u[v+1][C]&&M===u[v+1][C+1]&&l++}}return Ht.N2*l}static applyMaskPenaltyRule3(r){let l=0;const u=r.getArray(),m=r.getWidth(),g=r.getHeight();for(let v=0;v<g;v++)for(let _=0;_<m;_++){const C=u[v];_+6<m&&C[_]===1&&C[_+1]===0&&C[_+2]===1&&C[_+3]===1&&C[_+4]===1&&C[_+5]===0&&C[_+6]===1&&(Ht.isWhiteHorizontal(C,_-4,_)||Ht.isWhiteHorizontal(C,_+7,_+11))&&l++,v+6<g&&u[v][_]===1&&u[v+1][_]===0&&u[v+2][_]===1&&u[v+3][_]===1&&u[v+4][_]===1&&u[v+5][_]===0&&u[v+6][_]===1&&(Ht.isWhiteVertical(u,_,v-4,v)||Ht.isWhiteVertical(u,_,v+7,v+11))&&l++}return l*Ht.N3}static isWhiteHorizontal(r,l,u){l=Math.max(l,0),u=Math.min(u,r.length);for(let m=l;m<u;m++)if(r[m]===1)return!1;return!0}static isWhiteVertical(r,l,u,m){u=Math.max(u,0),m=Math.min(m,r.length);for(let g=u;g<m;g++)if(r[g][l]===1)return!1;return!0}static applyMaskPenaltyRule4(r){let l=0;const u=r.getArray(),m=r.getWidth(),g=r.getHeight();for(let C=0;C<g;C++){const M=u[C];for(let O=0;O<m;O++)M[O]===1&&l++}const v=r.getHeight()*r.getWidth();return Math.floor(Math.abs(l*2-v)*10/v)*Ht.N4}static getDataMaskBit(r,l,u){let m,g;switch(r){case 0:m=u+l&1;break;case 1:m=u&1;break;case 2:m=l%3;break;case 3:m=(u+l)%3;break;case 4:m=Math.floor(u/2)+Math.floor(l/3)&1;break;case 5:g=u*l,m=(g&1)+g%3;break;case 6:g=u*l,m=(g&1)+g%3&1;break;case 7:g=u*l,m=g%3+(u+l&1)&1;break;default:throw new N("Invalid mask pattern: "+r)}return m===0}static applyMaskPenaltyRule1Internal(r,l){let u=0;const m=l?r.getHeight():r.getWidth(),g=l?r.getWidth():r.getHeight(),v=r.getArray();for(let _=0;_<m;_++){let C=0,M=-1;for(let O=0;O<g;O++){const j=l?v[_][O]:v[O][_];j===M?C++:(C>=5&&(u+=Ht.N1+(C-5)),C=1,M=j)}C>=5&&(u+=Ht.N1+(C-5))}return u}}Ht.N1=3,Ht.N2=3,Ht.N3=40,Ht.N4=10;class Qr{constructor(r,l){this.width=r,this.height=l;const u=new Array(l);for(let m=0;m!==l;m++)u[m]=new Uint8Array(r);this.bytes=u}getHeight(){return this.height}getWidth(){return this.width}get(r,l){return this.bytes[l][r]}getArray(){return this.bytes}setNumber(r,l,u){this.bytes[l][r]=u}setBoolean(r,l,u){this.bytes[l][r]=u?1:0}clear(r){for(const l of this.bytes)le.fill(l,r)}equals(r){if(!(r instanceof Qr))return!1;const l=r;if(this.width!==l.width||this.height!==l.height)return!1;for(let u=0,m=this.height;u<m;++u){const g=this.bytes[u],v=l.bytes[u];for(let _=0,C=this.width;_<C;++_)if(g[_]!==v[_])return!1}return!0}toString(){const r=new z;for(let l=0,u=this.height;l<u;++l){const m=this.bytes[l];for(let g=0,v=this.width;g<v;++g)switch(m[g]){case 0:r.append(" 0");break;case 1:r.append(" 1");break;default:r.append("  ");break}r.append(`
`)}return r.toString()}}class Js{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const r=new z;return r.append(`<<
`),r.append(" mode: "),r.append(this.mode?this.mode.toString():"null"),r.append(`
 ecLevel: `),r.append(this.ecLevel?this.ecLevel.toString():"null"),r.append(`
 version: `),r.append(this.version?this.version.toString():"null"),r.append(`
 maskPattern: `),r.append(this.maskPattern.toString()),this.matrix?(r.append(`
 matrix:
`),r.append(this.matrix.toString())):r.append(`
 matrix: null
`),r.append(`>>
`),r.toString()}setMode(r){this.mode=r}setECLevel(r){this.ecLevel=r}setVersion(r){this.version=r}setMaskPattern(r){this.maskPattern=r}setMatrix(r){this.matrix=r}static isValidMaskPattern(r){return r>=0&&r<Js.NUM_MASK_PATTERNS}}Js.NUM_MASK_PATTERNS=8;class Yt extends x{}Yt.kind="WriterException";class E{constructor(){}static clearMatrix(r){r.clear(255)}static buildMatrix(r,l,u,m,g){E.clearMatrix(g),E.embedBasicPatterns(u,g),E.embedTypeInfo(l,m,g),E.maybeEmbedVersionInfo(u,g),E.embedDataBits(r,m,g)}static embedBasicPatterns(r,l){E.embedPositionDetectionPatternsAndSeparators(l),E.embedDarkDotAtLeftBottomCorner(l),E.maybeEmbedPositionAdjustmentPatterns(r,l),E.embedTimingPatterns(l)}static embedTypeInfo(r,l,u){const m=new de;E.makeTypeInfoBits(r,l,m);for(let g=0,v=m.getSize();g<v;++g){const _=m.get(m.getSize()-1-g),C=E.TYPE_INFO_COORDINATES[g],M=C[0],O=C[1];if(u.setBoolean(M,O,_),g<8){const j=u.getWidth()-g-1;u.setBoolean(j,8,_)}else{const G=u.getHeight()-7+(g-8);u.setBoolean(8,G,_)}}}static maybeEmbedVersionInfo(r,l){if(r.getVersionNumber()<7)return;const u=new de;E.makeVersionInfoBits(r,u);let m=17;for(let g=0;g<6;++g)for(let v=0;v<3;++v){const _=u.get(m);m--,l.setBoolean(g,l.getHeight()-11+v,_),l.setBoolean(l.getHeight()-11+v,g,_)}}static embedDataBits(r,l,u){let m=0,g=-1,v=u.getWidth()-1,_=u.getHeight()-1;for(;v>0;){for(v===6&&(v-=1);_>=0&&_<u.getHeight();){for(let C=0;C<2;++C){const M=v-C;if(!E.isEmpty(u.get(M,_)))continue;let O;m<r.getSize()?(O=r.get(m),++m):O=!1,l!==255&&Ht.getDataMaskBit(l,M,_)&&(O=!O),u.setBoolean(M,_,O)}_+=g}g=-g,_+=g,v-=2}if(m!==r.getSize())throw new Yt("Not all bits consumed: "+m+"/"+r.getSize())}static findMSBSet(r){return 32-ee.numberOfLeadingZeros(r)}static calculateBCHCode(r,l){if(l===0)throw new N("0 polynomial");const u=E.findMSBSet(l);for(r<<=u-1;E.findMSBSet(r)>=u;)r^=l<<E.findMSBSet(r)-u;return r}static makeTypeInfoBits(r,l,u){if(!Js.isValidMaskPattern(l))throw new Yt("Invalid mask pattern");const m=r.getBits()<<3|l;u.appendBits(m,5);const g=E.calculateBCHCode(m,E.TYPE_INFO_POLY);u.appendBits(g,10);const v=new de;if(v.appendBits(E.TYPE_INFO_MASK_PATTERN,15),u.xor(v),u.getSize()!==15)throw new Yt("should not happen but we got: "+u.getSize())}static makeVersionInfoBits(r,l){l.appendBits(r.getVersionNumber(),6);const u=E.calculateBCHCode(r.getVersionNumber(),E.VERSION_INFO_POLY);if(l.appendBits(u,12),l.getSize()!==18)throw new Yt("should not happen but we got: "+l.getSize())}static isEmpty(r){return r===255}static embedTimingPatterns(r){for(let l=8;l<r.getWidth()-8;++l){const u=(l+1)%2;E.isEmpty(r.get(l,6))&&r.setNumber(l,6,u),E.isEmpty(r.get(6,l))&&r.setNumber(6,l,u)}}static embedDarkDotAtLeftBottomCorner(r){if(r.get(8,r.getHeight()-8)===0)throw new Yt;r.setNumber(8,r.getHeight()-8,1)}static embedHorizontalSeparationPattern(r,l,u){for(let m=0;m<8;++m){if(!E.isEmpty(u.get(r+m,l)))throw new Yt;u.setNumber(r+m,l,0)}}static embedVerticalSeparationPattern(r,l,u){for(let m=0;m<7;++m){if(!E.isEmpty(u.get(r,l+m)))throw new Yt;u.setNumber(r,l+m,0)}}static embedPositionAdjustmentPattern(r,l,u){for(let m=0;m<5;++m){const g=E.POSITION_ADJUSTMENT_PATTERN[m];for(let v=0;v<5;++v)u.setNumber(r+v,l+m,g[v])}}static embedPositionDetectionPattern(r,l,u){for(let m=0;m<7;++m){const g=E.POSITION_DETECTION_PATTERN[m];for(let v=0;v<7;++v)u.setNumber(r+v,l+m,g[v])}}static embedPositionDetectionPatternsAndSeparators(r){const l=E.POSITION_DETECTION_PATTERN[0].length;E.embedPositionDetectionPattern(0,0,r),E.embedPositionDetectionPattern(r.getWidth()-l,0,r),E.embedPositionDetectionPattern(0,r.getWidth()-l,r);const u=8;E.embedHorizontalSeparationPattern(0,u-1,r),E.embedHorizontalSeparationPattern(r.getWidth()-u,u-1,r),E.embedHorizontalSeparationPattern(0,r.getWidth()-u,r);const m=7;E.embedVerticalSeparationPattern(m,0,r),E.embedVerticalSeparationPattern(r.getHeight()-m-1,0,r),E.embedVerticalSeparationPattern(m,r.getHeight()-m,r)}static maybeEmbedPositionAdjustmentPatterns(r,l){if(r.getVersionNumber()<2)return;const u=r.getVersionNumber()-1,m=E.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[u];for(let g=0,v=m.length;g!==v;g++){const _=m[g];if(_>=0)for(let C=0;C!==v;C++){const M=m[C];M>=0&&E.isEmpty(l.get(M,_))&&E.embedPositionAdjustmentPattern(M-2,_-2,l)}}}}E.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),E.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),E.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),E.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),E.VERSION_INFO_POLY=7973,E.TYPE_INFO_POLY=1335,E.TYPE_INFO_MASK_PATTERN=21522;class D{constructor(r,l){this.dataBytes=r,this.errorCorrectionBytes=l}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class L{constructor(){}static calculateMaskPenalty(r){return Ht.applyMaskPenaltyRule1(r)+Ht.applyMaskPenaltyRule2(r)+Ht.applyMaskPenaltyRule3(r)+Ht.applyMaskPenaltyRule4(r)}static encode(r,l,u=null){let m=L.DEFAULT_BYTE_MODE_ENCODING;const g=u!==null&&u.get(zn.CHARACTER_SET)!==void 0;g&&(m=u.get(zn.CHARACTER_SET).toString());const v=this.chooseMode(r,m),_=new de;if(v===ft.BYTE&&(g||L.DEFAULT_BYTE_MODE_ENCODING!==m)){const He=F.getCharacterSetECIByName(m);He!==void 0&&this.appendECI(He,_)}this.appendModeInfo(v,_);const C=new de;this.appendBytes(r,v,C,m);let M;if(u!==null&&u.get(zn.QR_VERSION)!==void 0){const He=Number.parseInt(u.get(zn.QR_VERSION).toString(),10);M=at.getVersionForNumber(He);const Fe=this.calculateBitsNeeded(v,_,C,M);if(!this.willFit(Fe,M,l))throw new Yt("Data too big for requested version")}else M=this.recommendVersion(l,v,_,C);const O=new de;O.appendBitArray(_);const j=v===ft.BYTE?C.getSizeInBytes():r.length;this.appendLengthInfo(j,M,v,O),O.appendBitArray(C);const G=M.getECBlocksForLevel(l),Z=M.getTotalCodewords()-G.getTotalECCodewords();this.terminateBits(Z,O);const re=this.interleaveWithECBytes(O,M.getTotalCodewords(),Z,G.getNumBlocks()),ce=new Js;ce.setECLevel(l),ce.setMode(v),ce.setVersion(M);const ye=M.getDimensionForVersion(),Ce=new Qr(ye,ye),qe=this.chooseMaskPattern(re,l,M,Ce);return ce.setMaskPattern(qe),E.buildMatrix(re,l,M,qe,Ce),ce.setMatrix(Ce),ce}static recommendVersion(r,l,u,m){const g=this.calculateBitsNeeded(l,u,m,at.getVersionForNumber(1)),v=this.chooseVersion(g,r),_=this.calculateBitsNeeded(l,u,m,v);return this.chooseVersion(_,r)}static calculateBitsNeeded(r,l,u,m){return l.getSize()+r.getCharacterCountBits(m)+u.getSize()}static getAlphanumericCode(r){return r<L.ALPHANUMERIC_TABLE.length?L.ALPHANUMERIC_TABLE[r]:-1}static chooseMode(r,l=null){if(F.SJIS.getName()===l&&this.isOnlyDoubleByteKanji(r))return ft.KANJI;let u=!1,m=!1;for(let g=0,v=r.length;g<v;++g){const _=r.charAt(g);if(L.isDigit(_))u=!0;else if(this.getAlphanumericCode(_.charCodeAt(0))!==-1)m=!0;else return ft.BYTE}return m?ft.ALPHANUMERIC:u?ft.NUMERIC:ft.BYTE}static isOnlyDoubleByteKanji(r){let l;try{l=Y.encode(r,F.SJIS)}catch{return!1}const u=l.length;if(u%2!==0)return!1;for(let m=0;m<u;m+=2){const g=l[m]&255;if((g<129||g>159)&&(g<224||g>235))return!1}return!0}static chooseMaskPattern(r,l,u,m){let g=Number.MAX_SAFE_INTEGER,v=-1;for(let _=0;_<Js.NUM_MASK_PATTERNS;_++){E.buildMatrix(r,l,u,_,m);let C=this.calculateMaskPenalty(m);C<g&&(g=C,v=_)}return v}static chooseVersion(r,l){for(let u=1;u<=40;u++){const m=at.getVersionForNumber(u);if(L.willFit(r,m,l))return m}throw new Yt("Data too big")}static willFit(r,l,u){const m=l.getTotalCodewords(),v=l.getECBlocksForLevel(u).getTotalECCodewords(),_=m-v,C=(r+7)/8;return _>=C}static terminateBits(r,l){const u=r*8;if(l.getSize()>u)throw new Yt("data bits cannot fit in the QR Code"+l.getSize()+" > "+u);for(let v=0;v<4&&l.getSize()<u;++v)l.appendBit(!1);const m=l.getSize()&7;if(m>0)for(let v=m;v<8;v++)l.appendBit(!1);const g=r-l.getSizeInBytes();for(let v=0;v<g;++v)l.appendBits((v&1)===0?236:17,8);if(l.getSize()!==u)throw new Yt("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(r,l,u,m,g,v){if(m>=u)throw new Yt("Block ID too large");const _=r%u,C=u-_,M=Math.floor(r/u),O=M+1,j=Math.floor(l/u),G=j+1,Z=M-j,re=O-G;if(Z!==re)throw new Yt("EC bytes mismatch");if(u!==C+_)throw new Yt("RS blocks mismatch");if(r!==(j+Z)*C+(G+re)*_)throw new Yt("Total bytes mismatch");m<C?(g[0]=j,v[0]=Z):(g[0]=G,v[0]=re)}static interleaveWithECBytes(r,l,u,m){if(r.getSizeInBytes()!==u)throw new Yt("Number of bits and data bytes does not match");let g=0,v=0,_=0;const C=new Array;for(let O=0;O<m;++O){const j=new Int32Array(1),G=new Int32Array(1);L.getNumDataBytesAndNumECBytesForBlockID(l,u,m,O,j,G);const Z=j[0],re=new Uint8Array(Z);r.toBytes(8*g,re,0,Z);const ce=L.generateECBytes(re,G[0]);C.push(new D(re,ce)),v=Math.max(v,Z),_=Math.max(_,ce.length),g+=j[0]}if(u!==g)throw new Yt("Data bytes does not match offset");const M=new de;for(let O=0;O<v;++O)for(const j of C){const G=j.getDataBytes();O<G.length&&M.appendBits(G[O],8)}for(let O=0;O<_;++O)for(const j of C){const G=j.getErrorCorrectionBytes();O<G.length&&M.appendBits(G[O],8)}if(l!==M.getSizeInBytes())throw new Yt("Interleaving error: "+l+" and "+M.getSizeInBytes()+" differ.");return M}static generateECBytes(r,l){const u=r.length,m=new Int32Array(u+l);for(let v=0;v<u;v++)m[v]=r[v]&255;new $s(St.QR_CODE_FIELD_256).encode(m,l);const g=new Uint8Array(l);for(let v=0;v<l;v++)g[v]=m[u+v];return g}static appendModeInfo(r,l){l.appendBits(r.getBits(),4)}static appendLengthInfo(r,l,u,m){const g=u.getCharacterCountBits(l);if(r>=1<<g)throw new Yt(r+" is bigger than "+((1<<g)-1));m.appendBits(r,g)}static appendBytes(r,l,u,m){switch(l){case ft.NUMERIC:L.appendNumericBytes(r,u);break;case ft.ALPHANUMERIC:L.appendAlphanumericBytes(r,u);break;case ft.BYTE:L.append8BitBytes(r,u,m);break;case ft.KANJI:L.appendKanjiBytes(r,u);break;default:throw new Yt("Invalid mode: "+l)}}static getDigit(r){return r.charCodeAt(0)-48}static isDigit(r){const l=L.getDigit(r);return l>=0&&l<=9}static appendNumericBytes(r,l){const u=r.length;let m=0;for(;m<u;){const g=L.getDigit(r.charAt(m));if(m+2<u){const v=L.getDigit(r.charAt(m+1)),_=L.getDigit(r.charAt(m+2));l.appendBits(g*100+v*10+_,10),m+=3}else if(m+1<u){const v=L.getDigit(r.charAt(m+1));l.appendBits(g*10+v,7),m+=2}else l.appendBits(g,4),m++}}static appendAlphanumericBytes(r,l){const u=r.length;let m=0;for(;m<u;){const g=L.getAlphanumericCode(r.charCodeAt(m));if(g===-1)throw new Yt;if(m+1<u){const v=L.getAlphanumericCode(r.charCodeAt(m+1));if(v===-1)throw new Yt;l.appendBits(g*45+v,11),m+=2}else l.appendBits(g,6),m++}}static append8BitBytes(r,l,u){let m;try{m=Y.encode(r,u)}catch(g){throw new Yt(g)}for(let g=0,v=m.length;g!==v;g++){const _=m[g];l.appendBits(_,8)}}static appendKanjiBytes(r,l){let u;try{u=Y.encode(r,F.SJIS)}catch(g){throw new Yt(g)}const m=u.length;for(let g=0;g<m;g+=2){const v=u[g]&255,_=u[g+1]&255,C=v<<8&4294967295|_;let M=-1;if(C>=33088&&C<=40956?M=C-33088:C>=57408&&C<=60351&&(M=C-49472),M===-1)throw new Yt("Invalid byte sequence");const O=(M>>8)*192+(M&255);l.appendBits(O,13)}}static appendECI(r,l){l.appendBits(ft.ECI.getBits(),4),l.appendBits(r.getValue(),8)}}L.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),L.DEFAULT_BYTE_MODE_ENCODING=F.UTF8.getName();class X{write(r,l,u,m=null){if(r.length===0)throw new N("Found empty contents");if(l<0||u<0)throw new N("Requested dimensions are too small: "+l+"x"+u);let g=Ut.L,v=X.QUIET_ZONE_SIZE;m!==null&&(m.get(zn.ERROR_CORRECTION)!==void 0&&(g=Ut.fromString(m.get(zn.ERROR_CORRECTION).toString())),m.get(zn.MARGIN)!==void 0&&(v=Number.parseInt(m.get(zn.MARGIN).toString(),10)));const _=L.encode(r,g,m);return this.renderResult(_,l,u,v)}writeToDom(r,l,u,m,g=null){typeof r=="string"&&(r=document.querySelector(r));const v=this.write(l,u,m,g);r&&r.appendChild(v)}renderResult(r,l,u,m){const g=r.getMatrix();if(g===null)throw new De;const v=g.getWidth(),_=g.getHeight(),C=v+m*2,M=_+m*2,O=Math.max(l,C),j=Math.max(u,M),G=Math.min(Math.floor(O/C),Math.floor(j/M)),Z=Math.floor((O-v*G)/2),re=Math.floor((j-_*G)/2),ce=this.createSVGElement(O,j);for(let ye=0,Ce=re;ye<_;ye++,Ce+=G)for(let qe=0,He=Z;qe<v;qe++,He+=G)if(g.get(qe,ye)===1){const Fe=this.createSvgRectElement(He,Ce,G,G);ce.appendChild(Fe)}return ce}createSVGElement(r,l){const u=document.createElementNS(X.SVG_NS,"svg");return u.setAttributeNS(null,"height",r.toString()),u.setAttributeNS(null,"width",l.toString()),u}createSvgRectElement(r,l,u,m){const g=document.createElementNS(X.SVG_NS,"rect");return g.setAttributeNS(null,"x",r.toString()),g.setAttributeNS(null,"y",l.toString()),g.setAttributeNS(null,"height",u.toString()),g.setAttributeNS(null,"width",m.toString()),g.setAttributeNS(null,"fill","#000000"),g}}X.QUIET_ZONE_SIZE=4,X.SVG_NS="http://www.w3.org/2000/svg";class xe{encode(r,l,u,m,g){if(r.length===0)throw new N("Found empty contents");if(l!==pe.QR_CODE)throw new N("Can only encode QR_CODE, but got "+l);if(u<0||m<0)throw new N(`Requested dimensions are too small: ${u}x${m}`);let v=Ut.L,_=xe.QUIET_ZONE_SIZE;g!==null&&(g.get(zn.ERROR_CORRECTION)!==void 0&&(v=Ut.fromString(g.get(zn.ERROR_CORRECTION).toString())),g.get(zn.MARGIN)!==void 0&&(_=Number.parseInt(g.get(zn.MARGIN).toString(),10)));const C=L.encode(r,v,g);return xe.renderResult(C,u,m,_)}static renderResult(r,l,u,m){const g=r.getMatrix();if(g===null)throw new De;const v=g.getWidth(),_=g.getHeight(),C=v+m*2,M=_+m*2,O=Math.max(l,C),j=Math.max(u,M),G=Math.min(Math.floor(O/C),Math.floor(j/M)),Z=Math.floor((O-v*G)/2),re=Math.floor((j-_*G)/2),ce=new _e(O,j);for(let ye=0,Ce=re;ye<_;ye++,Ce+=G)for(let qe=0,He=Z;qe<v;qe++,He+=G)g.get(qe,ye)===1&&ce.setRegion(He,Ce,G,G);return ce}}xe.QUIET_ZONE_SIZE=4;class Ne{encode(r,l,u,m,g){let v;switch(l){case pe.QR_CODE:v=new xe;break;default:throw new N("No encoder available for format "+l)}return v.encode(r,l,u,m,g)}}class Ye extends Me{constructor(r,l,u,m,g,v,_,C){if(super(v,_),this.yuvData=r,this.dataWidth=l,this.dataHeight=u,this.left=m,this.top=g,m+v>l||g+_>u)throw new N("Crop rectangle does not fit within image data.");C&&this.reverseHorizontal(v,_)}getRow(r,l){if(r<0||r>=this.getHeight())throw new N("Requested row is outside the image: "+r);const u=this.getWidth();(l==null||l.length<u)&&(l=new Uint8ClampedArray(u));const m=(r+this.top)*this.dataWidth+this.left;return W.arraycopy(this.yuvData,m,l,0,u),l}getMatrix(){const r=this.getWidth(),l=this.getHeight();if(r===this.dataWidth&&l===this.dataHeight)return this.yuvData;const u=r*l,m=new Uint8ClampedArray(u);let g=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return W.arraycopy(this.yuvData,g,m,0,u),m;for(let v=0;v<l;v++){const _=v*r;W.arraycopy(this.yuvData,g,m,_,r),g+=this.dataWidth}return m}isCropSupported(){return!0}crop(r,l,u,m){return new Ye(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+l,u,m,!1)}renderThumbnail(){const r=this.getWidth()/Ye.THUMBNAIL_SCALE_FACTOR,l=this.getHeight()/Ye.THUMBNAIL_SCALE_FACTOR,u=new Int32Array(r*l),m=this.yuvData;let g=this.top*this.dataWidth+this.left;for(let v=0;v<l;v++){const _=v*r;for(let C=0;C<r;C++){const M=m[g+C*Ye.THUMBNAIL_SCALE_FACTOR]&255;u[_+C]=4278190080|M*65793}g+=this.dataWidth*Ye.THUMBNAIL_SCALE_FACTOR}return u}getThumbnailWidth(){return this.getWidth()/Ye.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Ye.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(r,l){const u=this.yuvData;for(let m=0,g=this.top*this.dataWidth+this.left;m<l;m++,g+=this.dataWidth){const v=g+r/2;for(let _=g,C=g+r-1;_<v;_++,C--){const M=u[_];u[_]=u[C],u[C]=M}}}invert(){return new ze(this)}}Ye.THUMBNAIL_SCALE_FACTOR=2;class Ct extends Me{constructor(r,l,u,m,g,v,_){if(super(l,u),this.dataWidth=m,this.dataHeight=g,this.left=v,this.top=_,r.BYTES_PER_ELEMENT===4){const C=l*u,M=new Uint8ClampedArray(C);for(let O=0;O<C;O++){const j=r[O],G=j>>16&255,Z=j>>7&510,re=j&255;M[O]=(G+Z+re)/4&255}this.luminances=M}else this.luminances=r;if(m===void 0&&(this.dataWidth=l),g===void 0&&(this.dataHeight=u),v===void 0&&(this.left=0),_===void 0&&(this.top=0),this.left+l>this.dataWidth||this.top+u>this.dataHeight)throw new N("Crop rectangle does not fit within image data.")}getRow(r,l){if(r<0||r>=this.getHeight())throw new N("Requested row is outside the image: "+r);const u=this.getWidth();(l==null||l.length<u)&&(l=new Uint8ClampedArray(u));const m=(r+this.top)*this.dataWidth+this.left;return W.arraycopy(this.luminances,m,l,0,u),l}getMatrix(){const r=this.getWidth(),l=this.getHeight();if(r===this.dataWidth&&l===this.dataHeight)return this.luminances;const u=r*l,m=new Uint8ClampedArray(u);let g=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return W.arraycopy(this.luminances,g,m,0,u),m;for(let v=0;v<l;v++){const _=v*r;W.arraycopy(this.luminances,g,m,_,r),g+=this.dataWidth}return m}isCropSupported(){return!0}crop(r,l,u,m){return new Ct(this.luminances,u,m,this.dataWidth,this.dataHeight,this.left+r,this.top+l)}invert(){return new ze(this)}}class qn extends F{static forName(r){return this.getCharacterSetECIByName(r)}}class en{}en.ISO_8859_1=F.ISO8859_1;class In{isCompact(){return this.compact}setCompact(r){this.compact=r}getSize(){return this.size}setSize(r){this.size=r}getLayers(){return this.layers}setLayers(r){this.layers=r}getCodeWords(){return this.codeWords}setCodeWords(r){this.codeWords=r}getMatrix(){return this.matrix}setMatrix(r){this.matrix=r}}class as{static singletonList(r){return[r]}static min(r,l){return r.sort(l)[0]}}class Qs{constructor(r){this.previous=r}getPrevious(){return this.previous}}class Si extends Qs{constructor(r,l,u){super(r),this.value=l,this.bitCount=u}appendTo(r,l){r.appendBits(this.value,this.bitCount)}add(r,l){return new Si(this,r,l)}addBinaryShift(r,l){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Si(this,r,l)}toString(){let r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+ee.toBinaryString(r|1<<this.bitCount).substring(1)+">"}}class ls extends Si{constructor(r,l,u){super(r,0,0),this.binaryShiftStart=l,this.binaryShiftByteCount=u}appendTo(r,l){for(let u=0;u<this.binaryShiftByteCount;u++)(u===0||u===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):u===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(l[this.binaryShiftStart+u],8)}addBinaryShift(r,l){return new ls(this,r,l)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Zr(B,r,l){return new ls(B,r,l)}function Zs(B,r,l){return new Si(B,r,l)}const Fo=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Rr=0,pl=1,ws=2,Sc=3,ks=4,Ua=new Si(null,0,0),eo=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function xf(B){for(let r of B)le.fill(r,-1);return B[Rr][ks]=0,B[pl][ks]=0,B[pl][Rr]=28,B[Sc][ks]=0,B[ws][ks]=0,B[ws][Rr]=15,B}const Ba=xf(le.createInt32Array(6,6));class Ps{constructor(r,l,u,m){this.token=r,this.mode=l,this.binaryShiftByteCount=u,this.bitCount=m}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(r,l){let u=this.bitCount,m=this.token;if(r!==this.mode){let v=eo[this.mode][r];m=Zs(m,v&65535,v>>16),u+=v>>16}let g=r===ws?4:5;return m=Zs(m,l,g),new Ps(m,r,0,u+g)}shiftAndAppend(r,l){let u=this.token,m=this.mode===ws?4:5;return u=Zs(u,Ba[this.mode][r],m),u=Zs(u,l,5),new Ps(u,this.mode,0,this.bitCount+m+5)}addBinaryShiftChar(r){let l=this.token,u=this.mode,m=this.bitCount;if(this.mode===ks||this.mode===ws){let _=eo[u][Rr];l=Zs(l,_&65535,_>>16),m+=_>>16,u=Rr}let g=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,v=new Ps(l,u,this.binaryShiftByteCount+1,m+g);return v.binaryShiftByteCount===2078&&(v=v.endBinaryShift(r+1)),v}endBinaryShift(r){if(this.binaryShiftByteCount===0)return this;let l=this.token;return l=Zr(l,r-this.binaryShiftByteCount,this.binaryShiftByteCount),new Ps(l,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(r){let l=this.bitCount+(eo[this.mode][r.mode]>>16);return this.binaryShiftByteCount<r.binaryShiftByteCount?l+=Ps.calculateBinaryShiftCost(r)-Ps.calculateBinaryShiftCost(this):this.binaryShiftByteCount>r.binaryShiftByteCount&&r.binaryShiftByteCount>0&&(l+=10),l<=r.bitCount}toBitArray(r){let l=[];for(let m=this.endBinaryShift(r.length).token;m!==null;m=m.getPrevious())l.unshift(m);let u=new de;for(const m of l)m.appendTo(u,r);return u}toString(){return $.format("%s bits=%d bytes=%d",Fo[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(r){return r.binaryShiftByteCount>62?21:r.binaryShiftByteCount>31?20:r.binaryShiftByteCount>0?10:0}}Ps.INITIAL_STATE=new Ps(Ua,Rr,0,0);function Yu(B){const r=$.getCharCode(" "),l=$.getCharCode("."),u=$.getCharCode(",");B[Rr][r]=1;const m=$.getCharCode("Z"),g=$.getCharCode("A");for(let G=g;G<=m;G++)B[Rr][G]=G-g+2;B[pl][r]=1;const v=$.getCharCode("z"),_=$.getCharCode("a");for(let G=_;G<=v;G++)B[pl][G]=G-_+2;B[ws][r]=1;const C=$.getCharCode("9"),M=$.getCharCode("0");for(let G=M;G<=C;G++)B[ws][G]=G-M+2;B[ws][u]=12,B[ws][l]=13;const O=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let G=0;G<O.length;G++)B[Sc][$.getCharCode(O[G])]=G;const j=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let G=0;G<j.length;G++)$.getCharCode(j[G])>0&&(B[ks][$.getCharCode(j[G])]=G);return B}const Fa=Yu(le.createInt32Array(5,256));class to{constructor(r){this.text=r}encode(){const r=$.getCharCode(" "),l=$.getCharCode(`
`);let u=as.singletonList(Ps.INITIAL_STATE);for(let g=0;g<this.text.length;g++){let v,_=g+1<this.text.length?this.text[g+1]:0;switch(this.text[g]){case $.getCharCode("\r"):v=_===l?2:0;break;case $.getCharCode("."):v=_===r?3:0;break;case $.getCharCode(","):v=_===r?4:0;break;case $.getCharCode(":"):v=_===r?5:0;break;default:v=0}v>0?(u=to.updateStateListForPair(u,g,v),g++):u=this.updateStateListForChar(u,g)}return as.min(u,(g,v)=>g.getBitCount()-v.getBitCount()).toBitArray(this.text)}updateStateListForChar(r,l){const u=[];for(let m of r)this.updateStateForChar(m,l,u);return to.simplifyStates(u)}updateStateForChar(r,l,u){let m=this.text[l]&255,g=Fa[r.getMode()][m]>0,v=null;for(let _=0;_<=ks;_++){let C=Fa[_][m];if(C>0){if(v==null&&(v=r.endBinaryShift(l)),!g||_===r.getMode()||_===ws){const M=v.latchAndAppend(_,C);u.push(M)}if(!g&&Ba[r.getMode()][_]>=0){const M=v.shiftAndAppend(_,C);u.push(M)}}}if(r.getBinaryShiftByteCount()>0||Fa[r.getMode()][m]===0){let _=r.addBinaryShiftChar(l);u.push(_)}}static updateStateListForPair(r,l,u){const m=[];for(let g of r)this.updateStateForPair(g,l,u,m);return this.simplifyStates(m)}static updateStateForPair(r,l,u,m){let g=r.endBinaryShift(l);if(m.push(g.latchAndAppend(ks,u)),r.getMode()!==ks&&m.push(g.shiftAndAppend(ks,u)),u===3||u===4){let v=g.latchAndAppend(ws,16-u).latchAndAppend(ws,1);m.push(v)}if(r.getBinaryShiftByteCount()>0){let v=r.addBinaryShiftChar(l).addBinaryShiftChar(l+1);m.push(v)}}static simplifyStates(r){let l=[];for(const u of r){let m=!0;for(const g of l){if(g.isBetterThanOrEqualTo(u)){m=!1;break}u.isBetterThanOrEqualTo(g)&&(l=l.filter(v=>v!==g))}m&&l.push(u)}return l}}class $t{constructor(){}static encodeBytes(r){return $t.encode(r,$t.DEFAULT_EC_PERCENT,$t.DEFAULT_AZTEC_LAYERS)}static encode(r,l,u){let m=new to(r).encode(),g=ee.truncDivision(m.getSize()*l,100)+11,v=m.getSize()+g,_,C,M,O,j;if(u!==$t.DEFAULT_AZTEC_LAYERS){if(_=u<0,C=Math.abs(u),C>(_?$t.MAX_NB_BITS_COMPACT:$t.MAX_NB_BITS))throw new N($.format("Illegal value %s for layers",u));M=$t.totalBitsInLayer(C,_),O=$t.WORD_SIZE[C];let Fe=M-M%O;if(j=$t.stuffBits(m,O),j.getSize()+g>Fe)throw new N("Data to large for user specified layer");if(_&&j.getSize()>O*64)throw new N("Data to large for user specified layer")}else{O=0,j=null;for(let Fe=0;;Fe++){if(Fe>$t.MAX_NB_BITS)throw new N("Data too large for an Aztec code");if(_=Fe<=3,C=_?Fe+1:Fe,M=$t.totalBitsInLayer(C,_),v>M)continue;(j==null||O!==$t.WORD_SIZE[C])&&(O=$t.WORD_SIZE[C],j=$t.stuffBits(m,O));let jt=M-M%O;if(!(_&&j.getSize()>O*64)&&j.getSize()+g<=jt)break}}let G=$t.generateCheckWords(j,M,O),Z=j.getSize()/O,re=$t.generateModeMessage(_,C,Z),ce=(_?11:14)+C*4,ye=new Int32Array(ce),Ce;if(_){Ce=ce;for(let Fe=0;Fe<ye.length;Fe++)ye[Fe]=Fe}else{Ce=ce+1+2*ee.truncDivision(ee.truncDivision(ce,2)-1,15);let Fe=ee.truncDivision(ce,2),jt=ee.truncDivision(Ce,2);for(let Nt=0;Nt<Fe;Nt++){let Zn=Nt+ee.truncDivision(Nt,15);ye[Fe-Nt-1]=jt-Zn-1,ye[Fe+Nt]=jt+Zn+1}}let qe=new _e(Ce);for(let Fe=0,jt=0;Fe<C;Fe++){let Nt=(C-Fe)*4+(_?9:12);for(let Zn=0;Zn<Nt;Zn++){let bs=Zn*2;for(let Ui=0;Ui<2;Ui++)G.get(jt+bs+Ui)&&qe.set(ye[Fe*2+Ui],ye[Fe*2+Zn]),G.get(jt+Nt*2+bs+Ui)&&qe.set(ye[Fe*2+Zn],ye[ce-1-Fe*2-Ui]),G.get(jt+Nt*4+bs+Ui)&&qe.set(ye[ce-1-Fe*2-Ui],ye[ce-1-Fe*2-Zn]),G.get(jt+Nt*6+bs+Ui)&&qe.set(ye[ce-1-Fe*2-Zn],ye[Fe*2+Ui])}jt+=Nt*8}if($t.drawModeMessage(qe,_,Ce,re),_)$t.drawBullsEye(qe,ee.truncDivision(Ce,2),5);else{$t.drawBullsEye(qe,ee.truncDivision(Ce,2),7);for(let Fe=0,jt=0;Fe<ee.truncDivision(ce,2)-1;Fe+=15,jt+=16)for(let Nt=ee.truncDivision(Ce,2)&1;Nt<Ce;Nt+=2)qe.set(ee.truncDivision(Ce,2)-jt,Nt),qe.set(ee.truncDivision(Ce,2)+jt,Nt),qe.set(Nt,ee.truncDivision(Ce,2)-jt),qe.set(Nt,ee.truncDivision(Ce,2)+jt)}let He=new In;return He.setCompact(_),He.setSize(Ce),He.setLayers(C),He.setCodeWords(Z),He.setMatrix(qe),He}static drawBullsEye(r,l,u){for(let m=0;m<u;m+=2)for(let g=l-m;g<=l+m;g++)r.set(g,l-m),r.set(g,l+m),r.set(l-m,g),r.set(l+m,g);r.set(l-u,l-u),r.set(l-u+1,l-u),r.set(l-u,l-u+1),r.set(l+u,l-u),r.set(l+u,l-u+1),r.set(l+u,l+u-1)}static generateModeMessage(r,l,u){let m=new de;return r?(m.appendBits(l-1,2),m.appendBits(u-1,6),m=$t.generateCheckWords(m,28,4)):(m.appendBits(l-1,5),m.appendBits(u-1,11),m=$t.generateCheckWords(m,40,4)),m}static drawModeMessage(r,l,u,m){let g=ee.truncDivision(u,2);if(l)for(let v=0;v<7;v++){let _=g-3+v;m.get(v)&&r.set(_,g-5),m.get(v+7)&&r.set(g+5,_),m.get(20-v)&&r.set(_,g+5),m.get(27-v)&&r.set(g-5,_)}else for(let v=0;v<10;v++){let _=g-5+v+ee.truncDivision(v,5);m.get(v)&&r.set(_,g-7),m.get(v+10)&&r.set(g+7,_),m.get(29-v)&&r.set(_,g+7),m.get(39-v)&&r.set(g-7,_)}}static generateCheckWords(r,l,u){let m=r.getSize()/u,g=new $s($t.getGF(u)),v=ee.truncDivision(l,u),_=$t.bitsToWords(r,u,v);g.encode(_,v-m);let C=l%u,M=new de;M.appendBits(0,C);for(const O of Array.from(_))M.appendBits(O,u);return M}static bitsToWords(r,l,u){let m=new Int32Array(u),g,v;for(g=0,v=r.getSize()/l;g<v;g++){let _=0;for(let C=0;C<l;C++)_|=r.get(g*l+C)?1<<l-C-1:0;m[g]=_}return m}static getGF(r){switch(r){case 4:return St.AZTEC_PARAM;case 6:return St.AZTEC_DATA_6;case 8:return St.AZTEC_DATA_8;case 10:return St.AZTEC_DATA_10;case 12:return St.AZTEC_DATA_12;default:throw new N("Unsupported word size "+r)}}static stuffBits(r,l){let u=new de,m=r.getSize(),g=(1<<l)-2;for(let v=0;v<m;v+=l){let _=0;for(let C=0;C<l;C++)(v+C>=m||r.get(v+C))&&(_|=1<<l-1-C);(_&g)===g?(u.appendBits(_&g,l),v--):(_&g)===0?(u.appendBits(_|1,l),v--):u.appendBits(_,l)}return u}static totalBitsInLayer(r,l){return((l?88:112)+16*r)*r}}$t.DEFAULT_EC_PERCENT=33,$t.DEFAULT_AZTEC_LAYERS=0,$t.MAX_NB_BITS=32,$t.MAX_NB_BITS_COMPACT=4,$t.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class ja{encode(r,l,u,m){return this.encodeWithHints(r,l,u,m,null)}encodeWithHints(r,l,u,m,g){let v=en.ISO_8859_1,_=$t.DEFAULT_EC_PERCENT,C=$t.DEFAULT_AZTEC_LAYERS;return g!=null&&(g.has(zn.CHARACTER_SET)&&(v=qn.forName(g.get(zn.CHARACTER_SET).toString())),g.has(zn.ERROR_CORRECTION)&&(_=ee.parseInt(g.get(zn.ERROR_CORRECTION).toString())),g.has(zn.AZTEC_LAYERS)&&(C=ee.parseInt(g.get(zn.AZTEC_LAYERS).toString()))),ja.encodeLayers(r,l,u,m,v,_,C)}static encodeLayers(r,l,u,m,g,v,_){if(l!==pe.AZTEC)throw new N("Can only encode AZTEC, but got "+l);let C=$t.encode($.getBytes(r,g),v,_);return ja.renderResult(C,u,m)}static renderResult(r,l,u){let m=r.getMatrix();if(m==null)throw new De;let g=m.getWidth(),v=m.getHeight(),_=Math.max(l,g),C=Math.max(u,v),M=Math.min(_/g,C/v),O=(_-g*M)/2,j=(C-v*M)/2,G=new _e(_,C);for(let Z=0,re=j;Z<v;Z++,re+=M)for(let ce=0,ye=O;ce<g;ce++,ye+=M)m.get(ce,Z)&&G.setRegion(ye,re,M,M);return G}}t.AbstractExpandedDecoder=jn,t.ArgumentException=A,t.ArithmeticException=Dn,t.AztecCode=In,t.AztecCodeReader=Tr,t.AztecCodeWriter=ja,t.AztecDecoder=Qe,t.AztecDetector=Do,t.AztecDetectorResult=Mo,t.AztecEncoder=$t,t.AztecHighLevelEncoder=to,t.AztecPoint=ci,t.BarcodeFormat=pe,t.Binarizer=H,t.BinaryBitmap=R,t.BitArray=de,t.BitMatrix=_e,t.BitSource=Gn,t.BrowserAztecCodeReader=Ma,t.BrowserBarcodeReader=Oa,t.BrowserCodeReader=Ae,t.BrowserDatamatrixCodeReader=Ws,t.BrowserMultiFormatReader=Ks,t.BrowserPDF417Reader=ml,t.BrowserQRCodeReader=gl,t.BrowserQRCodeSvgWriter=X,t.CharacterSetECI=F,t.ChecksumException=k,t.Code128Reader=Ge,t.Code39Reader=ln,t.DataMatrixDecodedBitStreamParser=Li,t.DataMatrixReader=Yi,t.DecodeHintType=me,t.DecoderResult=it,t.DefaultGridSampler=Hr,t.DetectorResult=Gr,t.EAN13Reader=At,t.EncodeHintType=zn,t.Exception=x,t.FormatException=U,t.GenericGF=St,t.GenericGFPoly=kt,t.GlobalHistogramBinarizer=ne,t.GridSampler=qs,t.GridSamplerInstance=_i,t.HTMLCanvasElementLuminanceSource=ct,t.HybridBinarizer=ie,t.ITFReader=_t,t.IllegalArgumentException=N,t.IllegalStateException=De,t.InvertedLuminanceSource=ze,t.LuminanceSource=Me,t.MathUtils=nt,t.MultiFormatOneDReader=ki,t.MultiFormatReader=La,t.MultiFormatWriter=Ne,t.NotFoundException=he,t.OneDReader=an,t.PDF417DecodedBitStreamParser=Se,t.PDF417DecoderErrorCorrection=Rs,t.PDF417Reader=Hn,t.PDF417ResultMetadata=fr,t.PerspectiveTransform=Ei,t.PlanarYUVLuminanceSource=Ye,t.QRCodeByteMatrix=Qr,t.QRCodeDataMask=si,t.QRCodeDecodedBitStreamParser=vn,t.QRCodeDecoderErrorCorrectionLevel=Ut,t.QRCodeDecoderFormatInformation=Wn,t.QRCodeEncoder=L,t.QRCodeEncoderQRCode=Js,t.QRCodeMaskUtil=Ht,t.QRCodeMatrixUtil=E,t.QRCodeMode=ft,t.QRCodeReader=$i,t.QRCodeVersion=at,t.QRCodeWriter=xe,t.RGBLuminanceSource=Ct,t.RSS14Reader=un,t.RSSExpandedReader=Le,t.ReaderException=Jr,t.ReedSolomonDecoder=ot,t.ReedSolomonEncoder=$s,t.ReedSolomonException=Pn,t.Result=je,t.ResultMetadataType=Ke,t.ResultPoint=Ze,t.StringUtils=$,t.UnsupportedOperationException=Q,t.VideoInputDevice=ae,t.WhiteRectangleDetector=On,t.WriterException=Yt,t.ZXingArrays=le,t.ZXingCharset=qn,t.ZXingInteger=ee,t.ZXingStandardCharsets=en,t.ZXingStringBuilder=z,t.ZXingStringEncoding=Y,t.ZXingSystem=W,t.createAbstractExpandedDecoder=qi,Object.defineProperty(t,"__esModule",{value:!0})}))})(du,du.exports)),du.exports}var Fn=jM();const VM=wg(Fn),GM=DA({__proto__:null,default:VM},[Fn]);var Sw=(function(){function n(e,t,i){if(this.formatMap=new Map([[tt.QR_CODE,Fn.BarcodeFormat.QR_CODE],[tt.AZTEC,Fn.BarcodeFormat.AZTEC],[tt.CODABAR,Fn.BarcodeFormat.CODABAR],[tt.CODE_39,Fn.BarcodeFormat.CODE_39],[tt.CODE_93,Fn.BarcodeFormat.CODE_93],[tt.CODE_128,Fn.BarcodeFormat.CODE_128],[tt.DATA_MATRIX,Fn.BarcodeFormat.DATA_MATRIX],[tt.MAXICODE,Fn.BarcodeFormat.MAXICODE],[tt.ITF,Fn.BarcodeFormat.ITF],[tt.EAN_13,Fn.BarcodeFormat.EAN_13],[tt.EAN_8,Fn.BarcodeFormat.EAN_8],[tt.PDF_417,Fn.BarcodeFormat.PDF_417],[tt.RSS_14,Fn.BarcodeFormat.RSS_14],[tt.RSS_EXPANDED,Fn.BarcodeFormat.RSS_EXPANDED],[tt.UPC_A,Fn.BarcodeFormat.UPC_A],[tt.UPC_E,Fn.BarcodeFormat.UPC_E],[tt.UPC_EAN_EXTENSION,Fn.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!GM)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=t,this.logger=i;var o=this.createZXingFormats(e),c=new Map;c.set(Fn.DecodeHintType.POSSIBLE_FORMATS,o),c.set(Fn.DecodeHintType.TRY_HARDER,!1),this.hints=c}return n.prototype.decodeAsync=function(e){var t=this;return new Promise(function(i,o){try{i(t.decode(e))}catch(c){o(c)}})},n.prototype.decode=function(e){var t=new Fn.MultiFormatReader(this.verbose,this.hints),i=new Fn.HTMLCanvasElementLuminanceSource(e),o=new Fn.BinaryBitmap(new Fn.HybridBinarizer(i)),c=t.decode(o);return{text:c.text,format:l2.create(this.toHtml5QrcodeSupportedFormats(c.format)),debugData:this.createDebugData()}},n.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,i,o){e.set(t,i)}),e},n.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},n.prototype.createZXingFormats=function(e){for(var t=[],i=0,o=e;i<o.length;i++){var c=o[i];this.formatMap.has(c)?t.push(this.formatMap.get(c)):this.logger.logError("".concat(c," is not supported by")+"ZXingHtml5QrcodeShim")}return t},n.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},n})(),HM=function(n,e,t,i){function o(c){return c instanceof t?c:new t(function(f){f(c)})}return new(t||(t=Promise))(function(c,f){function y(A){try{x(i.next(A))}catch(N){f(N)}}function w(A){try{x(i.throw(A))}catch(N){f(N)}}function x(A){A.done?c(A.value):o(A.value).then(y,w)}x((i=i.apply(n,e||[])).next())})},zM=function(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,f;return f={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function y(x){return function(A){return w([x,A])}}function w(x){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(t=0)),t;)try{if(i=1,o&&(c=x[0]&2?o.return:x[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,x[1])).done)return c;switch(o=0,c&&(x=[x[0]&2,c.value]),x[0]){case 0:case 1:c=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,o=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!c||x[1]>c[0]&&x[1]<c[3])){t.label=x[1];break}if(x[0]===6&&t.label<c[1]){t.label=c[1],c=x;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(x);break}c[2]&&t.ops.pop(),t.trys.pop();continue}x=e.call(n,t)}catch(A){x=[6,A],o=0}finally{i=c=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},Cw=(function(){function n(e,t,i){if(this.formatMap=new Map([[tt.QR_CODE,"qr_code"],[tt.AZTEC,"aztec"],[tt.CODABAR,"codabar"],[tt.CODE_39,"code_39"],[tt.CODE_93,"code_93"],[tt.CODE_128,"code_128"],[tt.DATA_MATRIX,"data_matrix"],[tt.ITF,"itf"],[tt.EAN_13,"ean_13"],[tt.EAN_8,"ean_8"],[tt.PDF_417,"pdf417"],[tt.UPC_A,"upc_a"],[tt.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!n.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=t,this.logger=i;var o=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(o),!this.detector)throw"BarcodeDetector detector not supported"}return n.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},n.prototype.decodeAsync=function(e){return HM(this,void 0,void 0,function(){var t,i;return zM(this,function(o){switch(o.label){case 0:return[4,this.detector.detect(e)];case 1:if(t=o.sent(),!t||t.length===0)throw"No barcode or QR code detected.";return i=this.selectLargestBarcode(t),[2,{text:i.rawValue,format:l2.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}]}})})},n.prototype.selectLargestBarcode=function(e){for(var t=null,i=0,o=0,c=e;o<c.length;o++){var f=c[o],y=f.boundingBox.width*f.boundingBox.height;y>i&&(i=y,t=f)}if(!t)throw"No largest barcode found";return t},n.prototype.createBarcodeDetectorFormats=function(e){for(var t=[],i=0,o=e;i<o.length;i++){var c=o[i];this.formatMap.has(c)?t.push(this.formatMap.get(c)):this.logger.warn("".concat(c," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}},n.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},n.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,i,o){e.set(t,i)}),e},n.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},n})(),Nw=function(n,e,t,i){function o(c){return c instanceof t?c:new t(function(f){f(c)})}return new(t||(t=Promise))(function(c,f){function y(A){try{x(i.next(A))}catch(N){f(N)}}function w(A){try{x(i.throw(A))}catch(N){f(N)}}function x(A){A.done?c(A.value):o(A.value).then(y,w)}x((i=i.apply(n,e||[])).next())})},Iw=function(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,f;return f={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function y(x){return function(A){return w([x,A])}}function w(x){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(t=0)),t;)try{if(i=1,o&&(c=x[0]&2?o.return:x[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,x[1])).done)return c;switch(o=0,c&&(x=[x[0]&2,c.value]),x[0]){case 0:case 1:c=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,o=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!c||x[1]>c[0]&&x[1]<c[3])){t.label=x[1];break}if(x[0]===6&&t.label<c[1]){t.label=c[1],c=x;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(x);break}c[2]&&t.ops.pop(),t.trys.pop();continue}x=e.call(n,t)}catch(A){x=[6,A],o=0}finally{i=c=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},qM=(function(){function n(e,t,i,o){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=i,t&&Cw.isSupported()?(this.primaryDecoder=new Cw(e,i,o),this.secondaryDecoder=new Sw(e,i,o)):this.primaryDecoder=new Sw(e,i,o)}return n.prototype.decodeAsync=function(e){return Nw(this,void 0,void 0,function(){var t;return Iw(this,function(i){switch(i.label){case 0:t=performance.now(),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,i.sent()];case 3:return this.possiblyLogPerformance(t),[7];case 4:return[2]}})})},n.prototype.decodeRobustlyAsync=function(e){return Nw(this,void 0,void 0,function(){var t,i;return Iw(this,function(o){switch(o.label){case 0:t=performance.now(),o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,o.sent()];case 3:if(i=o.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw i;case 4:return this.possiblyLogPerformance(t),[7];case 5:return[2]}})})},n.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},n.prototype.possiblyLogPerformance=function(e){if(this.verbose){var t=performance.now()-e;this.executionResults.push(t),this.executions++,this.possiblyFlushPerformanceReport()}},n.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,t=0,i=this.executionResults;t<i.length;t++){var o=i[t];e+=o}var c=e/this.executionResults.length;console.log("".concat(c," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},n})(),Og=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(i[c]=o[c])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Ih=function(n,e,t,i){function o(c){return c instanceof t?c:new t(function(f){f(c)})}return new(t||(t=Promise))(function(c,f){function y(A){try{x(i.next(A))}catch(N){f(N)}}function w(A){try{x(i.throw(A))}catch(N){f(N)}}function x(A){A.done?c(A.value):o(A.value).then(y,w)}x((i=i.apply(n,e||[])).next())})},Rh=function(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,f;return f={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function y(x){return function(A){return w([x,A])}}function w(x){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(t=0)),t;)try{if(i=1,o&&(c=x[0]&2?o.return:x[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,x[1])).done)return c;switch(o=0,c&&(x=[x[0]&2,c.value]),x[0]){case 0:case 1:c=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,o=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!c||x[1]>c[0]&&x[1]<c[3])){t.label=x[1];break}if(x[0]===6&&t.label<c[1]){t.label=c[1],c=x;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(x);break}c[2]&&t.ops.pop(),t.trys.pop();continue}x=e.call(n,t)}catch(A){x=[6,A],o=0}finally{i=c=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},u2=(function(){function n(e,t){this.name=e,this.track=t}return n.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},n.prototype.apply=function(e){var t={};t[this.name]=e;var i={advanced:[t]};return this.track.applyConstraints(i)},n.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var t=e[this.name];return t}return null},n})(),YM=(function(n){Og(e,n);function e(t,i){return n.call(this,t,i)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(t){var i={};i[this.name]=t;var o={advanced:[i]};return this.track.applyConstraints(o)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var t=this.track.getCapabilities(),i=t[this.name];return{min:i.min,max:i.max,step:i.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e})(u2),WM=(function(n){Og(e,n);function e(t){return n.call(this,"zoom",t)||this}return e})(YM),XM=(function(n){Og(e,n);function e(t){return n.call(this,"torch",t)||this}return e})(u2),KM=(function(){function n(e){this.track=e}return n.prototype.zoomFeature=function(){return new WM(this.track)},n.prototype.torchFeature=function(){return new XM(this.track)},n})(),$M=(function(){function n(e,t,i){this.isClosed=!1,this.parentElement=e,this.mediaStream=t,this.callbacks=i,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return n.prototype.createVideoElement=function(e){var t=document.createElement("video");return t.style.width="".concat(e,"px"),t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t},n.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var t=function(){var i=e.surface.clientWidth,o=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(i,o),e.surface.removeEventListener("playing",t)};this.surface.addEventListener("playing",t),this.surface.srcObject=this.mediaStream,this.surface.play()},n.create=function(e,t,i,o){return Ih(this,void 0,void 0,function(){var c,f;return Rh(this,function(y){switch(y.label){case 0:return c=new n(e,t,o),i.aspectRatio?(f={aspectRatio:i.aspectRatio},[4,c.getFirstTrackOrFail().applyConstraints(f)]):[3,2];case 1:y.sent(),y.label=2;case 2:return c.setupSurface(),[2,c]}})})},n.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},n.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},n.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},n.prototype.resume=function(e){this.failIfClosed();var t=this,i=function(){setTimeout(e,200),t.surface.removeEventListener("playing",i)};this.surface.addEventListener("playing",i),this.surface.play()},n.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},n.prototype.getSurface=function(){return this.failIfClosed(),this.surface},n.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},n.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},n.prototype.applyVideoConstraints=function(e){return Ih(this,void 0,void 0,function(){return Rh(this,function(t){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},n.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(t,i){var o=e.mediaStream.getVideoTracks(),c=o.length,f=0;e.mediaStream.getVideoTracks().forEach(function(y){e.mediaStream.removeTrack(y),y.stop(),++f,f>=c&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),t())})})},n.prototype.getCapabilities=function(){return new KM(this.getFirstTrackOrFail())},n})(),JM=(function(){function n(e){this.mediaStream=e}return n.prototype.render=function(e,t,i){return Ih(this,void 0,void 0,function(){return Rh(this,function(o){return[2,$M.create(e,this.mediaStream,t,i)]})})},n.create=function(e){return Ih(this,void 0,void 0,function(){var t,i;return Rh(this,function(o){switch(o.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return t={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(t)];case 1:return i=o.sent(),[2,new n(i)]}})})},n})(),Rw=function(n,e,t,i){function o(c){return c instanceof t?c:new t(function(f){f(c)})}return new(t||(t=Promise))(function(c,f){function y(A){try{x(i.next(A))}catch(N){f(N)}}function w(A){try{x(i.throw(A))}catch(N){f(N)}}function x(A){A.done?c(A.value):o(A.value).then(y,w)}x((i=i.apply(n,e||[])).next())})},Mw=function(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,f;return f={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function y(x){return function(A){return w([x,A])}}function w(x){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(t=0)),t;)try{if(i=1,o&&(c=x[0]&2?o.return:x[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,x[1])).done)return c;switch(o=0,c&&(x=[x[0]&2,c.value]),x[0]){case 0:case 1:c=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,o=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!c||x[1]>c[0]&&x[1]<c[3])){t.label=x[1];break}if(x[0]===6&&t.label<c[1]){t.label=c[1],c=x;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(x);break}c[2]&&t.ops.pop(),t.trys.pop();continue}x=e.call(n,t)}catch(A){x=[6,A],o=0}finally{i=c=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},QM=(function(){function n(){}return n.failIfNotSupported=function(){return Rw(this,void 0,void 0,function(){return Mw(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new n]})})},n.prototype.create=function(e){return Rw(this,void 0,void 0,function(){return Mw(this,function(t){return[2,JM.create(e)]})})},n})(),ZM=function(n,e,t,i){function o(c){return c instanceof t?c:new t(function(f){f(c)})}return new(t||(t=Promise))(function(c,f){function y(A){try{x(i.next(A))}catch(N){f(N)}}function w(A){try{x(i.throw(A))}catch(N){f(N)}}function x(A){A.done?c(A.value):o(A.value).then(y,w)}x((i=i.apply(n,e||[])).next())})},eD=function(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,f;return f={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function y(x){return function(A){return w([x,A])}}function w(x){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(t=0)),t;)try{if(i=1,o&&(c=x[0]&2?o.return:x[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,x[1])).done)return c;switch(o=0,c&&(x=[x[0]&2,c.value]),x[0]){case 0:case 1:c=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,o=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!c||x[1]>c[0]&&x[1]<c[3])){t.label=x[1];break}if(x[0]===6&&t.label<c[1]){t.label=c[1],c=x;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(x);break}c[2]&&t.ops.pop(),t.trys.pop();continue}x=e.call(n,t)}catch(A){x=[6,A],o=0}finally{i=c=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},tD=(function(){function n(){}return n.retrieve=function(){if(navigator.mediaDevices)return n.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?n.getCamerasFromMediaStreamTrack():n.rejectWithError()},n.rejectWithError=function(){var e=$l.unableToQuerySupportedDevices();return n.isHttpsOrLocalhost()||(e=$l.insecureContextCameraQueryError()),Promise.reject(e)},n.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},n.getCamerasFromMediaDevices=function(){return ZM(this,void 0,void 0,function(){var e,t,i,o,c,f,y;return eD(this,function(w){switch(w.label){case 0:return e=function(x){for(var A=x.getVideoTracks(),N=0,R=A;N<R.length;N++){var k=R[N];k.enabled=!1,k.stop(),x.removeTrack(k)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=w.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(i=w.sent(),o=[],c=0,f=i;c<f.length;c++)y=f[c],y.kind==="videoinput"&&o.push({id:y.deviceId,label:y.label});return e(t),[2,o]}})})},n.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,t){var i=function(c){for(var f=[],y=0,w=c;y<w.length;y++){var x=w[y];x.kind==="video"&&f.push({id:x.id,label:x.label})}e(f)},o=MediaStreamTrack;o.getSources(i)})},n})(),ni;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.NOT_STARTED=1]="NOT_STARTED",n[n.SCANNING=2]="SCANNING",n[n.PAUSED=3]="PAUSED"})(ni||(ni={}));var nD=(function(){function n(){this.state=ni.NOT_STARTED,this.onGoingTransactionNewState=ni.UNKNOWN}return n.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},n.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},n.prototype.execute=function(){if(this.onGoingTransactionNewState===ni.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=ni.UNKNOWN,this.directTransition(e)},n.prototype.cancel=function(){if(this.onGoingTransactionNewState===ni.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=ni.UNKNOWN},n.prototype.getState=function(){return this.state},n.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==ni.UNKNOWN)throw"Cannot transition to a new state, already under transition"},n.prototype.validateTransition=function(e){switch(this.state){case ni.UNKNOWN:throw"Transition from unknown is not allowed";case ni.NOT_STARTED:this.failIfNewStateIs(e,[ni.PAUSED]);break;case ni.SCANNING:break;case ni.PAUSED:break}},n.prototype.failIfNewStateIs=function(e,t){for(var i=0,o=t;i<o.length;i++){var c=o[i];if(e===c)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},n})(),iD=(function(){function n(e){this.stateManager=e}return n.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},n.prototype.directTransition=function(e){this.stateManager.directTransition(e)},n.prototype.getState=function(){return this.stateManager.getState()},n.prototype.canScanFile=function(){return this.stateManager.getState()===ni.NOT_STARTED},n.prototype.isScanning=function(){return this.stateManager.getState()!==ni.NOT_STARTED},n.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===ni.SCANNING},n.prototype.isPaused=function(){return this.stateManager.getState()===ni.PAUSED},n})(),sD=(function(){function n(){}return n.create=function(){return new iD(new nD)},n})(),rD=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(i[c]=o[c])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Gs=(function(n){rD(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e})(LM),oD=(function(){function n(e,t){this.logger=t,this.fps=Gs.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=Gs.DEFAULT_DISABLE_FLIP}return n.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?c2.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},n.prototype.isShadedBoxEnabled=function(){return!vo(this.qrbox)},n.create=function(e,t){return new n(e,t)},n})(),aD=(function(){function n(e,t){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var i;typeof t=="boolean"?this.verbose=t===!0:t&&(i=t,this.verbose=i.verbose===!0,i.experimentalFeatures),this.logger=new BM(this.verbose),this.qrcode=new qM(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(i),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=sD.create()}return n.prototype.start=function(e,t,i,o){var c=this;if(!e)throw"cameraIdOrConfig is required";if(!i||typeof i!="function")throw"qrCodeSuccessCallback is required and should be a function.";var f;o?f=o:f=this.verbose?this.logger.log:function(){};var y=oD.create(t,this.logger);this.clearElement();var w=!1;y.videoConstraints&&(y.isMediaStreamConstraintsValid()?w=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var x=w,A=document.getElementById(this.elementId);A.clientWidth?A.clientWidth:Gs.DEFAULT_WIDTH,A.style.position="relative",this.shouldScan=!0,this.element=A;var N=this,R=this.stateManagerProxy.startTransition(ni.SCANNING);return new Promise(function(k,H){var W=x?y.videoConstraints:N.createVideoConstraints(e);if(!W){R.cancel(),H("videoConstraints should be defined");return}var K={};(!x||y.aspectRatio)&&(K.aspectRatio=y.aspectRatio);var te={onRenderSurfaceReady:function(le,ee){N.setupUi(le,ee,y),N.isScanning=!0,N.foreverScan(y,i,f)}};QM.failIfNotSupported().then(function(le){le.create(W).then(function(ee){return ee.render(c.element,K,te).then(function(de){N.renderedCamera=de,R.execute(),k(null)}).catch(function(de){R.cancel(),H(de)})}).catch(function(ee){R.cancel(),H($l.errorGettingUserMedia(ee))})}).catch(function(le){R.cancel(),H($l.cameraStreamingNotSupported())})})},n.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(ni.PAUSED),this.showPausedState(),(vo(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},n.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,t=function(){e.stateManagerProxy.directTransition(ni.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){t();return}this.renderedCamera.resume(function(){t()})},n.prototype.getState=function(){return this.stateManagerProxy.getState()},n.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(ni.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var i=function(){if(e.element){var c=document.getElementById(Gs.SHADED_REGION_ELEMENT_ID);c&&e.element.removeChild(c)}},o=this;return this.renderedCamera.close().then(function(){return o.renderedCamera=null,o.element&&(o.element.removeChild(o.canvasElement),o.canvasElement=null),i(),o.qrRegion&&(o.qrRegion=null),o.context&&(o.context=null),t.execute(),o.hidePausedState(),o.isScanning=!1,Promise.resolve()})},n.prototype.scanFile=function(e,t){return this.scanFileV2(e,t).then(function(i){return i.decodedText})},n.prototype.scanFileV2=function(e,t){var i=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(vo(t)&&(t=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(o,c){i.possiblyCloseLastScanImageFile(),i.clearElement(),i.lastScanImageFile=URL.createObjectURL(e);var f=new Image;f.onload=function(){var y=f.width,w=f.height,x=document.getElementById(i.elementId),A=x.clientWidth?x.clientWidth:Gs.DEFAULT_WIDTH,N=Math.max(x.clientHeight?x.clientHeight:w,Gs.FILE_SCAN_MIN_HEIGHT),R=i.computeCanvasDrawConfig(y,w,A,N);if(t){var k=i.createCanvasElement(A,N,"qr-canvas-visible");k.style.display="inline-block",x.appendChild(k);var H=k.getContext("2d");if(!H)throw"Unable to get 2d context from canvas";H.canvas.width=A,H.canvas.height=N,H.drawImage(f,0,0,y,w,R.x,R.y,R.width,R.height)}var W=Gs.FILE_SCAN_HIDDEN_CANVAS_PADDING,K=Math.max(f.width,R.width),te=Math.max(f.height,R.height),le=K+2*W,ee=te+2*W,de=i.createCanvasElement(le,ee);x.appendChild(de);var Ee=de.getContext("2d");if(!Ee)throw"Unable to get 2d context from canvas";Ee.canvas.width=le,Ee.canvas.height=ee,Ee.drawImage(f,0,0,y,w,W,W,K,te);try{i.qrcode.decodeRobustlyAsync(de).then(function(me){o(Tw.createFromQrcodeResult(me))}).catch(c)}catch(me){c("QR code parse error, error = ".concat(me))}},f.onerror=c,f.onabort=c,f.onstalled=c,f.onsuspend=c,f.src=URL.createObjectURL(e)})},n.prototype.clear=function(){this.clearElement()},n.getCameras=function(){return tD.retrieve()},n.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},n.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},n.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},n.prototype.applyVideoConstraints=function(e){if(e){if(!c2.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},n.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},n.prototype.getSupportedFormats=function(e){var t=[tt.QR_CODE,tt.AZTEC,tt.CODABAR,tt.CODE_39,tt.CODE_93,tt.CODE_128,tt.DATA_MATRIX,tt.MAXICODE,tt.ITF,tt.EAN_13,tt.EAN_8,tt.PDF_417,tt.RSS_14,tt.RSS_EXPANDED,tt.UPC_A,tt.UPC_E,tt.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return t;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var i=[],o=0,c=e.formatsToSupport;o<c.length;o++){var f=c[o];PM(f)?i.push(f):this.logger.warn("Invalid format: ".concat(f," passed in config, ignoring."))}if(i.length===0)throw"None of formatsToSupport match supported values.";return i},n.prototype.getUseBarCodeDetectorIfSupported=function(e){if(vo(e))return!0;if(!vo(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(vo(e.experimentalFeatures))return!0;var t=e.experimentalFeatures;return vo(t.useBarCodeDetectorIfSupported)?!0:t.useBarCodeDetectorIfSupported!==!1},n.prototype.validateQrboxSize=function(e,t,i){var o=this,c=i.qrbox;this.validateQrboxConfig(c);var f=this.toQrdimensions(e,t,c),y=function(x){if(x<Gs.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Gs.MIN_QR_BOX_SIZE,"px.")},w=function(x){return x>e&&(o.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),x=e),x};y(f.width),y(f.height),f.width=w(f.width)},n.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},n.prototype.toQrdimensions=function(e,t,i){if(typeof i=="number")return{width:i,height:i};if(typeof i=="function")try{return i(e,t)}catch(o){throw new Error("qrbox config was passed as a function but it failed with unknown error"+o)}return i},n.prototype.setupUi=function(e,t,i){i.isShadedBoxEnabled()&&this.validateQrboxSize(e,t,i);var o=vo(i.qrbox)?{width:e,height:t}:i.qrbox;this.validateQrboxConfig(o);var c=this.toQrdimensions(e,t,o);c.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var f=i.isShadedBoxEnabled()&&c.height<=t,y={x:0,y:0,width:e,height:t},w=f?this.getShadedRegionBounds(e,t,c):y,x=this.createCanvasElement(w.width,w.height),A={willReadFrequently:!0},N=x.getContext("2d",A);N.canvas.width=w.width,N.canvas.height=w.height,this.element.append(x),f&&this.possiblyInsertShadingElement(this.element,e,t,c),this.createScannerPausedUiElement(this.element),this.qrRegion=w,this.context=N,this.canvasElement=x},n.prototype.createScannerPausedUiElement=function(e){var t=document.createElement("div");t.innerText=$l.scannerPaused(),t.style.display="none",t.style.position="absolute",t.style.top="0px",t.style.zIndex="1",t.style.background="rgba(9, 9, 9, 0.46)",t.style.color="#FFECEC",t.style.textAlign="center",t.style.width="100%",e.appendChild(t),this.scannerPausedUiElement=t},n.prototype.scanContext=function(e,t){var i=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(o){return e(o.text,Tw.createFromQrcodeResult(o)),i.possiblyUpdateShaders(!0),!0}).catch(function(o){i.possiblyUpdateShaders(!1);var c=$l.codeParseError(o);return t(c,UM.createFrom(c)),!1})},n.prototype.foreverScan=function(e,t,i){var o=this;if(this.shouldScan&&this.renderedCamera){var c=this.renderedCamera.getSurface(),f=c.videoWidth/c.clientWidth,y=c.videoHeight/c.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var w=this.qrRegion.width*f,x=this.qrRegion.height*y,A=this.qrRegion.x*f,N=this.qrRegion.y*y;this.context.drawImage(c,A,N,w,x,0,0,this.qrRegion.width,this.qrRegion.height);var R=function(){o.foreverScanTimeout=setTimeout(function(){o.foreverScan(e,t,i)},o.getTimeoutFps(e.fps))};this.scanContext(t,i).then(function(k){!k&&e.disableFlip!==!0?(o.context.translate(o.context.canvas.width,0),o.context.scale(-1,1),o.scanContext(t,i).finally(function(){R()})):R()}).catch(function(k){o.logger.logError("Error happend while scanning context",k),R()})}},n.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var t="facingMode",i="deviceId",o={user:!0,environment:!0},c="exact",f=function(H){if(H in o)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(H,"'")},y=Object.keys(e);if(y.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(y.length," keys");var w=Object.keys(e)[0];if(w!==t&&w!==i)throw"Only '".concat(t,"' and '").concat(i,"' ")+" are supported for 'cameraIdOrConfig'";if(w===t){var x=e.facingMode;if(typeof x=="string"){if(f(x))return{facingMode:x}}else if(typeof x=="object")if(c in x){if(f(x["".concat(c)]))return{facingMode:{exact:x["".concat(c)]}}}else throw"'facingMode' should be string or object with"+" ".concat(c," as key.");else{var A=typeof x;throw"Invalid type of 'facingMode' = ".concat(A)}}else{var N=e.deviceId;if(typeof N=="string")return{deviceId:N};if(typeof N=="object"){if(c in N)return{deviceId:{exact:N["".concat(c)]}};throw"'deviceId' should be string or object with"+" ".concat(c," as key.")}else{var R=typeof N;throw"Invalid type of 'deviceId' = ".concat(R)}}}var k=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(k)},n.prototype.computeCanvasDrawConfig=function(e,t,i,o){if(e<=i&&t<=o){var c=(i-e)/2,f=(o-t)/2;return{x:c,y:f,width:e,height:t}}else{var y=e,w=t;return e>i&&(t=i/e*t,e=i),t>o&&(e=o/t*e,t=o),this.logger.log("Image downsampled from "+"".concat(y,"X").concat(w)+" to ".concat(e,"X").concat(t,".")),this.computeCanvasDrawConfig(e,t,i,o)}},n.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},n.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(t){t.style.backgroundColor=e?Gs.BORDER_SHADER_MATCH_COLOR:Gs.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},n.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},n.prototype.createCanvasElement=function(e,t,i){var o=e,c=t,f=document.createElement("canvas");return f.style.width="".concat(o,"px"),f.style.height="".concat(c,"px"),f.style.display="none",f.id=vo(i)?"qr-canvas":i,f},n.prototype.getShadedRegionBounds=function(e,t,i){if(i.width>e||i.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-i.width)/2,y:(t-i.height)/2,width:i.width,height:i.height}},n.prototype.possiblyInsertShadingElement=function(e,t,i,o){if(!(t-o.width<1||i-o.height<1)){var c=document.createElement("div");c.style.position="absolute";var f=(t-o.width)/2,y=(i-o.height)/2;if(c.style.borderLeft="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderRight="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderTop="".concat(y,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderBottom="".concat(y,"px solid rgba(0, 0, 0, 0.48)"),c.style.boxSizing="border-box",c.style.top="0px",c.style.bottom="0px",c.style.left="0px",c.style.right="0px",c.id="".concat(Gs.SHADED_REGION_ELEMENT_ID),t-o.width<11||i-o.height<11)this.hasBorderShaders=!1;else{var w=5,x=40;this.insertShaderBorders(c,x,w,-w,null,0,!0),this.insertShaderBorders(c,x,w,-w,null,0,!1),this.insertShaderBorders(c,x,w,null,-w,0,!0),this.insertShaderBorders(c,x,w,null,-w,0,!1),this.insertShaderBorders(c,w,x+w,-w,null,-w,!0),this.insertShaderBorders(c,w,x+w,null,-w,-w,!0),this.insertShaderBorders(c,w,x+w,-w,null,-w,!1),this.insertShaderBorders(c,w,x+w,null,-w,-w,!1),this.hasBorderShaders=!0}e.append(c)}},n.prototype.insertShaderBorders=function(e,t,i,o,c,f,y){var w=document.createElement("div");w.style.position="absolute",w.style.backgroundColor=Gs.BORDER_SHADER_DEFAULT_COLOR,w.style.width="".concat(t,"px"),w.style.height="".concat(i,"px"),o!==null&&(w.style.top="".concat(o,"px")),c!==null&&(w.style.bottom="".concat(c,"px")),y?w.style.left="".concat(f,"px"):w.style.right="".concat(f,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(w),e.appendChild(w)},n.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},n.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},n.prototype.getTimeoutFps=function(e){return 1e3/e},n})(),Dw;(function(n){n[n.STATUS_DEFAULT=0]="STATUS_DEFAULT",n[n.STATUS_SUCCESS=1]="STATUS_SUCCESS",n[n.STATUS_WARNING=2]="STATUS_WARNING",n[n.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Dw||(Dw={}));const d2=({onClose:n,onScanSuccess:e})=>{const[t,i]=oe.useState(null),o=oe.useRef(null),c=oe.useRef(!1);return oe.useEffect(()=>{c.current=!0;const f="reader",w=setTimeout(async()=>{if(!document.getElementById(f))return;if(o.current){try{await o.current.clear()}catch{}o.current=null}const x=new aD(f,{formatsToSupport:[tt.EAN_13,tt.EAN_8,tt.UPC_A,tt.UPC_E,tt.CODE_128],experimentalFeatures:{useBarCodeDetectorIfSupported:!0},verbose:!1});o.current=x;try{await x.start({facingMode:"environment"},{fps:10,aspectRatio:1,videoConstraints:{facingMode:"environment",focusMode:"continuous"}},A=>{c.current&&x.stop().then(()=>{x.clear(),e(A)}).catch(()=>{e(A)})},A=>{})}catch(A){c.current&&(console.error("Error starting scanner",A),i("Camera permission denied or unavailable. Please check settings."))}},100);return()=>{c.current=!1,clearTimeout(w),o.current&&(o.current.isScanning?o.current.stop().then(()=>{var x;(x=o.current)==null||x.clear()}).catch(console.error):o.current.clear())}},[e]),h.jsxs("div",{className:"fixed inset-0 bg-black z-[9999] flex flex-col h-[100dvh]",children:[h.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 pt-[calc(env(safe-area-inset-top)+1rem)] bg-gradient-to-b from-black/80 to-transparent z-20 flex justify-between items-start pointer-events-none",children:[h.jsxs("div",{className:"pointer-events-auto",children:[h.jsxs("h3",{className:"font-bold text-lg text-white flex items-center gap-2 drop-shadow-md",children:[h.jsx(ue,{name:"scan-barcode",className:"w-5 h-5 text-teal-400"}),"Scan Product"]}),h.jsx("p",{className:"text-xs text-gray-300 drop-shadow-sm",children:"Align barcode in window"})]}),h.jsx("button",{onClick:n,className:"pointer-events-auto bg-white/20 backdrop-blur-md p-2.5 rounded-full hover:bg-white/30 transition-colors text-white border border-white/10 shadow-lg","aria-label":"Close Scanner",children:h.jsx(ue,{name:"x",className:"w-6 h-6"})})]}),h.jsxs("div",{className:"flex-1 relative w-full h-full bg-black overflow-hidden",children:[h.jsx("div",{id:"reader",className:"w-full h-full"}),h.jsx("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:h.jsxs("div",{className:"w-64 h-64 border-2 border-white/50 rounded-lg relative",children:[h.jsx("div",{className:"absolute top-0 left-0 w-4 h-4 border-t-4 border-l-4 border-teal-400 -mt-1 -ml-1"}),h.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 border-t-4 border-r-4 border-teal-400 -mt-1 -mr-1"}),h.jsx("div",{className:"absolute bottom-0 left-0 w-4 h-4 border-b-4 border-l-4 border-teal-400 -mb-1 -ml-1"}),h.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 border-b-4 border-r-4 border-teal-400 -mb-1 -mr-1"}),h.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:h.jsx("div",{className:"w-full h-0.5 bg-red-500/50 animate-pulse"})})]})})]}),h.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6 pb-[calc(env(safe-area-inset-bottom)+2rem)] flex flex-col items-center bg-gradient-to-t from-black/90 to-transparent z-20 pointer-events-none",children:[h.jsx("button",{onClick:n,className:"pointer-events-auto text-white text-sm font-semibold bg-white/20 border border-white/30 px-8 py-3 rounded-full backdrop-blur-md hover:bg-white/30 transition-all active:scale-95",children:"Cancel Scan"}),t&&h.jsx("p",{className:"text-red-400 text-xs mt-3 bg-black/80 inline-block px-3 py-1 rounded text-center",children:t})]}),h.jsx("style",{children:`
                #reader video {
                    object-fit: cover;
                    width: 100%;
                    height: 100%;
                }
            `})]})},lD=Object.freeze(Object.defineProperty({__proto__:null,default:d2},Symbol.toStringTag,{value:"Module"})),cD=({recipes:n,onClose:e,onSave:t,onCreateRecipe:i,baseColor:o="teal",initialFoods:c=[],customFoods:f=[],enableScanner:y=!1,onAddCustomFood:w})=>{const[x,A]=oe.useState("SELECT"),[N,R]=oe.useState(new Date().toISOString().split("T")[0]),[k,H]=oe.useState("lunch"),[W,K]=oe.useState("foods"),[te,le]=oe.useState(""),[ee,de]=oe.useState(new Set(c)),[Ee,me]=oe.useState(!1),[U,V]=oe.useState({}),[F,Q]=oe.useState(null),[Y,$]=oe.useState(""),[z,_e]=oe.useState(!1),[he,ne]=oe.useState("");oe.useEffect(()=>{if(c.length>0){const pe={};c.forEach(Ve=>{pe[Ve]={status:"eaten",tags:new Set}}),V(pe)}},[c]);const ie=oe.useMemo(()=>[...ac,...f.map(Ve=>Ve.name)].filter(Ve=>Ve.toLowerCase().includes(te.toLowerCase())),[te,f]),Me=pe=>{const Ve=new Set(ee);if(Ve.has(pe)){Ve.delete(pe);const Ke={...U};delete Ke[pe],V(Ke)}else Ve.add(pe),V(Ke=>({...Ke,[pe]:{status:"eaten",tags:new Set}}));de(Ve)},ze=(pe,Ve)=>{V(Ke=>({...Ke,[pe]:{...Ke[pe],status:Ve,tags:new Set}}))},ct=(pe,Ve)=>{V(Ke=>{const it=new Set(Ke[pe].tags);return it.has(Ve)?it.delete(Ve):it.add(Ve),{...Ke,[pe]:{...Ke[pe],tags:it}}})},ae=pe=>{const Ve=pe.ingredients.split(`
`).map(kt=>kt.replace("-","").trim()),Ke=new Set(ee),it={...U};[...ac,...f.map(kt=>kt.name)].forEach(kt=>{const Dn=kt.toLowerCase();Ve.some(St=>St.toLowerCase().includes(Dn))&&(Ke.add(kt),it[kt]||(it[kt]={status:"eaten",tags:new Set}))}),de(Ke),V(it),K("foods")},Ie=async pe=>{me(!1);try{const Ve=await a2(pe);if(Ve)if(Ve.matchedFoods.length>0){const Ke=new Set(ee),it={...U};let Mn=0;Ve.matchedFoods.forEach(kt=>{Ke.has(kt)||(Ke.add(kt),it[kt]||(it[kt]={status:"eaten",tags:new Set}),Mn++)}),de(Ke),V(it),ne(Ve.productName),_e(!0),K("foods"),alert(`Found ${Mn} ingredients in ${Ve.productName}!`)}else alert(`Scanned ${Ve.productName} but couldn't match any specific foods to our list. Try adding custom foods manually.`),w&&w(Ve.productName);else alert("Product not found.")}catch(Ve){console.error(Ve),alert("Error scanning barcode.")}},Ae=pe=>{var Ke;const Ve=(Ke=pe.target.files)==null?void 0:Ke[0];if(Ve){const it=new FileReader;it.onloadend=()=>Q(it.result),it.readAsDataURL(Ve)}},je=()=>{if(ee.size===0)return;const pe=Array.from(ee);z&&i&&he&&i({title:he,ingredients:pe.join(`
`),instructions:"Quick Log Preset",tags:["Toddler Meal",k],mealTypes:[k]});const Ve=pe.map(Ke=>{var it,Mn;return{food:Ke,status:((it=U[Ke])==null?void 0:it.status)||"eaten",tags:Array.from(((Mn=U[Ke])==null?void 0:Mn.tags)||[])}});t(Ve,N,k,F||void 0,Y),e()},rt=pe=>{const Ve=Ns.flatMap(it=>it.items).find(it=>it.name===pe);if(Ve)return Ve.emoji;const Ke=f.find(it=>it.name===pe);return(Ke==null?void 0:Ke.emoji)||""};return h.jsxs("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[500]",children:[h.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg mx-auto flex flex-col max-h-[90vh] overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4 bg-gray-50",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:x==="SELECT"?"Build Plate":"Review Meal"}),h.jsx("p",{className:"text-xs text-gray-500",children:x==="SELECT"?"Select foods":"How did it go?"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[y&&h.jsx("button",{onClick:()=>me(!0),className:`text-${o}-600 bg-${o}-50 hover:bg-${o}-100 p-2 rounded-full transition-colors`,title:"Scan Barcode",children:h.jsx(ue,{name:"scan-barcode",className:"w-5 h-5"})}),h.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 p-2",children:h.jsx(ue,{name:"x"})})]})]}),x==="SELECT"&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"p-3 border-b bg-white flex gap-2",children:[h.jsx("input",{type:"date",value:N,onChange:pe=>R(pe.target.value),className:"flex-1 text-sm border-gray-300 rounded-md focus:ring-teal-500 focus:border-teal-500"}),h.jsx("select",{value:k,onChange:pe=>H(pe.target.value),className:"flex-1 text-sm border-gray-300 rounded-md capitalize focus:ring-teal-500 focus:border-teal-500",children:["breakfast","lunch","dinner","snack"].map(pe=>h.jsx("option",{value:pe,children:pe},pe))})]}),h.jsxs("div",{className:"flex border-b",children:[h.jsx("button",{onClick:()=>K("foods"),className:`flex-1 py-3 text-sm font-medium ${W==="foods"?`text-${o}-600 border-b-2 border-${o}-600 bg-teal-50/50`:"text-gray-500"}`,children:"Foods"}),h.jsx("button",{onClick:()=>K("recipe"),className:`flex-1 py-3 text-sm font-medium ${W==="recipe"?`text-${o}-600 border-b-2 border-${o}-600 bg-teal-50/50`:"text-gray-500"}`,children:"Use Preset / Recipe"})]}),h.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-white",children:W==="foods"?h.jsxs(h.Fragment,{children:[h.jsx("input",{type:"text",placeholder:"Search...",value:te,onChange:pe=>le(pe.target.value),className:"w-full mb-4 rounded-lg border-gray-300 shadow-sm focus:ring-teal-500 focus:border-teal-500"}),h.jsx("div",{className:"grid grid-cols-2 gap-2",children:ie.map(pe=>{const Ve=ee.has(pe);return h.jsxs("button",{onClick:()=>Me(pe),className:`flex items-center gap-2 p-3 rounded-xl border text-left transition-all ${Ve?`bg-${o}-50 border-${o}-500 ring-1 ring-${o}-500`:"bg-white border-gray-100 hover:border-gray-300"}`,children:[h.jsx("span",{className:"text-xl",children:rt(pe)}),h.jsx("span",{className:`text-sm font-medium truncate ${Ve?"text-teal-900":"text-gray-700"}`,children:pe}),Ve&&h.jsx(ue,{name:"check-circle",className:`ml-auto w-4 h-4 text-${o}-600`})]},pe)})})]}):h.jsxs("div",{className:"space-y-4",children:[f.length>0&&h.jsxs("div",{children:[h.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide mb-2 sticky top-0 bg-white py-1 z-10",children:"Custom Foods"}),h.jsx("div",{className:"space-y-2",children:f.map(pe=>{const Ve=ee.has(pe.name);return h.jsxs("button",{onClick:()=>Me(pe.name),className:`w-full text-left p-3 rounded-xl border transition-all flex justify-between items-center ${Ve?`bg-${o}-50 border-${o}-500 ring-1 ring-${o}-500`:"bg-white border-gray-200 hover:border-teal-400 hover:bg-teal-50"}`,children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xl",children:pe.emoji}),h.jsxs("div",{children:[h.jsx("h4",{className:`font-bold ${Ve?`text-${o}-900`:"text-gray-800"}`,children:pe.name}),h.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Scanned Item"})]})]}),Ve?h.jsx(ue,{name:"check-circle",className:`w-5 h-5 text-${o}-600`}):h.jsx(ue,{name:"plus",className:"w-4 h-4 text-teal-600"})]},pe.name)})})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide mb-2 mt-2 sticky top-0 bg-white py-1 z-10",children:"My Recipes"}),h.jsxs("div",{className:"space-y-3",children:[n.map(pe=>h.jsxs("button",{onClick:()=>ae(pe),className:"w-full text-left p-4 rounded-xl border border-gray-200 hover:border-teal-400 hover:bg-teal-50 transition-all flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-bold text-gray-800",children:pe.title}),h.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-1",children:pe.ingredients})]}),h.jsx(ue,{name:"plus",className:"w-4 h-4 text-teal-600"})]},pe.id)),n.length===0&&h.jsx("p",{className:"text-sm text-gray-400 italic",children:"No recipes created yet."})]})]})]})}),h.jsxs("div",{className:"border-t bg-white p-4 shadow-lg z-10",children:[h.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 mb-3 no-scrollbar h-14 items-center",children:ee.size===0?h.jsx("span",{className:"text-sm text-gray-400 italic w-full text-center",children:"Plate is empty..."}):Array.from(ee).map(pe=>h.jsxs("button",{onClick:()=>Me(pe),className:"relative shrink-0 w-12 h-12 bg-white rounded-full flex items-center justify-center border-2 border-gray-100 shadow-sm animate-popIn hover:bg-red-50 hover:border-red-200 group transition-all",children:[h.jsx("span",{className:"text-2xl",children:rt(pe)}),h.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity",children:h.jsx(ue,{name:"x",className:"w-2 h-2 text-white"})})]},pe))}),h.jsxs("button",{onClick:()=>A("REVIEW"),disabled:ee.size===0,className:`w-full py-3 px-4 rounded-xl shadow-lg text-sm font-bold text-white transition-all flex justify-center items-center gap-2 ${ee.size>0?`bg-${o}-600 hover:bg-${o}-700`:"bg-gray-300 cursor-not-allowed"}`,children:["Review Plate ",h.jsx(ue,{name:"arrow-right",className:"w-4 h-4"})]})]})]}),x==="REVIEW"&&h.jsxs("div",{className:"flex-1 flex flex-col bg-gray-50",children:[h.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[h.jsx("div",{className:"space-y-4",children:Array.from(ee).map(pe=>{const Ve=pe,Ke=U[Ve],it=(Ke==null?void 0:Ke.status)||"eaten",Mn=Iy[it],kt=it!=="eaten";return h.jsxs("div",{className:`rounded-xl border transition-all duration-300 overflow-hidden bg-white shadow-sm ${Mn.color}`,children:[h.jsxs("div",{className:"flex items-center justify-between p-3",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"text-2xl",children:rt(Ve)}),h.jsx("span",{className:"font-bold text-gray-800",children:Ve})]}),h.jsx("div",{className:"flex bg-white rounded-lg border border-gray-200 p-1 shadow-sm",children:["eaten","touched","refused"].map(Dn=>{const St=it===Dn,Pn=Iy[Dn];return h.jsx("button",{onClick:()=>ze(Ve,Dn),className:`p-2 rounded-md transition-all ${St?`${Pn.color} ${Pn.text}`:"text-gray-400 hover:bg-gray-50"}`,title:Pn.label,children:h.jsx(ue,{name:Pn.icon,className:"w-5 h-5"})},Dn)})})]}),kt&&h.jsxs("div",{className:"px-4 pb-4 pt-0 animate-fadeIn",children:[h.jsx("div",{className:"h-px bg-black/5 w-full mb-3"}),h.jsx("p",{className:"text-xs font-bold uppercase tracking-wide text-gray-500 mb-2",children:"What happened?"}),h.jsx("div",{className:"flex flex-wrap gap-2",children:(it==="touched"?bh.touched:bh.refused).map(Dn=>{const St=Ke.tags.has(Dn);return h.jsx("button",{onClick:()=>ct(Ve,Dn),className:`text-xs px-2.5 py-1.5 rounded-full border transition-all ${St?"bg-gray-800 text-white border-gray-800":"bg-white text-gray-600 border-gray-200 hover:border-gray-400"}`,children:Dn},Dn)})})]})]},Ve)})}),h.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm space-y-4",children:[h.jsxs("h3",{className:"text-sm font-bold text-gray-700 mb-3 flex items-center gap-2",children:[h.jsx(ue,{name:"camera",className:"w-4 h-4"})," Meal Photo"]}),F?h.jsxs("div",{className:"relative aspect-video rounded-lg overflow-hidden bg-gray-100",children:[h.jsx("img",{src:F,alt:"Meal",className:"w-full h-full object-cover"}),h.jsx("button",{onClick:()=>Q(null),className:"absolute top-2 right-2 bg-red-600 text-white p-1 rounded-full",children:h.jsx(ue,{name:"x",className:"w-4 h-4"})})]}):h.jsxs("label",{className:"flex flex-col items-center justify-center h-20 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors bg-gray-50",children:[h.jsx(ue,{name:"camera",className:"w-6 h-6 text-gray-400 mb-1"}),h.jsx("span",{className:"text-xs text-gray-500",children:"Tap to snap a picture"}),h.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:Ae})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-sm font-bold text-gray-700 mb-1 block",children:"Overall Notes"}),h.jsx("textarea",{className:"w-full rounded-lg border-gray-300 text-sm focus:ring-teal-500 focus:border-teal-500",rows:2,placeholder:"Anything else?",value:Y,onChange:pe=>$(pe.target.value)})]}),i&&h.jsxs("div",{className:"bg-indigo-50 p-4 rounded-xl border border-indigo-100",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("input",{type:"checkbox",id:"savePreset",checked:z,onChange:pe=>_e(pe.target.checked),className:"rounded text-indigo-600 focus:ring-indigo-500"}),h.jsx("label",{htmlFor:"savePreset",className:"text-sm font-bold text-indigo-900",children:"Save this meal as a Preset?"})]}),z&&h.jsx("input",{type:"text",placeholder:"e.g. Monday Pasta Lunch",value:he,onChange:pe=>ne(pe.target.value),className:"w-full mt-2 rounded-lg border-indigo-200 text-sm focus:ring-indigo-500 focus:border-indigo-500",autoFocus:!0})]})]}),h.jsxs("div",{className:"p-4 bg-white border-t flex gap-3",children:[h.jsx("button",{onClick:()=>A("SELECT"),className:"flex-1 py-3 text-sm font-bold text-gray-600 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:"Back"}),h.jsxs("button",{onClick:je,className:`flex-[2] py-3 text-sm font-bold text-white bg-${o}-600 rounded-xl shadow-lg hover:bg-${o}-700 transition-colors flex justify-center items-center gap-2`,children:[h.jsx(ue,{name:"check",className:"w-5 h-5"})," Save Log"]})]})]})]}),Ee&&h.jsx(d2,{onClose:()=>me(!1),onScanSuccess:Ie})]})},Ow=[{icon:"baby",title:"Welcome to Tiny Tastes",description:"The intelligent companion that adapts to your child's agefrom newborn days to toddler years."},{icon:"moon",title:"Newborn Mode (0-6m)",description:"Track essential feeds, diapers, and growth. Ask 'Sage' AI about sleep schedules and development milestones."},{icon:"carrot",title:"Explorer Mode (6-12m)",description:"Start solids safely with our '100 Foods' tracker. Log reactions, check allergens, and get serving tips."},{icon:"chef-hat",title:"Toddler Mode (12m+)",description:"Meal planning, recipe scanning, and AI-powered strategies to help your picky eater learn to love food."}],uD=({onSave:n,onClose:e})=>{const[t,i]=oe.useState(0),[o,c]=oe.useState(""),[f,y]=oe.useState(""),[w,x]=oe.useState(void 0),[A,N]=oe.useState(0),R=Ow.length+1,k=()=>{t<R-1&&i(t+1)},H=()=>{t>0&&i(t-1)},W=le=>{o.trim()&&f?(n({babyName:o.trim(),birthDate:f,gender:w}),le?e():(c(""),y(""),x(void 0),N(ee=>ee+1),alert(`${o} added! You can now add another child.`))):alert("Please enter your baby's name and birth date.")},K=t===R-1,te=Ow[t];return h.jsx("div",{className:"fixed inset-0 bg-gray-50 flex items-center justify-center p-4 z-[999]",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto border-t-4 border-teal-500 overflow-hidden",children:[h.jsx("div",{className:"p-6 min-h-[280px] flex flex-col justify-center",children:K?h.jsxs(h.Fragment,{children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800 text-center",children:A>0?"Add Another Child":"Let's Get Started!"}),h.jsx("p",{className:"text-center text-gray-600 mt-2 mb-6",children:A>0?"Great! Who else are we tracking today?":"Create a profile for your little one to personalize recommendations and tracking."}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"baby-name-input",className:"block text-sm font-medium text-gray-700",children:"Child's Name"}),h.jsx("input",{type:"text",id:"baby-name-input",value:o,onChange:le=>c(le.target.value),placeholder:"e.g., Alex",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"birth-date-input",className:"block text-sm font-medium text-gray-700",children:"Birth Date"}),h.jsx("input",{type:"date",id:"birth-date-input",value:f,onChange:le=>y(le.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender (For Growth Charts)"}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:()=>x("boy"),className:`flex-1 py-2 px-3 border rounded-md text-sm font-medium transition-colors ${w==="boy"?"bg-teal-50 border-teal-500 text-teal-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Boy"}),h.jsx("button",{onClick:()=>x("girl"),className:`flex-1 py-2 px-3 border rounded-md text-sm font-medium transition-colors ${w==="girl"?"bg-teal-50 border-teal-500 text-teal-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Girl"})]})]})]})]}):h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-teal-100 mb-4",children:h.jsx(ue,{name:te.icon,className:"h-8 w-8 text-teal-600"})}),h.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:te.title}),h.jsx("p",{className:"text-gray-600 mt-2",children:te.description})]})}),h.jsx("div",{className:"bg-gray-50 p-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[t>0&&!K&&h.jsx("button",{onClick:H,className:"text-sm font-medium text-gray-600 hover:text-gray-800 px-4 py-2",children:"Previous"}),t===0&&h.jsx("div",{}),K&&h.jsx("button",{onClick:H,className:"text-sm font-medium text-gray-600 hover:text-gray-800 px-4 py-2",children:"Back"}),!K&&h.jsx("div",{className:"flex items-center gap-2",children:Array.from({length:R}).map((le,ee)=>h.jsx("div",{className:`h-2 w-2 rounded-full transition-colors ${t===ee?"bg-teal-500":"bg-gray-300"}`},ee))}),K?h.jsxs("div",{className:"flex gap-2 w-full justify-end",children:[h.jsx("button",{onClick:()=>W(!1),className:"px-4 py-2 border border-teal-600 text-teal-600 rounded-md text-sm font-bold hover:bg-teal-50 transition-colors",children:"+ Add Another"}),h.jsx("button",{onClick:()=>W(!0),className:"px-4 py-2 bg-teal-600 text-white rounded-md text-sm font-bold hover:bg-teal-700 shadow-sm transition-colors",children:A>0?"Finish":"Save & Start"})]}):h.jsxs("button",{onClick:k,className:"inline-flex items-center gap-1.5 justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700",children:["Next ",h.jsx(ue,{name:"arrow-right",className:"w-4 h-4"})]})]})})]})})},dD=({onClose:n,onSave:e})=>{const[t,i]=oe.useState(""),[o,c]=oe.useState(""),[f,y]=oe.useState(void 0),w=x=>{if(x.preventDefault(),!t.trim())return;const A={id:crypto.randomUUID(),babyName:t,birthDate:o||void 0,gender:f,badges:[],knownAllergies:[]};e(A),n()};return h.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[600]",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm mx-auto overflow-hidden animate-popIn",children:[h.jsxs("div",{className:"flex justify-between items-center border-b p-4 bg-teal-50",children:[h.jsxs("h2",{className:"text-lg font-bold text-teal-900 flex items-center gap-2",children:[h.jsx(ue,{name:"baby",className:"w-5 h-5 text-teal-600"}),"Add Child"]}),h.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:h.jsx(ue,{name:"x"})})]}),h.jsxs("form",{onSubmit:w,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Child's Name"}),h.jsx("input",{type:"text",required:!0,value:t,onChange:x=>i(x.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 text-sm",placeholder:"e.g. Liam"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Birth Date"}),h.jsx("input",{type:"date",value:o,onChange:x=>c(x.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 text-sm"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender (for Growth Charts)"}),h.jsxs("div",{className:"flex gap-3",children:[h.jsxs("button",{type:"button",onClick:()=>y("boy"),className:`flex-1 py-2 px-3 border rounded-md text-sm font-medium transition-colors flex items-center justify-center gap-2 ${f==="boy"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[h.jsx(ue,{name:"smile",className:"w-4 h-4"})," Boy"]}),h.jsxs("button",{type:"button",onClick:()=>y("girl"),className:`flex-1 py-2 px-3 border rounded-md text-sm font-medium transition-colors flex items-center justify-center gap-2 ${f==="girl"?"bg-pink-50 border-pink-500 text-pink-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[h.jsx(ue,{name:"heart",className:"w-4 h-4"})," Girl"]})]})]}),h.jsxs("div",{className:"pt-4 flex gap-3",children:[h.jsx("button",{type:"button",onClick:n,className:"flex-1 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),h.jsx("button",{type:"submit",className:"flex-1 py-2 bg-teal-600 text-white rounded-md text-sm font-bold hover:bg-teal-700 shadow-sm",children:"Add Profile"})]})]})]})})},hD=({onClose:n,babyName:e="Baby",mode:t})=>{const[i,o]=oe.useState(!1),[c,f]=oe.useState("connecting"),[y,w]=oe.useState(""),x=oe.useRef(null),A=oe.useRef(0),N=oe.useRef(new Set),R=oe.useRef(null);oe.useEffect(()=>{const K=new Dg({apiKey:void 0});return(async()=>{try{const le=await navigator.mediaDevices.getUserMedia({audio:!0}),ee=new(window.AudioContext||window.webkitAudioContext)({sampleRate:16e3}),de=new(window.AudioContext||window.webkitAudioContext)({sampleRate:24e3});x.current=de;const Ee=K.live.connect({model:"gemini-2.5-flash-native-audio-preview-09-2025",callbacks:{onopen:()=>{f("listening"),o(!0);const me=ee.createMediaStreamSource(le),U=ee.createScriptProcessor(4096,1,1);U.onaudioprocess=V=>{const F=V.inputBuffer.getChannelData(0),Q=W(F);Ee.then(Y=>{Y.sendRealtimeInput({media:Q})})},me.connect(U),U.connect(ee.destination)},onmessage:async me=>{var U,V,F,Q,Y,$;if((Q=(F=(V=(U=me.serverContent)==null?void 0:U.modelTurn)==null?void 0:V.parts[0])==null?void 0:F.inlineData)!=null&&Q.data){f("speaking");const z=me.serverContent.modelTurn.parts[0].inlineData.data;A.current=Math.max(A.current,de.currentTime);const _e=await H(k(z),de,24e3,1),he=de.createBufferSource();he.buffer=_e,he.connect(de.destination),he.addEventListener("ended",()=>{N.current.delete(he),N.current.size===0&&f("listening")}),he.start(A.current),A.current+=_e.duration,N.current.add(he)}(Y=me.serverContent)!=null&&Y.interrupted&&(N.current.forEach(z=>z.stop()),N.current.clear(),A.current=0,f("listening")),($=me.serverContent)!=null&&$.outputTranscription&&w(z=>{var _e,he;return(z+" "+((he=(_e=me.serverContent)==null?void 0:_e.outputTranscription)==null?void 0:he.text)).trim()})},onerror:me=>{console.error("Live API Error:",me),f("error")},onclose:()=>{o(!1)}},config:{responseModalities:[Tu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Zephyr"}}},systemInstruction:`You are Sage, a helpful parenting assistant. You are talking to a parent currently in ${t} mode. Their baby's name is ${e}. Keep responses brief, encouraging, and helpful for a parent who might have their hands full. Focus on feeding safety, development, and quick tips.`,outputAudioTranscription:{}}});R.current=await Ee}catch(le){console.error("Init failure:",le),f("error")}})(),()=>{R.current&&R.current.close(),N.current.forEach(le=>le.stop())}},[e,t]);function k(K){const te=atob(K),le=te.length,ee=new Uint8Array(le);for(let de=0;de<le;de++)ee[de]=te.charCodeAt(de);return ee}async function H(K,te,le,ee){const de=new Int16Array(K.buffer),Ee=de.length/ee,me=te.createBuffer(ee,Ee,le);for(let U=0;U<ee;U++){const V=me.getChannelData(U);for(let F=0;F<Ee;F++)V[F]=de[F*ee+U]/32768}return me}function W(K){const te=K.length,le=new Int16Array(te);for(let ee=0;ee<te;ee++)le[ee]=K[ee]*32768;return{data:btoa(String.fromCharCode(...new Uint8Array(le.buffer))),mimeType:"audio/pcm;rate=16000"}}return h.jsxs("div",{className:"fixed inset-0 bg-violet-900/90 backdrop-blur-md z-[1000] flex flex-col items-center justify-center p-8 text-white",children:[h.jsx("button",{onClick:n,className:"absolute top-6 right-6 p-2 bg-white/10 rounded-full hover:bg-white/20 transition-colors",children:h.jsx(ue,{name:"x",className:"w-6 h-6"})}),h.jsxs("div",{className:"flex flex-col items-center text-center max-w-sm",children:[h.jsxs("div",{className:"relative mb-12",children:[h.jsx("div",{className:`absolute inset-0 bg-violet-400 rounded-full blur-2xl opacity-20 transition-all duration-700 ${c==="speaking"?"scale-150":"scale-100"}`}),h.jsx("div",{className:`relative w-32 h-32 rounded-full bg-gradient-to-tr from-violet-500 to-fuchsia-500 flex items-center justify-center shadow-2xl border-4 border-white/20 ${c==="speaking"?"animate-pulse":""}`,children:h.jsx(ue,{name:c==="speaking"?"volume-2":"mic",className:"w-12 h-12 text-white"})})]}),h.jsx("h2",{className:"text-2xl font-black mb-2 tracking-tight",children:"Sage Live"}),h.jsxs("p",{className:`text-sm font-bold uppercase tracking-widest mb-8 ${c==="connecting"?"animate-pulse text-violet-300":"text-violet-200"}`,children:[c==="connecting"&&"Establishing Link...",c==="listening"&&"Listening to you...",c==="speaking"&&"Sage is speaking...",c==="error"&&"Connection Lost"]}),h.jsx("div",{className:"bg-white/10 rounded-2xl p-6 border border-white/10 min-h-[120px] flex items-center justify-center italic text-violet-100",children:y?h.jsxs("p",{className:"text-lg leading-relaxed line-clamp-3",children:['"',y,'"']}):h.jsx("p",{className:"text-sm opacity-60",children:'"Sage, is peanut butter safe for a 6-month-old?"'})}),h.jsx("div",{className:"mt-12",children:h.jsx("button",{onClick:n,className:"px-12 py-4 bg-white text-violet-900 font-black rounded-full shadow-xl hover:bg-violet-50 active:scale-95 transition-all",children:"End Conversation"})})]}),h.jsx("p",{className:"absolute bottom-8 text-[10px] uppercase font-bold text-white/30 tracking-[0.2em]",children:"Powered by Gemini Live API"})]})},fD=n=>{const e=oe.useMemo(()=>r2(n),[n==null?void 0:n.birthDate,n==null?void 0:n.preferredMode,n==null?void 0:n.pediatricianApproved]),t=oe.useMemo(()=>W6(e),[e]);return{mode:e,config:t,isExplorer:e==="EXPLORER"}};function ds(n,e){const[t,i]=oe.useState(()=>{try{const o=localStorage.getItem(n);return o?JSON.parse(o):e}catch(o){return console.warn(`Error reading localStorage key "${n}":`,o),e}});return oe.useEffect(()=>{try{t===void 0?localStorage.removeItem(n):localStorage.setItem(n,JSON.stringify(t))}catch(o){console.warn(`Error setting localStorage key "${n}":`,o)}},[n,t]),[t,i]}const mD=()=>{const[n,e]=ds("tiny-tastes-tracker-profiles",[]),[t,i]=ds("tiny-tastes-tracker-activeChildId",""),[o,c]=ds("tiny-tastes-tracker-triedFoods",[]),[f,y]=ds("tiny-tastes-tracker-recipes",[]),[w,x]=ds("tiny-tastes-tracker-mealPlan",{}),[A,N]=ds("tiny-tastes-tracker-customFoods",[]),[R,k]=ds("tiny-tastes-tracker-milestones",Jd),[H,W]=ds("tiny-tastes-tracker-savedStrategies",[]),[K,te]=ds("tiny-tastes-tracker-manualShopping",[]),[le,ee]=ds("tiny-tastes-tracker-shoppingChecked",{}),[de,Ee]=ds("tiny-tastes-tracker-feedLogs",[]),[me,U]=ds("tiny-tastes-tracker-diaperLogs",[]),[V,F]=ds("tiny-tastes-tracker-sleepLogs",[]),[Q,Y]=ds("tiny-tastes-tracker-medicineLogs",[]),[$,z]=ds("tiny-tastes-tracker-growthLogs",[]),[_e,he]=oe.useState({type:null}),[ne,ie]=oe.useState(!1);oe.useEffect(()=>{!t&&n.length>0&&i(n[0].id)},[n,t,i]),oe.useEffect(()=>{if(n.length===0){const Ue=localStorage.getItem("tiny-tastes-tracker-profile");if(Ue)try{const Xe=JSON.parse(Ue);Xe.id||(Xe.id=crypto.randomUUID()),e([Xe])}catch(Xe){console.error("Failed to migrate legacy profile",Xe)}else ie(!0)}},[n.length,e]);const Me=oe.useMemo(()=>n.find(Ue=>Ue.id===t)||null,[n,t]),ze=oe.useCallback(Ue=>t?Ue.filter(Xe=>Xe.childId?Xe.childId===t:n.length>0&&n[0].id===t):[],[t,n]),ct=oe.useMemo(()=>ze(o),[o,ze]),ae=oe.useMemo(()=>ze(de),[de,ze]),Ie=oe.useMemo(()=>ze(me),[me,ze]),Ae=oe.useMemo(()=>ze(V),[V,ze]),je=oe.useMemo(()=>ze(Q),[Q,ze]),rt=oe.useMemo(()=>ze($),[$,ze]),pe=oe.useMemo(()=>ze(H),[H,ze]),Ve=oe.useMemo(()=>{var Xe;if(!t)return Jd;const Ue=R.filter(xt=>xt.childId===t);return Ue.length===0&&t!==((Xe=n[0])==null?void 0:Xe.id)?Jd.map(xt=>({...xt,childId:t})):Ue.length===0&&n.length>0&&t===n[0].id?R.filter(xt=>!xt.childId):Ue.length>0?Ue:Jd.map(xt=>({...xt,childId:t}))},[R,t,n]),Ke=Ue=>{e(Xe=>[...Xe,Ue]),i(Ue.id),he({type:null}),ie(!1)},it=Ue=>{e(Xe=>Xe.map(xt=>xt.id===Ue.id?Ue:xt)),he({type:null})},Mn=()=>{window.confirm("Are you sure? This will delete ALL data for ALL children.")&&(localStorage.clear(),window.location.reload())},kt=Ue=>{const Xe=new Set(Ue.map(Tn=>Tn.id)).size;let yt=[...(Me==null?void 0:Me.badges)||uE],ut=null;if([10,20,30,40,50,60,70,80,90].forEach(Tn=>{const yn=`tried_${Tn}`,Pt=yt.findIndex(is=>is.id===yn);Pt!==-1&&!yt[Pt].isUnlocked&&Xe>=Tn&&(yt[Pt]={...yt[Pt],isUnlocked:!0,dateUnlocked:new Date().toISOString().split("T")[0]},ut=yt[Pt])}),Xe>=100){const Tn="100_club",yn=yt.findIndex(Pt=>Pt.id===Tn);yn!==-1&&!yt[yn].isUnlocked&&(yt[yn]={...yt[yn],isUnlocked:!0,dateUnlocked:new Date().toISOString().split("T")[0]},ut=yt[yn])}ut&&Me?(it({...Me,badges:yt}),he({type:"BADGE_UNLOCKED",badge:ut})):Me&&it({...Me,badges:yt})};return{state:{profiles:n,activeChildId:t,userProfile:Me,isOnboarding:ne,triedFoods:o,activeTriedFoods:ct,recipes:f,mealPlan:w,customFoods:A,activeMilestones:Ve,activeSavedStrategies:pe,manualShoppingItems:K,shoppingCheckedItems:le,feedLogs:ae,diaperLogs:Ie,sleepLogs:Ae,medicineLogs:je,growthLogs:rt,modalState:_e},actions:{setActiveChildId:i,setModalState:he,setIsOnboarding:ie,handleCreateChild:Ke,handleUpdateProfile:it,handleResetData:Mn,handleSaveFoodLog:(Ue,Xe)=>{if(!t)return;const xt={id:Ue,childId:t,...Xe},yt=[...o.filter(At=>!(At.childId===t&&At.id===Ue&&At.date===Xe.date&&At.meal===Xe.meal)),xt];c(yt);const ut=!ct.some(At=>At.id===Ue);if(he({type:null}),ut){kt(yt.filter(yn=>yn.childId===t));const At=A.find(yn=>yn.name===Ue);let Tn=[];At&&At.details.allergen_info&&At.details.allergen_info!=="No common allergens"&&Tn.push(At.details.allergen_info),Tn.length>0&&he({type:"ALLERGEN_ALERT",foodName:Ue,allergens:Tn})}},handleBatchLogMeal:(Ue,Xe,xt,yt,ut,At)=>{if(!t)return;const Tn=Ue.map(Pt=>{let is=6,Vt=!0;return Pt.status==="refused"?(is=1,Vt=!1):Pt.status==="touched"&&(is=3,Vt=!1),{id:Pt.food,childId:t,date:Xe,meal:xt,reaction:is,moreThanOneBite:Vt,allergyReaction:"none",notes:ut||"",tryCount:1,messyFaceImage:yt,behavioralTags:Pt.behavioralTags,portion:Pt.portion,consumption:Pt.consumption,usedStrategy:At}}),yn=[...o,...Tn];c(yn),kt(yn.filter(Pt=>Pt.childId===t))},handleUpdateBatchLog:(Ue,Xe,xt,yt,ut,At,Tn,yn)=>{if(!t)return;const Pt=o.filter(Vt=>!(Vt.childId===t&&Vt.date===Ue&&Vt.meal===Xe)),is=xt.map(Vt=>{let ii=6,zi=!0;return Vt.status==="refused"||Vt.consumption==="none"?(ii=1,zi=!1):(Vt.status==="touched"||Vt.consumption==="some")&&(ii=3,zi=!1),{id:Vt.food,childId:t,date:yt,meal:ut,reaction:ii,moreThanOneBite:zi,allergyReaction:"none",notes:Tn||"",tryCount:1,messyFaceImage:At,behavioralTags:Vt.behavioralTags,portion:Vt.portion,consumption:Vt.consumption,usedStrategy:yn}});c([...Pt,...is])},handleBarcodeScan:async Ue=>{he({type:null});try{const Xe=await a2(Ue);if(!Xe){alert("Product not found or error fetching details.");return}Xe.matchedFoods.length===1&&Xe.productName.toLowerCase().includes(Xe.matchedFoods[0].toLowerCase())?he({type:"LOG_MEAL",initialFoods:Xe.matchedFoods}):he({type:"ADD_CUSTOM_FOOD",scannedData:{name:Xe.productName,brand:Xe.brand,ingredientsText:Xe.ingredientsText,image:Xe.imageUrl}})}catch(Xe){console.error(Xe),alert("Error looking up barcode. Please try again.")}},handleCreateRecipe:Ue=>{const Xe={...Ue,id:crypto.randomUUID(),createdAt:new Date().toISOString(),rating:0};y([...f,Xe])},handleUpdateRecipe:(Ue,Xe)=>y(xt=>xt.map(yt=>yt.id===Ue?{...yt,...Xe}:yt)),handleDeleteRecipe:Ue=>y(Xe=>Xe.filter(xt=>xt.id!==Ue)),handleDeleteCustomFood:Ue=>{window.confirm(`Are you sure you want to delete "${Ue}"?`)&&N(Xe=>Xe.filter(xt=>xt.name!==Ue))},saveMealToPlan:(Ue,Xe,xt,yt)=>{x(ut=>({...ut,[Ue]:{...ut[Ue],[Xe]:{id:xt,title:yt}}})),he({type:null})},removeMealFromPlan:(Ue,Xe)=>x(xt=>{const yt={...xt};return yt[Ue]&&(delete yt[Ue][Xe],Object.keys(yt[Ue]).length===0&&delete yt[Ue]),yt}),handleSaveStrategy:Ue=>W(Xe=>[...Xe,{...Ue,childId:t}]),handleDeleteStrategy:Ue=>W(Xe=>Xe.filter(xt=>xt.id!==Ue)),handleUpdateSafeFoods:Ue=>{Me&&it({...Me,safeFoods:Ue})},handleAddManualItem:Ue=>te(Xe=>[...Xe,{id:crypto.randomUUID(),name:Ue,addedAt:new Date().toISOString()}]),handleToggleShoppingItem:(Ue,Xe)=>ee(xt=>{const yt={...xt};return Xe?yt[Ue]=new Date().toISOString():delete yt[Ue],yt}),handleClearCheckedItems:()=>{window.confirm("Clear all checked items?")&&(te(Ue=>Ue.filter(Xe=>!le[Xe.name])),ee({}))},handleLogFeed:Ue=>Ee(Xe=>[{...Ue,childId:t},...Xe]),handleLogDiaper:Ue=>U(Xe=>[{...Ue,childId:t},...Xe]),handleLogSleep:Ue=>F(Xe=>[{...Ue,childId:t},...Xe]),handleUpdateSleepLog:Ue=>F(Xe=>Xe.map(xt=>xt.id===Ue.id?Ue:xt)),handleLogMedicine:Ue=>Y(Xe=>[{...Ue,childId:t},...Xe]),handleLogGrowth:Ue=>z(Xe=>[{...Ue,childId:t},...Xe].sort((xt,yt)=>new Date(yt.date).getTime()-new Date(xt.date).getTime())),handleDeleteGrowth:Ue=>z(Xe=>Xe.filter(xt=>xt.id!==Ue)),handleUpdateMilestone:Ue=>k(Xe=>{const xt={...Ue,childId:t};return[...Xe.filter(ut=>{var At;return!(ut.id===Ue.id&&(ut.childId===t||!ut.childId&&t===((At=n[0])==null?void 0:At.id)))}),xt]}),handleIncrementTry:Ue=>{const Xe=o.find(xt=>xt.id===Ue&&xt.childId===t);if(Xe){const xt={...Xe,tryCount:(Xe.tryCount||1)+1};c(yt=>yt.map(ut=>ut.id===Ue&&ut.childId===t?xt:ut))}},setCustomFoods:N,setTriedFoods:c}}},gD=()=>{};var kw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},pD=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[i++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],f=n[t++],y=n[t++],w=((o&7)<<18|(c&63)<<12|(f&63)<<6|y&63)-65536;e[i++]=String.fromCharCode(55296+(w>>10)),e[i++]=String.fromCharCode(56320+(w&1023))}else{const c=n[t++],f=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(c&63)<<6|f&63)}}return e.join("")},f2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const c=n[o],f=o+1<n.length,y=f?n[o+1]:0,w=o+2<n.length,x=w?n[o+2]:0,A=c>>2,N=(c&3)<<4|y>>4;let R=(y&15)<<2|x>>6,k=x&63;w||(k=64,f||(R=64)),i.push(t[A],t[N],t[R],t[k])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(h2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):pD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],y=o<n.length?t[n.charAt(o)]:0;++o;const x=o<n.length?t[n.charAt(o)]:64;++o;const N=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||y==null||x==null||N==null)throw new xD;const R=c<<2|y>>4;if(i.push(R),x!==64){const k=y<<4&240|x>>2;if(i.push(k),N!==64){const H=x<<6&192|N;i.push(H)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class xD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yD=function(n){const e=h2(n);return f2.encodeByteArray(e,!0)},Mh=function(n){return yD(n).replace(/\./g,"")},m2=function(n){try{return f2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD=()=>vD().__FIREBASE_DEFAULTS__,bD=()=>{if(typeof process>"u"||typeof kw>"u")return;const n=kw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},ED=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&m2(n[1]);return e&&JSON.parse(e)},ef=()=>{try{return gD()||wD()||bD()||ED()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},g2=n=>{var e,t;return(t=(e=ef())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},_D=n=>{const e=g2(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},p2=()=>{var n;return(n=ef())==null?void 0:n.config},x2=n=>{var e;return(e=ef())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vc(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function y2(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AD(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const f={iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Mh(JSON.stringify(t)),Mh(JSON.stringify(f)),""].join(".")}const yu={};function SD(){const n={prod:[],emulator:[]};for(const e of Object.keys(yu))yu[e]?n.emulator.push(e):n.prod.push(e);return n}function CD(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Pw=!1;function v2(n,e){if(typeof window>"u"||typeof document>"u"||!vc(window.location.host)||yu[n]===e||yu[n]||Pw)return;yu[n]=e;function t(R){return`__firebase__banner__${R}`}const i="__firebase__banner",c=SD().prod.length>0;function f(){const R=document.getElementById(i);R&&R.remove()}function y(R){R.style.display="flex",R.style.background="#7faaf0",R.style.position="fixed",R.style.bottom="5px",R.style.left="5px",R.style.padding=".5em",R.style.borderRadius="5px",R.style.alignItems="center"}function w(R,k){R.setAttribute("width","24"),R.setAttribute("id",k),R.setAttribute("height","24"),R.setAttribute("viewBox","0 0 24 24"),R.setAttribute("fill","none"),R.style.marginLeft="-6px"}function x(){const R=document.createElement("span");return R.style.cursor="pointer",R.style.marginLeft="16px",R.style.fontSize="24px",R.innerHTML=" &times;",R.onclick=()=>{Pw=!0,f()},R}function A(R,k){R.setAttribute("id",k),R.innerText="Learn more",R.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",R.setAttribute("target","__blank"),R.style.paddingLeft="5px",R.style.textDecoration="underline"}function N(){const R=CD(i),k=t("text"),H=document.getElementById(k)||document.createElement("span"),W=t("learnmore"),K=document.getElementById(W)||document.createElement("a"),te=t("preprendIcon"),le=document.getElementById(te)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(R.created){const ee=R.element;y(ee),A(K,W);const de=x();w(le,te),ee.append(le,H,K,de),document.body.appendChild(ee)}c?(H.innerText="Preview backend disconnected.",le.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(le.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,H.innerText="Preview backend running in this workspace."),H.setAttribute("id",k)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",N):N()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ND(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ns())}function ID(){var e;const n=(e=ef())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function RD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function MD(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function DD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function OD(){const n=ns();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function kD(){return!ID()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function PD(){try{return typeof indexedDB=="object"}catch{return!1}}function LD(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var c;e(((c=o.error)==null?void 0:c.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD="FirebaseError";class Ro extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=UD,Object.setPrototypeOf(this,Ro.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pu.prototype.create)}}class Pu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],f=c?BD(c,i):"Error",y=`${this.serviceName}: ${f} (${o}).`;return new Ro(o,y,i)}}function BD(n,e){return n.replace(FD,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const FD=/\{\$([^}]+)}/g;function jD(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ol(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const c=n[o],f=e[o];if(Lw(c)&&Lw(f)){if(!ol(c,f))return!1}else if(c!==f)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function Lw(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function hu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,c]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function fu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function VD(n,e){const t=new GD(n,e);return t.subscribe.bind(t)}class GD{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");HD(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=ym),o.error===void 0&&(o.error=ym),o.complete===void 0&&(o.complete=ym);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function HD(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ym(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _r(n){return n&&n._delegate?n._delegate:n}class al{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new TD;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(YD(e))try{this.getOrInitializeService({instanceIdentifier:tl})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});i.resolve(c)}catch{}}}}clearInstance(e=tl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=tl){return this.instances.has(e)}getOptions(e=tl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[c,f]of this.instancesDeferred.entries()){const y=this.normalizeInstanceIdentifier(c);i===y&&f.resolve(o)}return o}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(i)??new Set;o.add(e),this.onInitCallbacks.set(i,o);const c=this.instances.get(i);return c&&e(c,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:qD(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=tl){return this.component?this.component.multipleInstances?e:tl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qD(n){return n===tl?void 0:n}function YD(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new zD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Zt||(Zt={}));const XD={debug:Zt.DEBUG,verbose:Zt.VERBOSE,info:Zt.INFO,warn:Zt.WARN,error:Zt.ERROR,silent:Zt.SILENT},KD=Zt.INFO,$D={[Zt.DEBUG]:"log",[Zt.VERBOSE]:"log",[Zt.INFO]:"info",[Zt.WARN]:"warn",[Zt.ERROR]:"error"},JD=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=$D[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kg{constructor(e){this.name=e,this._logLevel=KD,this._logHandler=JD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Zt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?XD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Zt.DEBUG,...e),this._logHandler(this,Zt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Zt.VERBOSE,...e),this._logHandler(this,Zt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Zt.INFO,...e),this._logHandler(this,Zt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Zt.WARN,...e),this._logHandler(this,Zt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Zt.ERROR,...e),this._logHandler(this,Zt.ERROR,...e)}}const QD=(n,e)=>e.some(t=>n instanceof t);let Uw,Bw;function ZD(){return Uw||(Uw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function e8(){return Bw||(Bw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const w2=new WeakMap,Ym=new WeakMap,b2=new WeakMap,vm=new WeakMap,Pg=new WeakMap;function t8(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",f)},c=()=>{t(ga(n.result)),o()},f=()=>{i(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",f)});return e.then(t=>{t instanceof IDBCursor&&w2.set(t,n)}).catch(()=>{}),Pg.set(e,n),e}function n8(n){if(Ym.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",f),n.removeEventListener("abort",f)},c=()=>{t(),o()},f=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",f),n.addEventListener("abort",f)});Ym.set(n,e)}let Wm={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ym.get(n);if(e==="objectStoreNames")return n.objectStoreNames||b2.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ga(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function i8(n){Wm=n(Wm)}function s8(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(wm(this),e,...t);return b2.set(i,e.sort?e.sort():[e]),ga(i)}:e8().includes(n)?function(...e){return n.apply(wm(this),e),ga(w2.get(this))}:function(...e){return ga(n.apply(wm(this),e))}}function r8(n){return typeof n=="function"?s8(n):(n instanceof IDBTransaction&&n8(n),QD(n,ZD())?new Proxy(n,Wm):n)}function ga(n){if(n instanceof IDBRequest)return t8(n);if(vm.has(n))return vm.get(n);const e=r8(n);return e!==n&&(vm.set(n,e),Pg.set(e,n)),e}const wm=n=>Pg.get(n);function o8(n,e,{blocked:t,upgrade:i,blocking:o,terminated:c}={}){const f=indexedDB.open(n,e),y=ga(f);return i&&f.addEventListener("upgradeneeded",w=>{i(ga(f.result),w.oldVersion,w.newVersion,ga(f.transaction),w)}),t&&f.addEventListener("blocked",w=>t(w.oldVersion,w.newVersion,w)),y.then(w=>{c&&w.addEventListener("close",()=>c()),o&&w.addEventListener("versionchange",x=>o(x.oldVersion,x.newVersion,x))}).catch(()=>{}),y}const a8=["get","getKey","getAll","getAllKeys","count"],l8=["put","add","delete","clear"],bm=new Map;function Fw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(bm.get(e))return bm.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=l8.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||a8.includes(t)))return;const c=async function(f,...y){const w=this.transaction(f,o?"readwrite":"readonly");let x=w.store;return i&&(x=x.index(y.shift())),(await Promise.all([x[t](...y),o&&w.done]))[0]};return bm.set(e,c),c}i8(n=>({...n,get:(e,t,i)=>Fw(e,t)||n.get(e,t,i),has:(e,t)=>!!Fw(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c8{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(u8(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function u8(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Xm="@firebase/app",jw="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao=new kg("@firebase/app"),d8="@firebase/app-compat",h8="@firebase/analytics-compat",f8="@firebase/analytics",m8="@firebase/app-check-compat",g8="@firebase/app-check",p8="@firebase/auth",x8="@firebase/auth-compat",y8="@firebase/database",v8="@firebase/data-connect",w8="@firebase/database-compat",b8="@firebase/functions",E8="@firebase/functions-compat",_8="@firebase/installations",T8="@firebase/installations-compat",A8="@firebase/messaging",S8="@firebase/messaging-compat",C8="@firebase/performance",N8="@firebase/performance-compat",I8="@firebase/remote-config",R8="@firebase/remote-config-compat",M8="@firebase/storage",D8="@firebase/storage-compat",O8="@firebase/firestore",k8="@firebase/ai",P8="@firebase/firestore-compat",L8="firebase",U8="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km="[DEFAULT]",B8={[Xm]:"fire-core",[d8]:"fire-core-compat",[f8]:"fire-analytics",[h8]:"fire-analytics-compat",[g8]:"fire-app-check",[m8]:"fire-app-check-compat",[p8]:"fire-auth",[x8]:"fire-auth-compat",[y8]:"fire-rtdb",[v8]:"fire-data-connect",[w8]:"fire-rtdb-compat",[b8]:"fire-fn",[E8]:"fire-fn-compat",[_8]:"fire-iid",[T8]:"fire-iid-compat",[A8]:"fire-fcm",[S8]:"fire-fcm-compat",[C8]:"fire-perf",[N8]:"fire-perf-compat",[I8]:"fire-rc",[R8]:"fire-rc-compat",[M8]:"fire-gcs",[D8]:"fire-gcs-compat",[O8]:"fire-fst",[P8]:"fire-fst-compat",[k8]:"fire-vertex","fire-js":"fire-js",[L8]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dh=new Map,F8=new Map,$m=new Map;function Vw(n,e){try{n.container.addComponent(e)}catch(t){Ao.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function lc(n){const e=n.name;if($m.has(e))return Ao.debug(`There were multiple attempts to register component ${e}.`),!1;$m.set(e,n);for(const t of Dh.values())Vw(t,n);for(const t of F8.values())Vw(t,n);return!0}function Lg(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Hs(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},pa=new Pu("app","Firebase",j8);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V8{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new al("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wc=U8;function E2(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Km,automaticDataCollectionEnabled:!0,...e},o=i.name;if(typeof o!="string"||!o)throw pa.create("bad-app-name",{appName:String(o)});if(t||(t=p2()),!t)throw pa.create("no-options");const c=Dh.get(o);if(c){if(ol(t,c.options)&&ol(i,c.config))return c;throw pa.create("duplicate-app",{appName:o})}const f=new WD(o);for(const w of $m.values())f.addComponent(w);const y=new V8(t,i,f);return Dh.set(o,y),y}function _2(n=Km){const e=Dh.get(n);if(!e&&n===Km&&p2())return E2();if(!e)throw pa.create("no-app",{appName:n});return e}function xa(n,e,t){let i=B8[n]??n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const f=[`Unable to register library "${i}" with version "${e}":`];o&&f.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&c&&f.push("and"),c&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ao.warn(f.join(" "));return}lc(new al(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G8="firebase-heartbeat-database",H8=1,Au="firebase-heartbeat-store";let Em=null;function T2(){return Em||(Em=o8(G8,H8,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Au)}catch(t){console.warn(t)}}}}).catch(n=>{throw pa.create("idb-open",{originalErrorMessage:n.message})})),Em}async function z8(n){try{const t=(await T2()).transaction(Au),i=await t.objectStore(Au).get(A2(n));return await t.done,i}catch(e){if(e instanceof Ro)Ao.warn(e.message);else{const t=pa.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ao.warn(t.message)}}}async function Gw(n,e){try{const i=(await T2()).transaction(Au,"readwrite");await i.objectStore(Au).put(e,A2(n)),await i.done}catch(t){if(t instanceof Ro)Ao.warn(t.message);else{const i=pa.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ao.warn(i.message)}}}function A2(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q8=1024,Y8=30;class W8{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new K8(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=Hw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(f=>f.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:o}),this._heartbeatsCache.heartbeats.length>Y8){const f=$8(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(f,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Ao.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Hw(),{heartbeatsToSend:i,unsentEntries:o}=X8(this._heartbeatsCache.heartbeats),c=Mh(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return Ao.warn(t),""}}}function Hw(){return new Date().toISOString().substring(0,10)}function X8(n,e=q8){const t=[];let i=n.slice();for(const o of n){const c=t.find(f=>f.agent===o.agent);if(c){if(c.dates.push(o.date),zw(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),zw(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class K8{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return PD()?LD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await z8(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Gw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Gw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function zw(n){return Mh(JSON.stringify({version:2,heartbeats:n})).length}function $8(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J8(n){lc(new al("platform-logger",e=>new c8(e),"PRIVATE")),lc(new al("heartbeat",e=>new W8(e),"PRIVATE")),xa(Xm,jw,n),xa(Xm,jw,"esm2020"),xa("fire-js","")}J8("");var Q8="firebase",Z8="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xa(Q8,Z8,"app");function S2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const e5=S2,C2=new Pu("auth","Firebase",S2());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh=new kg("@firebase/auth");function t5(n,...e){Oh.logLevel<=Zt.WARN&&Oh.warn(`Auth (${wc}): ${n}`,...e)}function dh(n,...e){Oh.logLevel<=Zt.ERROR&&Oh.error(`Auth (${wc}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(n,...e){throw Bg(n,...e)}function br(n,...e){return Bg(n,...e)}function Ug(n,e,t){const i={...e5(),[e]:t};return new Pu("auth","Firebase",i).create(e,{appName:n.name})}function _o(n){return Ug(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function n5(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&ur(n,"argument-error"),Ug(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Bg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return C2.create(n,...e)}function Tt(n,e,...t){if(!n)throw Bg(e,...t)}function bo(n){const e="INTERNAL ASSERTION FAILED: "+n;throw dh(e),new Error(e)}function So(n,e){n||bo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jm(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function i5(){return qw()==="http:"||qw()==="https:"}function qw(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(i5()||MD()||"connection"in navigator)?navigator.onLine:!0}function r5(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e,t){this.shortDelay=e,this.longDelay=t,So(t>e,"Short delay should be less than long delay!"),this.isMobile=ND()||DD()}get(){return s5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(n,e){So(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;bo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;bo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;bo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],l5=new Uu(3e4,6e4);function Na(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ia(n,e,t,i,o={}){return I2(n,o,async()=>{let c={},f={};i&&(e==="GET"?f=i:c={body:JSON.stringify(i)});const y=Lu({key:n.config.apiKey,...f}).slice(1),w=await n._getAdditionalHeaders();w["Content-Type"]="application/json",n.languageCode&&(w["X-Firebase-Locale"]=n.languageCode);const x={method:e,headers:w,...c};return RD()||(x.referrerPolicy="no-referrer"),n.emulatorConfig&&vc(n.emulatorConfig.host)&&(x.credentials="include"),N2.fetch()(await R2(n,n.config.apiHost,t,y),x)})}async function I2(n,e,t){n._canInitEmulator=!1;const i={...o5,...e};try{const o=new u5(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const f=await c.json();if("needConfirmation"in f)throw ih(n,"account-exists-with-different-credential",f);if(c.ok&&!("errorMessage"in f))return f;{const y=c.ok?f.errorMessage:f.error.message,[w,x]=y.split(" : ");if(w==="FEDERATED_USER_ID_ALREADY_LINKED")throw ih(n,"credential-already-in-use",f);if(w==="EMAIL_EXISTS")throw ih(n,"email-already-in-use",f);if(w==="USER_DISABLED")throw ih(n,"user-disabled",f);const A=i[w]||w.toLowerCase().replace(/[_\s]+/g,"-");if(x)throw Ug(n,A,x);ur(n,A)}}catch(o){if(o instanceof Ro)throw o;ur(n,"network-request-failed",{message:String(o)})}}async function Bu(n,e,t,i,o={}){const c=await Ia(n,e,t,i,o);return"mfaPendingCredential"in c&&ur(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function R2(n,e,t,i){const o=`${e}${t}?${i}`,c=n,f=c.config.emulator?Fg(n.config,o):`${n.config.apiScheme}://${o}`;return a5.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(f).toString():f}function c5(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class u5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(br(this.auth,"network-request-failed")),l5.get())})}}function ih(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=br(n,e,i);return o.customData._tokenResponse=t,o}function Yw(n){return n!==void 0&&n.enterprise!==void 0}class d5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return c5(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function h5(n,e){return Ia(n,"GET","/v2/recaptchaConfig",Na(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f5(n,e){return Ia(n,"POST","/v1/accounts:delete",e)}async function kh(n,e){return Ia(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function m5(n,e=!1){const t=_r(n),i=await t.getIdToken(e),o=jg(i);Tt(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,f=c==null?void 0:c.sign_in_provider;return{claims:o,token:i,authTime:vu(_m(o.auth_time)),issuedAtTime:vu(_m(o.iat)),expirationTime:vu(_m(o.exp)),signInProvider:f||null,signInSecondFactor:(c==null?void 0:c.sign_in_second_factor)||null}}function _m(n){return Number(n)*1e3}function jg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return dh("JWT malformed, contained fewer than 3 sections"),null;try{const o=m2(t);return o?JSON.parse(o):(dh("Failed to decode base64 JWT payload"),null)}catch(o){return dh("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function Ww(n){const e=jg(n);return Tt(e,"internal-error"),Tt(typeof e.exp<"u","internal-error"),Tt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Su(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Ro&&g5(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function g5({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=vu(this.lastLoginAt),this.creationTime=vu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ph(n){var N;const e=n.auth,t=await n.getIdToken(),i=await Su(n,kh(e,{idToken:t}));Tt(i==null?void 0:i.users.length,e,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const c=(N=o.providerUserInfo)!=null&&N.length?M2(o.providerUserInfo):[],f=y5(n.providerData,c),y=n.isAnonymous,w=!(n.email&&o.passwordHash)&&!(f!=null&&f.length),x=y?w:!1,A={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:f,metadata:new Qm(o.createdAt,o.lastLoginAt),isAnonymous:x};Object.assign(n,A)}async function x5(n){const e=_r(n);await Ph(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function y5(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function M2(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v5(n,e){const t=await I2(n,{},async()=>{const i=Lu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,f=await R2(n,o,"/v1/token",`key=${c}`),y=await n._getAdditionalHeaders();y["Content-Type"]="application/x-www-form-urlencoded";const w={method:"POST",headers:y,body:i};return n.emulatorConfig&&vc(n.emulatorConfig.host)&&(w.credentials="include"),N2.fetch()(f,w)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function w5(n,e){return Ia(n,"POST","/v2/accounts:revokeToken",Na(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Tt(e.idToken,"internal-error"),Tt(typeof e.idToken<"u","internal-error"),Tt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ww(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Tt(e.length!==0,"internal-error");const t=Ww(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Tt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:c}=await v5(e,t);this.updateTokensAndExpiration(i,o,Number(c))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:c}=t,f=new ec;return i&&(Tt(typeof i=="string","internal-error",{appName:e}),f.refreshToken=i),o&&(Tt(typeof o=="string","internal-error",{appName:e}),f.accessToken=o),c&&(Tt(typeof c=="number","internal-error",{appName:e}),f.expirationTime=c),f}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ec,this.toJSON())}_performRefresh(){return bo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ca(n,e){Tt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class yr{constructor({uid:e,auth:t,stsTokenManager:i,...o}){this.providerId="firebase",this.proactiveRefresh=new p5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Qm(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Su(this,this.stsTokenManager.getToken(this.auth,e));return Tt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return m5(this,e)}reload(){return x5(this)}_assign(e){this!==e&&(Tt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new yr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Ph(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Hs(this.auth.app))return Promise.reject(_o(this.auth));const e=await this.getIdToken();return await Su(this,f5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,o=t.email??void 0,c=t.phoneNumber??void 0,f=t.photoURL??void 0,y=t.tenantId??void 0,w=t._redirectEventId??void 0,x=t.createdAt??void 0,A=t.lastLoginAt??void 0,{uid:N,emailVerified:R,isAnonymous:k,providerData:H,stsTokenManager:W}=t;Tt(N&&W,e,"internal-error");const K=ec.fromJSON(this.name,W);Tt(typeof N=="string",e,"internal-error"),ca(i,e.name),ca(o,e.name),Tt(typeof R=="boolean",e,"internal-error"),Tt(typeof k=="boolean",e,"internal-error"),ca(c,e.name),ca(f,e.name),ca(y,e.name),ca(w,e.name),ca(x,e.name),ca(A,e.name);const te=new yr({uid:N,auth:e,email:o,emailVerified:R,displayName:i,isAnonymous:k,photoURL:f,phoneNumber:c,tenantId:y,stsTokenManager:K,createdAt:x,lastLoginAt:A});return H&&Array.isArray(H)&&(te.providerData=H.map(le=>({...le}))),w&&(te._redirectEventId=w),te}static async _fromIdTokenResponse(e,t,i=!1){const o=new ec;o.updateFromServerResponse(t);const c=new yr({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await Ph(c),c}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];Tt(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?M2(o.providerUserInfo):[],f=!(o.email&&o.passwordHash)&&!(c!=null&&c.length),y=new ec;y.updateFromIdToken(i);const w=new yr({uid:o.localId,auth:e,stsTokenManager:y,isAnonymous:f}),x={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new Qm(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(c!=null&&c.length)};return Object.assign(w,x),w}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw=new Map;function Eo(n){So(n instanceof Function,"Expected a class definition");let e=Xw.get(n);return e?(So(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Xw.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}D2.type="NONE";const Kw=D2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hh(n,e,t){return`firebase:${n}:${e}:${t}`}class tc{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:c}=this.auth;this.fullUserKey=hh(this.userKey,o.apiKey,c),this.fullPersistenceKey=hh("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await kh(this.auth,{idToken:e}).catch(()=>{});return t?yr._fromGetAccountInfoResponse(this.auth,t,e):null}return yr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new tc(Eo(Kw),e,i);const o=(await Promise.all(t.map(async x=>{if(await x._isAvailable())return x}))).filter(x=>x);let c=o[0]||Eo(Kw);const f=hh(i,e.config.apiKey,e.name);let y=null;for(const x of t)try{const A=await x._get(f);if(A){let N;if(typeof A=="string"){const R=await kh(e,{idToken:A}).catch(()=>{});if(!R)break;N=await yr._fromGetAccountInfoResponse(e,R,A)}else N=yr._fromJSON(e,A);x!==c&&(y=N),c=x;break}}catch{}const w=o.filter(x=>x._shouldAllowMigration);return!c._shouldAllowMigration||!w.length?new tc(c,e,i):(c=w[0],y&&await c._set(f,y.toJSON()),await Promise.all(t.map(async x=>{if(x!==c)try{await x._remove(f)}catch{}})),new tc(c,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(L2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(O2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(B2(e))return"Blackberry";if(F2(e))return"Webos";if(k2(e))return"Safari";if((e.includes("chrome/")||P2(e))&&!e.includes("edge/"))return"Chrome";if(U2(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function O2(n=ns()){return/firefox\//i.test(n)}function k2(n=ns()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function P2(n=ns()){return/crios\//i.test(n)}function L2(n=ns()){return/iemobile/i.test(n)}function U2(n=ns()){return/android/i.test(n)}function B2(n=ns()){return/blackberry/i.test(n)}function F2(n=ns()){return/webos/i.test(n)}function Vg(n=ns()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function b5(n=ns()){var e;return Vg(n)&&!!((e=window.navigator)!=null&&e.standalone)}function E5(){return OD()&&document.documentMode===10}function j2(n=ns()){return Vg(n)||U2(n)||F2(n)||B2(n)||/windows phone/i.test(n)||L2(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V2(n,e=[]){let t;switch(n){case"Browser":t=$w(ns());break;case"Worker":t=`${$w(ns())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${wc}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=c=>new Promise((f,y)=>{try{const w=e(c);f(w)}catch(w){y(w)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T5(n,e={}){return Ia(n,"GET","/v2/passwordPolicy",Na(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A5=6;class S5{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??A5,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C5{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Jw(this),this.idTokenSubscription=new Jw(this),this.beforeStateQueue=new _5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=C2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Eo(t)),this._initializationPromise=this.queue(async()=>{var i,o,c;if(!this._deleted&&(this.persistenceManager=await tc.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((o=this._popupRedirectResolver)!=null&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((c=this.currentUser)==null?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await kh(this,{idToken:e}),i=await yr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var c;if(Hs(this.app)){const f=this.app.settings.authIdToken;return f?new Promise(y=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(f).then(y,y))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const f=(c=this.redirectUser)==null?void 0:c._redirectEventId,y=i==null?void 0:i._redirectEventId,w=await this.tryRedirectSignIn(e);(!f||f===y)&&(w!=null&&w.user)&&(i=w.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(f){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(f))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Tt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ph(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=r5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Hs(this.app))return Promise.reject(_o(this));const t=e?_r(e):null;return t&&Tt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Tt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Hs(this.app)?Promise.reject(_o(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Hs(this.app)?Promise.reject(_o(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Eo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await T5(this),t=new S5(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Pu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await w5(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Eo(e)||this._popupRedirectResolver;Tt(t,this,"argument-error"),this.redirectPersistenceManager=await tc.create(this,[Eo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let f=!1;const y=this._isInitialized?Promise.resolve():this._initializationPromise;if(Tt(y,this,"internal-error"),y.then(()=>{f||c(this.currentUser)}),typeof t=="function"){const w=e.addObserver(t,i,o);return()=>{f=!0,w()}}else{const w=e.addObserver(t);return()=>{f=!0,w()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=V2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var o;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((o=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:o.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(Hs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&t5(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ra(n){return _r(n)}class Jw{constructor(e){this.auth=e,this.observer=null,this.addObserver=VD(t=>this.observer=t)}get next(){return Tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function N5(n){tf=n}function G2(n){return tf.loadJS(n)}function I5(){return tf.recaptchaEnterpriseScript}function R5(){return tf.gapiScript}function M5(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class D5{constructor(){this.enterprise=new O5}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class O5{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const k5="recaptcha-enterprise",H2="NO_RECAPTCHA";class P5{constructor(e){this.type=k5,this.auth=Ra(e)}async verify(e="verify",t=!1){async function i(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(f,y)=>{h5(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(w=>{if(w.recaptchaKey===void 0)y(new Error("recaptcha Enterprise site key undefined"));else{const x=new d5(w);return c.tenantId==null?c._agentRecaptchaConfig=x:c._tenantRecaptchaConfigs[c.tenantId]=x,f(x.siteKey)}}).catch(w=>{y(w)})})}function o(c,f,y){const w=window.grecaptcha;Yw(w)?w.enterprise.ready(()=>{w.enterprise.execute(c,{action:e}).then(x=>{f(x)}).catch(()=>{f(H2)})}):y(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new D5().execute("siteKey",{action:"verify"}):new Promise((c,f)=>{i(this.auth).then(y=>{if(!t&&Yw(window.grecaptcha))o(y,c,f);else{if(typeof window>"u"){f(new Error("RecaptchaVerifier is only supported in browser"));return}let w=I5();w.length!==0&&(w+=y),G2(w).then(()=>{o(y,c,f)}).catch(x=>{f(x)})}}).catch(y=>{f(y)})})}}async function Qw(n,e,t,i=!1,o=!1){const c=new P5(n);let f;if(o)f=H2;else try{f=await c.verify(t)}catch{f=await c.verify(t,!0)}const y={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in y){const w=y.phoneEnrollmentInfo.phoneNumber,x=y.phoneEnrollmentInfo.recaptchaToken;Object.assign(y,{phoneEnrollmentInfo:{phoneNumber:w,recaptchaToken:x,captchaResponse:f,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in y){const w=y.phoneSignInInfo.recaptchaToken;Object.assign(y,{phoneSignInInfo:{recaptchaToken:w,captchaResponse:f,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return y}return i?Object.assign(y,{captchaResp:f}):Object.assign(y,{captchaResponse:f}),Object.assign(y,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(y,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),y}async function Zm(n,e,t,i,o){var c;if((c=n._getRecaptchaConfig())!=null&&c.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const f=await Qw(n,e,t,t==="getOobCode");return i(n,f)}else return i(n,e).catch(async f=>{if(f.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const y=await Qw(n,e,t,t==="getOobCode");return i(n,y)}else return Promise.reject(f)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L5(n,e){const t=Lg(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(ol(c,e??{}))return o;ur(o,"already-initialized")}return t.initialize({options:e})}function U5(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Eo);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function B5(n,e,t){const i=Ra(n);Tt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,c=z2(e),{host:f,port:y}=F5(e),w=y===null?"":`:${y}`,x={url:`${c}//${f}${w}/`},A=Object.freeze({host:f,port:y,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){Tt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Tt(ol(x,i.config.emulator)&&ol(A,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=x,i.emulatorConfig=A,i.settings.appVerificationDisabledForTesting=!0,vc(f)?(y2(`${c}//${f}${w}`),v2("Auth",!0)):j5()}function z2(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function F5(n){const e=z2(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const c=o[1];return{host:c,port:Zw(i.substr(c.length+1))}}else{const[c,f]=i.split(":");return{host:c,port:Zw(f)}}}function Zw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function j5(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return bo("not implemented")}_getIdTokenResponse(e){return bo("not implemented")}_linkToIdToken(e,t){return bo("not implemented")}_getReauthenticationResolver(e){return bo("not implemented")}}async function V5(n,e){return Ia(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G5(n,e){return Bu(n,"POST","/v1/accounts:signInWithPassword",Na(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H5(n,e){return Bu(n,"POST","/v1/accounts:signInWithEmailLink",Na(n,e))}async function z5(n,e){return Bu(n,"POST","/v1/accounts:signInWithEmailLink",Na(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu extends Gg{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Cu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Cu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zm(e,t,"signInWithPassword",G5);case"emailLink":return H5(e,{email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zm(e,i,"signUpPassword",V5);case"emailLink":return z5(e,{idToken:t,email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nc(n,e){return Bu(n,"POST","/v1/accounts:signInWithIdp",Na(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q5="http://localhost";class ll extends Gg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ll(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ur("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o,...c}=t;if(!i||!o)return null;const f=new ll(i,o);return f.idToken=c.idToken||void 0,f.accessToken=c.accessToken||void 0,f.secret=c.secret,f.nonce=c.nonce,f.pendingToken=c.pendingToken||null,f}_getIdTokenResponse(e){const t=this.buildRequest();return nc(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,nc(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,nc(e,t)}buildRequest(){const e={requestUri:q5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Lu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y5(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function W5(n){const e=hu(fu(n)).link,t=e?hu(fu(e)).deep_link_id:null,i=hu(fu(n)).deep_link_id;return(i?hu(fu(i)).link:null)||i||t||e||n}class Hg{constructor(e){const t=hu(fu(e)),i=t.apiKey??null,o=t.oobCode??null,c=Y5(t.mode??null);Tt(i&&o&&c,"argument-error"),this.apiKey=i,this.operation=c,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=W5(e);try{return new Hg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(){this.providerId=bc.PROVIDER_ID}static credential(e,t){return Cu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Hg.parseLink(t);return Tt(i,"argument-error"),Cu._fromEmailAndCode(e,i.code,i.tenantId)}}bc.PROVIDER_ID="password";bc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";bc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu extends zg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua extends Fu{constructor(){super("facebook.com")}static credential(e){return ll._fromParams({providerId:ua.PROVIDER_ID,signInMethod:ua.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ua.credentialFromTaggedObject(e)}static credentialFromError(e){return ua.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ua.credential(e.oauthAccessToken)}catch{return null}}}ua.FACEBOOK_SIGN_IN_METHOD="facebook.com";ua.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo extends Fu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ll._fromParams({providerId:wo.PROVIDER_ID,signInMethod:wo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return wo.credentialFromTaggedObject(e)}static credentialFromError(e){return wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return wo.credential(t,i)}catch{return null}}}wo.GOOGLE_SIGN_IN_METHOD="google.com";wo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da extends Fu{constructor(){super("github.com")}static credential(e){return ll._fromParams({providerId:da.PROVIDER_ID,signInMethod:da.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return da.credentialFromTaggedObject(e)}static credentialFromError(e){return da.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return da.credential(e.oauthAccessToken)}catch{return null}}}da.GITHUB_SIGN_IN_METHOD="github.com";da.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha extends Fu{constructor(){super("twitter.com")}static credential(e,t){return ll._fromParams({providerId:ha.PROVIDER_ID,signInMethod:ha.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ha.credentialFromTaggedObject(e)}static credentialFromError(e){return ha.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return ha.credential(t,i)}catch{return null}}}ha.TWITTER_SIGN_IN_METHOD="twitter.com";ha.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X5(n,e){return Bu(n,"POST","/v1/accounts:signUp",Na(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const c=await yr._fromIdTokenResponse(e,i,o),f=eb(i);return new cl({user:c,providerId:f,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=eb(i);return new cl({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function eb(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh extends Ro{constructor(e,t,i,o){super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,Lh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new Lh(e,t,i,o)}}function q2(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?Lh._fromErrorAndOperation(n,c,e,i):c})}async function K5(n,e,t=!1){const i=await Su(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return cl._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $5(n,e,t=!1){const{auth:i}=n;if(Hs(i.app))return Promise.reject(_o(i));const o="reauthenticate";try{const c=await Su(n,q2(i,o,e,n),t);Tt(c.idToken,i,"internal-error");const f=jg(c.idToken);Tt(f,i,"internal-error");const{sub:y}=f;return Tt(n.uid===y,i,"user-mismatch"),cl._forOperation(n,o,c)}catch(c){throw(c==null?void 0:c.code)==="auth/user-not-found"&&ur(i,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y2(n,e,t=!1){if(Hs(n.app))return Promise.reject(_o(n));const i="signIn",o=await q2(n,i,e),c=await cl._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(c.user),c}async function J5(n,e){return Y2(Ra(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W2(n){const e=Ra(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Q5(n,e,t){if(Hs(n.app))return Promise.reject(_o(n));const i=Ra(n),f=await Zm(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",X5).catch(w=>{throw w.code==="auth/password-does-not-meet-requirements"&&W2(n),w}),y=await cl._fromIdTokenResponse(i,"signIn",f);return await i._updateCurrentUser(y.user),y}function Z5(n,e,t){return Hs(n.app)?Promise.reject(_o(n)):J5(_r(n),bc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&W2(n),i})}function eO(n,e,t,i){return _r(n).onIdTokenChanged(e,t,i)}function tO(n,e,t){return _r(n).beforeAuthStateChanged(e,t)}function X2(n,e,t,i){return _r(n).onAuthStateChanged(e,t,i)}function nO(n){return _r(n).signOut()}const Uh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Uh,"1"),this.storage.removeItem(Uh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO=1e3,sO=10;class $2 extends K2{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=j2(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((f,y,w)=>{this.notifyListeners(f,w)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const f=this.storage.getItem(i);!t&&this.localCache[i]===f||this.notifyListeners(i,f)},c=this.storage.getItem(i);E5()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,sO):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},iO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}$2.type="LOCAL";const rO=$2;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J2 extends K2{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}J2.type="SESSION";const Q2=J2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oO(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new nf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:c}=t.data,f=this.handlersMap[o];if(!(f!=null&&f.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const y=Array.from(f).map(async x=>x(t.origin,c)),w=await oO(y);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:w})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}nf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,f;return new Promise((y,w)=>{const x=qg("",20);o.port1.start();const A=setTimeout(()=>{w(new Error("unsupported_event"))},i);f={messageChannel:o,onMessage(N){const R=N;if(R.data.eventId===x)switch(R.data.status){case"ack":clearTimeout(A),c=setTimeout(()=>{w(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),y(R.data.response);break;default:clearTimeout(A),clearTimeout(c),w(new Error("invalid_response"));break}}},this.handlers.add(f),o.port1.addEventListener("message",f.onMessage),this.target.postMessage({eventType:e,eventId:x,data:t},[o.port2])}).finally(()=>{f&&this.removeMessageHandler(f)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Br(){return window}function lO(n){Br().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(){return typeof Br().WorkerGlobalScope<"u"&&typeof Br().importScripts=="function"}async function cO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function uO(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function dO(){return Z2()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_="firebaseLocalStorageDb",hO=1,Bh="firebaseLocalStorage",t_="fbase_key";class ju{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function sf(n,e){return n.transaction([Bh],e?"readwrite":"readonly").objectStore(Bh)}function fO(){const n=indexedDB.deleteDatabase(e_);return new ju(n).toPromise()}function eg(){const n=indexedDB.open(e_,hO);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Bh,{keyPath:t_})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Bh)?e(i):(i.close(),await fO(),e(await eg()))})})}async function tb(n,e,t){const i=sf(n,!0).put({[t_]:e,value:t});return new ju(i).toPromise()}async function mO(n,e){const t=sf(n,!1).get(e),i=await new ju(t).toPromise();return i===void 0?null:i.value}function nb(n,e){const t=sf(n,!0).delete(e);return new ju(t).toPromise()}const gO=800,pO=3;class n_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await eg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>pO)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Z2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nf._getInstance(dO()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await cO(),!this.activeServiceWorker)return;this.sender=new aO(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||uO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await eg();return await tb(e,Uh,"1"),await nb(e,Uh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>tb(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>mO(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>nb(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=sf(o,!1).getAll();return new ju(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),gO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}n_.type="LOCAL";const xO=n_;new Uu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i_(n,e){return e?Eo(e):(Tt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg extends Gg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return nc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return nc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return nc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function yO(n){return Y2(n.auth,new Yg(n),n.bypassAuthState)}function vO(n){const{auth:e,user:t}=n;return Tt(t,e,"internal-error"),$5(t,new Yg(n),n.bypassAuthState)}async function wO(n){const{auth:e,user:t}=n;return Tt(t,e,"internal-error"),K5(t,new Yg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e,t,i,o,c=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:c,error:f,type:y}=e;if(f){this.reject(f);return}const w={auth:this.auth,requestUri:t,sessionId:i,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(y)(w))}catch(x){this.reject(x)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return yO;case"linkViaPopup":case"linkViaRedirect":return wO;case"reauthViaPopup":case"reauthViaRedirect":return vO;default:ur(this.auth,"internal-error")}}resolve(e){So(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){So(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bO=new Uu(2e3,1e4);async function EO(n,e,t){if(Hs(n.app))return Promise.reject(br(n,"operation-not-supported-in-this-environment"));const i=Ra(n);n5(n,e,zg);const o=i_(i,t);return new nl(i,"signInViaPopup",e,o).executeNotNull()}class nl extends s_{constructor(e,t,i,o,c){super(e,t,o,c),this.provider=i,this.authWindow=null,this.pollId=null,nl.currentPopupAction&&nl.currentPopupAction.cancel(),nl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Tt(e,this.auth,"internal-error"),e}async onExecution(){So(this.filter.length===1,"Popup operations only handle one event");const e=qg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(br(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(br(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(br(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,bO.get())};e()}}nl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _O="pendingRedirect",fh=new Map;class TO extends s_{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=fh.get(this.auth._key());if(!e){try{const i=await AO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}fh.set(this.auth._key(),e)}return this.bypassAuthState||fh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function AO(n,e){const t=NO(e),i=CO(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function SO(n,e){fh.set(n._key(),e)}function CO(n){return Eo(n._redirectPersistence)}function NO(n){return hh(_O,n.config.apiKey,n.name)}async function IO(n,e,t=!1){if(Hs(n.app))return Promise.reject(_o(n));const i=Ra(n),o=i_(i,e),f=await new TO(i,o,t).execute();return f&&!t&&(delete f.user._redirectEventId,await i._persistUserIfCurrent(f.user),await i._setRedirectUser(null,e)),f}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RO=600*1e3;class MO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!DO(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!r_(e)){const o=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(br(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=RO&&this.cachedEventUids.clear(),this.cachedEventUids.has(ib(e))}saveEventToCache(e){this.cachedEventUids.add(ib(e)),this.lastProcessedEventTime=Date.now()}}function ib(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function r_({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function DO(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return r_(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OO(n,e={}){return Ia(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,PO=/^https?/;async function LO(n){if(n.config.emulator)return;const{authorizedDomains:e}=await OO(n);for(const t of e)try{if(UO(t))return}catch{}ur(n,"unauthorized-domain")}function UO(n){const e=Jm(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const f=new URL(n);return f.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&f.hostname===i}if(!PO.test(t))return!1;if(kO.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BO=new Uu(3e4,6e4);function sb(){const n=Br().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function FO(n){return new Promise((e,t)=>{var o,c,f;function i(){sb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{sb(),t(br(n,"network-request-failed"))},timeout:BO.get()})}if((c=(o=Br().gapi)==null?void 0:o.iframes)!=null&&c.Iframe)e(gapi.iframes.getContext());else if((f=Br().gapi)!=null&&f.load)i();else{const y=M5("iframefcb");return Br()[y]=()=>{gapi.load?i():t(br(n,"network-request-failed"))},G2(`${R5()}?onload=${y}`).catch(w=>t(w))}}).catch(e=>{throw mh=null,e})}let mh=null;function jO(n){return mh=mh||FO(n),mh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VO=new Uu(5e3,15e3),GO="__/auth/iframe",HO="emulator/auth/iframe",zO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},qO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function YO(n){const e=n.config;Tt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Fg(e,HO):`https://${n.config.authDomain}/${GO}`,i={apiKey:e.apiKey,appName:n.name,v:wc},o=qO.get(n.config.apiHost);o&&(i.eid=o);const c=n._getFrameworks();return c.length&&(i.fw=c.join(",")),`${t}?${Lu(i).slice(1)}`}async function WO(n){const e=await jO(n),t=Br().gapi;return Tt(t,n,"internal-error"),e.open({where:document.body,url:YO(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:zO,dontclear:!0},i=>new Promise(async(o,c)=>{await i.restyle({setHideOnLeave:!1});const f=br(n,"network-request-failed"),y=Br().setTimeout(()=>{c(f)},VO.get());function w(){Br().clearTimeout(y),o(i)}i.ping(w).then(w,()=>{c(f)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},KO=500,$O=600,JO="_blank",QO="http://localhost";class rb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ZO(n,e,t,i=KO,o=$O){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),f=Math.max((window.screen.availWidth-i)/2,0).toString();let y="";const w={...XO,width:i.toString(),height:o.toString(),top:c,left:f},x=ns().toLowerCase();t&&(y=P2(x)?JO:t),O2(x)&&(e=e||QO,w.scrollbars="yes");const A=Object.entries(w).reduce((R,[k,H])=>`${R}${k}=${H},`,"");if(b5(x)&&y!=="_self")return ek(e||"",y),new rb(null);const N=window.open(e||"",y,A);Tt(N,n,"popup-blocked");try{N.focus()}catch{}return new rb(N)}function ek(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tk="__/auth/handler",nk="emulator/auth/handler",ik=encodeURIComponent("fac");async function ob(n,e,t,i,o,c){Tt(n.config.authDomain,n,"auth-domain-config-required"),Tt(n.config.apiKey,n,"invalid-api-key");const f={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:wc,eventId:o};if(e instanceof zg){e.setDefaultLanguage(n.languageCode),f.providerId=e.providerId||"",jD(e.getCustomParameters())||(f.customParameters=JSON.stringify(e.getCustomParameters()));for(const[A,N]of Object.entries({}))f[A]=N}if(e instanceof Fu){const A=e.getScopes().filter(N=>N!=="");A.length>0&&(f.scopes=A.join(","))}n.tenantId&&(f.tid=n.tenantId);const y=f;for(const A of Object.keys(y))y[A]===void 0&&delete y[A];const w=await n._getAppCheckToken(),x=w?`#${ik}=${encodeURIComponent(w)}`:"";return`${sk(n)}?${Lu(y).slice(1)}${x}`}function sk({config:n}){return n.emulator?Fg(n,nk):`https://${n.authDomain}/${tk}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tm="webStorageSupport";class rk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Q2,this._completeRedirectFn=IO,this._overrideRedirectResult=SO}async _openPopup(e,t,i,o){var f;So((f=this.eventManagers[e._key()])==null?void 0:f.manager,"_initialize() not called before _openPopup()");const c=await ob(e,t,i,Jm(),o);return ZO(e,c,qg())}async _openRedirect(e,t,i,o){await this._originValidation(e);const c=await ob(e,t,i,Jm(),o);return lO(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(So(c,"If manager is not set, promise should be"),c)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await WO(e),i=new MO(e);return t.register("authEvent",o=>(Tt(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Tm,{type:Tm},o=>{var f;const c=(f=o==null?void 0:o[0])==null?void 0:f[Tm];c!==void 0&&t(!!c),ur(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=LO(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return j2()||k2()||Vg()}}const ok=rk;var ab="@firebase/auth",lb="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lk(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function ck(n){lc(new al("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:f,authDomain:y}=i.options;Tt(f&&!f.includes(":"),"invalid-api-key",{appName:i.name});const w={apiKey:f,authDomain:y,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:V2(n)},x=new C5(i,o,c,w);return U5(x,t),x},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),lc(new al("auth-internal",e=>{const t=Ra(e.getProvider("auth").getImmediate());return(i=>new ak(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),xa(ab,lb,lk(n)),xa(ab,lb,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uk=300,dk=x2("authIdTokenMaxAge")||uk;let cb=null;const hk=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>dk)return;const o=t==null?void 0:t.token;cb!==o&&(cb=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function fk(n=_2()){const e=Lg(n,"auth");if(e.isInitialized())return e.getImmediate();const t=L5(n,{popupRedirectResolver:ok,persistence:[xO,rO,Q2]}),i=x2("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(i,location.origin);if(location.origin===c.origin){const f=hk(c.toString());tO(t,f,()=>f(t.currentUser)),eO(t,y=>f(y))}}const o=g2("auth");return o&&B5(t,`http://${o}`),t}function mk(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}N5({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const c=br("internal-error");c.customData=o,t(c)},i.type="text/javascript",i.charset="UTF-8",mk().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});ck("Browser");var ub=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ya,o_;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(U,V){function F(){}F.prototype=V.prototype,U.F=V.prototype,U.prototype=new F,U.prototype.constructor=U,U.D=function(Q,Y,$){for(var z=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)z[_e-2]=arguments[_e];return V.prototype[Y].apply(Q,z)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(U,V,F){F||(F=0);const Q=Array(16);if(typeof V=="string")for(var Y=0;Y<16;++Y)Q[Y]=V.charCodeAt(F++)|V.charCodeAt(F++)<<8|V.charCodeAt(F++)<<16|V.charCodeAt(F++)<<24;else for(Y=0;Y<16;++Y)Q[Y]=V[F++]|V[F++]<<8|V[F++]<<16|V[F++]<<24;V=U.g[0],F=U.g[1],Y=U.g[2];let $=U.g[3],z;z=V+($^F&(Y^$))+Q[0]+3614090360&4294967295,V=F+(z<<7&4294967295|z>>>25),z=$+(Y^V&(F^Y))+Q[1]+3905402710&4294967295,$=V+(z<<12&4294967295|z>>>20),z=Y+(F^$&(V^F))+Q[2]+606105819&4294967295,Y=$+(z<<17&4294967295|z>>>15),z=F+(V^Y&($^V))+Q[3]+3250441966&4294967295,F=Y+(z<<22&4294967295|z>>>10),z=V+($^F&(Y^$))+Q[4]+4118548399&4294967295,V=F+(z<<7&4294967295|z>>>25),z=$+(Y^V&(F^Y))+Q[5]+1200080426&4294967295,$=V+(z<<12&4294967295|z>>>20),z=Y+(F^$&(V^F))+Q[6]+2821735955&4294967295,Y=$+(z<<17&4294967295|z>>>15),z=F+(V^Y&($^V))+Q[7]+4249261313&4294967295,F=Y+(z<<22&4294967295|z>>>10),z=V+($^F&(Y^$))+Q[8]+1770035416&4294967295,V=F+(z<<7&4294967295|z>>>25),z=$+(Y^V&(F^Y))+Q[9]+2336552879&4294967295,$=V+(z<<12&4294967295|z>>>20),z=Y+(F^$&(V^F))+Q[10]+4294925233&4294967295,Y=$+(z<<17&4294967295|z>>>15),z=F+(V^Y&($^V))+Q[11]+2304563134&4294967295,F=Y+(z<<22&4294967295|z>>>10),z=V+($^F&(Y^$))+Q[12]+1804603682&4294967295,V=F+(z<<7&4294967295|z>>>25),z=$+(Y^V&(F^Y))+Q[13]+4254626195&4294967295,$=V+(z<<12&4294967295|z>>>20),z=Y+(F^$&(V^F))+Q[14]+2792965006&4294967295,Y=$+(z<<17&4294967295|z>>>15),z=F+(V^Y&($^V))+Q[15]+1236535329&4294967295,F=Y+(z<<22&4294967295|z>>>10),z=V+(Y^$&(F^Y))+Q[1]+4129170786&4294967295,V=F+(z<<5&4294967295|z>>>27),z=$+(F^Y&(V^F))+Q[6]+3225465664&4294967295,$=V+(z<<9&4294967295|z>>>23),z=Y+(V^F&($^V))+Q[11]+643717713&4294967295,Y=$+(z<<14&4294967295|z>>>18),z=F+($^V&(Y^$))+Q[0]+3921069994&4294967295,F=Y+(z<<20&4294967295|z>>>12),z=V+(Y^$&(F^Y))+Q[5]+3593408605&4294967295,V=F+(z<<5&4294967295|z>>>27),z=$+(F^Y&(V^F))+Q[10]+38016083&4294967295,$=V+(z<<9&4294967295|z>>>23),z=Y+(V^F&($^V))+Q[15]+3634488961&4294967295,Y=$+(z<<14&4294967295|z>>>18),z=F+($^V&(Y^$))+Q[4]+3889429448&4294967295,F=Y+(z<<20&4294967295|z>>>12),z=V+(Y^$&(F^Y))+Q[9]+568446438&4294967295,V=F+(z<<5&4294967295|z>>>27),z=$+(F^Y&(V^F))+Q[14]+3275163606&4294967295,$=V+(z<<9&4294967295|z>>>23),z=Y+(V^F&($^V))+Q[3]+4107603335&4294967295,Y=$+(z<<14&4294967295|z>>>18),z=F+($^V&(Y^$))+Q[8]+1163531501&4294967295,F=Y+(z<<20&4294967295|z>>>12),z=V+(Y^$&(F^Y))+Q[13]+2850285829&4294967295,V=F+(z<<5&4294967295|z>>>27),z=$+(F^Y&(V^F))+Q[2]+4243563512&4294967295,$=V+(z<<9&4294967295|z>>>23),z=Y+(V^F&($^V))+Q[7]+1735328473&4294967295,Y=$+(z<<14&4294967295|z>>>18),z=F+($^V&(Y^$))+Q[12]+2368359562&4294967295,F=Y+(z<<20&4294967295|z>>>12),z=V+(F^Y^$)+Q[5]+4294588738&4294967295,V=F+(z<<4&4294967295|z>>>28),z=$+(V^F^Y)+Q[8]+2272392833&4294967295,$=V+(z<<11&4294967295|z>>>21),z=Y+($^V^F)+Q[11]+1839030562&4294967295,Y=$+(z<<16&4294967295|z>>>16),z=F+(Y^$^V)+Q[14]+4259657740&4294967295,F=Y+(z<<23&4294967295|z>>>9),z=V+(F^Y^$)+Q[1]+2763975236&4294967295,V=F+(z<<4&4294967295|z>>>28),z=$+(V^F^Y)+Q[4]+1272893353&4294967295,$=V+(z<<11&4294967295|z>>>21),z=Y+($^V^F)+Q[7]+4139469664&4294967295,Y=$+(z<<16&4294967295|z>>>16),z=F+(Y^$^V)+Q[10]+3200236656&4294967295,F=Y+(z<<23&4294967295|z>>>9),z=V+(F^Y^$)+Q[13]+681279174&4294967295,V=F+(z<<4&4294967295|z>>>28),z=$+(V^F^Y)+Q[0]+3936430074&4294967295,$=V+(z<<11&4294967295|z>>>21),z=Y+($^V^F)+Q[3]+3572445317&4294967295,Y=$+(z<<16&4294967295|z>>>16),z=F+(Y^$^V)+Q[6]+76029189&4294967295,F=Y+(z<<23&4294967295|z>>>9),z=V+(F^Y^$)+Q[9]+3654602809&4294967295,V=F+(z<<4&4294967295|z>>>28),z=$+(V^F^Y)+Q[12]+3873151461&4294967295,$=V+(z<<11&4294967295|z>>>21),z=Y+($^V^F)+Q[15]+530742520&4294967295,Y=$+(z<<16&4294967295|z>>>16),z=F+(Y^$^V)+Q[2]+3299628645&4294967295,F=Y+(z<<23&4294967295|z>>>9),z=V+(Y^(F|~$))+Q[0]+4096336452&4294967295,V=F+(z<<6&4294967295|z>>>26),z=$+(F^(V|~Y))+Q[7]+1126891415&4294967295,$=V+(z<<10&4294967295|z>>>22),z=Y+(V^($|~F))+Q[14]+2878612391&4294967295,Y=$+(z<<15&4294967295|z>>>17),z=F+($^(Y|~V))+Q[5]+4237533241&4294967295,F=Y+(z<<21&4294967295|z>>>11),z=V+(Y^(F|~$))+Q[12]+1700485571&4294967295,V=F+(z<<6&4294967295|z>>>26),z=$+(F^(V|~Y))+Q[3]+2399980690&4294967295,$=V+(z<<10&4294967295|z>>>22),z=Y+(V^($|~F))+Q[10]+4293915773&4294967295,Y=$+(z<<15&4294967295|z>>>17),z=F+($^(Y|~V))+Q[1]+2240044497&4294967295,F=Y+(z<<21&4294967295|z>>>11),z=V+(Y^(F|~$))+Q[8]+1873313359&4294967295,V=F+(z<<6&4294967295|z>>>26),z=$+(F^(V|~Y))+Q[15]+4264355552&4294967295,$=V+(z<<10&4294967295|z>>>22),z=Y+(V^($|~F))+Q[6]+2734768916&4294967295,Y=$+(z<<15&4294967295|z>>>17),z=F+($^(Y|~V))+Q[13]+1309151649&4294967295,F=Y+(z<<21&4294967295|z>>>11),z=V+(Y^(F|~$))+Q[4]+4149444226&4294967295,V=F+(z<<6&4294967295|z>>>26),z=$+(F^(V|~Y))+Q[11]+3174756917&4294967295,$=V+(z<<10&4294967295|z>>>22),z=Y+(V^($|~F))+Q[2]+718787259&4294967295,Y=$+(z<<15&4294967295|z>>>17),z=F+($^(Y|~V))+Q[9]+3951481745&4294967295,U.g[0]=U.g[0]+V&4294967295,U.g[1]=U.g[1]+(Y+(z<<21&4294967295|z>>>11))&4294967295,U.g[2]=U.g[2]+Y&4294967295,U.g[3]=U.g[3]+$&4294967295}i.prototype.v=function(U,V){V===void 0&&(V=U.length);const F=V-this.blockSize,Q=this.C;let Y=this.h,$=0;for(;$<V;){if(Y==0)for(;$<=F;)o(this,U,$),$+=this.blockSize;if(typeof U=="string"){for(;$<V;)if(Q[Y++]=U.charCodeAt($++),Y==this.blockSize){o(this,Q),Y=0;break}}else for(;$<V;)if(Q[Y++]=U[$++],Y==this.blockSize){o(this,Q),Y=0;break}}this.h=Y,this.o+=V},i.prototype.A=function(){var U=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);U[0]=128;for(var V=1;V<U.length-8;++V)U[V]=0;V=this.o*8;for(var F=U.length-8;F<U.length;++F)U[F]=V&255,V/=256;for(this.v(U),U=Array(16),V=0,F=0;F<4;++F)for(let Q=0;Q<32;Q+=8)U[V++]=this.g[F]>>>Q&255;return U};function c(U,V){var F=y;return Object.prototype.hasOwnProperty.call(F,U)?F[U]:F[U]=V(U)}function f(U,V){this.h=V;const F=[];let Q=!0;for(let Y=U.length-1;Y>=0;Y--){const $=U[Y]|0;Q&&$==V||(F[Y]=$,Q=!1)}this.g=F}var y={};function w(U){return-128<=U&&U<128?c(U,function(V){return new f([V|0],V<0?-1:0)}):new f([U|0],U<0?-1:0)}function x(U){if(isNaN(U)||!isFinite(U))return N;if(U<0)return K(x(-U));const V=[];let F=1;for(let Q=0;U>=F;Q++)V[Q]=U/F|0,F*=4294967296;return new f(V,0)}function A(U,V){if(U.length==0)throw Error("number format error: empty string");if(V=V||10,V<2||36<V)throw Error("radix out of range: "+V);if(U.charAt(0)=="-")return K(A(U.substring(1),V));if(U.indexOf("-")>=0)throw Error('number format error: interior "-" character');const F=x(Math.pow(V,8));let Q=N;for(let $=0;$<U.length;$+=8){var Y=Math.min(8,U.length-$);const z=parseInt(U.substring($,$+Y),V);Y<8?(Y=x(Math.pow(V,Y)),Q=Q.j(Y).add(x(z))):(Q=Q.j(F),Q=Q.add(x(z)))}return Q}var N=w(0),R=w(1),k=w(16777216);n=f.prototype,n.m=function(){if(W(this))return-K(this).m();let U=0,V=1;for(let F=0;F<this.g.length;F++){const Q=this.i(F);U+=(Q>=0?Q:4294967296+Q)*V,V*=4294967296}return U},n.toString=function(U){if(U=U||10,U<2||36<U)throw Error("radix out of range: "+U);if(H(this))return"0";if(W(this))return"-"+K(this).toString(U);const V=x(Math.pow(U,6));var F=this;let Q="";for(;;){const Y=de(F,V).g;F=te(F,Y.j(V));let $=((F.g.length>0?F.g[0]:F.h)>>>0).toString(U);if(F=Y,H(F))return $+Q;for(;$.length<6;)$="0"+$;Q=$+Q}},n.i=function(U){return U<0?0:U<this.g.length?this.g[U]:this.h};function H(U){if(U.h!=0)return!1;for(let V=0;V<U.g.length;V++)if(U.g[V]!=0)return!1;return!0}function W(U){return U.h==-1}n.l=function(U){return U=te(this,U),W(U)?-1:H(U)?0:1};function K(U){const V=U.g.length,F=[];for(let Q=0;Q<V;Q++)F[Q]=~U.g[Q];return new f(F,~U.h).add(R)}n.abs=function(){return W(this)?K(this):this},n.add=function(U){const V=Math.max(this.g.length,U.g.length),F=[];let Q=0;for(let Y=0;Y<=V;Y++){let $=Q+(this.i(Y)&65535)+(U.i(Y)&65535),z=($>>>16)+(this.i(Y)>>>16)+(U.i(Y)>>>16);Q=z>>>16,$&=65535,z&=65535,F[Y]=z<<16|$}return new f(F,F[F.length-1]&-2147483648?-1:0)};function te(U,V){return U.add(K(V))}n.j=function(U){if(H(this)||H(U))return N;if(W(this))return W(U)?K(this).j(K(U)):K(K(this).j(U));if(W(U))return K(this.j(K(U)));if(this.l(k)<0&&U.l(k)<0)return x(this.m()*U.m());const V=this.g.length+U.g.length,F=[];for(var Q=0;Q<2*V;Q++)F[Q]=0;for(Q=0;Q<this.g.length;Q++)for(let Y=0;Y<U.g.length;Y++){const $=this.i(Q)>>>16,z=this.i(Q)&65535,_e=U.i(Y)>>>16,he=U.i(Y)&65535;F[2*Q+2*Y]+=z*he,le(F,2*Q+2*Y),F[2*Q+2*Y+1]+=$*he,le(F,2*Q+2*Y+1),F[2*Q+2*Y+1]+=z*_e,le(F,2*Q+2*Y+1),F[2*Q+2*Y+2]+=$*_e,le(F,2*Q+2*Y+2)}for(U=0;U<V;U++)F[U]=F[2*U+1]<<16|F[2*U];for(U=V;U<2*V;U++)F[U]=0;return new f(F,0)};function le(U,V){for(;(U[V]&65535)!=U[V];)U[V+1]+=U[V]>>>16,U[V]&=65535,V++}function ee(U,V){this.g=U,this.h=V}function de(U,V){if(H(V))throw Error("division by zero");if(H(U))return new ee(N,N);if(W(U))return V=de(K(U),V),new ee(K(V.g),K(V.h));if(W(V))return V=de(U,K(V)),new ee(K(V.g),V.h);if(U.g.length>30){if(W(U)||W(V))throw Error("slowDivide_ only works with positive integers.");for(var F=R,Q=V;Q.l(U)<=0;)F=Ee(F),Q=Ee(Q);var Y=me(F,1),$=me(Q,1);for(Q=me(Q,2),F=me(F,2);!H(Q);){var z=$.add(Q);z.l(U)<=0&&(Y=Y.add(F),$=z),Q=me(Q,1),F=me(F,1)}return V=te(U,Y.j(V)),new ee(Y,V)}for(Y=N;U.l(V)>=0;){for(F=Math.max(1,Math.floor(U.m()/V.m())),Q=Math.ceil(Math.log(F)/Math.LN2),Q=Q<=48?1:Math.pow(2,Q-48),$=x(F),z=$.j(V);W(z)||z.l(U)>0;)F-=Q,$=x(F),z=$.j(V);H($)&&($=R),Y=Y.add($),U=te(U,z)}return new ee(Y,U)}n.B=function(U){return de(this,U).h},n.and=function(U){const V=Math.max(this.g.length,U.g.length),F=[];for(let Q=0;Q<V;Q++)F[Q]=this.i(Q)&U.i(Q);return new f(F,this.h&U.h)},n.or=function(U){const V=Math.max(this.g.length,U.g.length),F=[];for(let Q=0;Q<V;Q++)F[Q]=this.i(Q)|U.i(Q);return new f(F,this.h|U.h)},n.xor=function(U){const V=Math.max(this.g.length,U.g.length),F=[];for(let Q=0;Q<V;Q++)F[Q]=this.i(Q)^U.i(Q);return new f(F,this.h^U.h)};function Ee(U){const V=U.g.length+1,F=[];for(let Q=0;Q<V;Q++)F[Q]=U.i(Q)<<1|U.i(Q-1)>>>31;return new f(F,U.h)}function me(U,V){const F=V>>5;V%=32;const Q=U.g.length-F,Y=[];for(let $=0;$<Q;$++)Y[$]=V>0?U.i($+F)>>>V|U.i($+F+1)<<32-V:U.i($+F);return new f(Y,U.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o_=i,f.prototype.add=f.prototype.add,f.prototype.multiply=f.prototype.j,f.prototype.modulo=f.prototype.B,f.prototype.compare=f.prototype.l,f.prototype.toNumber=f.prototype.m,f.prototype.toString=f.prototype.toString,f.prototype.getBits=f.prototype.i,f.fromNumber=x,f.fromString=A,ya=f}).apply(typeof ub<"u"?ub:typeof self<"u"?self:typeof window<"u"?window:{});var sh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var a_,mu,l_,gh,tg,c_,u_,d_;(function(){var n,e=Object.defineProperty;function t(E){E=[typeof globalThis=="object"&&globalThis,E,typeof window=="object"&&window,typeof self=="object"&&self,typeof sh=="object"&&sh];for(var D=0;D<E.length;++D){var L=E[D];if(L&&L.Math==Math)return L}throw Error("Cannot find global object")}var i=t(this);function o(E,D){if(D)e:{var L=i;E=E.split(".");for(var X=0;X<E.length-1;X++){var xe=E[X];if(!(xe in L))break e;L=L[xe]}E=E[E.length-1],X=L[E],D=D(X),D!=X&&D!=null&&e(L,E,{configurable:!0,writable:!0,value:D})}}o("Symbol.dispose",function(E){return E||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(E){return E||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(E){return E||function(D){var L=[],X;for(X in D)Object.prototype.hasOwnProperty.call(D,X)&&L.push([X,D[X]]);return L}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},f=this||self;function y(E){var D=typeof E;return D=="object"&&E!=null||D=="function"}function w(E,D,L){return E.call.apply(E.bind,arguments)}function x(E,D,L){return x=w,x.apply(null,arguments)}function A(E,D){var L=Array.prototype.slice.call(arguments,1);return function(){var X=L.slice();return X.push.apply(X,arguments),E.apply(this,X)}}function N(E,D){function L(){}L.prototype=D.prototype,E.Z=D.prototype,E.prototype=new L,E.prototype.constructor=E,E.Ob=function(X,xe,Ne){for(var Ye=Array(arguments.length-2),Ct=2;Ct<arguments.length;Ct++)Ye[Ct-2]=arguments[Ct];return D.prototype[xe].apply(X,Ye)}}var R=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?E=>E&&AsyncContext.Snapshot.wrap(E):E=>E;function k(E){const D=E.length;if(D>0){const L=Array(D);for(let X=0;X<D;X++)L[X]=E[X];return L}return[]}function H(E,D){for(let X=1;X<arguments.length;X++){const xe=arguments[X];var L=typeof xe;if(L=L!="object"?L:xe?Array.isArray(xe)?"array":L:"null",L=="array"||L=="object"&&typeof xe.length=="number"){L=E.length||0;const Ne=xe.length||0;E.length=L+Ne;for(let Ye=0;Ye<Ne;Ye++)E[L+Ye]=xe[Ye]}else E.push(xe)}}class W{constructor(D,L){this.i=D,this.j=L,this.h=0,this.g=null}get(){let D;return this.h>0?(this.h--,D=this.g,this.g=D.next,D.next=null):D=this.i(),D}}function K(E){f.setTimeout(()=>{throw E},0)}function te(){var E=U;let D=null;return E.g&&(D=E.g,E.g=E.g.next,E.g||(E.h=null),D.next=null),D}class le{constructor(){this.h=this.g=null}add(D,L){const X=ee.get();X.set(D,L),this.h?this.h.next=X:this.g=X,this.h=X}}var ee=new W(()=>new de,E=>E.reset());class de{constructor(){this.next=this.g=this.h=null}set(D,L){this.h=D,this.g=L,this.next=null}reset(){this.next=this.g=this.h=null}}let Ee,me=!1,U=new le,V=()=>{const E=Promise.resolve(void 0);Ee=()=>{E.then(F)}};function F(){for(var E;E=te();){try{E.h.call(E.g)}catch(L){K(L)}var D=ee;D.j(E),D.h<100&&(D.h++,E.next=D.g,D.g=E)}me=!1}function Q(){this.u=this.u,this.C=this.C}Q.prototype.u=!1,Q.prototype.dispose=function(){this.u||(this.u=!0,this.N())},Q.prototype[Symbol.dispose]=function(){this.dispose()},Q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Y(E,D){this.type=E,this.g=this.target=D,this.defaultPrevented=!1}Y.prototype.h=function(){this.defaultPrevented=!0};var $=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var E=!1,D=Object.defineProperty({},"passive",{get:function(){E=!0}});try{const L=()=>{};f.addEventListener("test",L,D),f.removeEventListener("test",L,D)}catch{}return E})();function z(E){return/^[\s\xa0]*$/.test(E)}function _e(E,D){Y.call(this,E?E.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,E&&this.init(E,D)}N(_e,Y),_e.prototype.init=function(E,D){const L=this.type=E.type,X=E.changedTouches&&E.changedTouches.length?E.changedTouches[0]:null;this.target=E.target||E.srcElement,this.g=D,D=E.relatedTarget,D||(L=="mouseover"?D=E.fromElement:L=="mouseout"&&(D=E.toElement)),this.relatedTarget=D,X?(this.clientX=X.clientX!==void 0?X.clientX:X.pageX,this.clientY=X.clientY!==void 0?X.clientY:X.pageY,this.screenX=X.screenX||0,this.screenY=X.screenY||0):(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0),this.button=E.button,this.key=E.key||"",this.ctrlKey=E.ctrlKey,this.altKey=E.altKey,this.shiftKey=E.shiftKey,this.metaKey=E.metaKey,this.pointerId=E.pointerId||0,this.pointerType=E.pointerType,this.state=E.state,this.i=E,E.defaultPrevented&&_e.Z.h.call(this)},_e.prototype.h=function(){_e.Z.h.call(this);const E=this.i;E.preventDefault?E.preventDefault():E.returnValue=!1};var he="closure_listenable_"+(Math.random()*1e6|0),ne=0;function ie(E,D,L,X,xe){this.listener=E,this.proxy=null,this.src=D,this.type=L,this.capture=!!X,this.ha=xe,this.key=++ne,this.da=this.fa=!1}function Me(E){E.da=!0,E.listener=null,E.proxy=null,E.src=null,E.ha=null}function ze(E,D,L){for(const X in E)D.call(L,E[X],X,E)}function ct(E,D){for(const L in E)D.call(void 0,E[L],L,E)}function ae(E){const D={};for(const L in E)D[L]=E[L];return D}const Ie="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ae(E,D){let L,X;for(let xe=1;xe<arguments.length;xe++){X=arguments[xe];for(L in X)E[L]=X[L];for(let Ne=0;Ne<Ie.length;Ne++)L=Ie[Ne],Object.prototype.hasOwnProperty.call(X,L)&&(E[L]=X[L])}}function je(E){this.src=E,this.g={},this.h=0}je.prototype.add=function(E,D,L,X,xe){const Ne=E.toString();E=this.g[Ne],E||(E=this.g[Ne]=[],this.h++);const Ye=pe(E,D,X,xe);return Ye>-1?(D=E[Ye],L||(D.fa=!1)):(D=new ie(D,this.src,Ne,!!X,xe),D.fa=L,E.push(D)),D};function rt(E,D){const L=D.type;if(L in E.g){var X=E.g[L],xe=Array.prototype.indexOf.call(X,D,void 0),Ne;(Ne=xe>=0)&&Array.prototype.splice.call(X,xe,1),Ne&&(Me(D),E.g[L].length==0&&(delete E.g[L],E.h--))}}function pe(E,D,L,X){for(let xe=0;xe<E.length;++xe){const Ne=E[xe];if(!Ne.da&&Ne.listener==D&&Ne.capture==!!L&&Ne.ha==X)return xe}return-1}var Ve="closure_lm_"+(Math.random()*1e6|0),Ke={};function it(E,D,L,X,xe){if(Array.isArray(D)){for(let Ne=0;Ne<D.length;Ne++)it(E,D[Ne],L,X,xe);return null}return L=Qe(L),E&&E[he]?E.J(D,L,y(X)?!!X.capture:!1,xe):Mn(E,D,L,!1,X,xe)}function Mn(E,D,L,X,xe,Ne){if(!D)throw Error("Invalid event type");const Ye=y(xe)?!!xe.capture:!!xe;let Ct=ot(E);if(Ct||(E[Ve]=Ct=new je(E)),L=Ct.add(D,L,X,Ye,Ne),L.proxy)return L;if(X=kt(),L.proxy=X,X.src=E,X.listener=L,E.addEventListener)$||(xe=Ye),xe===void 0&&(xe=!1),E.addEventListener(D.toString(),X,xe);else if(E.attachEvent)E.attachEvent(Pn(D.toString()),X);else if(E.addListener&&E.removeListener)E.addListener(X);else throw Error("addEventListener and attachEvent are unavailable.");return L}function kt(){function E(L){return D.call(E.src,E.listener,L)}const D=De;return E}function Dn(E,D,L,X,xe){if(Array.isArray(D))for(var Ne=0;Ne<D.length;Ne++)Dn(E,D[Ne],L,X,xe);else X=y(X)?!!X.capture:!!X,L=Qe(L),E&&E[he]?(E=E.i,Ne=String(D).toString(),Ne in E.g&&(D=E.g[Ne],L=pe(D,L,X,xe),L>-1&&(Me(D[L]),Array.prototype.splice.call(D,L,1),D.length==0&&(delete E.g[Ne],E.h--)))):E&&(E=ot(E))&&(D=E.g[D.toString()],E=-1,D&&(E=pe(D,L,X,xe)),(L=E>-1?D[E]:null)&&St(L))}function St(E){if(typeof E!="number"&&E&&!E.da){var D=E.src;if(D&&D[he])rt(D.i,E);else{var L=E.type,X=E.proxy;D.removeEventListener?D.removeEventListener(L,X,E.capture):D.detachEvent?D.detachEvent(Pn(L),X):D.addListener&&D.removeListener&&D.removeListener(X),(L=ot(D))?(rt(L,E),L.h==0&&(L.src=null,D[Ve]=null)):Me(E)}}}function Pn(E){return E in Ke?Ke[E]:Ke[E]="on"+E}function De(E,D){if(E.da)E=!0;else{D=new _e(D,this);const L=E.listener,X=E.ha||E.src;E.fa&&St(E),E=L.call(X,D)}return E}function ot(E){return E=E[Ve],E instanceof je?E:null}var ht="__closure_events_fn_"+(Math.random()*1e9>>>0);function Qe(E){return typeof E=="function"?E:(E[ht]||(E[ht]=function(D){return E.handleEvent(D)}),E[ht])}function nt(){Q.call(this),this.i=new je(this),this.M=this,this.G=null}N(nt,Q),nt.prototype[he]=!0,nt.prototype.removeEventListener=function(E,D,L,X){Dn(this,E,D,L,X)};function xn(E,D){var L,X=E.G;if(X)for(L=[];X;X=X.G)L.push(X);if(E=E.M,X=D.type||D,typeof D=="string")D=new Y(D,E);else if(D instanceof Y)D.target=D.target||E;else{var xe=D;D=new Y(X,E),Ae(D,xe)}xe=!0;let Ne,Ye;if(L)for(Ye=L.length-1;Ye>=0;Ye--)Ne=D.g=L[Ye],xe=Ze(Ne,X,!0,D)&&xe;if(Ne=D.g=E,xe=Ze(Ne,X,!0,D)&&xe,xe=Ze(Ne,X,!1,D)&&xe,L)for(Ye=0;Ye<L.length;Ye++)Ne=D.g=L[Ye],xe=Ze(Ne,X,!1,D)&&xe}nt.prototype.N=function(){if(nt.Z.N.call(this),this.i){var E=this.i;for(const D in E.g){const L=E.g[D];for(let X=0;X<L.length;X++)Me(L[X]);delete E.g[D],E.h--}}this.G=null},nt.prototype.J=function(E,D,L,X){return this.i.add(String(E),D,!1,L,X)},nt.prototype.K=function(E,D,L,X){return this.i.add(String(E),D,!0,L,X)};function Ze(E,D,L,X){if(D=E.i.g[String(D)],!D)return!0;D=D.concat();let xe=!0;for(let Ne=0;Ne<D.length;++Ne){const Ye=D[Ne];if(Ye&&!Ye.da&&Ye.capture==L){const Ct=Ye.listener,qn=Ye.ha||Ye.src;Ye.fa&&rt(E.i,Ye),xe=Ct.call(qn,X)!==!1&&xe}}return xe&&!X.defaultPrevented}function Gr(E,D){if(typeof E!="function")if(E&&typeof E.handleEvent=="function")E=x(E.handleEvent,E);else throw Error("Invalid listener argument");return Number(D)>2147483647?-1:f.setTimeout(E,D||0)}function Mo(E){E.g=Gr(()=>{E.g=null,E.i&&(E.i=!1,Mo(E))},E.l);const D=E.h;E.h=null,E.m.apply(null,D)}class On extends Q{constructor(D,L){super(),this.m=D,this.l=L,this.h=null,this.i=!1,this.g=null}j(D){this.h=arguments,this.g?this.i=!0:Mo(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qs(E){Q.call(this),this.h=E,this.g={}}N(qs,Q);var Ei=[];function Hr(E){ze(E.g,function(D,L){this.g.hasOwnProperty(L)&&St(D)},E),E.g={}}qs.prototype.N=function(){qs.Z.N.call(this),Hr(this)},qs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _i=f.JSON.stringify,ci=f.JSON.parse,Do=class{stringify(E){return f.JSON.stringify(E,void 0)}parse(E){return f.JSON.parse(E,void 0)}};function Tr(){}function Ma(){}var an={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ge(){Y.call(this,"d")}N(Ge,Y);function ln(){Y.call(this,"c")}N(ln,Y);var _t={},Ue=null;function Xe(){return Ue=Ue||new nt}_t.Ia="serverreachability";function xt(E){Y.call(this,_t.Ia,E)}N(xt,Y);function yt(E){const D=Xe();xn(D,new xt(D))}_t.STAT_EVENT="statevent";function ut(E,D){Y.call(this,_t.STAT_EVENT,E),this.stat=D}N(ut,Y);function At(E){const D=Xe();xn(D,new ut(D,E))}_t.Ja="timingevent";function Tn(E,D){Y.call(this,_t.Ja,E),this.size=D}N(Tn,Y);function yn(E,D){if(typeof E!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){E()},D)}function Pt(){this.g=!0}Pt.prototype.ua=function(){this.g=!1};function is(E,D,L,X,xe,Ne){E.info(function(){if(E.g)if(Ne){var Ye="",Ct=Ne.split("&");for(let en=0;en<Ct.length;en++){var qn=Ct[en].split("=");if(qn.length>1){const In=qn[0];qn=qn[1];const as=In.split("_");Ye=as.length>=2&&as[1]=="type"?Ye+(In+"="+qn+"&"):Ye+(In+"=redacted&")}}}else Ye=null;else Ye=Ne;return"XMLHTTP REQ ("+X+") [attempt "+xe+"]: "+D+`
`+L+`
`+Ye})}function Vt(E,D,L,X,xe,Ne,Ye){E.info(function(){return"XMLHTTP RESP ("+X+") [ attempt "+xe+"]: "+D+`
`+L+`
`+Ne+" "+Ye})}function ii(E,D,L,X){E.info(function(){return"XMLHTTP TEXT ("+D+"): "+ps(E,L)+(X?" "+X:"")})}function zi(E,D){E.info(function(){return"TIMEOUT: "+D})}Pt.prototype.info=function(){};function ps(E,D){if(!E.g)return D;if(!D)return null;try{const Ne=JSON.parse(D);if(Ne){for(E=0;E<Ne.length;E++)if(Array.isArray(Ne[E])){var L=Ne[E];if(!(L.length<2)){var X=L[1];if(Array.isArray(X)&&!(X.length<1)){var xe=X[0];if(xe!="noop"&&xe!="stop"&&xe!="close")for(let Ye=1;Ye<X.length;Ye++)X[Ye]=""}}}}return _i(Ne)}catch{return D}}var zr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Is={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},qr;function Qn(){}N(Qn,Tr),Qn.prototype.g=function(){return new XMLHttpRequest},qr=new Qn;function Ri(E){return encodeURIComponent(String(E))}function Mi(E){var D=1;E=E.split(":");const L=[];for(;D>0&&E.length;)L.push(E.shift()),D--;return E.length&&L.push(E.join(":")),L}function Je(E,D,L,X){this.j=E,this.i=D,this.l=L,this.S=X||1,this.V=new qs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ti}function Ti(){this.i=null,this.g="",this.h=!1}var jn={},cn={};function Di(E,D,L){E.M=1,E.A=Yi(Gn(D)),E.u=L,E.R=!0,dr(E,null)}function dr(E,D){E.F=Date.now(),Ys(E),E.B=Gn(E.A);var L=E.B,X=E.S;Array.isArray(X)||(X=[String(X)]),vn(L.i,"t",X),E.C=0,L=E.j.L,E.h=new Ti,E.g=Bo(E.j,L?D:null,!E.u),E.P>0&&(E.O=new On(x(E.Y,E,E.g),E.P)),D=E.V,L=E.g,X=E.ba;var xe="readystatechange";Array.isArray(xe)||(xe&&(Ei[0]=xe.toString()),xe=Ei);for(let Ne=0;Ne<xe.length;Ne++){const Ye=it(L,xe[Ne],X||D.handleEvent,!1,D.h||D);if(!Ye)break;D.g[Ye.key]=Ye}D=E.J?ae(E.J):{},E.u?(E.v||(E.v="POST"),D["Content-Type"]="application/x-www-form-urlencoded",E.g.ea(E.B,E.v,E.u,D)):(E.v="GET",E.g.ea(E.B,E.v,null,D)),yt(),is(E.i,E.v,E.B,E.l,E.S,E.u)}Je.prototype.ba=function(E){E=E.target;const D=this.O;D&&vs(E)==3?D.j():this.Y(E)},Je.prototype.Y=function(E){try{if(E==this.g)e:{const Ct=vs(this.g),qn=this.g.ya(),en=this.g.ca();if(!(Ct<3)&&(Ct!=3||this.g&&(this.h.h||this.g.la()||Kn(this.g)))){this.K||Ct!=4||qn==7||(qn==8||en<=0?yt(3):yt(2)),kn(this);var D=this.g.ca();this.X=D;var L=Oo(this);if(this.o=D==200,Vt(this.i,this.v,this.B,this.l,this.S,Ct,D),this.o){if(this.U&&!this.L){t:{if(this.g){var X,xe=this.g;if((X=xe.g?xe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(X)){var Ne=X;break t}}Ne=null}if(E=Ne)ii(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,xi(this,E);else{this.o=!1,this.m=3,At(12),qi(this),zt(this);break e}}if(this.R){E=!0;let In;for(;!this.K&&this.C<L.length;)if(In=fl(this,L),In==cn){Ct==4&&(this.m=4,At(14),E=!1),ii(this.i,this.l,null,"[Incomplete Response]");break}else if(In==jn){this.m=4,At(15),ii(this.i,this.l,L,"[Invalid Chunk]"),E=!1;break}else ii(this.i,this.l,In,null),xi(this,In);if(ss(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ct!=4||L.length!=0||this.h.h||(this.m=1,At(16),E=!1),this.o=this.o&&E,!E)ii(this.i,this.l,L,"[Invalid Chunked Response]"),qi(this),zt(this);else if(L.length>0&&!this.W){this.W=!0;var Ye=this.j;Ye.g==this&&Ye.aa&&!Ye.P&&(Ye.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),Se(Ye),Ye.P=!0,At(11))}}else ii(this.i,this.l,L,null),xi(this,L);Ct==4&&qi(this),this.o&&!this.K&&(Ct==4?Jr(this.j,this):(this.o=!1,Ys(this)))}else os(this.g),D==400&&L.indexOf("Unknown SID")>0?(this.m=3,At(12)):(this.m=0,At(13)),qi(this),zt(this)}}}catch{}finally{}};function Oo(E){if(!ss(E))return E.g.la();const D=Kn(E.g);if(D==="")return"";let L="";const X=D.length,xe=vs(E.g)==4;if(!E.h.i){if(typeof TextDecoder>"u")return qi(E),zt(E),"";E.h.i=new f.TextDecoder}for(let Ne=0;Ne<X;Ne++)E.h.h=!0,L+=E.h.i.decode(D[Ne],{stream:!(xe&&Ne==X-1)});return D.length=0,E.h.g+=L,E.C=0,E.h.g}function ss(E){return E.g?E.v=="GET"&&E.M!=2&&E.j.Aa:!1}function fl(E,D){var L=E.C,X=D.indexOf(`
`,L);return X==-1?cn:(L=Number(D.substring(L,X)),isNaN(L)?jn:(X+=1,X+L>D.length?cn:(D=D.slice(X,X+L),E.C=X+L,D)))}Je.prototype.cancel=function(){this.K=!0,qi(this)};function Ys(E){E.T=Date.now()+E.H,Oi(E,E.H)}function Oi(E,D){if(E.D!=null)throw Error("WatchDog timer not null");E.D=yn(x(E.aa,E),D)}function kn(E){E.D&&(f.clearTimeout(E.D),E.D=null)}Je.prototype.aa=function(){this.D=null;const E=Date.now();E-this.T>=0?(zi(this.i,this.B),this.M!=2&&(yt(),At(17)),qi(this),this.m=2,zt(this)):Oi(this,this.T-E)};function zt(E){E.j.I==0||E.K||Jr(E.j,E)}function qi(E){kn(E);var D=E.O;D&&typeof D.dispose=="function"&&D.dispose(),E.O=null,Hr(E.V),E.g&&(D=E.g,E.g=null,D.abort(),D.dispose())}function xi(E,D){try{var L=E.j;if(L.I!=0&&(L.g==E||ki(L.h,E))){if(!E.L&&ki(L.h,E)&&L.I==3){try{var X=L.Ba.g.parse(D)}catch{X=null}if(Array.isArray(X)&&X.length==3){var xe=X;if(xe[0]==0){e:if(!L.v){if(L.g)if(L.g.F+3e3<E.F)Hn(L),mr(L);else break e;$r(L),At(18)}}else L.xa=xe[1],0<L.xa-L.K&&xe[2]<37500&&L.F&&L.A==0&&!L.C&&(L.C=yn(x(L.Va,L),6e3));un(L.h)<=1&&L.ta&&(L.ta=void 0)}else Ks(L,11)}else if((E.L||L.g==E)&&Hn(L),!z(D))for(xe=L.Ba.g.parse(D),D=0;D<xe.length;D++){let en=xe[D];const In=en[0];if(!(In<=L.K))if(L.K=In,en=en[1],L.I==2)if(en[0]=="c"){L.M=en[1],L.ba=en[2];const as=en[3];as!=null&&(L.ka=as,L.j.info("VER="+L.ka));const Qs=en[4];Qs!=null&&(L.za=Qs,L.j.info("SVER="+L.za));const Si=en[5];Si!=null&&typeof Si=="number"&&Si>0&&(X=1.5*Si,L.O=X,L.j.info("backChannelRequestTimeoutMs_="+X)),X=L;const ls=E.g;if(ls){const Zr=ls.g?ls.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zr){var Ne=X.h;Ne.g||Zr.indexOf("spdy")==-1&&Zr.indexOf("quic")==-1&&Zr.indexOf("h2")==-1||(Ne.j=Ne.l,Ne.g=new Set,Ne.h&&(Oa(Ne,Ne.h),Ne.h=null))}if(X.G){const Zs=ls.g?ls.g.getResponseHeader("X-HTTP-Session-Id"):null;Zs&&(X.wa=Zs,wt(X.J,X.G,Zs))}}L.I=3,L.l&&L.l.ra(),L.aa&&(L.T=Date.now()-E.F,L.j.info("Handshake RTT: "+L.T+"ms")),X=L;var Ye=E;if(X.na=gl(X,X.L?X.ba:null,X.W),Ye.L){Kt(X.h,Ye);var Ct=Ye,qn=X.O;qn&&(Ct.H=qn),Ct.D&&(kn(Ct),Ys(Ct)),X.g=Ye}else Os(X);L.i.length>0&&Xs(L)}else en[0]!="stop"&&en[0]!="close"||Ks(L,7);else L.I==3&&(en[0]=="stop"||en[0]=="close"?en[0]=="stop"?Ks(L,7):Po(L):en[0]!="noop"&&L.l&&L.l.qa(en),L.A=0)}}yt(4)}catch{}}var Vn=class{constructor(E,D){this.g=E,this.map=D}};function Le(E){this.l=E||10,f.PerformanceNavigationTiming?(E=f.performance.getEntriesByType("navigation"),E=E.length>0&&(E[0].nextHopProtocol=="hq"||E[0].nextHopProtocol=="h2")):E=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=E?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Da(E){return E.h?!0:E.g?E.g.size>=E.j:!1}function un(E){return E.h?1:E.g?E.g.size:0}function ki(E,D){return E.h?E.h==D:E.g?E.g.has(D):!1}function Oa(E,D){E.g?E.g.add(D):E.h=D}function Kt(E,D){E.h&&E.h==D?E.h=null:E.g&&E.g.has(D)&&E.g.delete(D)}Le.prototype.cancel=function(){if(this.i=qt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const E of this.g.values())E.cancel();this.g.clear()}};function qt(E){if(E.h!=null)return E.i.concat(E.h.G);if(E.g!=null&&E.g.size!==0){let D=E.i;for(const L of E.g.values())D=D.concat(L.G);return D}return k(E.i)}var Ft=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ar(E,D){if(E){E=E.split("&");for(let L=0;L<E.length;L++){const X=E[L].indexOf("=");let xe,Ne=null;X>=0?(xe=E[L].substring(0,X),Ne=E[L].substring(X+1)):xe=E[L],D(xe,Ne?decodeURIComponent(Ne.replace(/\+/g," ")):"")}}}function Pi(E){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let D;E instanceof Pi?(this.l=E.l,Gt(this,E.j),this.o=E.o,this.g=E.g,Li(this,E.u),this.h=E.h,ka(this,Pa(E.i)),this.m=E.m):E&&(D=String(E).match(Ft))?(this.l=!1,Gt(this,D[1]||"",!0),this.o=Ws(D[2]||""),this.g=Ws(D[3]||"",!0),Li(this,D[4]),this.h=Ws(D[5]||"",!0),ka(this,D[6]||"",!0),this.m=Ws(D[7]||"")):(this.l=!1,this.i=new si(null,this.l))}Pi.prototype.toString=function(){const E=[];var D=this.j;D&&E.push(xs(D,Wn,!0),":");var L=this.g;return(L||D=="file")&&(E.push("//"),(D=this.o)&&E.push(xs(D,Wn,!0),"@"),E.push(Ri(L).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L=this.u,L!=null&&E.push(":",String(L))),(L=this.h)&&(this.g&&L.charAt(0)!="/"&&E.push("/"),E.push(xs(L,L.charAt(0)=="/"?J:ve,!0))),(L=this.i.toString())&&E.push("?",L),(L=this.m)&&E.push("#",xs(L,Xn)),E.join("")},Pi.prototype.resolve=function(E){const D=Gn(this);let L=!!E.j;L?Gt(D,E.j):L=!!E.o,L?D.o=E.o:L=!!E.g,L?D.g=E.g:L=E.u!=null;var X=E.h;if(L)Li(D,E.u);else if(L=!!E.h){if(X.charAt(0)!="/")if(this.g&&!this.h)X="/"+X;else{var xe=D.h.lastIndexOf("/");xe!=-1&&(X=D.h.slice(0,xe+1)+X)}if(xe=X,xe==".."||xe==".")X="";else if(xe.indexOf("./")!=-1||xe.indexOf("/.")!=-1){X=xe.lastIndexOf("/",0)==0,xe=xe.split("/");const Ne=[];for(let Ye=0;Ye<xe.length;){const Ct=xe[Ye++];Ct=="."?X&&Ye==xe.length&&Ne.push(""):Ct==".."?((Ne.length>1||Ne.length==1&&Ne[0]!="")&&Ne.pop(),X&&Ye==xe.length&&Ne.push("")):(Ne.push(Ct),X=!0)}X=Ne.join("/")}else X=xe}return L?D.h=X:L=E.i.toString()!=="",L?ka(D,Pa(E.i)):L=!!E.m,L&&(D.m=E.m),D};function Gn(E){return new Pi(E)}function Gt(E,D,L){E.j=L?Ws(D,!0):D,E.j&&(E.j=E.j.replace(/:$/,""))}function Li(E,D){if(D){if(D=Number(D),isNaN(D)||D<0)throw Error("Bad port number "+D);E.u=D}else E.u=null}function ka(E,D,L){D instanceof si?(E.i=D,Cr(E.i,E.l)):(L||(D=xs(D,at)),E.i=new si(D,E.l))}function wt(E,D,L){E.i.set(D,L)}function Yi(E){return wt(E,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),E}function Ws(E,D){return E?D?decodeURI(E.replace(/%25/g,"%2525")):decodeURIComponent(E):""}function xs(E,D,L){return typeof E=="string"?(E=encodeURI(E).replace(D,Ut),L&&(E=E.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E):null}function Ut(E){return E=E.charCodeAt(0),"%"+(E>>4&15).toString(16)+(E&15).toString(16)}var Wn=/[#\/\?@]/g,ve=/[#\?:]/g,J=/[#\?]/g,at=/[#\?@]/g,Xn=/#/g;function si(E,D){this.h=this.g=null,this.i=E||null,this.j=!!D}function Wi(E){E.g||(E.g=new Map,E.h=0,E.i&&Ar(E.i,function(D,L){E.add(decodeURIComponent(D.replace(/\+/g," ")),L)}))}n=si.prototype,n.add=function(E,D){Wi(this),this.i=null,E=Sr(this,E);let L=this.g.get(E);return L||this.g.set(E,L=[]),L.push(D),this.h+=1,this};function ko(E,D){Wi(E),D=Sr(E,D),E.g.has(D)&&(E.i=null,E.h-=E.g.get(D).length,E.g.delete(D))}function Ai(E,D){return Wi(E),D=Sr(E,D),E.g.has(D)}n.forEach=function(E,D){Wi(this),this.g.forEach(function(L,X){L.forEach(function(xe){E.call(D,xe,X,this)},this)},this)};function ft(E,D){Wi(E);let L=[];if(typeof D=="string")Ai(E,D)&&(L=L.concat(E.g.get(Sr(E,D))));else for(E=Array.from(E.g.values()),D=0;D<E.length;D++)L=L.concat(E[D]);return L}n.set=function(E,D){return Wi(this),this.i=null,E=Sr(this,E),Ai(this,E)&&(this.h-=this.g.get(E).length),this.g.set(E,[D]),this.h+=1,this},n.get=function(E,D){return E?(E=ft(this,E),E.length>0?String(E[0]):D):D};function vn(E,D,L){ko(E,D),L.length>0&&(E.i=null,E.g.set(Sr(E,D),k(L)),E.h+=L.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const E=[],D=Array.from(this.g.keys());for(let X=0;X<D.length;X++){var L=D[X];const xe=Ri(L);L=ft(this,L);for(let Ne=0;Ne<L.length;Ne++){let Ye=xe;L[Ne]!==""&&(Ye+="="+Ri(L[Ne])),E.push(Ye)}}return this.i=E.join("&")};function Pa(E){const D=new si;return D.i=E.i,E.g&&(D.g=new Map(E.g),D.h=E.h),D}function Sr(E,D){return D=String(D),E.j&&(D=D.toLowerCase()),D}function Cr(E,D){D&&!E.j&&(Wi(E),E.i=null,E.g.forEach(function(L,X){const xe=X.toLowerCase();X!=xe&&(ko(this,X),vn(this,xe,L))},E)),E.j=D}function Xi(E,D){const L=new Pt;if(f.Image){const X=new Image;X.onload=A(ys,L,"TestLoadImage: loaded",!0,D,X),X.onerror=A(ys,L,"TestLoadImage: error",!1,D,X),X.onabort=A(ys,L,"TestLoadImage: abort",!1,D,X),X.ontimeout=A(ys,L,"TestLoadImage: timeout",!1,D,X),f.setTimeout(function(){X.ontimeout&&X.ontimeout()},1e4),X.src=E}else D(!1)}function Yr(E,D){const L=new Pt,X=new AbortController,xe=setTimeout(()=>{X.abort(),ys(L,"TestPingServer: timeout",!1,D)},1e4);fetch(E,{signal:X.signal}).then(Ne=>{clearTimeout(xe),Ne.ok?ys(L,"TestPingServer: ok",!0,D):ys(L,"TestPingServer: server error",!1,D)}).catch(()=>{clearTimeout(xe),ys(L,"TestPingServer: error",!1,D)})}function ys(E,D,L,X,xe){try{xe&&(xe.onload=null,xe.onerror=null,xe.onabort=null,xe.ontimeout=null),X(L)}catch{}}function Nn(){this.g=new Do}function Ki(E){this.i=E.Sb||null,this.h=E.ab||!1}N(Ki,Tr),Ki.prototype.g=function(){return new $i(this.i,this.h)};function $i(E,D){nt.call(this),this.H=E,this.o=D,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}N($i,nt),n=$i.prototype,n.open=function(E,D){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=E,this.D=D,this.readyState=1,vt(this)},n.send=function(E){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const D={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};E&&(D.body=E),(this.H||f).fetch(new Request(this.D,D)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Nr(this)),this.readyState=0},n.Pa=function(E){if(this.g&&(this.l=E,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=E.headers,this.readyState=2,vt(this)),this.g&&(this.readyState=3,vt(this),this.g)))if(this.responseType==="arraybuffer")E.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in E){if(this.j=E.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;mt(this)}else E.text().then(this.Oa.bind(this),this.ga.bind(this))};function mt(E){E.j.read().then(E.Ma.bind(E)).catch(E.ga.bind(E))}n.Ma=function(E){if(this.g){if(this.o&&E.value)this.response.push(E.value);else if(!this.o){var D=E.value?E.value:new Uint8Array(0);(D=this.B.decode(D,{stream:!E.done}))&&(this.response=this.responseText+=D)}E.done?Nr(this):vt(this),this.readyState==3&&mt(this)}},n.Oa=function(E){this.g&&(this.response=this.responseText=E,Nr(this))},n.Na=function(E){this.g&&(this.response=E,Nr(this))},n.ga=function(){this.g&&Nr(this)};function Nr(E){E.readyState=4,E.l=null,E.j=null,E.B=null,vt(E)}n.setRequestHeader=function(E,D){this.A.append(E,D)},n.getResponseHeader=function(E){return this.h&&this.h.get(E.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const E=[],D=this.h.entries();for(var L=D.next();!L.done;)L=L.value,E.push(L[0]+": "+L[1]),L=D.next();return E.join(`\r
`)};function vt(E){E.onreadystatechange&&E.onreadystatechange.call(E)}Object.defineProperty($i.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(E){this.m=E?"include":"same-origin"}});function wn(E){let D="";return ze(E,function(L,X){D+=X,D+=":",D+=L,D+=`\r
`}),D}function Wr(E,D,L){e:{for(X in L){var X=!1;break e}X=!0}X||(L=wn(L),typeof E=="string"?L!=null&&Ri(L):wt(E,D,L))}function hn(E){nt.call(this),this.headers=new Map,this.L=E||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}N(hn,nt);var Rs=/^https?$/i,Ms=["POST","PUT"];n=hn.prototype,n.Fa=function(E){this.H=E},n.ea=function(E,D,L,X){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+E);D=D?D.toUpperCase():"GET",this.D=E,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():qr.g(),this.g.onreadystatechange=R(x(this.Ca,this));try{this.B=!0,this.g.open(D,String(E),!0),this.B=!1}catch(Ne){Xr(this,Ne);return}if(E=L||"",L=new Map(this.headers),X)if(Object.getPrototypeOf(X)===Object.prototype)for(var xe in X)L.set(xe,X[xe]);else if(typeof X.keys=="function"&&typeof X.get=="function")for(const Ne of X.keys())L.set(Ne,X.get(Ne));else throw Error("Unknown input type for opt_headers: "+String(X));X=Array.from(L.keys()).find(Ne=>Ne.toLowerCase()=="content-type"),xe=f.FormData&&E instanceof f.FormData,!(Array.prototype.indexOf.call(Ms,D,void 0)>=0)||X||xe||L.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ne,Ye]of L)this.g.setRequestHeader(Ne,Ye);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(E),this.v=!1}catch(Ne){Xr(this,Ne)}};function Xr(E,D){E.h=!1,E.g&&(E.j=!0,E.g.abort(),E.j=!1),E.l=D,E.o=5,hr(E),rs(E)}function hr(E){E.A||(E.A=!0,xn(E,"complete"),xn(E,"error"))}n.abort=function(E){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=E||7,xn(this,"complete"),xn(this,"abort"),rs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),rs(this,!0)),hn.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ds(this):this.Xa())},n.Xa=function(){Ds(this)};function Ds(E){if(E.h&&typeof c<"u"){if(E.v&&vs(E)==4)setTimeout(E.Ca.bind(E),0);else if(xn(E,"readystatechange"),vs(E)==4){E.h=!1;try{const Ne=E.ca();e:switch(Ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var D=!0;break e;default:D=!1}var L;if(!(L=D)){var X;if(X=Ne===0){let Ye=String(E.D).match(Ft)[1]||null;!Ye&&f.self&&f.self.location&&(Ye=f.self.location.protocol.slice(0,-1)),X=!Rs.test(Ye?Ye.toLowerCase():"")}L=X}if(L)xn(E,"complete"),xn(E,"success");else{E.o=6;try{var xe=vs(E)>2?E.g.statusText:""}catch{xe=""}E.l=xe+" ["+E.ca()+"]",hr(E)}}finally{rs(E)}}}}function rs(E,D){if(E.g){E.m&&(clearTimeout(E.m),E.m=null);const L=E.g;E.g=null,D||xn(E,"ready");try{L.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function vs(E){return E.g?E.g.readyState:0}n.ca=function(){try{return vs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(E){if(this.g){var D=this.g.responseText;return E&&D.indexOf(E)==0&&(D=D.substring(E.length)),ci(D)}};function Kn(E){try{if(!E.g)return null;if("response"in E.g)return E.g.response;switch(E.F){case"":case"text":return E.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in E.g)return E.g.mozResponseArrayBuffer}return null}catch{return null}}function os(E){const D={};E=(E.g&&vs(E)>=2&&E.g.getAllResponseHeaders()||"").split(`\r
`);for(let X=0;X<E.length;X++){if(z(E[X]))continue;var L=Mi(E[X]);const xe=L[0];if(L=L[1],typeof L!="string")continue;L=L.trim();const Ne=D[xe]||[];D[xe]=Ne,Ne.push(L)}ct(D,function(X){return X.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ln(E,D,L){return L&&L.internalChannelParams&&L.internalChannelParams[E]||D}function fr(E){this.za=0,this.i=[],this.j=new Pt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ln("failFast",!1,E),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ln("baseRetryDelayMs",5e3,E),this.Za=Ln("retryDelaySeedMs",1e4,E),this.Ta=Ln("forwardChannelMaxRetries",2,E),this.va=Ln("forwardChannelRequestTimeoutMs",2e4,E),this.ma=E&&E.xmlHttpFactory||void 0,this.Ua=E&&E.Rb||void 0,this.Aa=E&&E.useFetchStreams||!1,this.O=void 0,this.L=E&&E.supportsCrossDomainXhr||!1,this.M="",this.h=new Le(E&&E.concurrentRequestLimit),this.Ba=new Nn,this.S=E&&E.fastHandshake||!1,this.R=E&&E.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=E&&E.Pb||!1,E&&E.ua&&this.j.ua(),E&&E.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&E&&E.detectBufferingProxy||!1,this.ia=void 0,E&&E.longPollingTimeout&&E.longPollingTimeout>0&&(this.ia=E.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=fr.prototype,n.ka=8,n.I=1,n.connect=function(E,D,L,X){At(0),this.W=E,this.H=D||{},L&&X!==void 0&&(this.H.OSID=L,this.H.OAID=X),this.F=this.X,this.J=gl(this,null,this.W),Xs(this)};function Po(E){if(Lo(E),E.I==3){var D=E.V++,L=Gn(E.J);if(wt(L,"SID",E.M),wt(L,"RID",D),wt(L,"TYPE","terminate"),Ir(E,L),D=new Je(E,E.j,D),D.M=2,D.A=Yi(Gn(L)),L=!1,f.navigator&&f.navigator.sendBeacon)try{L=f.navigator.sendBeacon(D.A.toString(),"")}catch{}!L&&f.Image&&(new Image().src=D.A,L=!0),L||(D.g=Bo(D.j,null),D.g.ea(D.A)),D.F=Date.now(),Ys(D)}ml(E)}function mr(E){E.g&&(Se(E),E.g.cancel(),E.g=null)}function Lo(E){mr(E),E.v&&(f.clearTimeout(E.v),E.v=null),Hn(E),E.h.cancel(),E.m&&(typeof E.m=="number"&&f.clearTimeout(E.m),E.m=null)}function Xs(E){if(!Da(E.h)&&!E.m){E.m=!0;var D=E.Ea;Ee||V(),me||(Ee(),me=!0),U.add(D,E),E.D=0}}function Uo(E,D){return un(E.h)>=E.h.j-(E.m?1:0)?!1:E.m?(E.i=D.G.concat(E.i),!0):E.I==1||E.I==2||E.D>=(E.Sa?0:E.Ta)?!1:(E.m=yn(x(E.Ea,E,D),La(E,E.D)),E.D++,!0)}n.Ea=function(E){if(this.m)if(this.m=null,this.I==1){if(!E){this.V=Math.floor(Math.random()*1e5),E=this.V++;const xe=new Je(this,this.j,E);let Ne=this.o;if(this.U&&(Ne?(Ne=ae(Ne),Ae(Ne,this.U)):Ne=this.U),this.u!==null||this.R||(xe.J=Ne,Ne=null),this.S)e:{for(var D=0,L=0;L<this.i.length;L++){t:{var X=this.i[L];if("__data__"in X.map&&(X=X.map.__data__,typeof X=="string")){X=X.length;break t}X=void 0}if(X===void 0)break;if(D+=X,D>4096){D=L;break e}if(D===4096||L===this.i.length-1){D=L+1;break e}}D=1e3}else D=1e3;D=Kr(this,xe,D),L=Gn(this.J),wt(L,"RID",E),wt(L,"CVER",22),this.G&&wt(L,"X-HTTP-Session-Id",this.G),Ir(this,L),Ne&&(this.R?D="headers="+Ri(wn(Ne))+"&"+D:this.u&&Wr(L,this.u,Ne)),Oa(this.h,xe),this.Ra&&wt(L,"TYPE","init"),this.S?(wt(L,"$req",D),wt(L,"SID","null"),xe.U=!0,Di(xe,L,null)):Di(xe,L,D),this.I=2}}else this.I==3&&(E?sn(this,E):this.i.length==0||Da(this.h)||sn(this))};function sn(E,D){var L;D?L=D.l:L=E.V++;const X=Gn(E.J);wt(X,"SID",E.M),wt(X,"RID",L),wt(X,"AID",E.K),Ir(E,X),E.u&&E.o&&Wr(X,E.u,E.o),L=new Je(E,E.j,L,E.D+1),E.u===null&&(L.J=E.o),D&&(E.i=D.G.concat(E.i)),D=Kr(E,L,1e3),L.H=Math.round(E.va*.5)+Math.round(E.va*.5*Math.random()),Oa(E.h,L),Di(L,X,D)}function Ir(E,D){E.H&&ze(E.H,function(L,X){wt(D,X,L)}),E.l&&ze({},function(L,X){wt(D,X,L)})}function Kr(E,D,L){L=Math.min(E.i.length,L);const X=E.l?x(E.l.Ka,E.l,E):null;e:{var xe=E.i;let Ct=-1;for(;;){const qn=["count="+L];Ct==-1?L>0?(Ct=xe[0].g,qn.push("ofs="+Ct)):Ct=0:qn.push("ofs="+Ct);let en=!0;for(let In=0;In<L;In++){var Ne=xe[In].g;const as=xe[In].map;if(Ne-=Ct,Ne<0)Ct=Math.max(0,xe[In].g-100),en=!1;else try{Ne="req"+Ne+"_"||"";try{var Ye=as instanceof Map?as:Object.entries(as);for(const[Qs,Si]of Ye){let ls=Si;y(Si)&&(ls=_i(Si)),qn.push(Ne+Qs+"="+encodeURIComponent(ls))}}catch(Qs){throw qn.push(Ne+"type="+encodeURIComponent("_badmap")),Qs}}catch{X&&X(as)}}if(en){Ye=qn.join("&");break e}}Ye=void 0}return E=E.i.splice(0,L),D.G=E,Ye}function Os(E){if(!E.g&&!E.v){E.Y=1;var D=E.Da;Ee||V(),me||(Ee(),me=!0),U.add(D,E),E.A=0}}function $r(E){return E.g||E.v||E.A>=3?!1:(E.Y++,E.v=yn(x(E.Da,E),La(E,E.A)),E.A++,!0)}n.Da=function(){if(this.v=null,Rt(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var E=4*this.T;this.j.info("BP detection timer enabled: "+E),this.B=yn(x(this.Wa,this),E)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,At(10),mr(this),Rt(this))};function Se(E){E.B!=null&&(f.clearTimeout(E.B),E.B=null)}function Rt(E){E.g=new Je(E,E.j,"rpc",E.Y),E.u===null&&(E.g.J=E.o),E.g.P=0;var D=Gn(E.na);wt(D,"RID","rpc"),wt(D,"SID",E.M),wt(D,"AID",E.K),wt(D,"CI",E.F?"0":"1"),!E.F&&E.ia&&wt(D,"TO",E.ia),wt(D,"TYPE","xmlhttp"),Ir(E,D),E.u&&E.o&&Wr(D,E.u,E.o),E.O&&(E.g.H=E.O);var L=E.g;E=E.ba,L.M=1,L.A=Yi(Gn(D)),L.u=null,L.R=!0,dr(L,E)}n.Va=function(){this.C!=null&&(this.C=null,mr(this),$r(this),At(19))};function Hn(E){E.C!=null&&(f.clearTimeout(E.C),E.C=null)}function Jr(E,D){var L=null;if(E.g==D){Hn(E),Se(E),E.g=null;var X=2}else if(ki(E.h,D))L=D.G,Kt(E.h,D),X=1;else return;if(E.I!=0){if(D.o)if(X==1){L=D.u?D.u.length:0,D=Date.now()-D.F;var xe=E.D;X=Xe(),xn(X,new Tn(X,L)),Xs(E)}else Os(E);else if(xe=D.m,xe==3||xe==0&&D.X>0||!(X==1&&Uo(E,D)||X==2&&$r(E)))switch(L&&L.length>0&&(D=E.h,D.i=D.i.concat(L)),xe){case 1:Ks(E,5);break;case 4:Ks(E,10);break;case 3:Ks(E,6);break;default:Ks(E,2)}}}function La(E,D){let L=E.Qa+Math.floor(Math.random()*E.Za);return E.isActive()||(L*=2),L*D}function Ks(E,D){if(E.j.info("Error code "+D),D==2){var L=x(E.bb,E),X=E.Ua;const xe=!X;X=new Pi(X||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||Gt(X,"https"),Yi(X),xe?Xi(X.toString(),L):Yr(X.toString(),L)}else At(2);E.I=0,E.l&&E.l.pa(D),ml(E),Lo(E)}n.bb=function(E){E?(this.j.info("Successfully pinged google.com"),At(2)):(this.j.info("Failed to ping google.com"),At(1))};function ml(E){if(E.I=0,E.ja=[],E.l){const D=qt(E.h);(D.length!=0||E.i.length!=0)&&(H(E.ja,D),H(E.ja,E.i),E.h.i.length=0,k(E.i),E.i.length=0),E.l.oa()}}function gl(E,D,L){var X=L instanceof Pi?Gn(L):new Pi(L);if(X.g!="")D&&(X.g=D+"."+X.g),Li(X,X.u);else{var xe=f.location;X=xe.protocol,D=D?D+"."+xe.hostname:xe.hostname,xe=+xe.port;const Ne=new Pi(null);X&&Gt(Ne,X),D&&(Ne.g=D),xe&&Li(Ne,xe),L&&(Ne.h=L),X=Ne}return L=E.G,D=E.wa,L&&D&&wt(X,L,D),wt(X,"VER",E.ka),Ir(E,X),X}function Bo(E,D,L){if(D&&!E.L)throw Error("Can't create secondary domain capable XhrIo object.");return D=E.Aa&&!E.ma?new hn(new Ki({ab:L})):new hn(E.ma),D.Fa(E.L),D}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function zn(){}n=zn.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function $s(){}$s.prototype.g=function(E,D){return new Ht(E,D)};function Ht(E,D){nt.call(this),this.g=new fr(D),this.l=E,this.h=D&&D.messageUrlParams||null,E=D&&D.messageHeaders||null,D&&D.clientProtocolHeaderRequired&&(E?E["X-Client-Protocol"]="webchannel":E={"X-Client-Protocol":"webchannel"}),this.g.o=E,E=D&&D.initMessageHeaders||null,D&&D.messageContentType&&(E?E["X-WebChannel-Content-Type"]=D.messageContentType:E={"X-WebChannel-Content-Type":D.messageContentType}),D&&D.sa&&(E?E["X-WebChannel-Client-Profile"]=D.sa:E={"X-WebChannel-Client-Profile":D.sa}),this.g.U=E,(E=D&&D.Qb)&&!z(E)&&(this.g.u=E),this.A=D&&D.supportsCrossDomainXhr||!1,this.v=D&&D.sendRawJson||!1,(D=D&&D.httpSessionIdParam)&&!z(D)&&(this.g.G=D,E=this.h,E!==null&&D in E&&(E=this.h,D in E&&delete E[D])),this.j=new Yt(this)}N(Ht,nt),Ht.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ht.prototype.close=function(){Po(this.g)},Ht.prototype.o=function(E){var D=this.g;if(typeof E=="string"){var L={};L.__data__=E,E=L}else this.v&&(L={},L.__data__=_i(E),E=L);D.i.push(new Vn(D.Ya++,E)),D.I==3&&Xs(D)},Ht.prototype.N=function(){this.g.l=null,delete this.j,Po(this.g),delete this.g,Ht.Z.N.call(this)};function Qr(E){Ge.call(this),E.__headers__&&(this.headers=E.__headers__,this.statusCode=E.__status__,delete E.__headers__,delete E.__status__);var D=E.__sm__;if(D){e:{for(const L in D){E=L;break e}E=void 0}(this.i=E)&&(E=this.i,D=D!==null&&E in D?D[E]:void 0),this.data=D}else this.data=E}N(Qr,Ge);function Js(){ln.call(this),this.status=1}N(Js,ln);function Yt(E){this.g=E}N(Yt,zn),Yt.prototype.ra=function(){xn(this.g,"a")},Yt.prototype.qa=function(E){xn(this.g,new Qr(E))},Yt.prototype.pa=function(E){xn(this.g,new Js)},Yt.prototype.oa=function(){xn(this.g,"b")},$s.prototype.createWebChannel=$s.prototype.g,Ht.prototype.send=Ht.prototype.o,Ht.prototype.open=Ht.prototype.m,Ht.prototype.close=Ht.prototype.close,d_=function(){return new $s},u_=function(){return Xe()},c_=_t,tg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},zr.NO_ERROR=0,zr.TIMEOUT=8,zr.HTTP_ERROR=6,gh=zr,Is.COMPLETE="complete",l_=Is,Ma.EventType=an,an.OPEN="a",an.CLOSE="b",an.ERROR="c",an.MESSAGE="d",nt.prototype.listen=nt.prototype.J,mu=Ma,hn.prototype.listenOnce=hn.prototype.K,hn.prototype.getLastError=hn.prototype.Ha,hn.prototype.getLastErrorCode=hn.prototype.ya,hn.prototype.getStatus=hn.prototype.ca,hn.prototype.getResponseJson=hn.prototype.La,hn.prototype.getResponseText=hn.prototype.la,hn.prototype.send=hn.prototype.ea,hn.prototype.setWithCredentials=hn.prototype.Fa,a_=hn}).apply(typeof sh<"u"?sh:typeof self<"u"?self:typeof window<"u"?window:{});const db="@firebase/firestore",hb="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Zi.UNAUTHENTICATED=new Zi(null),Zi.GOOGLE_CREDENTIALS=new Zi("google-credentials-uid"),Zi.FIRST_PARTY=new Zi("first-party-uid"),Zi.MOCK_USER=new Zi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ec="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul=new kg("@firebase/firestore");function zl(){return ul.logLevel}function st(n,...e){if(ul.logLevel<=Zt.DEBUG){const t=e.map(Wg);ul.debug(`Firestore (${Ec}): ${n}`,...t)}}function Co(n,...e){if(ul.logLevel<=Zt.ERROR){const t=e.map(Wg);ul.error(`Firestore (${Ec}): ${n}`,...t)}}function cc(n,...e){if(ul.logLevel<=Zt.WARN){const t=e.map(Wg);ul.warn(`Firestore (${Ec}): ${n}`,...t)}}function Wg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,h_(n,i,t)}function h_(n,e,t){let i=`FIRESTORE (${Ec}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Co(i),new Error(i)}function Jn(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||h_(e,o,i)}function on(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $e={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pt extends Ro{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Zi.UNAUTHENTICATED)))}shutdown(){}}class pk{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class xk{constructor(e){this.t=e,this.currentUser=Zi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Jn(this.o===void 0,42304);let i=this.i;const o=w=>this.i!==i?(i=this.i,t(w)):Promise.resolve();let c=new ic;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new ic,e.enqueueRetryable((()=>o(this.currentUser)))};const f=()=>{const w=c;e.enqueueRetryable((async()=>{await w.promise,await o(this.currentUser)}))},y=w=>{st("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=w,this.o&&(this.auth.addAuthTokenListener(this.o),f())};this.t.onInit((w=>y(w))),setTimeout((()=>{if(!this.auth){const w=this.t.getImmediate({optional:!0});w?y(w):(st("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new ic)}}),0),f()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(st("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Jn(typeof i.accessToken=="string",31837,{l:i}),new f_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Jn(e===null||typeof e=="string",2055,{h:e}),new Zi(e)}}class yk{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Zi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class vk{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new yk(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Zi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class fb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wk{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Hs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Jn(this.o===void 0,3512);const i=c=>{c.error!=null&&st("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const f=c.token!==this.m;return this.m=c.token,st("FirebaseAppCheckTokenProvider",`Received ${f?"new":"existing"} token.`),f?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable((()=>i(c)))};const o=c=>{st("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((c=>o(c))),setTimeout((()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):st("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new fb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Jn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new fb(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bk(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=bk(40);for(let c=0;c<o.length;++c)i.length<20&&o[c]<t&&(i+=e.charAt(o[c]%62))}return i}}function nn(n,e){return n<e?-1:n>e?1:0}function ng(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const o=n.charAt(i),c=e.charAt(i);if(o!==c)return Am(o)===Am(c)?nn(o,c):Am(o)?1:-1}return nn(n.length,e.length)}const Ek=55296,_k=57343;function Am(n){const e=n.charCodeAt(0);return e>=Ek&&e<=_k}function uc(n,e,t){return n.length===e.length&&n.every(((i,o)=>t(i,e[o])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb="__name__";class Pr{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ot(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ot(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Pr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Pr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const c=Pr.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return nn(e.length,t.length)}static compareSegments(e,t){const i=Pr.isNumericId(e),o=Pr.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?Pr.extractNumericId(e).compare(Pr.extractNumericId(t)):ng(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ya.fromString(e.substring(4,e.length-2))}}class $n extends Pr{construct(e,t,i){return new $n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new pt($e.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((o=>o.length>0)))}return new $n(t)}static emptyPath(){return new $n([])}}const Tk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fs extends Pr{construct(e,t,i){return new fs(e,t,i)}static isValidIdentifier(e){return Tk.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===mb}static keyField(){return new fs([mb])}static fromServerFormat(e){const t=[];let i="",o=0;const c=()=>{if(i.length===0)throw new pt($e.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let f=!1;for(;o<e.length;){const y=e[o];if(y==="\\"){if(o+1===e.length)throw new pt($e.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const w=e[o+1];if(w!=="\\"&&w!=="."&&w!=="`")throw new pt($e.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=w,o+=2}else y==="`"?(f=!f,o++):y!=="."||f?(i+=y,o++):(c(),o++)}if(c(),f)throw new pt($e.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fs(t)}static emptyPath(){return new fs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.path=e}static fromPath(e){return new Et($n.fromString(e))}static fromName(e){return new Et($n.fromString(e).popFirst(5))}static empty(){return new Et($n.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&$n.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return $n.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Et(new $n(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ak(n,e,t){if(!t)throw new pt($e.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Sk(n,e,t,i){if(e===!0&&i===!0)throw new pt($e.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function gb(n){if(!Et.isDocumentKey(n))throw new pt($e.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Ck(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Nk(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ot(12329,{type:typeof n})}function ph(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new pt($e.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Nk(n);throw new pt($e.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pi(n,e){const t={typeString:n};return e&&(t.value=e),t}function Vu(n,e){if(!Ck(n))throw new pt($e.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const o=e[i].typeString,c="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const f=n[i];if(o&&typeof f!==o){t=`JSON field '${i}' must be a ${o}.`;break}if(c!==void 0&&f!==c.value){t=`Expected '${i}' field to equal '${c.value}'`;break}}if(t)throw new pt($e.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb=-62135596800,xb=1e6;class gi{static now(){return gi.fromMillis(Date.now())}static fromDate(e){return gi.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*xb);return new gi(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new pt($e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new pt($e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<pb)throw new pt($e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pt($e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/xb}_compareTo(e){return this.seconds===e.seconds?nn(this.nanoseconds,e.nanoseconds):nn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:gi._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Vu(e,gi._jsonSchema))return new gi(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-pb;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}gi._jsonSchemaVersion="firestore/timestamp/1.0",gi._jsonSchema={type:pi("string",gi._jsonSchemaVersion),seconds:pi("number"),nanoseconds:pi("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{static fromTimestamp(e){return new Dt(e)}static min(){return new Dt(new gi(0,0))}static max(){return new Dt(new gi(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nu=-1;function Ik(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=Dt.fromTimestamp(i===1e9?new gi(t+1,0):new gi(t,i));return new ba(o,Et.empty(),e)}function Rk(n){return new ba(n.readTime,n.key,Nu)}class ba{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ba(Dt.min(),Et.empty(),Nu)}static max(){return new ba(Dt.max(),Et.empty(),Nu)}}function Mk(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Et.comparator(n.documentKey,e.documentKey),t!==0?t:nn(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ok{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rf(n){if(n.code!==$e.FAILED_PRECONDITION||n.message!==Dk)throw n;st("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ot(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Be(((i,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(i,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(i,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Be?t:Be.resolve(t)}catch(t){return Be.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Be.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Be.reject(t)}static resolve(e){return new Be(((t,i)=>{t(e)}))}static reject(e){return new Be(((t,i)=>{i(e)}))}static waitFor(e){return new Be(((t,i)=>{let o=0,c=0,f=!1;e.forEach((y=>{++o,y.next((()=>{++c,f&&c===o&&t()}),(w=>i(w)))})),f=!0,c===o&&t()}))}static or(e){let t=Be.resolve(!1);for(const i of e)t=t.next((o=>o?Be.resolve(o):i()));return t}static forEach(e,t){const i=[];return e.forEach(((o,c)=>{i.push(t.call(this,o,c))})),this.waitFor(i)}static mapArray(e,t){return new Be(((i,o)=>{const c=e.length,f=new Array(c);let y=0;for(let w=0;w<c;w++){const x=w;t(e[x]).next((A=>{f[x]=A,++y,y===c&&i(f)}),(A=>o(A)))}}))}static doWhile(e,t){return new Be(((i,o)=>{const c=()=>{e()===!0?t().next((()=>{c()}),o):i()};c()}))}}function kk(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function _c(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}of.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk=-1;function af(n){return n==null}function ig(n){return n===0&&1/n==-1/0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_="";function Lk(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=yb(e)),e=Uk(n.get(t),e);return yb(e)}function Uk(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case m_:t+="";break;default:t+=c}}return t}function yb(n){return n+m_+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vb(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Gu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Bk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e,t){this.comparator=e,this.root=t||Gi.EMPTY}insert(e,t){return new li(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Gi.BLACK,null,null))}remove(e){return new li(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rh(this.root,e,this.comparator,!1)}getReverseIterator(){return new rh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rh(this.root,e,this.comparator,!0)}}class rh{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?i(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Gi{constructor(e,t,i,o,c){this.key=e,this.value=t,this.color=i??Gi.RED,this.left=o??Gi.EMPTY,this.right=c??Gi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,c){return new Gi(e??this.key,t??this.value,i??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const c=i(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,i),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Gi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return Gi.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ot(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ot(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ot(27949);return e+(this.isRed()?0:1)}}Gi.EMPTY=null,Gi.RED=!0,Gi.BLACK=!1;Gi.EMPTY=new class{constructor(){this.size=0}get key(){throw Ot(57766)}get value(){throw Ot(16141)}get color(){throw Ot(16727)}get left(){throw Ot(29726)}get right(){throw Ot(36894)}copy(e,t,i,o,c){return this}insert(e,t,i){return new Gi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e){this.comparator=e,this.data=new li(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new wb(this.data.getIterator())}getIteratorFrom(e){return new wb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof bi)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new bi(this.comparator);return t.data=e,t}}class wb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e){this.fields=e,e.sort(fs.comparator)}static empty(){return new fa([])}unionWith(e){let t=new bi(fs.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new fa(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return uc(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new g_("Invalid base64 string: "+c):c}})(e);return new Hi(t)}static fromUint8Array(e){const t=(function(o){let c="";for(let f=0;f<o.length;++f)c+=String.fromCharCode(o[f]);return c})(e);return new Hi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return nn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hi.EMPTY_BYTE_STRING=new Hi("");const Fk=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ea(n){if(Jn(!!n,39018),typeof n=="string"){let e=0;const t=Fk.exec(n);if(Jn(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ai(n.seconds),nanos:ai(n.nanos)}}function ai(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function _a(n){return typeof n=="string"?Hi.fromBase64String(n):Hi.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p_="server_timestamp",x_="__type__",y_="__previous_value__",v_="__local_write_time__";function Kg(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[x_])==null?void 0:i.stringValue)===p_}function lf(n){const e=n.mapValue.fields[y_];return Kg(e)?lf(e):e}function Iu(n){const e=Ea(n.mapValue.fields[v_].timestampValue);return new gi(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{constructor(e,t,i,o,c,f,y,w,x,A){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=c,this.forceLongPolling=f,this.autoDetectLongPolling=y,this.longPollingOptions=w,this.useFetchStreams=x,this.isUsingEmulator=A}}const Fh="(default)";class Ru{constructor(e,t){this.projectId=e,this.database=t||Fh}static empty(){return new Ru("","")}get isDefaultDatabase(){return this.database===Fh}isEqual(e){return e instanceof Ru&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vk="__type__",Gk="__max__",oh={mapValue:{}},Hk="__vector__",sg="value";function Ta(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Kg(n)?4:qk(n)?9007199254740991:zk(n)?10:11:Ot(28295,{value:n})}function jr(n,e){if(n===e)return!0;const t=Ta(n);if(t!==Ta(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Iu(n).isEqual(Iu(e));case 3:return(function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const f=Ea(o.timestampValue),y=Ea(c.timestampValue);return f.seconds===y.seconds&&f.nanos===y.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,c){return _a(o.bytesValue).isEqual(_a(c.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,c){return ai(o.geoPointValue.latitude)===ai(c.geoPointValue.latitude)&&ai(o.geoPointValue.longitude)===ai(c.geoPointValue.longitude)})(n,e);case 2:return(function(o,c){if("integerValue"in o&&"integerValue"in c)return ai(o.integerValue)===ai(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const f=ai(o.doubleValue),y=ai(c.doubleValue);return f===y?ig(f)===ig(y):isNaN(f)&&isNaN(y)}return!1})(n,e);case 9:return uc(n.arrayValue.values||[],e.arrayValue.values||[],jr);case 10:case 11:return(function(o,c){const f=o.mapValue.fields||{},y=c.mapValue.fields||{};if(vb(f)!==vb(y))return!1;for(const w in f)if(f.hasOwnProperty(w)&&(y[w]===void 0||!jr(f[w],y[w])))return!1;return!0})(n,e);default:return Ot(52216,{left:n})}}function Mu(n,e){return(n.values||[]).find((t=>jr(t,e)))!==void 0}function dc(n,e){if(n===e)return 0;const t=Ta(n),i=Ta(e);if(t!==i)return nn(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return nn(n.booleanValue,e.booleanValue);case 2:return(function(c,f){const y=ai(c.integerValue||c.doubleValue),w=ai(f.integerValue||f.doubleValue);return y<w?-1:y>w?1:y===w?0:isNaN(y)?isNaN(w)?0:-1:1})(n,e);case 3:return bb(n.timestampValue,e.timestampValue);case 4:return bb(Iu(n),Iu(e));case 5:return ng(n.stringValue,e.stringValue);case 6:return(function(c,f){const y=_a(c),w=_a(f);return y.compareTo(w)})(n.bytesValue,e.bytesValue);case 7:return(function(c,f){const y=c.split("/"),w=f.split("/");for(let x=0;x<y.length&&x<w.length;x++){const A=nn(y[x],w[x]);if(A!==0)return A}return nn(y.length,w.length)})(n.referenceValue,e.referenceValue);case 8:return(function(c,f){const y=nn(ai(c.latitude),ai(f.latitude));return y!==0?y:nn(ai(c.longitude),ai(f.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Eb(n.arrayValue,e.arrayValue);case 10:return(function(c,f){var R,k,H,W;const y=c.fields||{},w=f.fields||{},x=(R=y[sg])==null?void 0:R.arrayValue,A=(k=w[sg])==null?void 0:k.arrayValue,N=nn(((H=x==null?void 0:x.values)==null?void 0:H.length)||0,((W=A==null?void 0:A.values)==null?void 0:W.length)||0);return N!==0?N:Eb(x,A)})(n.mapValue,e.mapValue);case 11:return(function(c,f){if(c===oh.mapValue&&f===oh.mapValue)return 0;if(c===oh.mapValue)return 1;if(f===oh.mapValue)return-1;const y=c.fields||{},w=Object.keys(y),x=f.fields||{},A=Object.keys(x);w.sort(),A.sort();for(let N=0;N<w.length&&N<A.length;++N){const R=ng(w[N],A[N]);if(R!==0)return R;const k=dc(y[w[N]],x[A[N]]);if(k!==0)return k}return nn(w.length,A.length)})(n.mapValue,e.mapValue);default:throw Ot(23264,{he:t})}}function bb(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return nn(n,e);const t=Ea(n),i=Ea(e),o=nn(t.seconds,i.seconds);return o!==0?o:nn(t.nanos,i.nanos)}function Eb(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const c=dc(t[o],i[o]);if(c)return c}return nn(t.length,i.length)}function hc(n){return rg(n)}function rg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Ea(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return _a(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Et.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",o=!0;for(const c of t.values||[])o?o=!1:i+=",",i+=rg(c);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const f of i)c?c=!1:o+=",",o+=`${f}:${rg(t.fields[f])}`;return o+"}"})(n.mapValue):Ot(61005,{value:n})}function xh(n){switch(Ta(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=lf(n);return e?16+xh(e):16;case 5:return 2*n.stringValue.length;case 6:return _a(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((o,c)=>o+xh(c)),0)})(n.arrayValue);case 10:case 11:return(function(i){let o=0;return Gu(i.fields,((c,f)=>{o+=c.length+xh(f)})),o})(n.mapValue);default:throw Ot(13486,{value:n})}}function og(n){return!!n&&"integerValue"in n}function $g(n){return!!n&&"arrayValue"in n}function _b(n){return!!n&&"nullValue"in n}function Tb(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Sm(n){return!!n&&"mapValue"in n}function zk(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Vk])==null?void 0:i.stringValue)===Hk}function wu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Gu(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=wu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=wu(n.arrayValue.values[t]);return e}return{...n}}function qk(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Gk}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e){this.value=e}static empty(){return new Lr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Sm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wu(t)}setAll(e){let t=fs.emptyPath(),i={},o=[];e.forEach(((f,y)=>{if(!t.isImmediateParentOf(y)){const w=this.getFieldsMap(t);this.applyChanges(w,i,o),i={},o=[],t=y.popLast()}f?i[y.lastSegment()]=wu(f):o.push(y.lastSegment())}));const c=this.getFieldsMap(t);this.applyChanges(c,i,o)}delete(e){const t=this.field(e.popLast());Sm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return jr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];Sm(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){Gu(t,((o,c)=>e[o]=c));for(const o of i)delete e[o]}clone(){return new Lr(wu(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e,t,i,o,c,f,y){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=c,this.data=f,this.documentState=y}static newInvalidDocument(e){return new es(e,0,Dt.min(),Dt.min(),Dt.min(),Lr.empty(),0)}static newFoundDocument(e,t,i,o){return new es(e,1,t,Dt.min(),i,o,0)}static newNoDocument(e,t){return new es(e,2,t,Dt.min(),Dt.min(),Lr.empty(),0)}static newUnknownDocument(e,t){return new es(e,3,t,Dt.min(),Dt.min(),Lr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Dt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Dt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof es&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new es(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(e,t){this.position=e,this.inclusive=t}}function Ab(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const c=e[o],f=n.position[o];if(c.field.isKeyField()?i=Et.comparator(Et.fromName(f.referenceValue),t.key):i=dc(f,t.data.field(c.field)),c.dir==="desc"&&(i*=-1),i!==0)break}return i}function Sb(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!jr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,t="asc"){this.field=e,this.dir=t}}function Yk(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{}class wi extends w_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Xk(e,t,i):t==="array-contains"?new Jk(e,i):t==="in"?new Qk(e,i):t==="not-in"?new Zk(e,i):t==="array-contains-any"?new eP(e,i):new wi(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new Kk(e,i):new $k(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(dc(t,this.value)):t!==null&&Ta(this.value)===Ta(t)&&this.matchesComparison(dc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ot(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vr extends w_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Vr(e,t)}matches(e){return b_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function b_(n){return n.op==="and"}function E_(n){return Wk(n)&&b_(n)}function Wk(n){for(const e of n.filters)if(e instanceof Vr)return!1;return!0}function ag(n){if(n instanceof wi)return n.field.canonicalString()+n.op.toString()+hc(n.value);if(E_(n))return n.filters.map((e=>ag(e))).join(",");{const e=n.filters.map((t=>ag(t))).join(",");return`${n.op}(${e})`}}function __(n,e){return n instanceof wi?(function(i,o){return o instanceof wi&&i.op===o.op&&i.field.isEqual(o.field)&&jr(i.value,o.value)})(n,e):n instanceof Vr?(function(i,o){return o instanceof Vr&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce(((c,f,y)=>c&&__(f,o.filters[y])),!0):!1})(n,e):void Ot(19439)}function T_(n){return n instanceof wi?(function(t){return`${t.field.canonicalString()} ${t.op} ${hc(t.value)}`})(n):n instanceof Vr?(function(t){return t.op.toString()+" {"+t.getFilters().map(T_).join(" ,")+"}"})(n):"Filter"}class Xk extends wi{constructor(e,t,i){super(e,t,i),this.key=Et.fromName(i.referenceValue)}matches(e){const t=Et.comparator(e.key,this.key);return this.matchesComparison(t)}}class Kk extends wi{constructor(e,t){super(e,"in",t),this.keys=A_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class $k extends wi{constructor(e,t){super(e,"not-in",t),this.keys=A_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function A_(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>Et.fromName(i.referenceValue)))}class Jk extends wi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return $g(t)&&Mu(t.arrayValue,this.value)}}class Qk extends wi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Mu(this.value.arrayValue,t)}}class Zk extends wi{constructor(e,t){super(e,"not-in",t)}matches(e){if(Mu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Mu(this.value.arrayValue,t)}}class eP extends wi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!$g(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Mu(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e,t=null,i=[],o=[],c=null,f=null,y=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=c,this.startAt=f,this.endAt=y,this.Te=null}}function Cb(n,e=null,t=[],i=[],o=null,c=null,f=null){return new tP(n,e,t,i,o,c,f)}function Jg(n){const e=on(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>ag(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(c){return c.field.canonicalString()+c.dir})(i))).join(","),af(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>hc(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>hc(i))).join(",")),e.Te=t}return e.Te}function Qg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Yk(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!__(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Sb(n.startAt,e.startAt)&&Sb(n.endAt,e.endAt)}function lg(n){return Et.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e,t=null,i=[],o=[],c=null,f="F",y=null,w=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=c,this.limitType=f,this.startAt=y,this.endAt=w,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function nP(n,e,t,i,o,c,f,y){return new cf(n,e,t,i,o,c,f,y)}function Zg(n){return new cf(n)}function Nb(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function iP(n){return n.collectionGroup!==null}function bu(n){const e=on(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ie.push(c),t.add(c.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(f){let y=new bi(fs.comparator);return f.filters.forEach((w=>{w.getFlattenedFilters().forEach((x=>{x.isInequality()&&(y=y.add(x.field))}))})),y})(e).forEach((c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ie.push(new Vh(c,i))})),t.has(fs.keyField().canonicalString())||e.Ie.push(new Vh(fs.keyField(),i))}return e.Ie}function Fr(n){const e=on(n);return e.Ee||(e.Ee=sP(e,bu(n))),e.Ee}function sP(n,e){if(n.limitType==="F")return Cb(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const c=o.dir==="desc"?"asc":"desc";return new Vh(o.field,c)}));const t=n.endAt?new jh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new jh(n.startAt.position,n.startAt.inclusive):null;return Cb(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function cg(n,e,t){return new cf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function uf(n,e){return Qg(Fr(n),Fr(e))&&n.limitType===e.limitType}function S_(n){return`${Jg(Fr(n))}|lt:${n.limitType}`}function ql(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((o=>T_(o))).join(", ")}]`),af(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((o=>(function(f){return`${f.field.canonicalString()} (${f.dir})`})(o))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((o=>hc(o))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((o=>hc(o))).join(",")),`Target(${i})`})(Fr(n))}; limitType=${n.limitType})`}function df(n,e){return e.isFoundDocument()&&(function(i,o){const c=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(c):Et.isDocumentKey(i.path)?i.path.isEqual(c):i.path.isImmediateParentOf(c)})(n,e)&&(function(i,o){for(const c of bu(i))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0})(n,e)&&(function(i,o){for(const c of i.filters)if(!c.matches(o))return!1;return!0})(n,e)&&(function(i,o){return!(i.startAt&&!(function(f,y,w){const x=Ab(f,y,w);return f.inclusive?x<=0:x<0})(i.startAt,bu(i),o)||i.endAt&&!(function(f,y,w){const x=Ab(f,y,w);return f.inclusive?x>=0:x>0})(i.endAt,bu(i),o))})(n,e)}function rP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function C_(n){return(e,t)=>{let i=!1;for(const o of bu(n)){const c=oP(o,e,t);if(c!==0)return c;i=i||o.field.isKeyField()}return 0}}function oP(n,e,t){const i=n.field.isKeyField()?Et.comparator(e.key,t.key):(function(c,f,y){const w=f.data.field(c),x=y.data.field(c);return w!==null&&x!==null?dc(w,x):Ot(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ot(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,c]of i)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Gu(this.inner,((t,i)=>{for(const[o,c]of i)e(o,c)}))}isEmpty(){return Bk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aP=new li(Et.comparator);function Aa(){return aP}const N_=new li(Et.comparator);function gu(...n){let e=N_;for(const t of n)e=e.insert(t.key,t);return e}function lP(n){let e=N_;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function il(){return Eu()}function I_(){return Eu()}function Eu(){return new hl((n=>n.toString()),((n,e)=>n.isEqual(e)))}const cP=new bi(Et.comparator);function dn(...n){let e=cP;for(const t of n)e=e.add(t);return e}const uP=new bi(nn);function dP(){return uP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hP(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ig(e)?"-0":e}}function fP(n){return{integerValue:""+n}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(){this._=void 0}}function mP(n,e,t){return n instanceof ug?(function(o,c){const f={fields:{[x_]:{stringValue:p_},[v_]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&Kg(c)&&(c=lf(c)),c&&(f.fields[y_]=c),{mapValue:f}})(t,e):n instanceof Gh?R_(n,e):n instanceof Hh?M_(n,e):(function(o,c){const f=pP(o,c),y=Ib(f)+Ib(o.Ae);return og(f)&&og(o.Ae)?fP(y):hP(o.serializer,y)})(n,e)}function gP(n,e,t){return n instanceof Gh?R_(n,e):n instanceof Hh?M_(n,e):t}function pP(n,e){return n instanceof dg?(function(i){return og(i)||(function(c){return!!c&&"doubleValue"in c})(i)})(e)?e:{integerValue:0}:null}class ug extends hf{}class Gh extends hf{constructor(e){super(),this.elements=e}}function R_(n,e){const t=D_(e);for(const i of n.elements)t.some((o=>jr(o,i)))||t.push(i);return{arrayValue:{values:t}}}class Hh extends hf{constructor(e){super(),this.elements=e}}function M_(n,e){let t=D_(e);for(const i of n.elements)t=t.filter((o=>!jr(o,i)));return{arrayValue:{values:t}}}class dg extends hf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Ib(n){return ai(n.integerValue||n.doubleValue)}function D_(n){return $g(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function xP(n,e){return n.field.isEqual(e.field)&&(function(i,o){return i instanceof Gh&&o instanceof Gh||i instanceof Hh&&o instanceof Hh?uc(i.elements,o.elements,jr):i instanceof dg&&o instanceof dg?jr(i.Ae,o.Ae):i instanceof ug&&o instanceof ug})(n.transform,e.transform)}class sl{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new sl}static exists(e){return new sl(void 0,e)}static updateTime(e){return new sl(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class ep{}function O_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new vP(n.key,sl.none()):new tp(n.key,n.data,sl.none());{const t=n.data,i=Lr.empty();let o=new bi(fs.comparator);for(let c of e.fields)if(!o.has(c)){let f=t.field(c);f===null&&c.length>1&&(c=c.popLast(),f=t.field(c)),f===null?i.delete(c):i.set(c,f),o=o.add(c)}return new ff(n.key,i,new fa(o.toArray()),sl.none())}}function yP(n,e,t){n instanceof tp?(function(o,c,f){const y=o.value.clone(),w=Mb(o.fieldTransforms,c,f.transformResults);y.setAll(w),c.convertToFoundDocument(f.version,y).setHasCommittedMutations()})(n,e,t):n instanceof ff?(function(o,c,f){if(!yh(o.precondition,c))return void c.convertToUnknownDocument(f.version);const y=Mb(o.fieldTransforms,c,f.transformResults),w=c.data;w.setAll(k_(o)),w.setAll(y),c.convertToFoundDocument(f.version,w).setHasCommittedMutations()})(n,e,t):(function(o,c,f){c.convertToNoDocument(f.version).setHasCommittedMutations()})(0,e,t)}function _u(n,e,t,i){return n instanceof tp?(function(c,f,y,w){if(!yh(c.precondition,f))return y;const x=c.value.clone(),A=Db(c.fieldTransforms,w,f);return x.setAll(A),f.convertToFoundDocument(f.version,x).setHasLocalMutations(),null})(n,e,t,i):n instanceof ff?(function(c,f,y,w){if(!yh(c.precondition,f))return y;const x=Db(c.fieldTransforms,w,f),A=f.data;return A.setAll(k_(c)),A.setAll(x),f.convertToFoundDocument(f.version,A).setHasLocalMutations(),y===null?null:y.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map((N=>N.field)))})(n,e,t,i):(function(c,f,y){return yh(c.precondition,f)?(f.convertToNoDocument(f.version).setHasLocalMutations(),null):y})(n,e,t)}function Rb(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&uc(i,o,((c,f)=>xP(c,f)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class tp extends ep{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class ff extends ep{constructor(e,t,i,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function k_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Mb(n,e,t){const i=new Map;Jn(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let o=0;o<t.length;o++){const c=n[o],f=c.transform,y=e.data.field(c.field);i.set(c.field,gP(f,y,t[o]))}return i}function Db(n,e,t){const i=new Map;for(const o of n){const c=o.transform,f=t.data.field(o.field);i.set(o.field,mP(c,f,e))}return i}class vP extends ep{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&yP(c,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=_u(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=_u(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=I_();return this.mutations.forEach((o=>{const c=e.get(o.key),f=c.overlayedDocument;let y=this.applyToLocalView(f,c.mutatedFields);y=t.has(o.key)?null:y;const w=O_(f,y);w!==null&&i.set(o.key,w),f.isValidDocument()||f.convertToNoDocument(Dt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),dn())}isEqual(e){return this.batchId===e.batchId&&uc(this.mutations,e.mutations,((t,i)=>Rb(t,i)))&&uc(this.baseMutations,e.baseMutations,((t,i)=>Rb(t,i)))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mi,rn;function P_(n){if(n===void 0)return Co("GRPC error has no .code"),$e.UNKNOWN;switch(n){case mi.OK:return $e.OK;case mi.CANCELLED:return $e.CANCELLED;case mi.UNKNOWN:return $e.UNKNOWN;case mi.DEADLINE_EXCEEDED:return $e.DEADLINE_EXCEEDED;case mi.RESOURCE_EXHAUSTED:return $e.RESOURCE_EXHAUSTED;case mi.INTERNAL:return $e.INTERNAL;case mi.UNAVAILABLE:return $e.UNAVAILABLE;case mi.UNAUTHENTICATED:return $e.UNAUTHENTICATED;case mi.INVALID_ARGUMENT:return $e.INVALID_ARGUMENT;case mi.NOT_FOUND:return $e.NOT_FOUND;case mi.ALREADY_EXISTS:return $e.ALREADY_EXISTS;case mi.PERMISSION_DENIED:return $e.PERMISSION_DENIED;case mi.FAILED_PRECONDITION:return $e.FAILED_PRECONDITION;case mi.ABORTED:return $e.ABORTED;case mi.OUT_OF_RANGE:return $e.OUT_OF_RANGE;case mi.UNIMPLEMENTED:return $e.UNIMPLEMENTED;case mi.DATA_LOSS:return $e.DATA_LOSS;default:return Ot(39323,{code:n})}}(rn=mi||(mi={}))[rn.OK=0]="OK",rn[rn.CANCELLED=1]="CANCELLED",rn[rn.UNKNOWN=2]="UNKNOWN",rn[rn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rn[rn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rn[rn.NOT_FOUND=5]="NOT_FOUND",rn[rn.ALREADY_EXISTS=6]="ALREADY_EXISTS",rn[rn.PERMISSION_DENIED=7]="PERMISSION_DENIED",rn[rn.UNAUTHENTICATED=16]="UNAUTHENTICATED",rn[rn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rn[rn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rn[rn.ABORTED=10]="ABORTED",rn[rn.OUT_OF_RANGE=11]="OUT_OF_RANGE",rn[rn.UNIMPLEMENTED=12]="UNIMPLEMENTED",rn[rn.INTERNAL=13]="INTERNAL",rn[rn.UNAVAILABLE=14]="UNAVAILABLE",rn[rn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _P(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP=new ya([4294967295,4294967295],0);function Ob(n){const e=_P().encode(n),t=new o_;return t.update(e),new Uint8Array(t.digest())}function kb(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new ya([t,i],0),new ya([o,c],0)]}class np{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new pu(`Invalid padding: ${t}`);if(i<0)throw new pu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new pu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new pu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ya.fromNumber(this.ge)}ye(e,t,i){let o=e.add(t.multiply(ya.fromNumber(i)));return o.compare(TP)===1&&(o=new ya([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Ob(e),[i,o]=kb(t);for(let c=0;c<this.hashCount;c++){const f=this.ye(i,o,c);if(!this.we(f))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),f=new np(c,o,t);return i.forEach((y=>f.insert(y))),f}insert(e){if(this.ge===0)return;const t=Ob(e),[i,o]=kb(t);for(let c=0;c<this.hashCount;c++){const f=this.ye(i,o,c);this.Se(f)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class pu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,t,i,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,Hu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new mf(Dt.min(),o,new li(nn),Aa(),dn())}}class Hu{constructor(e,t,i,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Hu(i,t,dn(),dn(),dn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e,t,i,o){this.be=e,this.removedTargetIds=t,this.key=i,this.De=o}}class L_{constructor(e,t){this.targetId=e,this.Ce=t}}class U_{constructor(e,t,i=Hi.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class Pb{constructor(){this.ve=0,this.Fe=Lb(),this.Me=Hi.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=dn(),t=dn(),i=dn();return this.Fe.forEach(((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:Ot(38017,{changeType:c})}})),new Hu(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=Lb()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Jn(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class AP{constructor(e){this.Ge=e,this.ze=new Map,this.je=Aa(),this.Je=ah(),this.He=ah(),this.Ye=new li(nn)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Ot(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,i=e.Ce.count,o=this.ot(t);if(o){const c=o.target;if(lg(c))if(i===0){const f=new Et(c.path);this.et(t,f,es.newNoDocument(f,Dt.min()))}else Jn(i===1,20013,{expectedCount:i});else{const f=this._t(t);if(f!==i){const y=this.ut(e),w=y?this.ct(y,e,f):1;if(w!==0){this.it(t);const x=w===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,x)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:c=0}=t;let f,y;try{f=_a(i).toUint8Array()}catch(w){if(w instanceof g_)return cc("Decoding the base64 bloom filter in existence filter failed ("+w.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw w}try{y=new np(f,o,c)}catch(w){return cc(w instanceof pu?"BloomFilter error: ":"Applying bloom filter failed: ",w),null}return y.ge===0?null:y}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let o=0;return i.forEach((c=>{const f=this.Ge.ht(),y=`projects/${f.projectId}/databases/${f.database}/documents/${c.path.canonicalString()}`;e.mightContain(y)||(this.et(t,c,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((c,f)=>{const y=this.ot(f);if(y){if(c.current&&lg(y.target)){const w=new Et(y.target.path);this.It(w).has(f)||this.Et(f,w)||this.et(f,w,es.newNoDocument(w,e))}c.Be&&(t.set(f,c.ke()),c.qe())}}));let i=dn();this.He.forEach(((c,f)=>{let y=!0;f.forEachWhile((w=>{const x=this.ot(w);return!x||x.purpose==="TargetPurposeLimboResolution"||(y=!1,!1)})),y&&(i=i.add(c))})),this.je.forEach(((c,f)=>f.setReadTime(e)));const o=new mf(e,t,this.Ye,this.je,i);return this.je=Aa(),this.Je=ah(),this.He=ah(),this.Ye=new li(nn),o}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.Qe(t,1):o.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Pb,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new bi(nn),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new bi(nn),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||st("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Pb),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ah(){return new li(Et.comparator)}function Lb(){return new li(Et.comparator)}const SP={asc:"ASCENDING",desc:"DESCENDING"},CP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},NP={and:"AND",or:"OR"};class IP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function hg(n,e){return n.useProto3Json||af(e)?e:{value:e}}function RP(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function MP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function sc(n){return Jn(!!n,49232),Dt.fromTimestamp((function(t){const i=Ea(t);return new gi(i.seconds,i.nanos)})(n))}function DP(n,e){return fg(n,e).canonicalString()}function fg(n,e){const t=(function(o){return new $n(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function B_(n){const e=$n.fromString(n);return Jn(H_(e),10190,{key:e.toString()}),e}function Cm(n,e){const t=B_(e);if(t.get(1)!==n.databaseId.projectId)throw new pt($e.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new pt($e.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Et(j_(t))}function F_(n,e){return DP(n.databaseId,e)}function OP(n){const e=B_(n);return e.length===4?$n.emptyPath():j_(e)}function Ub(n){return new $n(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function j_(n){return Jn(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function kP(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(x){return x==="NO_CHANGE"?0:x==="ADD"?1:x==="REMOVE"?2:x==="CURRENT"?3:x==="RESET"?4:Ot(39313,{state:x})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=(function(x,A){return x.useProto3Json?(Jn(A===void 0||typeof A=="string",58123),Hi.fromBase64String(A||"")):(Jn(A===void 0||A instanceof Buffer||A instanceof Uint8Array,16193),Hi.fromUint8Array(A||new Uint8Array))})(n,e.targetChange.resumeToken),f=e.targetChange.cause,y=f&&(function(x){const A=x.code===void 0?$e.UNKNOWN:P_(x.code);return new pt(A,x.message||"")})(f);t=new U_(i,o,c,y||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=Cm(n,i.document.name),c=sc(i.document.updateTime),f=i.document.createTime?sc(i.document.createTime):Dt.min(),y=new Lr({mapValue:{fields:i.document.fields}}),w=es.newFoundDocument(o,c,f,y),x=i.targetIds||[],A=i.removedTargetIds||[];t=new vh(x,A,w.key,w)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=Cm(n,i.document),c=i.readTime?sc(i.readTime):Dt.min(),f=es.newNoDocument(o,c),y=i.removedTargetIds||[];t=new vh([],y,f.key,f)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=Cm(n,i.document),c=i.removedTargetIds||[];t=new vh([],c,o,null)}else{if(!("filter"in e))return Ot(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:c}=i,f=new EP(o,c),y=i.targetId;t=new L_(y,f)}}return t}function PP(n,e){return{documents:[F_(n,e.path)]}}function LP(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=F_(n,o);const c=(function(x){if(x.length!==0)return G_(Vr.create(x,"and"))})(e.filters);c&&(t.structuredQuery.where=c);const f=(function(x){if(x.length!==0)return x.map((A=>(function(R){return{field:Yl(R.field),direction:FP(R.dir)}})(A)))})(e.orderBy);f&&(t.structuredQuery.orderBy=f);const y=hg(n,e.limit);return y!==null&&(t.structuredQuery.limit=y),e.startAt&&(t.structuredQuery.startAt=(function(x){return{before:x.inclusive,values:x.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(x){return{before:!x.inclusive,values:x.position}})(e.endAt)),{ft:t,parent:o}}function UP(n){let e=OP(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){Jn(i===1,65062);const A=t.from[0];A.allDescendants?o=A.collectionId:e=e.child(A.collectionId)}let c=[];t.where&&(c=(function(N){const R=V_(N);return R instanceof Vr&&E_(R)?R.getFilters():[R]})(t.where));let f=[];t.orderBy&&(f=(function(N){return N.map((R=>(function(H){return new Vh(Wl(H.field),(function(K){switch(K){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(H.direction))})(R)))})(t.orderBy));let y=null;t.limit&&(y=(function(N){let R;return R=typeof N=="object"?N.value:N,af(R)?null:R})(t.limit));let w=null;t.startAt&&(w=(function(N){const R=!!N.before,k=N.values||[];return new jh(k,R)})(t.startAt));let x=null;return t.endAt&&(x=(function(N){const R=!N.before,k=N.values||[];return new jh(k,R)})(t.endAt)),nP(e,o,f,c,y,"F",w,x)}function BP(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ot(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function V_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Wl(t.unaryFilter.field);return wi.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=Wl(t.unaryFilter.field);return wi.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Wl(t.unaryFilter.field);return wi.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const f=Wl(t.unaryFilter.field);return wi.create(f,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ot(61313);default:return Ot(60726)}})(n):n.fieldFilter!==void 0?(function(t){return wi.create(Wl(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ot(58110);default:return Ot(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Vr.create(t.compositeFilter.filters.map((i=>V_(i))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ot(1026)}})(t.compositeFilter.op))})(n):Ot(30097,{filter:n})}function FP(n){return SP[n]}function jP(n){return CP[n]}function VP(n){return NP[n]}function Yl(n){return{fieldPath:n.canonicalString()}}function Wl(n){return fs.fromServerFormat(n.fieldPath)}function G_(n){return n instanceof wi?(function(t){if(t.op==="=="){if(Tb(t.value))return{unaryFilter:{field:Yl(t.field),op:"IS_NAN"}};if(_b(t.value))return{unaryFilter:{field:Yl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Tb(t.value))return{unaryFilter:{field:Yl(t.field),op:"IS_NOT_NAN"}};if(_b(t.value))return{unaryFilter:{field:Yl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yl(t.field),op:jP(t.op),value:t.value}}})(n):n instanceof Vr?(function(t){const i=t.getFilters().map((o=>G_(o)));return i.length===1?i[0]:{compositeFilter:{op:VP(t.op),filters:i}}})(n):Ot(54877,{filter:n})}function H_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(e,t,i,o,c=Dt.min(),f=Dt.min(),y=Hi.EMPTY_BYTE_STRING,w=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=f,this.resumeToken=y,this.expectedCount=w}withSequenceNumber(e){return new ma(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ma(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ma(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ma(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GP{constructor(e){this.yt=e}}function HP(n){const e=UP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?cg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(){this.Cn=new qP}addToCollectionParentIndex(e,t){return this.Cn.add(t),Be.resolve()}getCollectionParents(e,t){return Be.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Be.resolve()}deleteFieldIndex(e,t){return Be.resolve()}deleteAllFieldIndexes(e){return Be.resolve()}createTargetIndexes(e,t){return Be.resolve()}getDocumentsMatchingTarget(e,t){return Be.resolve(null)}getIndexType(e,t){return Be.resolve(0)}getFieldIndexes(e,t){return Be.resolve([])}getNextCollectionGroupToUpdate(e){return Be.resolve(null)}getMinOffset(e,t){return Be.resolve(ba.min())}getMinOffsetFromCollectionGroup(e,t){return Be.resolve(ba.min())}updateCollectionGroup(e,t,i){return Be.resolve()}updateIndexEntries(e,t){return Be.resolve()}}class qP{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new bi($n.comparator),c=!o.has(i);return this.index[t]=o.add(i),c}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new bi($n.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},z_=41943040;class Cs{static withCacheSize(e){return new Cs(e,Cs.DEFAULT_COLLECTION_PERCENTILE,Cs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cs.DEFAULT_COLLECTION_PERCENTILE=10,Cs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Cs.DEFAULT=new Cs(z_,Cs.DEFAULT_COLLECTION_PERCENTILE,Cs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Cs.DISABLED=new Cs(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new fc(0)}static cr(){return new fc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb="LruGarbageCollector",YP=1048576;function jb([n,e],[t,i]){const o=nn(n,t);return o===0?nn(e,i):o}class WP{constructor(e){this.Ir=e,this.buffer=new bi(jb),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();jb(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class XP{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){st(Fb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){_c(t)?st(Fb,"Ignoring IndexedDB error during garbage collection: ",t):await rf(t)}await this.Vr(3e5)}))}}class KP{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Be.resolve(of.ce);const i=new WP(t);return this.mr.forEachTarget(e,(o=>i.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>i.Ar(o))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(st("LruGarbageCollector","Garbage collection skipped; disabled"),Be.resolve(Bb)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(st("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Bb):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,o,c,f,y,w,x;const A=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((N=>(N>this.params.maximumSequenceNumbersToCollect?(st("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${N}`),o=this.params.maximumSequenceNumbersToCollect):o=N,f=Date.now(),this.nthSequenceNumber(e,o)))).next((N=>(i=N,y=Date.now(),this.removeTargets(e,i,t)))).next((N=>(c=N,w=Date.now(),this.removeOrphanedDocuments(e,i)))).next((N=>(x=Date.now(),zl()<=Zt.DEBUG&&st("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${f-A}ms
	Determined least recently used ${o} in `+(y-f)+`ms
	Removed ${c} targets in `+(w-y)+`ms
	Removed ${N} documents in `+(x-w)+`ms
Total Duration: ${x-A}ms`),Be.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:N}))))}}function $P(n,e){return new KP(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(){this.changes=new hl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,es.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Be.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(i=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(i!==null&&_u(i.mutation,o,fa.empty(),gi.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,dn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=dn()){const o=il();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,i).next((c=>{let f=gu();return c.forEach(((y,w)=>{f=f.insert(y,w.overlayedDocument)})),f}))))}getOverlayedDocuments(e,t){const i=il();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,dn())))}populateOverlays(e,t,i){const o=[];return i.forEach((c=>{t.has(c)||o.push(c)})),this.documentOverlayCache.getOverlays(e,o).next((c=>{c.forEach(((f,y)=>{t.set(f,y)}))}))}computeViews(e,t,i,o){let c=Aa();const f=Eu(),y=(function(){return Eu()})();return t.forEach(((w,x)=>{const A=i.get(x.key);o.has(x.key)&&(A===void 0||A.mutation instanceof ff)?c=c.insert(x.key,x):A!==void 0?(f.set(x.key,A.mutation.getFieldMask()),_u(A.mutation,x,A.mutation.getFieldMask(),gi.now())):f.set(x.key,fa.empty())})),this.recalculateAndSaveOverlays(e,c).next((w=>(w.forEach(((x,A)=>f.set(x,A))),t.forEach(((x,A)=>y.set(x,new QP(A,f.get(x)??null)))),y)))}recalculateAndSaveOverlays(e,t){const i=Eu();let o=new li(((f,y)=>f-y)),c=dn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((f=>{for(const y of f)y.keys().forEach((w=>{const x=t.get(w);if(x===null)return;let A=i.get(w)||fa.empty();A=y.applyToLocalView(x,A),i.set(w,A);const N=(o.get(y.batchId)||dn()).add(w);o=o.insert(y.batchId,N)}))})).next((()=>{const f=[],y=o.getReverseIterator();for(;y.hasNext();){const w=y.getNext(),x=w.key,A=w.value,N=I_();A.forEach((R=>{if(!c.has(R)){const k=O_(t.get(R),i.get(R));k!==null&&N.set(R,k),c=c.add(R)}})),f.push(this.documentOverlayCache.saveOverlays(e,x,N))}return Be.waitFor(f)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,o){return(function(f){return Et.isDocumentKey(f.path)&&f.collectionGroup===null&&f.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):iP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next((c=>{const f=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-c.size):Be.resolve(il());let y=Nu,w=c;return f.next((x=>Be.forEach(x,((A,N)=>(y<N.largestBatchId&&(y=N.largestBatchId),c.get(A)?Be.resolve():this.remoteDocumentCache.getEntry(e,A).next((R=>{w=w.insert(A,R)}))))).next((()=>this.populateOverlays(e,x,c))).next((()=>this.computeViews(e,w,x,dn()))).next((A=>({batchId:y,changes:lP(A)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Et(t)).next((i=>{let o=gu();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const c=t.collectionGroup;let f=gu();return this.indexManager.getCollectionParents(e,c).next((y=>Be.forEach(y,(w=>{const x=(function(N,R){return new cf(R,null,N.explicitOrderBy.slice(),N.filters.slice(),N.limit,N.limitType,N.startAt,N.endAt)})(t,w.child(c));return this.getDocumentsMatchingCollectionQuery(e,x,i,o).next((A=>{A.forEach(((N,R)=>{f=f.insert(N,R)}))}))})).next((()=>f))))}getDocumentsMatchingCollectionQuery(e,t,i,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((f=>(c=f,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,c,o)))).next((f=>{c.forEach(((w,x)=>{const A=x.getKey();f.get(A)===null&&(f=f.insert(A,es.newInvalidDocument(A)))}));let y=gu();return f.forEach(((w,x)=>{const A=c.get(w);A!==void 0&&_u(A.mutation,x,fa.empty(),gi.now()),df(t,x)&&(y=y.insert(w,x))})),y}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Be.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:sc(o.createTime)}})(t)),Be.resolve()}getNamedQuery(e,t){return Be.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(o){return{name:o.name,query:HP(o.bundledQuery),readTime:sc(o.readTime)}})(t)),Be.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(){this.overlays=new li(Et.comparator),this.qr=new Map}getOverlay(e,t){return Be.resolve(this.overlays.get(t))}getOverlays(e,t){const i=il();return Be.forEach(t,(o=>this.getOverlay(e,o).next((c=>{c!==null&&i.set(o,c)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((o,c)=>{this.St(e,t,c)})),Be.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.qr.get(i);return o!==void 0&&(o.forEach((c=>this.overlays=this.overlays.remove(c))),this.qr.delete(i)),Be.resolve()}getOverlaysForCollection(e,t,i){const o=il(),c=t.length+1,f=new Et(t.child("")),y=this.overlays.getIteratorFrom(f);for(;y.hasNext();){const w=y.getNext().value,x=w.getKey();if(!t.isPrefixOf(x.path))break;x.path.length===c&&w.largestBatchId>i&&o.set(w.getKey(),w)}return Be.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let c=new li(((x,A)=>x-A));const f=this.overlays.getIterator();for(;f.hasNext();){const x=f.getNext().value;if(x.getKey().getCollectionGroup()===t&&x.largestBatchId>i){let A=c.get(x.largestBatchId);A===null&&(A=il(),c=c.insert(x.largestBatchId,A)),A.set(x.getKey(),x)}}const y=il(),w=c.getIterator();for(;w.hasNext()&&(w.getNext().value.forEach(((x,A)=>y.set(x,A))),!(y.size()>=o)););return Be.resolve(y)}St(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const f=this.qr.get(o.largestBatchId).delete(i.key);this.qr.set(o.largestBatchId,f)}this.overlays=this.overlays.insert(i.key,new bP(t,i));let c=this.qr.get(t);c===void 0&&(c=dn(),this.qr.set(t,c)),this.qr.set(t,c.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(){this.sessionToken=Hi.EMPTY_BYTE_STRING}getSessionToken(e){return Be.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Be.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(){this.Qr=new bi(Ni.$r),this.Ur=new bi(Ni.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new Ni(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new Ni(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Et(new $n([])),i=new Ni(t,e),o=new Ni(t,e+1),c=[];return this.Ur.forEachInRange([i,o],(f=>{this.Gr(f),c.push(f.key)})),c}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Et(new $n([])),i=new Ni(t,e),o=new Ni(t,e+1);let c=dn();return this.Ur.forEachInRange([i,o],(f=>{c=c.add(f.key)})),c}containsKey(e){const t=new Ni(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Ni{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Et.comparator(e.key,t.key)||nn(e.Yr,t.Yr)}static Kr(e,t){return nn(e.Yr,t.Yr)||Et.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new bi(Ni.$r)}checkEmpty(e){return Be.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const c=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const f=new wP(c,t,i,o);this.mutationQueue.push(f);for(const y of o)this.Zr=this.Zr.add(new Ni(y.key,c)),this.indexManager.addToCollectionParentIndex(e,y.key.path.popLast());return Be.resolve(f)}lookupMutationBatch(e,t){return Be.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.ei(i),c=o<0?0:o;return Be.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return Be.resolve(this.mutationQueue.length===0?Pk:this.tr-1)}getAllMutationBatches(e){return Be.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Ni(t,0),o=new Ni(t,Number.POSITIVE_INFINITY),c=[];return this.Zr.forEachInRange([i,o],(f=>{const y=this.Xr(f.Yr);c.push(y)})),Be.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new bi(nn);return t.forEach((o=>{const c=new Ni(o,0),f=new Ni(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([c,f],(y=>{i=i.add(y.Yr)}))})),Be.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let c=i;Et.isDocumentKey(c)||(c=c.child(""));const f=new Ni(new Et(c),0);let y=new bi(nn);return this.Zr.forEachWhile((w=>{const x=w.key.path;return!!i.isPrefixOf(x)&&(x.length===o&&(y=y.add(w.Yr)),!0)}),f),Be.resolve(this.ti(y))}ti(e){const t=[];return e.forEach((i=>{const o=this.Xr(i);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){Jn(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Be.forEach(t.mutations,(o=>{const c=new Ni(o.key,t.batchId);return i=i.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new Ni(t,0),o=this.Zr.firstAfterOrEqual(i);return Be.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Be.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sL{constructor(e){this.ri=e,this.docs=(function(){return new li(Et.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),c=o?o.size:0,f=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:f}),this.size+=f-c,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Be.resolve(i?i.document.mutableCopy():es.newInvalidDocument(t))}getEntries(e,t){let i=Aa();return t.forEach((o=>{const c=this.docs.get(o);i=i.insert(o,c?c.document.mutableCopy():es.newInvalidDocument(o))})),Be.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let c=Aa();const f=t.path,y=new Et(f.child("__id-9223372036854775808__")),w=this.docs.getIteratorFrom(y);for(;w.hasNext();){const{key:x,value:{document:A}}=w.getNext();if(!f.isPrefixOf(x.path))break;x.path.length>f.length+1||Mk(Rk(A),i)<=0||(o.has(A.key)||df(t,A))&&(c=c.insert(A.key,A.mutableCopy()))}return Be.resolve(c)}getAllFromCollectionGroup(e,t,i,o){Ot(9500)}ii(e,t){return Be.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new rL(this)}getSize(e){return Be.resolve(this.size)}}class rL extends JP{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,o)=>{o.isValidDocument()?t.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(i)})),Be.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(e){this.persistence=e,this.si=new hl((t=>Jg(t)),Qg),this.lastRemoteSnapshotVersion=Dt.min(),this.highestTargetId=0,this.oi=0,this._i=new ip,this.targetCount=0,this.ai=fc.ur()}forEachTarget(e,t){return this.si.forEach(((i,o)=>t(o))),Be.resolve()}getLastRemoteSnapshotVersion(e){return Be.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Be.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Be.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Be.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new fc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Be.resolve()}updateTargetData(e,t){return this.Pr(t),Be.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Be.resolve()}removeTargets(e,t,i){let o=0;const c=[];return this.si.forEach(((f,y)=>{y.sequenceNumber<=t&&i.get(y.targetId)===null&&(this.si.delete(f),c.push(this.removeMatchingKeysForTargetId(e,y.targetId)),o++)})),Be.waitFor(c).next((()=>o))}getTargetCount(e){return Be.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Be.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Be.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach((f=>{c.push(o.markPotentiallyOrphaned(e,f))})),Be.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Be.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Be.resolve(i)}containsKey(e,t){return Be.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(e,t){this.ui={},this.overlays={},this.ci=new of(0),this.li=!1,this.li=!0,this.hi=new nL,this.referenceDelegate=e(this),this.Pi=new oL(this),this.indexManager=new zP,this.remoteDocumentCache=(function(o){return new sL(o)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new GP(t),this.Ii=new eL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new tL,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new iL(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){st("MemoryPersistence","Starting transaction:",e);const o=new aL(this.ci.next());return this.referenceDelegate.Ei(),i(o).next((c=>this.referenceDelegate.di(o).next((()=>c)))).toPromise().then((c=>(o.raiseOnCommittedEvent(),c)))}Ai(e,t){return Be.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class aL extends Ok{constructor(e){super(),this.currentSequenceNumber=e}}class sp{constructor(e){this.persistence=e,this.Ri=new ip,this.Vi=null}static mi(e){return new sp(e)}get fi(){if(this.Vi)return this.Vi;throw Ot(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Be.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Be.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Be.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((o=>this.fi.add(o.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((c=>this.fi.add(c.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Be.forEach(this.fi,(i=>{const o=Et.fromPath(i);return this.gi(e,o).next((c=>{c||t.removeEntry(o,Dt.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Be.or([()=>Be.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class zh{constructor(e,t){this.persistence=e,this.pi=new hl((i=>Lk(i.path)),((i,o)=>i.isEqual(o))),this.garbageCollector=$P(this,t)}static mi(e,t){return new zh(e,t)}Ei(){}di(e){return Be.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((o=>i+o))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return Be.forEach(this.pi,((i,o)=>this.br(e,i,o).next((c=>c?Be.resolve():t(o)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.ii(e,(f=>this.br(e,f,t).next((y=>{y||(i++,c.removeEntry(f,Dt.min()))})))).next((()=>c.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Be.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),Be.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),Be.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Be.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=xh(e.data.value)),t}br(e,t,i){return Be.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.pi.get(t);return Be.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=o}static As(e,t){let i=dn(),o=dn();for(const c of t.docChanges)switch(c.type){case 0:i=i.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new rp(e,t.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return kD()?8:kk(ns())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,o){const c={result:null};return this.ys(e,t).next((f=>{c.result=f})).next((()=>{if(!c.result)return this.ws(e,t,o,i).next((f=>{c.result=f}))})).next((()=>{if(c.result)return;const f=new lL;return this.Ss(e,t,f).next((y=>{if(c.result=y,this.Vs)return this.bs(e,t,f,y.size)}))})).next((()=>c.result))}bs(e,t,i,o){return i.documentReadCount<this.fs?(zl()<=Zt.DEBUG&&st("QueryEngine","SDK will not create cache indexes for query:",ql(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Be.resolve()):(zl()<=Zt.DEBUG&&st("QueryEngine","Query:",ql(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.gs*o?(zl()<=Zt.DEBUG&&st("QueryEngine","The SDK decides to create cache indexes for query:",ql(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fr(t))):Be.resolve())}ys(e,t){if(Nb(t))return Be.resolve(null);let i=Fr(t);return this.indexManager.getIndexType(e,i).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=cg(t,null,"F"),i=Fr(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((c=>{const f=dn(...c);return this.ps.getDocuments(e,f).next((y=>this.indexManager.getMinOffset(e,i).next((w=>{const x=this.Ds(t,y);return this.Cs(t,x,f,w.readTime)?this.ys(e,cg(t,null,"F")):this.vs(e,x,t,w)}))))})))))}ws(e,t,i,o){return Nb(t)||o.isEqual(Dt.min())?Be.resolve(null):this.ps.getDocuments(e,i).next((c=>{const f=this.Ds(t,c);return this.Cs(t,f,i,o)?Be.resolve(null):(zl()<=Zt.DEBUG&&st("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),ql(t)),this.vs(e,f,t,Ik(o,Nu)).next((y=>y)))}))}Ds(e,t){let i=new bi(C_(e));return t.forEach(((o,c)=>{df(e,c)&&(i=i.add(c))})),i}Cs(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}Ss(e,t,i){return zl()<=Zt.DEBUG&&st("QueryEngine","Using full collection scan to execute query:",ql(t)),this.ps.getDocumentsMatchingQuery(e,t,ba.min(),i)}vs(e,t,i,o){return this.ps.getDocumentsMatchingQuery(e,i,o).next((c=>(t.forEach((f=>{c=c.insert(f.key,f)})),c)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const op="LocalStore",uL=3e8;class dL{constructor(e,t,i,o){this.persistence=e,this.Fs=t,this.serializer=o,this.Ms=new li(nn),this.xs=new hl((c=>Jg(c)),Qg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZP(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function hL(n,e,t,i){return new dL(n,e,t,i)}async function Y_(n,e){const t=on(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next((c=>(o=c,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((c=>{const f=[],y=[];let w=dn();for(const x of o){f.push(x.batchId);for(const A of x.mutations)w=w.add(A.key)}for(const x of c){y.push(x.batchId);for(const A of x.mutations)w=w.add(A.key)}return t.localDocuments.getDocuments(i,w).next((x=>({Ls:x,removedBatchIds:f,addedBatchIds:y})))}))}))}function W_(n){const e=on(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function fL(n,e){const t=on(n),i=e.snapshotVersion;let o=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(c=>{const f=t.Ns.newChangeBuffer({trackRemovals:!0});o=t.Ms;const y=[];e.targetChanges.forEach(((A,N)=>{const R=o.get(N);if(!R)return;y.push(t.Pi.removeMatchingKeys(c,A.removedDocuments,N).next((()=>t.Pi.addMatchingKeys(c,A.addedDocuments,N))));let k=R.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(N)!==null?k=k.withResumeToken(Hi.EMPTY_BYTE_STRING,Dt.min()).withLastLimboFreeSnapshotVersion(Dt.min()):A.resumeToken.approximateByteSize()>0&&(k=k.withResumeToken(A.resumeToken,i)),o=o.insert(N,k),(function(W,K,te){return W.resumeToken.approximateByteSize()===0||K.snapshotVersion.toMicroseconds()-W.snapshotVersion.toMicroseconds()>=uL?!0:te.addedDocuments.size+te.modifiedDocuments.size+te.removedDocuments.size>0})(R,k,A)&&y.push(t.Pi.updateTargetData(c,k))}));let w=Aa(),x=dn();if(e.documentUpdates.forEach((A=>{e.resolvedLimboDocuments.has(A)&&y.push(t.persistence.referenceDelegate.updateLimboDocument(c,A))})),y.push(mL(c,f,e.documentUpdates).next((A=>{w=A.ks,x=A.qs}))),!i.isEqual(Dt.min())){const A=t.Pi.getLastRemoteSnapshotVersion(c).next((N=>t.Pi.setTargetsMetadata(c,c.currentSequenceNumber,i)));y.push(A)}return Be.waitFor(y).next((()=>f.apply(c))).next((()=>t.localDocuments.getLocalViewOfDocuments(c,w,x))).next((()=>w))})).then((c=>(t.Ms=o,c)))}function mL(n,e,t){let i=dn(),o=dn();return t.forEach((c=>i=i.add(c))),e.getEntries(n,i).next((c=>{let f=Aa();return t.forEach(((y,w)=>{const x=c.get(y);w.isFoundDocument()!==x.isFoundDocument()&&(o=o.add(y)),w.isNoDocument()&&w.version.isEqual(Dt.min())?(e.removeEntry(y,w.readTime),f=f.insert(y,w)):!x.isValidDocument()||w.version.compareTo(x.version)>0||w.version.compareTo(x.version)===0&&x.hasPendingWrites?(e.addEntry(w),f=f.insert(y,w)):st(op,"Ignoring outdated watch update for ",y,". Current version:",x.version," Watch version:",w.version)})),{ks:f,qs:o}}))}function gL(n,e){const t=on(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let o;return t.Pi.getTargetData(i,e).next((c=>c?(o=c,Be.resolve(o)):t.Pi.allocateTargetId(i).next((f=>(o=new ma(e,f,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,o).next((()=>o)))))))})).then((i=>{const o=t.Ms.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function mg(n,e,t){const i=on(n),o=i.Ms.get(e),c=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",c,(f=>i.persistence.referenceDelegate.removeTarget(f,o)))}catch(f){if(!_c(f))throw f;st(op,`Failed to update sequence numbers for target ${e}: ${f}`)}i.Ms=i.Ms.remove(e),i.xs.delete(o.target)}function Vb(n,e,t){const i=on(n);let o=Dt.min(),c=dn();return i.persistence.runTransaction("Execute query","readwrite",(f=>(function(w,x,A){const N=on(w),R=N.xs.get(A);return R!==void 0?Be.resolve(N.Ms.get(R)):N.Pi.getTargetData(x,A)})(i,f,Fr(e)).next((y=>{if(y)return o=y.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(f,y.targetId).next((w=>{c=w}))})).next((()=>i.Fs.getDocumentsMatchingQuery(f,e,t?o:Dt.min(),t?c:dn()))).next((y=>(pL(i,rP(e),y),{documents:y,Qs:c})))))}function pL(n,e,t){let i=n.Os.get(e)||Dt.min();t.forEach(((o,c)=>{c.readTime.compareTo(i)>0&&(i=c.readTime)})),n.Os.set(e,i)}class Gb{constructor(){this.activeTargetIds=dP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xL{constructor(){this.Mo=new Gb,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Gb,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb="ConnectivityMonitor";class zb{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){st(Hb,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){st(Hb,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lh=null;function gg(){return lh===null?lh=(function(){return 268435456+Math.round(2147483648*Math.random())})():lh++,"0x"+lh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nm="RestConnection",vL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class wL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${o}`,this.Wo=this.databaseId.database===Fh?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Go(e,t,i,o,c){const f=gg(),y=this.zo(e,t.toUriEncodedString());st(Nm,`Sending RPC '${e}' ${f}:`,y,i);const w={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(w,o,c);const{host:x}=new URL(y),A=vc(x);return this.Jo(e,y,w,i,A).then((N=>(st(Nm,`Received RPC '${e}' ${f}: `,N),N)),(N=>{throw cc(Nm,`RPC '${e}' ${f} failed with error: `,N,"url: ",y,"request:",i),N}))}Ho(e,t,i,o,c,f){return this.Go(e,t,i,o,c)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ec})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,c)=>e[c]=o)),i&&i.headers.forEach(((o,c)=>e[c]=o))}zo(e,t){const i=vL[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi="WebChannelConnection";class EL extends wL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,o,c){const f=gg();return new Promise(((y,w)=>{const x=new a_;x.setWithCredentials(!0),x.listenOnce(l_.COMPLETE,(()=>{try{switch(x.getLastErrorCode()){case gh.NO_ERROR:const N=x.getResponseJson();st(Qi,`XHR for RPC '${e}' ${f} received:`,JSON.stringify(N)),y(N);break;case gh.TIMEOUT:st(Qi,`RPC '${e}' ${f} timed out`),w(new pt($e.DEADLINE_EXCEEDED,"Request time out"));break;case gh.HTTP_ERROR:const R=x.getStatus();if(st(Qi,`RPC '${e}' ${f} failed with status:`,R,"response text:",x.getResponseText()),R>0){let k=x.getResponseJson();Array.isArray(k)&&(k=k[0]);const H=k==null?void 0:k.error;if(H&&H.status&&H.message){const W=(function(te){const le=te.toLowerCase().replace(/_/g,"-");return Object.values($e).indexOf(le)>=0?le:$e.UNKNOWN})(H.status);w(new pt(W,H.message))}else w(new pt($e.UNKNOWN,"Server responded with status "+x.getStatus()))}else w(new pt($e.UNAVAILABLE,"Connection failed."));break;default:Ot(9055,{l_:e,streamId:f,h_:x.getLastErrorCode(),P_:x.getLastError()})}}finally{st(Qi,`RPC '${e}' ${f} completed.`)}}));const A=JSON.stringify(o);st(Qi,`RPC '${e}' ${f} sending request:`,o),x.send(t,"POST",A,i,15)}))}T_(e,t,i){const o=gg(),c=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],f=d_(),y=u_(),w={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},x=this.longPollingOptions.timeoutSeconds;x!==void 0&&(w.longPollingTimeout=Math.round(1e3*x)),this.useFetchStreams&&(w.useFetchStreams=!0),this.jo(w.initMessageHeaders,t,i),w.encodeInitMessageHeaders=!0;const A=c.join("");st(Qi,`Creating RPC '${e}' stream ${o}: ${A}`,w);const N=f.createWebChannel(A,w);this.I_(N);let R=!1,k=!1;const H=new bL({Yo:K=>{k?st(Qi,`Not sending because RPC '${e}' stream ${o} is closed:`,K):(R||(st(Qi,`Opening RPC '${e}' stream ${o} transport.`),N.open(),R=!0),st(Qi,`RPC '${e}' stream ${o} sending:`,K),N.send(K))},Zo:()=>N.close()}),W=(K,te,le)=>{K.listen(te,(ee=>{try{le(ee)}catch(de){setTimeout((()=>{throw de}),0)}}))};return W(N,mu.EventType.OPEN,(()=>{k||(st(Qi,`RPC '${e}' stream ${o} transport opened.`),H.o_())})),W(N,mu.EventType.CLOSE,(()=>{k||(k=!0,st(Qi,`RPC '${e}' stream ${o} transport closed`),H.a_(),this.E_(N))})),W(N,mu.EventType.ERROR,(K=>{k||(k=!0,cc(Qi,`RPC '${e}' stream ${o} transport errored. Name:`,K.name,"Message:",K.message),H.a_(new pt($e.UNAVAILABLE,"The operation could not be completed")))})),W(N,mu.EventType.MESSAGE,(K=>{var te;if(!k){const le=K.data[0];Jn(!!le,16349);const ee=le,de=(ee==null?void 0:ee.error)||((te=ee[0])==null?void 0:te.error);if(de){st(Qi,`RPC '${e}' stream ${o} received error:`,de);const Ee=de.status;let me=(function(F){const Q=mi[F];if(Q!==void 0)return P_(Q)})(Ee),U=de.message;me===void 0&&(me=$e.INTERNAL,U="Unknown error status: "+Ee+" with message "+de.message),k=!0,H.a_(new pt(me,U)),N.close()}else st(Qi,`RPC '${e}' stream ${o} received:`,le),H.u_(le)}})),W(y,c_.STAT_EVENT,(K=>{K.stat===tg.PROXY?st(Qi,`RPC '${e}' stream ${o} detected buffering proxy`):K.stat===tg.NOPROXY&&st(Qi,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{H.__()}),0),H}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Im(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X_(n){return new IP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,t,i=1e3,o=1.5,c=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=o,this.R_=c,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-i);o>0&&st("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb="PersistentStream";class _L{constructor(e,t,i,o,c,f,y,w){this.Mi=e,this.S_=i,this.b_=o,this.connection=c,this.authCredentialsProvider=f,this.appCheckCredentialsProvider=y,this.listener=w,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new K_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===$e.RESOURCE_EXHAUSTED?(Co(t.toString()),Co("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===$e.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,o])=>{this.D_===t&&this.G_(i,o)}),(i=>{e((()=>{const o=new pt($e.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(o)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{i((()=>this.z_(o)))})),this.stream.onMessage((o=>{i((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return st(qb,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(st(qb,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class TL extends _L{constructor(e,t,i,o,c,f){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,f),this.serializer=c}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=kP(this.serializer,e),i=(function(c){if(!("targetChange"in c))return Dt.min();const f=c.targetChange;return f.targetIds&&f.targetIds.length?Dt.min():f.readTime?sc(f.readTime):Dt.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=Ub(this.serializer),t.addTarget=(function(c,f){let y;const w=f.target;if(y=lg(w)?{documents:PP(c,w)}:{query:LP(c,w).ft},y.targetId=f.targetId,f.resumeToken.approximateByteSize()>0){y.resumeToken=MP(c,f.resumeToken);const x=hg(c,f.expectedCount);x!==null&&(y.expectedCount=x)}else if(f.snapshotVersion.compareTo(Dt.min())>0){y.readTime=RP(c,f.snapshotVersion.toTimestamp());const x=hg(c,f.expectedCount);x!==null&&(y.expectedCount=x)}return y})(this.serializer,e);const i=BP(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=Ub(this.serializer),t.removeTarget=e,this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AL{}class SL extends AL{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new pt($e.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,f])=>this.connection.Go(e,fg(t,i),o,c,f))).catch((c=>{throw c.name==="FirebaseError"?(c.code===$e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new pt($e.UNKNOWN,c.toString())}))}Ho(e,t,i,o,c){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([f,y])=>this.connection.Ho(e,fg(t,i),o,f,y,c))).catch((f=>{throw f.name==="FirebaseError"?(f.code===$e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),f):new pt($e.UNKNOWN,f.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class CL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Co(t),this.aa=!1):st("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mc="RemoteStore";class NL{constructor(e,t,i,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=c,this.Aa.Oo((f=>{i.enqueueAndForget((async()=>{qu(this)&&(st(mc,"Restarting streams for network reachability change."),await(async function(w){const x=on(w);x.Ea.add(4),await zu(x),x.Ra.set("Unknown"),x.Ea.delete(4),await gf(x)})(this))}))})),this.Ra=new CL(i,o)}}async function gf(n){if(qu(n))for(const e of n.da)await e(!0)}async function zu(n){for(const e of n.da)await e(!1)}function $_(n,e){const t=on(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),up(t)?cp(t):Tc(t).O_()&&lp(t,e))}function ap(n,e){const t=on(n),i=Tc(t);t.Ia.delete(e),i.O_()&&J_(t,e),t.Ia.size===0&&(i.O_()?i.L_():qu(t)&&t.Ra.set("Unknown"))}function lp(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Dt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Tc(n).Y_(e)}function J_(n,e){n.Va.Ue(e),Tc(n).Z_(e)}function cp(n){n.Va=new AP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Tc(n).start(),n.Ra.ua()}function up(n){return qu(n)&&!Tc(n).x_()&&n.Ia.size>0}function qu(n){return on(n).Ea.size===0}function Q_(n){n.Va=void 0}async function IL(n){n.Ra.set("Online")}async function RL(n){n.Ia.forEach(((e,t)=>{lp(n,e)}))}async function ML(n,e){Q_(n),up(n)?(n.Ra.ha(e),cp(n)):n.Ra.set("Unknown")}async function DL(n,e,t){if(n.Ra.set("Online"),e instanceof U_&&e.state===2&&e.cause)try{await(async function(o,c){const f=c.cause;for(const y of c.targetIds)o.Ia.has(y)&&(await o.remoteSyncer.rejectListen(y,f),o.Ia.delete(y),o.Va.removeTarget(y))})(n,e)}catch(i){st(mc,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Yb(n,i)}else if(e instanceof vh?n.Va.Ze(e):e instanceof L_?n.Va.st(e):n.Va.tt(e),!t.isEqual(Dt.min()))try{const i=await W_(n.localStore);t.compareTo(i)>=0&&await(function(c,f){const y=c.Va.Tt(f);return y.targetChanges.forEach(((w,x)=>{if(w.resumeToken.approximateByteSize()>0){const A=c.Ia.get(x);A&&c.Ia.set(x,A.withResumeToken(w.resumeToken,f))}})),y.targetMismatches.forEach(((w,x)=>{const A=c.Ia.get(w);if(!A)return;c.Ia.set(w,A.withResumeToken(Hi.EMPTY_BYTE_STRING,A.snapshotVersion)),J_(c,w);const N=new ma(A.target,w,x,A.sequenceNumber);lp(c,N)})),c.remoteSyncer.applyRemoteEvent(y)})(n,t)}catch(i){st(mc,"Failed to raise snapshot:",i),await Yb(n,i)}}async function Yb(n,e,t){if(!_c(e))throw e;n.Ea.add(1),await zu(n),n.Ra.set("Offline"),t||(t=()=>W_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{st(mc,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await gf(n)}))}async function Wb(n,e){const t=on(n);t.asyncQueue.verifyOperationInProgress(),st(mc,"RemoteStore received new credentials");const i=qu(t);t.Ea.add(3),await zu(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await gf(t)}async function OL(n,e){const t=on(n);e?(t.Ea.delete(2),await gf(t)):e||(t.Ea.add(2),await zu(t),t.Ra.set("Unknown"))}function Tc(n){return n.ma||(n.ma=(function(t,i,o){const c=on(t);return c.sa(),new TL(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Xo:IL.bind(null,n),t_:RL.bind(null,n),r_:ML.bind(null,n),H_:DL.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),up(n)?cp(n):n.Ra.set("Unknown")):(await n.ma.stop(),Q_(n))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(e,t,i,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=c,this.deferred=new ic,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((f=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,c){const f=Date.now()+i,y=new dp(e,t,f,o,c);return y.start(i),y}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pt($e.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Z_(n,e){if(Co("AsyncQueue",`${e}: ${n}`),_c(n))return new pt($e.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{static emptySet(e){return new rc(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Et.comparator(t.key,i.key):(t,i)=>Et.comparator(t.key,i.key),this.keyedMap=gu(),this.sortedSet=new li(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof rc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new rc;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(){this.ga=new li(Et.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ot(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class gc{constructor(e,t,i,o,c,f,y,w,x){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=c,this.fromCache=f,this.syncStateChanged=y,this.excludesMetadataChanges=w,this.hasCachedResults=x}static fromInitialDocuments(e,t,i,o,c){const f=[];return t.forEach((y=>{f.push({type:0,doc:y})})),new gc(e,t,rc.emptySet(t),f,i,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&uf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class PL{constructor(){this.queries=Kb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=on(t),c=o.queries;o.queries=Kb(),c.forEach(((f,y)=>{for(const w of y.Sa)w.onError(i)}))})(this,new pt($e.ABORTED,"Firestore shutting down"))}}function Kb(){return new hl((n=>S_(n)),uf)}async function LL(n,e){const t=on(n);let i=3;const o=e.query;let c=t.queries.get(o);c?!c.ba()&&e.Da()&&(i=2):(c=new kL,i=e.Da()?0:1);try{switch(i){case 0:c.wa=await t.onListen(o,!0);break;case 1:c.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(f){const y=Z_(f,`Initialization of query '${ql(e.query)}' failed`);return void e.onError(y)}t.queries.set(o,c),c.Sa.push(e),e.va(t.onlineState),c.wa&&e.Fa(c.wa)&&hp(t)}async function UL(n,e){const t=on(n),i=e.query;let o=3;const c=t.queries.get(i);if(c){const f=c.Sa.indexOf(e);f>=0&&(c.Sa.splice(f,1),c.Sa.length===0?o=e.Da()?0:1:!c.ba()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function BL(n,e){const t=on(n);let i=!1;for(const o of e){const c=o.query,f=t.queries.get(c);if(f){for(const y of f.Sa)y.Fa(o)&&(i=!0);f.wa=o}}i&&hp(t)}function FL(n,e,t){const i=on(n),o=i.queries.get(e);if(o)for(const c of o.Sa)c.onError(t);i.queries.delete(e)}function hp(n){n.Ca.forEach((e=>{e.next()}))}var pg,$b;($b=pg||(pg={})).Ma="default",$b.Cache="cache";class jL{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new gc(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=gc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==pg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT{constructor(e){this.key=e}}class tT{constructor(e){this.key=e}}class VL{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=dn(),this.mutatedKeys=dn(),this.eu=C_(e),this.tu=new rc(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new Xb,o=t?t.tu:this.tu;let c=t?t.mutatedKeys:this.mutatedKeys,f=o,y=!1;const w=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,x=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((A,N)=>{const R=o.get(A),k=df(this.query,N)?N:null,H=!!R&&this.mutatedKeys.has(R.key),W=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations);let K=!1;R&&k?R.data.isEqual(k.data)?H!==W&&(i.track({type:3,doc:k}),K=!0):this.su(R,k)||(i.track({type:2,doc:k}),K=!0,(w&&this.eu(k,w)>0||x&&this.eu(k,x)<0)&&(y=!0)):!R&&k?(i.track({type:0,doc:k}),K=!0):R&&!k&&(i.track({type:1,doc:R}),K=!0,(w||x)&&(y=!0)),K&&(k?(f=f.add(k),c=W?c.add(A):c.delete(A)):(f=f.delete(A),c=c.delete(A)))})),this.query.limit!==null)for(;f.size>this.query.limit;){const A=this.query.limitType==="F"?f.last():f.first();f=f.delete(A.key),c=c.delete(A.key),i.track({type:1,doc:A})}return{tu:f,iu:i,Cs:y,mutatedKeys:c}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const c=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const f=e.iu.ya();f.sort(((A,N)=>(function(k,H){const W=K=>{switch(K){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ot(20277,{Rt:K})}};return W(k)-W(H)})(A.type,N.type)||this.eu(A.doc,N.doc))),this.ou(i),o=o??!1;const y=t&&!o?this._u():[],w=this.Xa.size===0&&this.current&&!o?1:0,x=w!==this.Za;return this.Za=w,f.length!==0||x?{snapshot:new gc(this.query,e.tu,c,f,e.mutatedKeys,w===0,x,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:y}:{au:y}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Xb,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=dn(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new tT(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new eT(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=dn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return gc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const fp="SyncEngine";class GL{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class HL{constructor(e){this.key=e,this.hu=!1}}class zL{constructor(e,t,i,o,c,f){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=f,this.Pu={},this.Tu=new hl((y=>S_(y)),uf),this.Iu=new Map,this.Eu=new Set,this.du=new li(Et.comparator),this.Au=new Map,this.Ru=new ip,this.Vu={},this.mu=new Map,this.fu=fc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function qL(n,e,t=!0){const i=oT(n);let o;const c=i.Tu.get(e);return c?(i.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.lu()):o=await nT(i,e,t,!0),o}async function YL(n,e){const t=oT(n);await nT(t,e,!0,!1)}async function nT(n,e,t,i){const o=await gL(n.localStore,Fr(e)),c=o.targetId,f=n.sharedClientState.addLocalQueryTarget(c,t);let y;return i&&(y=await WL(n,e,c,f==="current",o.resumeToken)),n.isPrimaryClient&&t&&$_(n.remoteStore,o),y}async function WL(n,e,t,i,o){n.pu=(N,R,k)=>(async function(W,K,te,le){let ee=K.view.ru(te);ee.Cs&&(ee=await Vb(W.localStore,K.query,!1).then((({documents:U})=>K.view.ru(U,ee))));const de=le&&le.targetChanges.get(K.targetId),Ee=le&&le.targetMismatches.get(K.targetId)!=null,me=K.view.applyChanges(ee,W.isPrimaryClient,de,Ee);return Qb(W,K.targetId,me.au),me.snapshot})(n,N,R,k);const c=await Vb(n.localStore,e,!0),f=new VL(e,c.Qs),y=f.ru(c.documents),w=Hu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),x=f.applyChanges(y,n.isPrimaryClient,w);Qb(n,t,x.au);const A=new GL(e,t,f);return n.Tu.set(e,A),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),x.snapshot}async function XL(n,e,t){const i=on(n),o=i.Tu.get(e),c=i.Iu.get(o.targetId);if(c.length>1)return i.Iu.set(o.targetId,c.filter((f=>!uf(f,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await mg(i.localStore,o.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(o.targetId),t&&ap(i.remoteStore,o.targetId),xg(i,o.targetId)})).catch(rf)):(xg(i,o.targetId),await mg(i.localStore,o.targetId,!0))}async function KL(n,e){const t=on(n),i=t.Tu.get(e),o=t.Iu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),ap(t.remoteStore,i.targetId))}async function iT(n,e){const t=on(n);try{const i=await fL(t.localStore,e);e.targetChanges.forEach(((o,c)=>{const f=t.Au.get(c);f&&(Jn(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?f.hu=!0:o.modifiedDocuments.size>0?Jn(f.hu,14607):o.removedDocuments.size>0&&(Jn(f.hu,42227),f.hu=!1))})),await rT(t,i,e)}catch(i){await rf(i)}}function Jb(n,e,t){const i=on(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.Tu.forEach(((c,f)=>{const y=f.view.va(e);y.snapshot&&o.push(y.snapshot)})),(function(f,y){const w=on(f);w.onlineState=y;let x=!1;w.queries.forEach(((A,N)=>{for(const R of N.Sa)R.va(y)&&(x=!0)})),x&&hp(w)})(i.eventManager,e),o.length&&i.Pu.H_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function $L(n,e,t){const i=on(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Au.get(e),c=o&&o.key;if(c){let f=new li(Et.comparator);f=f.insert(c,es.newNoDocument(c,Dt.min()));const y=dn().add(c),w=new mf(Dt.min(),new Map,new li(nn),f,y);await iT(i,w),i.du=i.du.remove(c),i.Au.delete(e),mp(i)}else await mg(i.localStore,e,!1).then((()=>xg(i,e,t))).catch(rf)}function xg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||sT(n,i)}))}function sT(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(ap(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),mp(n))}function Qb(n,e,t){for(const i of t)i instanceof eT?(n.Ru.addReference(i.key,e),JL(n,i)):i instanceof tT?(st(fp,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||sT(n,i.key)):Ot(19791,{wu:i})}function JL(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(st(fp,"New document in limbo: "+t),n.Eu.add(i),mp(n))}function mp(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Et($n.fromString(e)),i=n.fu.next();n.Au.set(i,new HL(t)),n.du=n.du.insert(t,i),$_(n.remoteStore,new ma(Fr(Zg(t.path)),i,"TargetPurposeLimboResolution",of.ce))}}async function rT(n,e,t){const i=on(n),o=[],c=[],f=[];i.Tu.isEmpty()||(i.Tu.forEach(((y,w)=>{f.push(i.pu(w,e,t).then((x=>{var A;if((x||t)&&i.isPrimaryClient){const N=x?!x.fromCache:(A=t==null?void 0:t.targetChanges.get(w.targetId))==null?void 0:A.current;i.sharedClientState.updateQueryState(w.targetId,N?"current":"not-current")}if(x){o.push(x);const N=rp.As(w.targetId,x);c.push(N)}})))})),await Promise.all(f),i.Pu.H_(o),await(async function(w,x){const A=on(w);try{await A.persistence.runTransaction("notifyLocalViewChanges","readwrite",(N=>Be.forEach(x,(R=>Be.forEach(R.Es,(k=>A.persistence.referenceDelegate.addReference(N,R.targetId,k))).next((()=>Be.forEach(R.ds,(k=>A.persistence.referenceDelegate.removeReference(N,R.targetId,k)))))))))}catch(N){if(!_c(N))throw N;st(op,"Failed to update sequence numbers: "+N)}for(const N of x){const R=N.targetId;if(!N.fromCache){const k=A.Ms.get(R),H=k.snapshotVersion,W=k.withLastLimboFreeSnapshotVersion(H);A.Ms=A.Ms.insert(R,W)}}})(i.localStore,c))}async function QL(n,e){const t=on(n);if(!t.currentUser.isEqual(e)){st(fp,"User change. New user:",e.toKey());const i=await Y_(t.localStore,e);t.currentUser=e,(function(c,f){c.mu.forEach((y=>{y.forEach((w=>{w.reject(new pt($e.CANCELLED,f))}))})),c.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await rT(t,i.Ls)}}function ZL(n,e){const t=on(n),i=t.Au.get(e);if(i&&i.hu)return dn().add(i.key);{let o=dn();const c=t.Iu.get(e);if(!c)return o;for(const f of c){const y=t.Tu.get(f);o=o.unionWith(y.view.nu)}return o}}function oT(n){const e=on(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=iT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ZL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$L.bind(null,e),e.Pu.H_=BL.bind(null,e.eventManager),e.Pu.yu=FL.bind(null,e.eventManager),e}class qh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=X_(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return hL(this.persistence,new cL,e.initialUser,this.serializer)}Cu(e){return new q_(sp.mi,this.serializer)}Du(e){return new xL}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}qh.provider={build:()=>new qh};class e9 extends qh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Jn(this.persistence.referenceDelegate instanceof zh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new XP(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Cs.withCacheSize(this.cacheSizeBytes):Cs.DEFAULT;return new q_((i=>zh.mi(i,t)),this.serializer)}}class yg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Jb(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=QL.bind(null,this.syncEngine),await OL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new PL})()}createDatastore(e){const t=X_(e.databaseInfo.databaseId),i=(function(c){return new EL(c)})(e.databaseInfo);return(function(c,f,y,w){return new SL(c,f,y,w)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,o,c,f,y){return new NL(i,o,c,f,y)})(this.localStore,this.datastore,e.asyncQueue,(t=>Jb(this.syncEngine,t,0)),(function(){return zb.v()?new zb:new yL})())}createSyncEngine(e,t){return(function(o,c,f,y,w,x,A){const N=new zL(o,c,f,y,w,x);return A&&(N.gu=!0),N})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(o){const c=on(o);st(mc,"RemoteStore shutting down."),c.Ea.add(5),await zu(c),c.Aa.shutdown(),c.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}yg.provider={build:()=>new yg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t9{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Co("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sa="FirestoreClient";class n9{constructor(e,t,i,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=Zi.UNAUTHENTICATED,this.clientId=Xg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(i,(async f=>{st(Sa,"Received user=",f.uid),await this.authCredentialListener(f),this.user=f})),this.appCheckCredentials.start(i,(f=>(st(Sa,"Received new app check token=",f),this.appCheckCredentialListener(f,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ic;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Z_(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Rm(n,e){n.asyncQueue.verifyOperationInProgress(),st(Sa,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async o=>{i.isEqual(o)||(await Y_(e.localStore,o),i=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Zb(n,e){n.asyncQueue.verifyOperationInProgress();const t=await i9(n);st(Sa,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Wb(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,o)=>Wb(e.remoteStore,o))),n._onlineComponents=e}async function i9(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){st(Sa,"Using user provided OfflineComponentProvider");try{await Rm(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===$e.FAILED_PRECONDITION||o.code===$e.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;cc("Error using user provided cache. Falling back to memory cache: "+t),await Rm(n,new qh)}}else st(Sa,"Using default OfflineComponentProvider"),await Rm(n,new e9(void 0));return n._offlineComponents}async function s9(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(st(Sa,"Using user provided OnlineComponentProvider"),await Zb(n,n._uninitializedComponentsProvider._online)):(st(Sa,"Using default OnlineComponentProvider"),await Zb(n,new yg))),n._onlineComponents}async function eE(n){const e=await s9(n),t=e.eventManager;return t.onListen=qL.bind(null,e.syncEngine),t.onUnlisten=XL.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=YL.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=KL.bind(null,e.syncEngine),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aT(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT="firestore.googleapis.com",nE=!0;class iE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new pt($e.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=lT,this.ssl=nE}else this.host=e.host,this.ssl=e.ssl??nE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=z_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<YP)throw new pt($e.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Sk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=aT(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new pt($e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new pt($e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new pt($e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,o){return i.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gp{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new iE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pt($e.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new pt($e.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new iE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new gk;switch(i.type){case"firstParty":return new vk(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new pt($e.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=tE.get(t);i&&(st("ComponentProvider","Removing Datastore"),tE.delete(t),i.terminate())})(this),Promise.resolve()}}function r9(n,e,t,i={}){var x;n=ph(n,gp);const o=vc(e),c=n._getSettings(),f={...c,emulatorOptions:n._getEmulatorOptions()},y=`${e}:${t}`;o&&(y2(`https://${y}`),v2("Firestore",!0)),c.host!==lT&&c.host!==y&&cc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const w={...c,host:y,ssl:o,emulatorOptions:i};if(!ol(w,f)&&(n._setSettings(w),i.mockUserToken)){let A,N;if(typeof i.mockUserToken=="string")A=i.mockUserToken,N=Zi.MOCK_USER;else{A=AD(i.mockUserToken,(x=n._app)==null?void 0:x.options.projectId);const R=i.mockUserToken.sub||i.mockUserToken.user_id;if(!R)throw new pt($e.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");N=new Zi(R)}n._authCredentials=new pk(new f_(A,N))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new pf(this.firestore,e,this._query)}}class ms{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Du(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ms(this.firestore,e,this._key)}toJSON(){return{type:ms._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Vu(t,ms._jsonSchema))return new ms(e,i||null,new Et($n.fromString(t.referencePath)))}}ms._jsonSchemaVersion="firestore/documentReference/1.0",ms._jsonSchema={type:pi("string",ms._jsonSchemaVersion),referencePath:pi("string")};class Du extends pf{constructor(e,t,i){super(e,t,Zg(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ms(this.firestore,null,new Et(e))}withConverter(e){return new Du(this.firestore,e,this._path)}}function o9(n,e,...t){if(n=_r(n),arguments.length===1&&(e=Xg.newId()),Ak("doc","path",e),n instanceof gp){const i=$n.fromString(e,...t);return gb(i),new ms(n,null,new Et(i))}{if(!(n instanceof ms||n instanceof Du))throw new pt($e.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child($n.fromString(e,...t));return gb(i),new ms(n.firestore,n instanceof Du?n.converter:null,new Et(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE="AsyncQueue";class rE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new K_(this,"async_queue_retry"),this._c=()=>{const i=Im();i&&st(sE,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Im();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Im();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ic;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!_c(e))throw e;st(sE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Co("INTERNAL UNHANDLED ERROR: ",oE(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=dp.createAndSchedule(this,e,t,i,(c=>this.hc(c)));return this.tc.push(o),o}uc(){this.nc&&Ot(47125,{Pc:oE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function oE(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aE(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of i)if(c in o&&typeof o[c]=="function")return!0;return!1})(n,["next","error","complete"])}class vg extends gp{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new rE,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rE(e),this._firestoreClient=void 0,await e}}}function a9(n,e){const t=typeof n=="object"?n:_2(),i=typeof n=="string"?n:Fh,o=Lg(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const c=_D("firestore");c&&r9(o,...c)}return o}function l9(n){if(n._terminated)throw new pt($e.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||c9(n),n._firestoreClient}function c9(n){var i,o,c;const e=n._freezeSettings(),t=(function(y,w,x,A){return new jk(y,w,x,A.host,A.ssl,A.experimentalForceLongPolling,A.experimentalAutoDetectLongPolling,aT(A.experimentalLongPollingOptions),A.useFetchStreams,A.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(o=e.localCache)!=null&&o._offlineComponentProvider&&((c=e.localCache)!=null&&c._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new n9(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(y){const w=y==null?void 0:y._online.build();return{_offline:y==null?void 0:y._offline.build(w),_online:w}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ur(Hi.fromBase64String(e))}catch(t){throw new pt($e.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ur(Hi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ur._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Vu(e,Ur._jsonSchema))return Ur.fromBase64String(e.bytes)}}Ur._jsonSchemaVersion="firestore/bytes/1.0",Ur._jsonSchema={type:pi("string",Ur._jsonSchemaVersion),bytes:pi("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new pt($e.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new pt($e.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new pt($e.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return nn(this._lat,e._lat)||nn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:va._jsonSchemaVersion}}static fromJSON(e){if(Vu(e,va._jsonSchema))return new va(e.latitude,e.longitude)}}va._jsonSchemaVersion="firestore/geoPoint/1.0",va._jsonSchema={type:pi("string",va._jsonSchemaVersion),latitude:pi("number"),longitude:pi("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,o){if(i.length!==o.length)return!1;for(let c=0;c<i.length;++c)if(i[c]!==o[c])return!1;return!0})(this._values,e._values)}toJSON(){return{type:wa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Vu(e,wa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new wa(e.vectorValues);throw new pt($e.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}wa._jsonSchemaVersion="firestore/vectorValue/1.0",wa._jsonSchema={type:pi("string",wa._jsonSchemaVersion),vectorValues:pi("object")};const u9=new RegExp("[~\\*/\\[\\]]");function d9(n,e,t){if(e.search(u9)>=0)throw lE(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new cT(...e.split("."))._internalPath}catch{throw lE(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function lE(n,e,t,i,o){let c=`Function ${e}() called with invalid data`;c+=". ";let f="";return new pt($e.INVALID_ARGUMENT,c+n+f)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(e,t,i,o,c){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new ms(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new h9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(dT("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class h9 extends uT{data(){return super.data()}}function dT(n,e){return typeof e=="string"?d9(n,e):e instanceof cT?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f9(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new pt($e.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class m9{convertValue(e,t="none"){switch(Ta(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ai(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_a(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ot(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Gu(e,((o,c)=>{i[o]=this.convertValue(c,t)})),i}convertVectorValue(e){var i,o,c;const t=(c=(o=(i=e.fields)==null?void 0:i[sg].arrayValue)==null?void 0:o.values)==null?void 0:c.map((f=>ai(f.doubleValue)));return new wa(t)}convertGeoPoint(e){return new va(ai(e.latitude),ai(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=lf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Iu(e));default:return null}}convertTimestamp(e){const t=Ea(e);return new gi(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=$n.fromString(e);Jn(H_(i),9688,{name:e});const o=new Ru(i.get(1),i.get(3)),c=new Et(i.popFirst(5));return o.isEqual(t)||Co(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}class xu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class rl extends uT{constructor(e,t,i,o,c,f){super(e,t,i,o,f),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(dT("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new pt($e.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=rl._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}rl._jsonSchemaVersion="firestore/documentSnapshot/1.0",rl._jsonSchema={type:pi("string",rl._jsonSchemaVersion),bundleSource:pi("string","DocumentSnapshot"),bundleName:pi("string"),bundle:pi("string")};class wh extends rl{data(e={}){return super.data(e)}}class oc{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new xu(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new wh(this._firestore,this._userDataWriter,i.key,i,new xu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new pt($e.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,c){if(o._snapshot.oldDocs.isEmpty()){let f=0;return o._snapshot.docChanges.map((y=>{const w=new wh(o._firestore,o._userDataWriter,y.doc.key,y.doc,new xu(o._snapshot.mutatedKeys.has(y.doc.key),o._snapshot.fromCache),o.query.converter);return y.doc,{type:"added",doc:w,oldIndex:-1,newIndex:f++}}))}{let f=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((y=>c||y.type!==3)).map((y=>{const w=new wh(o._firestore,o._userDataWriter,y.doc.key,y.doc,new xu(o._snapshot.mutatedKeys.has(y.doc.key),o._snapshot.fromCache),o.query.converter);let x=-1,A=-1;return y.type!==0&&(x=f.indexOf(y.doc.key),f=f.delete(y.doc.key)),y.type!==1&&(f=f.add(y.doc),A=f.indexOf(y.doc.key)),{type:g9(y.type),doc:w,oldIndex:x,newIndex:A}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new pt($e.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=oc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Xg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],o=[];return this.docs.forEach((c=>{c._document!==null&&(t.push(c._document),i.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),o.push(c.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function g9(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ot(61501,{type:n})}}oc._jsonSchemaVersion="firestore/querySnapshot/1.0",oc._jsonSchema={type:pi("string",oc._jsonSchemaVersion),bundleSource:pi("string","QuerySnapshot"),bundleName:pi("string"),bundle:pi("string")};class hT extends m9{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ur(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ms(this.firestore,null,t)}}function p9(n,...e){var w,x,A;n=_r(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||aE(e[i])||(t=e[i++]);const o={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(aE(e[i])){const N=e[i];e[i]=(w=N.next)==null?void 0:w.bind(N),e[i+1]=(x=N.error)==null?void 0:x.bind(N),e[i+2]=(A=N.complete)==null?void 0:A.bind(N)}let c,f,y;if(n instanceof ms)f=ph(n.firestore,vg),y=Zg(n._key.path),c={next:N=>{e[i]&&e[i](x9(f,n,N))},error:e[i+1],complete:e[i+2]};else{const N=ph(n,pf);f=ph(N.firestore,vg),y=N._query;const R=new hT(f);c={next:k=>{e[i]&&e[i](new oc(f,R,N,k))},error:e[i+1],complete:e[i+2]},f9(n._query)}return(function(R,k,H,W){const K=new t9(W),te=new jL(k,K,H);return R.asyncQueue.enqueueAndForget((async()=>LL(await eE(R),te))),()=>{K.Nu(),R.asyncQueue.enqueueAndForget((async()=>UL(await eE(R),te)))}})(l9(f),y,o,c)}function x9(n,e,t){const i=t.docs.get(e._key),o=new hT(n);return new rl(n,o,e._key,i,new xu(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(o){Ec=o})(wc),lc(new al("firestore",((i,{instanceIdentifier:o,options:c})=>{const f=i.getProvider("app").getImmediate(),y=new vg(new xk(i.getProvider("auth-internal")),new wk(f,i.getProvider("app-check-internal")),(function(x,A){if(!Object.prototype.hasOwnProperty.apply(x.options,["projectId"]))throw new pt($e.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ru(x.options.projectId,A)})(f,o),f);return c={useFetchStreams:t,...c},y._setSettings(c),y}),"PUBLIC").setMultipleInstances(!0)),xa(db,hb,e),xa(db,hb,"esm2020")})();const y9={apiKey:"AIzaSyC_xeE4wQXpGvlYJwBVbbyXH1AH7x8baJc",authDomain:"tiny-tastes-tracker-ai.firebaseapp.com",projectId:"tiny-tastes-tracker-ai",storageBucket:"tiny-tastes-tracker-ai.firebasestorage.app",messagingSenderId:"87950543929",appId:"1:87950543929:web:2e63d2392fd65b596411e8",measurementId:"G-4WGBFJBMGL"},fT=E2(y9),Ac=fk(fT),v9=a9(fT),w9=new wo,b9=async()=>{try{await EO(Ac,w9)}catch(n){throw console.error("Google Login failed",n),n}},E9=async(n,e)=>{try{return(await Q5(Ac,n,e)).user}catch(t){throw console.error("Registration failed",t),t}},_9=async(n,e)=>{try{return(await Z5(Ac,n,e)).user}catch(t){throw console.error("Login failed",t),t}},T9=async()=>{try{await nO(Ac)}catch(n){console.error("Logout failed",n)}};X2(Ac,n=>{n?(console.log("User is signed in:",n.uid),A9(n.uid)):console.log("User is signed out")});function A9(n){const e=o9(v9,"users",n);p9(e,t=>{t.exists()?console.log("Real-time data received:",t.data()):console.log("No data found for this user yet.")})}function S9(){const[n,e]=oe.useState(null),[t,i]=oe.useState(""),[o,c]=oe.useState(""),[f,y]=oe.useState(!1),[w,x]=oe.useState("");oe.useEffect(()=>{const N=X2(Ac,R=>{e(R)});return()=>N()},[]);const A=async N=>{N.preventDefault(),x("");try{f?await E9(t,o):await _9(t,o),i(""),c("")}catch(R){console.error("Auth error:",R);let k=R.message.replace("Firebase: ","");R.code==="auth/email-already-in-use"?k="This email is already in use. Please sign in.":R.code==="auth/invalid-credential"||R.code==="auth/user-not-found"||R.code==="auth/wrong-password"?k="Invalid email or password.":R.code==="auth/weak-password"?k="Password should be at least 6 characters.":R.message&&R.message.includes("requests-from-referer")&&(k="Configuration Error: Domain not authorized in Google Cloud Console API Key settings."),x(k)}};return n?h.jsxs("div",{className:"p-4 bg-white rounded-lg shadow-sm border border-gray-100 max-w-md mx-auto mt-6",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[h.jsx("div",{className:"w-12 h-12 bg-teal-100 rounded-full flex items-center justify-center text-teal-700 font-bold text-xl",children:n.email?n.email[0].toUpperCase():"U"}),h.jsxs("div",{className:"overflow-hidden",children:[h.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:n.email}),h.jsx("p",{className:"text-xs text-gray-500",children:"Signed in"})]})]}),h.jsx("button",{onClick:T9,className:"w-full py-2 px-4 bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-lg text-sm font-medium transition-colors border border-gray-200",children:"Sign Out"})]}):h.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-sm border border-gray-100 max-w-md mx-auto mt-6",children:[h.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6 text-center",children:f?"Create Account":"Welcome Back"}),w&&h.jsx("div",{className:"mb-4 p-3 bg-red-50 text-red-700 text-sm rounded-lg border border-red-100",children:w}),h.jsxs("form",{onSubmit:A,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),h.jsx("input",{type:"email",value:t,onChange:N=>i(N.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500",placeholder:"you@example.com",required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),h.jsx("input",{type:"password",value:o,onChange:N=>c(N.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500",placeholder:"",required:!0})]}),h.jsx("button",{type:"submit",className:"w-full py-2.5 px-4 bg-teal-600 hover:bg-teal-700 text-white rounded-lg text-sm font-medium transition-colors shadow-sm",children:f?"Sign Up":"Sign In"})]}),h.jsxs("div",{className:"mt-6",children:[h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-0 flex items-center",children:h.jsx("div",{className:"w-full border-t border-gray-200"})}),h.jsx("div",{className:"relative flex justify-center text-sm",children:h.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),h.jsxs("button",{onClick:b9,className:"mt-4 w-full py-2.5 px-4 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 rounded-lg text-sm font-medium transition-colors shadow-sm flex items-center justify-center gap-2",children:[h.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[h.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),h.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),h.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),h.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Google"]})]}),h.jsx("div",{className:"mt-6 text-center",children:h.jsx("button",{onClick:()=>y(!f),className:"text-sm text-teal-600 hover:text-teal-700 font-medium",children:f?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})}const C9=cE.lazy(()=>YA(()=>Promise.resolve().then(()=>lD),void 0)),N9=()=>{var w;const{state:n,actions:e}=mD(),{modalState:t}=n,[i,o]=oe.useState("tracker"),{mode:c,config:f}=fD(n.userProfile);oe.useEffect(()=>{f&&f.navItems.length>0&&(f.navItems.some(A=>A.id===i)||o(f.navItems[0].id))},[c,f]);const y=()=>{var A;const x=f.themeColor.replace("bg-","").replace("-600","").replace("-500","");switch(i){case"tracker":return h.jsx(uw,{triedFoods:n.activeTriedFoods,customFoods:n.customFoods,onFoodClick:N=>e.setModalState({type:"LOG_FOOD",food:N}),userProfile:n.userProfile,onShowGuide:N=>e.setModalState({type:"HOW_TO_SERVE",food:N,customDetails:N.isCustom?N.details:void 0}),onAddCustomFood:N=>e.setModalState({type:"ADD_CUSTOM_FOOD",initialName:N}),onScanBarcode:c==="TODDLER"?()=>e.setModalState({type:"SCAN_BARCODE"}):void 0,baseColor:x});case"recommendations":return h.jsx(A6,{userProfile:n.userProfile,triedFoods:n.activeTriedFoods,onSaveProfile:e.handleUpdateProfile,onFoodClick:N=>e.setModalState({type:"LOG_FOOD",food:N}),onShowSubstitutes:N=>e.setModalState({type:"SUBSTITUTES",food:N}),onShowFlavorPairing:()=>e.setModalState({type:"FLAVOR_PAIRING"}),baseColor:x});case"recipes":return h.jsx(M6,{recipes:n.recipes,mealPlan:n.mealPlan,triedFoods:n.activeTriedFoods,customFoods:n.customFoods,savedStrategies:n.activeSavedStrategies,manualShoppingItems:n.manualShoppingItems,shoppingCheckedItems:n.shoppingCheckedItems,onShowAddRecipe:()=>e.setModalState({type:"ADD_RECIPE"}),onShowImportRecipe:()=>e.setModalState({type:"IMPORT_RECIPE"}),onShowSuggestRecipe:()=>e.setModalState({type:"SUGGEST_RECIPE"}),onViewRecipe:N=>e.setModalState({type:"VIEW_RECIPE",recipe:N}),onAddToPlan:(N,R)=>e.setModalState({type:"SELECT_RECIPE",date:N,meal:R}),onRemoveFromPlan:e.removeMealFromPlan,onShowShoppingList:()=>e.setModalState({type:"SHOPPING_LIST"}),onBatchLog:e.handleBatchLogMeal,onUpdateBatchLog:e.handleUpdateBatchLog,onCreateRecipe:e.handleCreateRecipe,onEditRecipe:N=>e.setModalState({type:"ADD_RECIPE",recipeData:N}),onDeleteRecipe:e.handleDeleteRecipe,onDeleteCustomFood:e.handleDeleteCustomFood,onAddCustomFood:N=>e.setModalState({type:"ADD_CUSTOM_FOOD",initialName:N}),onScanBarcode:()=>e.setModalState({type:"SCAN_BARCODE"}),onAddManualShoppingItem:e.handleAddManualItem,onToggleShoppingItem:e.handleToggleShoppingItem,onClearCheckedShoppingItems:e.handleClearCheckedItems,baseColor:x,appMode:c});case"learn":return h.jsx(k6,{mode:c,baseColor:x,onStartLiveSage:()=>e.setModalState({type:"LIVE_SAGE"})});case"profile":return h.jsxs(h.Fragment,{children:[h.jsx(S9,{}),h.jsx(G6,{userProfile:n.userProfile,triedFoods:n.activeTriedFoods,milestones:n.activeMilestones,onSaveProfile:e.handleUpdateProfile,onResetData:e.handleResetData,onShowDoctorReport:()=>e.setModalState({type:"DOCTOR_REPORT"}),onUpdateMilestone:e.handleUpdateMilestone,onShowCertificate:()=>{var N;return e.setModalState({type:"CERTIFICATE",babyName:((N=n.userProfile)==null?void 0:N.babyName)||"Baby",date:new Date().toLocaleDateString()})},baseColor:x})]});case"feed":case"health_check":case"sleep_growth":return h.jsx(iM,{currentPage:i,feedLogs:n.feedLogs,diaperLogs:n.diaperLogs,sleepLogs:n.sleepLogs,medicineLogs:n.medicineLogs,growthLogs:n.growthLogs,onLogFeed:e.handleLogFeed,onLogDiaper:e.handleLogDiaper,onLogSleep:e.handleLogSleep,onUpdateSleepLog:e.handleUpdateSleepLog,onLogMedicine:e.handleLogMedicine,onLogGrowth:e.handleLogGrowth,onDeleteGrowth:e.handleDeleteGrowth,baseColor:x,userProfile:n.userProfile,onUpdateProfile:e.handleUpdateProfile});case"picky_eater":return h.jsx(H6,{baseColor:x,savedStrategies:n.activeSavedStrategies,onSaveStrategy:e.handleSaveStrategy,onDeleteStrategy:e.handleDeleteStrategy,safeFoods:((A=n.userProfile)==null?void 0:A.safeFoods)||[],onUpdateSafeFoods:e.handleUpdateSafeFoods});case"balance":return h.jsx(q6,{triedFoods:n.activeTriedFoods,baseColor:x});case"growth":return h.jsx(sM,{growthLogs:n.growthLogs,onLogGrowth:e.handleLogGrowth,onDeleteGrowth:e.handleDeleteGrowth,baseColor:x,userProfile:n.userProfile});default:return h.jsx(uw,{triedFoods:n.activeTriedFoods,customFoods:n.customFoods,onFoodClick:N=>e.setModalState({type:"LOG_FOOD",food:N}),userProfile:n.userProfile,onShowGuide:N=>e.setModalState({type:"HOW_TO_SERVE",food:N,customDetails:N.isCustom?N.details:void 0}),onAddCustomFood:N=>e.setModalState({type:"ADD_CUSTOM_FOOD",initialName:N}),onScanBarcode:c==="TODDLER"?()=>e.setModalState({type:"SCAN_BARCODE"}):void 0,baseColor:x})}};return h.jsxs(XA,{currentPage:i,setCurrentPage:o,profile:n.userProfile,allProfiles:n.profiles,onSwitchProfile:e.setActiveChildId,onAddProfile:()=>e.setModalState({type:"ADD_CHILD"}),progress:{triedCount:new Set(n.activeTriedFoods.map(x=>x.id)).size,totalCount:ac.length+n.customFoods.length},mode:c,config:f,children:[h.jsx(oe.Suspense,{fallback:h.jsx("div",{className:"p-4 text-center",children:"Loading..."}),children:y()}),t.type==="LOG_FOOD"&&h.jsx(fM,{food:t.food,existingLog:n.activeTriedFoods.find(x=>x.id===t.food.name&&x.date===new Date().toISOString().split("T")[0]&&!x.meal),onClose:()=>e.setModalState({type:null}),onSave:e.handleSaveFoodLog,onShowGuide:x=>e.setModalState({type:"HOW_TO_SERVE",food:x,returnToLog:!0,customDetails:x.isCustom?x.details:void 0}),onIncrementTry:e.handleIncrementTry,baseColor:f.themeColor.replace("bg-","").replace("-600","").replace("-500",""),appMode:c}),t.type==="HOW_TO_SERVE"&&h.jsx(mM,{food:t.food,onClose:()=>{t.type==="HOW_TO_SERVE"&&t.returnToLog?e.setModalState({type:"LOG_FOOD",food:t.food}):e.setModalState({type:null})}}),t.type==="ADD_RECIPE"&&h.jsx(pM,{onClose:()=>e.setModalState({type:null}),onSave:x=>{var A;t.type==="ADD_RECIPE"&&((A=t.recipeData)!=null&&A.id)?e.handleUpdateRecipe(t.recipeData.id,x):e.handleCreateRecipe(x),e.setModalState({type:null})},initialData:t.recipeData}),t.type==="VIEW_RECIPE"&&h.jsx(xM,{recipe:t.recipe,onClose:()=>e.setModalState({type:null}),onDelete:x=>{e.handleDeleteRecipe(x),e.setModalState({type:null})},onUpdateRating:(x,A)=>e.handleUpdateRecipe(x,{rating:A})}),t.type==="IMPORT_RECIPE"&&h.jsx(yM,{onClose:()=>e.setModalState({type:null}),onRecipeParsed:x=>e.setModalState({type:"ADD_RECIPE",recipeData:x})}),t.type==="SUGGEST_RECIPE"&&h.jsx(wM,{onClose:()=>e.setModalState({type:null}),userProfile:n.userProfile,onRecipeParsed:x=>e.setModalState({type:"ADD_RECIPE",recipeData:x})}),t.type==="SHOPPING_LIST"&&h.jsx(EM,{recipes:n.recipes,mealPlan:n.mealPlan,triedFoods:n.activeTriedFoods,manualItems:n.manualShoppingItems,checkedItems:n.shoppingCheckedItems,onAddManualItem:e.handleAddManualItem,onToggleItem:e.handleToggleShoppingItem,onClearChecked:e.handleClearCheckedItems,onClose:()=>e.setModalState({type:null})}),t.type==="SELECT_RECIPE"&&h.jsx(_M,{recipes:n.recipes,meal:t.meal,onClose:()=>e.setModalState({type:null}),onSelect:x=>e.saveMealToPlan(t.date,t.meal,x.id,x.title)}),t.type==="SUBSTITUTES"&&h.jsx(TM,{food:t.food,userProfile:n.userProfile,onClose:()=>e.setModalState({type:null}),onSelectSubstitute:x=>e.setModalState({type:"LOG_FOOD",food:x})}),t.type==="DOCTOR_REPORT"&&h.jsx(AM,{userProfile:n.userProfile,triedFoods:n.activeTriedFoods,onClose:()=>e.setModalState({type:null})}),t.type==="FLAVOR_PAIRING"&&h.jsx(SM,{triedFoods:n.activeTriedFoods,onClose:()=>e.setModalState({type:null})}),t.type==="ALLERGEN_ALERT"&&h.jsx(CM,{foodName:t.foodName,allergens:t.allergens,onClose:()=>e.setModalState({type:null})}),t.type==="BADGE_UNLOCKED"&&h.jsx(NM,{badge:t.badge,onClose:()=>e.setModalState({type:null})}),t.type==="CERTIFICATE"&&h.jsx(IM,{babyName:t.babyName,date:t.date,onClose:()=>e.setModalState({type:null})}),t.type==="ADD_CUSTOM_FOOD"&&h.jsx(DM,{initialName:t.initialName,scannedData:t.scannedData,onClose:()=>e.setModalState({type:null}),onSave:x=>{e.setCustomFoods(A=>[...A,x]),e.setModalState({type:null})}}),t.type==="LOG_MEAL"&&h.jsx(cD,{recipes:n.recipes,onClose:()=>e.setModalState({type:null}),onSave:e.handleBatchLogMeal,onCreateRecipe:e.handleCreateRecipe,baseColor:f.themeColor.replace("bg-","").replace("-600","").replace("-500",""),initialFoods:t.initialFoods,customFoods:n.customFoods,enableScanner:c==="TODDLER",onAddCustomFood:x=>e.setModalState({type:"ADD_CUSTOM_FOOD",initialName:x})}),t.type==="SCAN_BARCODE"&&h.jsx(oe.Suspense,{fallback:h.jsx("div",{children:"Loading Scanner..."}),children:h.jsx(C9,{onClose:()=>e.setModalState({type:null}),onScanSuccess:e.handleBarcodeScan})}),t.type==="ADD_CHILD"&&h.jsx(dD,{onClose:()=>e.setModalState({type:null}),onSave:e.handleCreateChild}),t.type==="LIVE_SAGE"&&h.jsx(hD,{onClose:()=>e.setModalState({type:null}),babyName:(w=n.userProfile)==null?void 0:w.babyName,mode:c}),n.isOnboarding&&h.jsx(uD,{onSave:x=>{const A={...x,id:crypto.randomUUID()};e.handleCreateChild(A)},onClose:()=>e.setIsOnboarding(!1)})]})},mT=document.getElementById("root");if(!mT)throw new Error("Could not find root element to mount to");const I9=HA.createRoot(mT);I9.render(h.jsx(cE.StrictMode,{children:h.jsx(N9,{})}));
